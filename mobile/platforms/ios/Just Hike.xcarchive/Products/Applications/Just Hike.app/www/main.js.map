{"version":3,"sources":["webpack:///./src/$_lazy_route_resource lazy namespace object","webpack:///./src/app/_util/admin/gpx-tools.ts","webpack:///./src/app/_util/color.ts","webpack:///./src/app/_util/cordova.ts","webpack:///./src/app/_util/downloader/downloader.ts","webpack:///./src/app/_util/downloader/parser.ts","webpack:///./src/app/_util/downloader/status-manager.ts","webpack:///./src/app/_util/file.ts","webpack:///./src/app/_util/generic.ts","webpack:///./src/app/_util/geolib/distance.ts","webpack:///./src/app/_util/leaflet/calculate.ts","webpack:///./src/app/_util/leaflet/converter.ts","webpack:///./src/app/_util/leaflet/icon.ts","webpack:///./src/app/_util/leaflet/layer.ts","webpack:///./src/app/_util/leaflet/marker.js","webpack:///./src/app/_util/leaflet/plugins/grid.js","webpack:///./src/app/_util/leaflet/tiles.ts","webpack:///./src/app/_util/math.ts","webpack:///./src/app/_util/poi.ts","webpack:///./src/app/_util/save.ts","webpack:///./src/app/_util/smooth-line.ts","webpack:///./src/app/_util/snow.ts","webpack:///./src/app/_util/timer.ts","webpack:///./src/app/_util/trail-meta.ts","webpack:///./src/app/_util/trail.ts","webpack:///./src/app/app-routing.module.ts","webpack:///./src/app/app.component.html","webpack:///./src/app/app.component.sass","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/base/base/base.component.html","webpack:///./src/app/base/base/base.component.sass","webpack:///./src/app/base/base/base.component.ts","webpack:///./src/app/base/button/button.component.html","webpack:///./src/app/base/button/button.component.sass","webpack:///./src/app/base/button/button.component.ts","webpack:///./src/app/base/icon/icon.component.html","webpack:///./src/app/base/icon/icon.component.sass","webpack:///./src/app/base/icon/icon.component.ts","webpack:///./src/app/base/location-based/location-based.component.html","webpack:///./src/app/base/location-based/location-based.component.sass","webpack:///./src/app/base/location-based/location-based.component.ts","webpack:///./src/app/base/settings-panel/settings-panel.component.html","webpack:///./src/app/base/settings-panel/settings-panel.component.sass","webpack:///./src/app/base/settings-panel/settings-panel.component.ts","webpack:///./src/app/base/trail-parser/trail-parser.ts","webpack:///./src/app/component/admin/admin.component.html","webpack:///./src/app/component/admin/admin.component.sass","webpack:///./src/app/component/admin/admin.component.ts","webpack:///./src/app/component/dialog/marker-dialog/marker-dialog.component.html","webpack:///./src/app/component/dialog/marker-dialog/marker-dialog.component.sass","webpack:///./src/app/component/dialog/marker-dialog/marker-dialog.component.ts","webpack:///./src/app/component/dialog/marker-dialog/rating/elements/add-score/add-score.component.html","webpack:///./src/app/component/dialog/marker-dialog/rating/elements/add-score/add-score.component.sass","webpack:///./src/app/component/dialog/marker-dialog/rating/elements/add-score/add-score.component.ts","webpack:///./src/app/component/dialog/marker-dialog/rating/elements/current-score/current-score.component.html","webpack:///./src/app/component/dialog/marker-dialog/rating/elements/current-score/current-score.component.sass","webpack:///./src/app/component/dialog/marker-dialog/rating/elements/current-score/current-score.component.ts","webpack:///./src/app/component/dialog/marker-dialog/rating/rating.component.html","webpack:///./src/app/component/dialog/marker-dialog/rating/rating.component.sass","webpack:///./src/app/component/dialog/marker-dialog/rating/rating.component.ts","webpack:///./src/app/component/dialog/note-dialog/note-dialog.component.html","webpack:///./src/app/component/dialog/note-dialog/note-dialog.component.sass","webpack:///./src/app/component/dialog/note-dialog/note-dialog.component.ts","webpack:///./src/app/component/dialog/offtrail-dialog/offtrail-dialog.component.html","webpack:///./src/app/component/dialog/offtrail-dialog/offtrail-dialog.component.sass","webpack:///./src/app/component/dialog/offtrail-dialog/offtrail-dialog.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/about/about.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/about/about.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/about/about.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/general-settings/general-settings.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/general-settings/general-settings.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/general-settings/general-settings.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/instructions/instructions.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/instructions/instructions.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/instructions/instructions.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/purchase-settings/purchase-settings.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/purchase-settings/purchase-settings.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/purchase-settings/purchase-settings.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/trail-settings/downloader/downloader.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/trail-settings/downloader/downloader.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/trail-settings/downloader/downloader.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/trail-settings/trail-settings.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/trail-settings/trail-settings.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/trail-settings/trail-settings.component.ts","webpack:///./src/app/component/dialog/settings-dialog/panels/user-settings/user-settings.component.html","webpack:///./src/app/component/dialog/settings-dialog/panels/user-settings/user-settings.component.sass","webpack:///./src/app/component/dialog/settings-dialog/panels/user-settings/user-settings.component.ts","webpack:///./src/app/component/dialog/settings-dialog/settings-dialog.component.html","webpack:///./src/app/component/dialog/settings-dialog/settings-dialog.component.sass","webpack:///./src/app/component/dialog/settings-dialog/settings-dialog.component.ts","webpack:///./src/app/component/elevation-profile/elevation-profile.component.html","webpack:///./src/app/component/elevation-profile/elevation-profile.component.sass","webpack:///./src/app/component/elevation-profile/elevation-profile.component.ts","webpack:///./src/app/component/elevation-profile/scrollbar/scrollbar.component.html","webpack:///./src/app/component/elevation-profile/scrollbar/scrollbar.component.sass","webpack:///./src/app/component/elevation-profile/scrollbar/scrollbar.component.ts","webpack:///./src/app/component/elevation-profile/virtual-list/guides/guides.component.html","webpack:///./src/app/component/elevation-profile/virtual-list/guides/guides.component.sass","webpack:///./src/app/component/elevation-profile/virtual-list/guides/guides.component.ts","webpack:///./src/app/component/elevation-profile/virtual-list/labels/labels.component.html","webpack:///./src/app/component/elevation-profile/virtual-list/labels/labels.component.sass","webpack:///./src/app/component/elevation-profile/virtual-list/labels/labels.component.ts","webpack:///./src/app/component/elevation-profile/virtual-list/list-item/list-item.component.html","webpack:///./src/app/component/elevation-profile/virtual-list/list-item/list-item.component.sass","webpack:///./src/app/component/elevation-profile/virtual-list/list-item/list-item.component.ts","webpack:///./src/app/component/elevation-profile/virtual-list/virtual-list.component.html","webpack:///./src/app/component/elevation-profile/virtual-list/virtual-list.component.sass","webpack:///./src/app/component/elevation-profile/virtual-list/virtual-list.component.ts","webpack:///./src/app/component/fa-sampler/fa-icon/fa-icon.component.html","webpack:///./src/app/component/fa-sampler/fa-icon/fa-icon.component.sass","webpack:///./src/app/component/fa-sampler/fa-icon/fa-icon.component.ts","webpack:///./src/app/component/fa-sampler/fa-sampler.component.html","webpack:///./src/app/component/fa-sampler/fa-sampler.component.sass","webpack:///./src/app/component/fa-sampler/fa-sampler.component.ts","webpack:///./src/app/component/leaflet-map/elements/dynamic-component-manager.ts","webpack:///./src/app/component/leaflet-map/elements/popup/popup.component.html","webpack:///./src/app/component/leaflet-map/elements/popup/popup.component.sass","webpack:///./src/app/component/leaflet-map/elements/popup/popup.component.ts","webpack:///./src/app/component/leaflet-map/leaflet-map.component.html","webpack:///./src/app/component/leaflet-map/leaflet-map.component.sass","webpack:///./src/app/component/leaflet-map/leaflet-map.component.ts","webpack:///./src/app/component/loader-overlay/loader-overlay.component.html","webpack:///./src/app/component/loader-overlay/loader-overlay.component.sass","webpack:///./src/app/component/loader-overlay/loader-overlay.component.ts","webpack:///./src/app/component/mile-detail/mile-detail.component.html","webpack:///./src/app/component/mile-detail/mile-detail.component.sass","webpack:///./src/app/component/mile-detail/mile-detail.component.ts","webpack:///./src/app/component/navigation/locator/locator.component.html","webpack:///./src/app/component/navigation/locator/locator.component.sass","webpack:///./src/app/component/navigation/locator/locator.component.ts","webpack:///./src/app/component/navigation/navigation.component.html","webpack:///./src/app/component/navigation/navigation.component.sass","webpack:///./src/app/component/navigation/navigation.component.ts","webpack:///./src/app/component/navigation/settings/settings.component.html","webpack:///./src/app/component/navigation/settings/settings.component.scss","webpack:///./src/app/component/navigation/settings/settings.component.ts","webpack:///./src/app/component/poi-list/dynamic-item/dynamic-item.component.html","webpack:///./src/app/component/poi-list/dynamic-item/dynamic-item.component.sass","webpack:///./src/app/component/poi-list/dynamic-item/dynamic-item.component.ts","webpack:///./src/app/component/poi-list/poi-list-item/poi-list-item.component.html","webpack:///./src/app/component/poi-list/poi-list-item/poi-list-item.component.sass","webpack:///./src/app/component/poi-list/poi-list-item/poi-list-item.component.ts","webpack:///./src/app/component/poi-list/poi-list.component.html","webpack:///./src/app/component/poi-list/poi-list.component.sass","webpack:///./src/app/component/poi-list/poi-list.component.ts","webpack:///./src/app/component/poi-list/poi-user-item/poi-user-item.component.html","webpack:///./src/app/component/poi-list/poi-user-item/poi-user-item.component.sass","webpack:///./src/app/component/poi-list/poi-user-item/poi-user-item.component.ts","webpack:///./src/app/component/poi-list/user-indicator/user-indicator.component.html","webpack:///./src/app/component/poi-list/user-indicator/user-indicator.component.sass","webpack:///./src/app/component/poi-list/user-indicator/user-indicator.component.ts","webpack:///./src/app/factory/dialog.service.ts","webpack:///./src/app/factory/marker.service.ts","webpack:///./src/app/parser/pct-data.ts","webpack:///./src/app/parser/shr-data.ts","webpack:///./src/app/pipe/distance.pipe.ts","webpack:///./src/app/pipe/filesize.pipe.ts","webpack:///./src/app/pipe/poi-sorting.pipe.ts","webpack:///./src/app/service/connection.service.ts","webpack:///./src/app/service/download.service.ts","webpack:///./src/app/service/filesystem.service.ts","webpack:///./src/app/service/loader.service.ts","webpack:///./src/app/service/location.service.ts","webpack:///./src/app/service/note.service.ts","webpack:///./src/app/service/orientation.service.ts","webpack:///./src/app/service/rate.service.ts","webpack:///./src/app/service/screen-mode.service.ts","webpack:///./src/app/service/sequential-resolver.service.ts","webpack:///./src/app/service/snow-generator.service.ts","webpack:///./src/app/service/trail-generator.service.ts","webpack:///./src/app/service/trail-resolver.service.ts","webpack:///./src/app/service/trail.service.ts","webpack:///./src/app/service/version-resolver.service.ts","webpack:///./src/app/settings.ts","webpack:///./src/app/type/rating.ts","webpack:///./src/app/type/snow.ts","webpack:///./src/environments/environment.prod.ts","webpack:///./src/main.ts","webpack:///crypto (ignored)"],"names":[],"mappings":"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ACA;AACA;AACA,gCAAgC,+BAA+B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8CAAQ;AAChC,2BAA2B,8CAAQ;AACnC;AACA,IAAI,8CAAQ;AACZ;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,0CAA0C,EAAE;AAC5C,KAAK;AACL,IAAI,8CAAQ;AACZ;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4CAAM;AACtC;AACA,aAAa;AACb,SAAS;AACT;AACA,2BAA2B,8CAAQ;AACnC;AACA;AACA;AACA;AACA,gCAAgC,4CAAM;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,+CAA+C;AAC/C;AACA;AACA,YAAY,4CAAM;AAClB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6CAAO;AAC9B,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL,CAAC;AACD,kC;;;;;;;;;;;ACzLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,yCAAyC,WAAW;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;;AAEA,gCAAgC;;AAEhC;AACA;AACA;AACA,GAAG;;;AAGH;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAc,kCAAkC;;AAEhD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;AAIA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;;AAGH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB;;AAEnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA4B,QAAQ;AACpC;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC,eAAe;AACjD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,wBAAwB;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,YAAY;;AAEjC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,YAAY;;AAEjC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,uCAAuC;AACvC;;AAEA;AACA;AACA,uBAAuB,YAAY;AACnC,yBAAyB,YAAY;;AAErC,oDAAoD;AACpD,uEAAuE;;AAEvE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB,YAAY;AACnC,yBAAyB,YAAY;;AAErC,oDAAoD;AACpD,uEAAuE;;AAEvE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC,yBAAyB,YAAY;;AAErC,iDAAiD;AACjD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAkD;AAClD;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;;AAEA;AACA;;AAEA,CAAC;;AAED;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACh4BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6B;AACiB;AACM;AAEpD,oBAAoB;AACpB,sCAAsC;AACtC,sCAAsC;AACtC,8CAA8C;AAC9C,iIAAiI;AACjI,IAAM,kBAAkB,GAAG,iDAAW,CAAC,MAAM,CAAC;IAE5C,UAAU,EAAE,UAAU,MAAM,EAAE,IAAI;QAChC,IAAM,KAAK,GAAG,iDAAW,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;QAExE,8BAA8B;QAC9B,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;QACnC,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;QACnC,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;QAEnC,KAAK,CAAC,YAAY,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;QAEvC,OAAO,KAAK,CAAC;IACf,CAAC;IAED,WAAW;IACX,YAAY,EAAE,UAAU,IAAI,EAAE,IAAI,EAAE,CAAC;QAEnC,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QAE9C,IAAM,WAAW,GAAG;YAChB,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YAC1B,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YAC1B,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;SAC7B,CAAC;QAEF,IAAI,UAAU,KAAK,SAAS,EAAE;YAC5B,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;YACvC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;SAC1E;aAAM,IAAI,UAAU,KAAK,UAAU,EAAE;YACpC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;SACtC;QAED,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;IAChB,CAAC;IAED,aAAa,EAAE,UAAU,MAAM,EAAE,GAAG;QAElC,IAAM,IAAI,GAAG;YACX,CAAC,EAAE,+DAAc,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;YAC9B,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;YAC7B,CAAC,EAAE,MAAM,CAAC,CAAC;YACX,CAAC,EAAE,MAAM,CAAC,CAAC;YACX,CAAC,EAAE,IAAI,CAAC,cAAc,EAAE;SACzB,CAAC;QACF,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE;YAChD,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;YACzD,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE;gBACpB,IAAI,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;aACvB;YACD,IAAI,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;SACxB;QAED,OAAO,8DAAa,CAAC,GAAG,EAAE,4DAAW,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;IAC7D,CAAC;CACF,CAAC,CAAC;AAEI,SAAS,aAAa,CAAE,GAAG,EAAE,OAAO;IACzC,OAAO,IAAI,kBAAkB,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AAC9C,CAAC;;;;;;;;;;;;;ACrED;AAAA;AAAA;AAAA;AAAA;AAAA,8BAA8B;AACkC;AAGzD,SAAS,OAAO,CAAE,MAAc;IACrC,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;QAC9B,IAAI,MAAM,GAAG,CAAC,KAAK,CAAC,EAAG;YACrB,OAAO,KAAK,CAAC;SACd;KACF;IACD,OAAO,MAAM,KAAK,CAAC,IAAI,MAAM,KAAK,CAAC,CAAC;AACtC,CAAC;AAED,+BAA+B;AACxB,SAAS,mBAAmB,CAAC,cAAsB,EAAE,KAAkB;IAAlB,kCAAkB;IAE5E,IAAI,SAAiB,CAAC;IACtB,IAAI,KAAa,CAAC;IAElB,IAAI,cAAc,GAAG,0EAAW,CAAC,IAAI,IAAI,GAAG,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,IAAI,EAAE;QAChF,gBAAgB;QAChB,SAAS,GAAG,MAAM,CAAC,CAAC,cAAc,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;QACnE,KAAK,GAAG,KAAK,CAAC;KAEf;SAAM;QACL,eAAe;QACf,SAAS,GAAG,MAAM,CAAC,CAAC,cAAc,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;QACnE,KAAK,GAAG,KAAK,CAAC;KACf;IAED,OAAO,EAAC,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAC,CAAC;AAC5C,CAAC;AAKD,uDAAuD;AACvD,oHAAoH;AAC7G,SAAS,qBAAqB,CAAC,KAAe,EAAE,WAA4B;IAEjF,IAAI,OAAO,CAAC;IACZ,IAAI,GAAG,CAAC;IACR,IAAI,KAAK,CAAC;IACV,IAAI,QAAgB,CAAC;IACrB,IAAI,SAAiB,CAAC;IACtB,IAAI,CAAC,CAAC;IACN,IAAI,IAAI,CAAC;IAET,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;QAE1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAG,CAAC,GAAG,WAAW,CAAC,MAAM,EAAG,CAAC,EAAE,EAAE;YAE7C,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,KAAK,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE;gBAC3D,IAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;gBAC9H,IAAM,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;gBACjE,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,QAAQ,GAAG,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;aAClF;iBAAM;gBACL,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;aAC1D;YAED,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YACtJ,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YAC5H,IAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,GAAG,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YACtI,IAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEhC,sCAAsC;YACtC,IAAM,OAAO,GAAG,GAAG,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,CAAC;YAE5C,6EAA6E;YAC7E,IAAI,OAAO,GAAG,GAAG,EAAE;gBACjB,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC;aACxC;YAED,IAAI,OAAO,IAAI,IAAI,IAAI,OAAO,GAAG,IAAI,EAAE;gBACrC,IAAI,OAAO,GAAG,GAAG,EAAE;oBACjB,IAAI,KAAK,GAAG,GAAG,EAAE;wBACf,GAAG,GAAG,CAAC,CAAC,CAAC,0BAA0B;wBACnC,KAAK,GAAG,CAAC,CAAC;qBACX;yBAAM;wBACL,KAAK,GAAG,CAAC,CAAC,CAAC,yBAAyB;wBACpC,GAAG,GAAG,CAAC,CAAC;qBACT;iBACF;qBAAM;oBAEL,mDAAmD;oBACnD,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;oBACpD,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;iBACrD;gBAED,OAAO,GAAG,IAAI,CAAC;gBACf,CAAC,GAAG,CAAC,CAAC;aACP;SACF;QAED,IAAM,EAAE,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;QACjE,IAAM,EAAE,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;QAEnE,QAAQ,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;QACpD,SAAS,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;KAEvD;IAED,mGAAmG;IAEnG,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAa,CAAC;AACjE,CAAC;;;;;;;;;;;;;ACzGD;AAAA;AAAA;AAAA;AAAqC;AAGrC,mFAAmF;AAC5E,SAAS,gBAAgB,CAAC,IAAW;IAE1C,IAAM,KAAK,GAAG,kDAAQ,CAAC,QAAQ,CAAC;IAEhC,IAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,UAAS,GAAG;QACtC,OAAO,GAAG,CAAC,MAAM,CAAC,KAAK,IAAI,CAAC;IAC9B,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,CAAK,oBAAoB;AAC5C,CAAC;AAED,0FAA0F;AACnF,SAAS,gBAAgB;IAE9B,IAAM,OAAO,GAAkB,EAAE,CAAC;IAElC,kDAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAS,GAAY;QAC7C,IAAI,GAAG,CAAC,OAAO,EAAE;YACf,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SACxB;IACH,CAAC,CAAC,CAAC;IAEH,OAAO,OAAO,CAAC;AACjB,CAAC;;;;;;;;;;;;;AC3BD;AAAA;AAAA;AAAA;AAAoC;AAEpC,oFAAoF;AAC7E,SAAS,UAAU,CAAC,IAAQ,EAAE,QAAe;IAElD,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;QAC5B,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;KAC5B;IAED,IAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,EAAC,IAAI,EAAE,0BAA0B,EAAC,CAAC,CAAC;IAClE,yDAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AACzB,CAAC;;;;;;;;;;;;;ACXD;AAAA;AAAA,wDAAwD;AAExD,sBAAsB;AACtB,IAAM,SAAS,GAAG,KAAK,CAAC;AAExB,uBAAuB;AACvB,IAAM,IAAI,GAAG,UAAC,MAAM,EAAE,MAAM;IAC1B,IAAM,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IACtC,IAAM,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IACtC,OAAO;QACL,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;QAC9D,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC;KACpC;AACH,CAAC,CAAC;AAEF,8BAA8B;AAC9B,IAAM,YAAY,GAAG,UAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAwB;IAAxB,yCAAwB;IAErE,yDAAyD;IACzD,oCAAoC;IACpC,yBAAyB;IACzB,IAAM,CAAC,GAAG,QAAQ,IAAI,OAAO,CAAC;IAC9B,IAAM,CAAC,GAAG,IAAI,IAAI,OAAO,CAAC;IAE1B,iCAAiC;IACjC,IAAM,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAErB,8DAA8D;IAC9D,IAAM,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAChD,IAAM,MAAM,GAAG,CAAC,CAAC,MAAM,GAAG,SAAS,CAAC;IAEpC,8DAA8D;IAC9D,IAAM,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;IAChD,IAAM,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;IAChD,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;AACf,CAAC,CAAC;AAEF,kCAAkC;AAClC,IAAM,aAAa,GAAG,UAAC,KAAK,EAAE,CAAC,EAAE,CAAC;IAEhC,sBAAsB;IACtB,IAAM,GAAG,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;IAEpD,oBAAoB;IACpB,IAAM,GAAG,GAAG,YAAY,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;IAC1D,OAAO,OAAK,GAAG,CAAC,CAAC,CAAC,SAAI,GAAG,CAAC,CAAC,CAAC,SAAI,GAAG,CAAC,CAAC,CAAC,SAAI,GAAG,CAAC,CAAC,CAAC,SAAI,KAAK,CAAC,CAAC,CAAC,SAAI,KAAK,CAAC,CAAC,CAAG;AAC5E,CAAC,CAAC;AAEF,gCAAgC;AACzB,SAAS,OAAO,CAAC,MAAM;IAC5B,oDAAoD;IACpD,IAAM,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,IAAK,QAAC,KAAK,CAAC;QACnD,CAAC,CAAC,OAAK,KAAK,CAAC,CAAC,CAAC,SAAI,KAAK,CAAC,CAAC,CAAG;QAC7B,CAAC,CAAI,GAAG,SAAI,aAAa,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAG,EAFI,CAEJ,EACtC,EAAE,CAAC,CAAC;IAER,OAAO,CAAC,CAAC;AACX,CAAC;;;;;;;;;;;;;ACzDD;AAAA;AAAA;AAAA;AAA6C;AAE7C;IAAA;IAGA,CAAC;IAAD,gBAAC;AAAD,CAAC;AAED,mBAAmB;AACnB;IAAA;IAIA,CAAC;IAAD,mBAAC;AAAD,CAAC;AAEM,SAAS,SAAS,CAAC,IAAyB,EAAE,OAAe,EAAE,IAAY,EAAE,OAAe;IAEjG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;QAC9B,OAAO;KACR;IAED,IAAM,UAAU,GAAG,IAAI,+CAAI,EAAE,CAAC;IAE9B,UAAU,CAAC,OAAO,GAAG,OAAO,CAAC;IAC7B,UAAU,CAAC,OAAO,GAAG,OAAO,CAAC;IAC7B,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC;IAEvB,IAAM,WAAW,GAAqB,EAAE,CAAC;IAEzC,yDAAyD;IACzD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAEpC,2CAA2C;QAC3C,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;YAC5B,yBAAyB;YACzB,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;SACvD;aAAM,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;YAC/C,qBAAqB;YACrB,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,EAAC,CAAC,CAAC;SAC3D;aAAM,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;YAC/C,oBAAoB;YACpB,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;SACrD;aAAM,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;YACjD,uBAAuB;YACvB,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;SACrD;KACF;IAED,IAAM,UAAU,GAA4B,EAAE,CAAC;IAE/C,qCAAqC;IACrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;QAE9C,IAAM,OAAO,GAAW,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAE9D,wCAAwC;QACxC,IAAM,SAAS,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;QAE5E,8DAA8D;QAC9D,IAAM,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QAE/F,gEAAgE;QAChE,IAAI,iBAAiB,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;QACzF,iBAAiB,GAAG,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAI,WAAW;QAEjE,+CAA+C;QAC/C,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;YACxB,UAAU,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;SAC1B;QAED,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CACtB,EAAC,QAAQ,EAAE,iBAAiB,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,EAAC,EACtE,EAAC,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,iBAAiB,GAAG,SAAS,CAAC,GAAG,YAAY,CAAC,EAAC,CAC1G,CAAC;QAEF,IAAI,MAAM,GAAG,iBAAiB,CAAC;QAE/B,+CAA+C;QAC/C,OAAO,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,SAAS,GAAG,iBAAiB,GAAG,CAAC,EAAE;YAEpE,MAAM,EAAG,CAAC;YAEV,4BAA4B;YAC5B,UAAU,CAAC,OAAO,GAAG,MAAM,GAAG,iBAAiB,CAAC,GAAG;gBACjD,EAAC,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,GAAG,YAAY,CAAC,EAAC;gBACpG,EAAC,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,GAAG,YAAY,CAAC,EAAC;aACjG,CAAC;SACH;QAED,qCAAqC;QACrC,UAAU,CAAE,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAE,GAAG;YACxD,IAAI,oDAAS,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,GAAG,YAAY,CAAC,CAAC;YACxF,IAAI,oDAAS,CAAC,MAAM,CAAC,CAAC,SAAS,GAAG,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC;SACzF,CAAC;KACH;IAED,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC;IAElC,OAAO,UAAU,CAAC;AACpB,CAAC;AAEM,SAAS,WAAW,CAAC,IAAU,EAAE,WAAmB;IACzD,oBAAoB;IACpB,4BAA4B;IAC5B,IAAM,aAAa,GAAe,EAAE,CAAC;IAErC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,QAA0B,EAAE,KAAa;QAExE,IAAI,QAAQ,EAAE;YACZ,QAAQ,CAAC,OAAO,EAAE,CAAC;YAEnB,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAgB;gBACzC,IAAI,KAAK,EAAE;oBACT,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;iBAC/C;YACH,CAAC,CAAC,CAAC;SACJ;QACD,aAAa,CAAC,WAAW,GAAG,KAAK,CAAC,GAAG,QAAQ,CAAC;IAChD,CAAC,CAAC,CAAC;IAEH,IAAI,CAAC,SAAS,GAAG,aAAa,CAAC;IAE/B,OAAO,IAAI,CAAC;AACd,CAAC;;;;;;;;;;;;;ACvHD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;IASE,kBAAY,EAAW,EAAE,OAAe,EAAE,MAAgB,EAAE,SAAkB,EAAE,aAAsB;QACpG,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;QACb,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAChE,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;IACrC,CAAC;IACH,eAAC;AAAD,CAAC;;AAED,iDAAiD;AAC1C,SAAS,UAAU,CAAC,OAAe,EAAE,MAAgB;IAC1D,IAAM,GAAG,GAAY,UAAU,CAAC;QAC9B,MAAM,EAAE,CAAC;IACX,CAAC,EAAE,OAAO,CAAC,CAAC;IAEZ,OAAO,IAAI,QAAQ,CAAC,GAAG,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;AAC5C,CAAC;AAED,8DAA8D;AACvD,SAAS,YAAY,CAAC,QAAkB;IAE7C,IAAM,YAAY,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;IAC1C,YAAY,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IAC1B,QAAQ,CAAC,aAAa,GAAG,QAAQ,CAAC,OAAO,GAAG,CAAC,YAAY,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC;IAChF,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC;IAE1B,OAAO,QAAQ,CAAC;AAClB,CAAC;AAED,sEAAsE;AAC/D,SAAS,aAAa,CAAC,QAAkB;IAC9C,OAAO,UAAU,CAAC,QAAQ,CAAC,aAAa,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC7D,CAAC;AAED,cAAc;AACP,SAAS,YAAY,CAAC,QAAkB;IAE7C,IAAI,QAAQ,EAAE;QAEZ,IAAI,QAAQ,CAAC,EAAE,EAAE;YACf,YAAY,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SAC3B;QAED,QAAQ,CAAC,MAAM,EAAE,CAAC;KACnB;IAED,QAAQ,GAAG,IAAI,CAAC;AAClB,CAAC;;;;;;;;;;;;;ACzDD;AAAA;AAAA;AAAA;AAAA;AAAA,IAAI,MAAwB,CAAC;AAE7B,MAAM;AACC,SAAS,gBAAgB,CAAC,IAAsB;IACrD,MAAM,GAAG,IAAI,CAAC;AAChB,CAAC;AAED,UAAU;AACH,SAAS,iBAAiB;IAC/B,OAAO,MAAM,CAAC;AAChB,CAAC;AAED,wFAAwF;AACjF,SAAS,oBAAoB,CAAC,EAAU;IAE7C,IAAI,CAAC,MAAM,EAAE;QACX,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;KACzC;IAED,KAAK,IAAM,GAAG,IAAI,MAAM,EAAE;QACxB,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE;YACzB,OAAO,MAAM,CAAC,GAAG,CAAc,CAAC;SACjC;KACF;IAED,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;AACtC,CAAC;AAED,4DAA4D;AACrD,SAAS,sBAAsB,CAAC,IAAY;IACjD,IAAI,CAAC,MAAM,EAAE;QACX,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;KACzC;IAED,OAAO,MAAM,CAAC,IAAI,CAAc,CAAC;AACnC,CAAC;;;;;;;;;;;;;ACrCD;AAAA;AAAA;AAAA;AAAA,uEAAuE;AACvE,2FAA2F;AAC3B;AAGhE,wHAAwH;AACjH,SAAS,kBAAkB,CAAC,eAAuB,EAAE,SAAiB,EAAE,GAAW,EAAE,KAAa,EAAE,OAAe;IAExH,IAAM,SAAS,GAAW,0EAAW,CAAC,IAAI,GAAG,CAAC,CAAC;IAE/C,IAAI,KAAK,GAAG,SAAS,GAAG,CAAC,EAAE;QACzB,IAAM,WAAW,GAAG,SAAS,GAAG,CAAC,GAAG,KAAK,CAAC;QAC1C,KAAK,GAAG,SAAS,CAAC;QAClB,SAAS,IAAI,WAAW,GAAG,CAAC,CAAC;KAC9B;IAED,SAAS,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,GAAG,CAAC,KAAK,GAAG,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC;IAEpE,oCAAoC;IACpC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;IAEpC,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,eAAe,CAAC,CAAC;AACjD,CAAC;AAGD,4BAA4B;AACrB,SAAS,aAAa,CAAC,IAAS,EAAE,KAAa,EAAE,UAAgC,EAAE,MAAsB;IAAxD,qDAAgC;IAAE,sCAAsB;IAE9G,8CAA8C;IAC9C,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;IAEzD,OAAO,KAAK,CAAC,OAAO,CAAC,CAAC;AACxB,CAAC;AAGD,uCAAuC;AACvC,SAAS,KAAK,CAAC,SAA0B;IAEvC,iBAAiB;IACjB,IAAQ,KAAK,GAAiB,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IAC7D,IAAQ,KAAK,GAAiB,MAAM,CAAC,KAAK,CAAC,CAAC;IAC5C,IAAQ,IAAI,GAAkB,MAAM,CAAC,KAAK,CAAC,CAAC;IAC5C,IAAQ,MAAM,GAAgB,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IAEhF,IAAM,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC,CAAG,QAAQ;IAC5C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;QAEhC,IAAM,SAAS,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;QAC/B,IAAM,UAAU,GAAG,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAE/C,IAAI,UAAU,GAAG,KAAK,EAAE;YAEtB,KAAK,GAAG,UAAU,CAAC;SAEpB;aAAM,IAAI,UAAU,GAAG,IAAI,EAAE;YAE5B,IAAI,GAAG,UAAU,CAAC;SACnB;KACF;IAED,OAAO,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,EAAC,CAAC;AAC9D,CAAC;;;;;;;;;;;;;;;;;;;;;;;AC7DwC;AACqE;AAE9G,YAAY;AACwE;AACkB;AAEtG,YAAY;AACoE;AACf;AAGjE,yCAAyC;AACzC,8DAA8D;AAC9D,sCAAsC;AACtC,IAAI;AAEJ,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,mBAAmB;QACzB,SAAS,EAAE,kHAAyB;QACpC,OAAO,EAAE;YACP,IAAI,EAAE,8FAAyB;SAChC;KACF;IACD;QACE,IAAI,EAAE,YAAY;QAClB,SAAS,EAAE,gGAAmB;QAC9B,OAAO,EAAE;YACP,IAAI,EAAE,8FAAyB;SAChC;KACF;IACD;QACE,IAAI,EAAE,EAAE;QACR,UAAU,EAAE,mBAAmB;QAC/B,SAAS,EAAE,MAAM;KAClB;IACD,IAAI;IACJ,eAAe;IACf,qCAAqC;IACrC,KAAK;IACL;QACE,IAAI,EAAE,OAAO;QACb,SAAS,EAAE,+EAAc;QACzB,OAAO,EAAE;YACP,IAAI,EAAE,8FAAyB;SAChC;KACF;CACF,CAAC;AAGF,+BAA+B;AAO/B;IAEE,UAAU;IAEV,0BAAoB,OAAe;QAAf,YAAO,GAAP,OAAO,CAAQ;QAEjC,2BAA2B;QAC3B,OAAO,CAAC,MAAM,CAAC,SAAS,CAAE,UAAC,KAAU;YAEnC,IAAI,KAAK,YAAY,+DAAe,EAAE;gBACpC,yBAAyB;aAC1B;YAED,IAAI,KAAK,YAAY,6DAAa,EAAE;gBAClC,yBAAyB;aAC1B;YAED,IAAI,KAAK,YAAY,+DAAe,EAAE;gBACpC,yBAAyB;gBAEzB,wBAAwB;gBACxB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAC1B;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAxBU,gBAAgB;QAN5B,8DAAQ,CAAC;YACR,OAAO,EAAE,CAAC,4DAAY,CAAC,OAAO,CAAC,MAAM,EAAE,EAAC,mBAAmB,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,KAAK,EAAC,CAAC;aAC5G;YACD,OAAO,EAAE,CAAC,4DAAY,CAAC;SACxB,CAAC;+EAM6B,sDAAM;OAJxB,gBAAgB,CAyB5B;IAAD,uBAAC;CAAA;AAzB4B;;;;;;;;;;;;AC1D7B,mU;;;;;;;;;;;ACAA,kCAAkC,kBAAkB,wBAAwB,gCAAgC,gCAAgC,mEAAmE,EAAE,oBAAoB,uBAAuB,uBAAuB,kEAAkE,EAAE,mBAAmB,kBAAkB,uBAAuB,EAAE,yCAAyC,kCAAkC,EAAE,+BAA+B,iBAAiB,EAAE,+CAA+C,+oC;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACArd;AACvD;AACX;AACyD;AACN;AACpC;AAC0C;AAClD;AACY;AAChB;AACgB;AACN;AAQzD;IAAkC,sEAAa;IAW7C,sBACU,MAAsB,EACtB,kBAAqC,EACrC,OAAkB,EAClB,cAA6B,EAC7B,QAAoB,EACpB,SAAmB,EACnB,aAAkC,EAClC,kBAAqC;QAR/C,YAUE,iBAAO,SAIR;QAbS,YAAM,GAAN,MAAM,CAAgB;QACtB,wBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,aAAO,GAAP,OAAO,CAAW;QAClB,oBAAc,GAAd,cAAc,CAAe;QAC7B,cAAQ,GAAR,QAAQ,CAAY;QACpB,eAAS,GAAT,SAAS,CAAU;QACnB,mBAAa,GAAb,aAAa,CAAqB;QAClC,wBAAkB,GAAlB,kBAAkB,CAAmB;QAdxC,gBAAU,GAAQ,IAAI,CAAC,CAAI,iCAAiC;QAC5D,kBAAY,GAAM,IAAI,CAAC,CAAI,iBAAiB;QAiBjD,qFAAqF;QACrF,yEAAe,CAAC,QAAQ,GAAG,KAAI,CAAC,SAAS,CAAC;;IAC5C,CAAC;IAED,+BAAQ,GAAR;QAAA,iBAsCC;QApCC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,uCAAuC,CAAC,EAAE;YAEtE,OAAO,CAAC,GAAG,CAAC,2BAA2B,EAAE,SAAS,CAAC,SAAS,CAAC,CAAC;YAE9D,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,aAAa,EAAE;gBAC7C,KAAK,CAAC,QAAQ,EAAE,CAAC;gBACjB,KAAK,CAAC,mBAAmB,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;YACrD,CAAC,CAAC,CAAC;SAEJ;aAAM;YAEL,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;YACpC,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QAED,mBAAmB;QACnB,IAAI,CAAC,eAAe,CAAC,eAAe,EAAE,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,GAAW;YACtF,KAAI,CAAC,UAAU,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,CAAC,KAAI,CAAC,UAAU,CAAC;YAC1F,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,MAAM,EAAE;gBAC5B,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aACzB;QACH,CAAC,CAAC,CAAC,CAAC;QAEJ,8BAA8B;QAC9B,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC1D,IAAI,SAAS,EAAE;YACb,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;YAC5C,IAAM,OAAO,GAAG,UAAU,CAAC;gBACzB,KAAK,CAAC,mBAAmB,EAAE,CAAC;YAC9B,CAAC,EAAE,GAAG,CAAC,CAAC;SACT;QAED,IAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,CAAC;QACxC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC,aAAa,EAAE,UAAU,CAAC,EAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;IAC1H,CAAC;IAED,kCAAW,GAAX;QACE,iBAAM,WAAW,WAAE,CAAC;QACpB,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC;IACzC,CAAC;IAED,UAAU;IAEF,+BAAQ,GAAhB;QACE,mFAAmF;QACnF,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,UAAC,KAAK;YACrF,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAID,iBAAiB;IAEjB,uDAAuD;IAChD,iCAAU,GAAjB,UAAkB,KAAa;QAE7B,IAAI,KAAK,KAAK,UAAU,EAAE;YACxB,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;IACH,CAAC;IAED,yEAAyE;IACjE,qCAAc,GAAtB,UAAuB,KAAY;QAEjC,sBAAsB;QACtB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QACjC,KAAK,CAAC,eAAe,EAAE,CAAC;QAExB,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE5B,IAAI,KAAK,CAAC,IAAI,KAAK,UAAU,EAAE;YAC7B,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;SACjC;aAAM;YACL,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;SAC/B;IACH,CAAC;IAID,UAAU;IAEV,gBAAgB;IACR,wCAAiB,GAAzB,UAA0B,KAAK;QAE7B,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SAC5B;QAED,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,6GAAqB,EAAE;YAC5D,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,MAAM;SAClE,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,EAAE,eAAe,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;IAC7E,CAAC;IAED,kBAAkB;IACV,0CAAmB,GAA3B;QAAA,iBAcC;QAZC,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE5B,IAAM,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mHAAuB,EAAE;YACjE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,EAAC,IAAI,EAAE,KAAK,EAAC;SACnE,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,CAAC,eAAe,EAAE,gBAAgB,EAAE,gBAAM;YAC3D,IAAI,MAAM,EAAE;gBACV,KAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;gBAClC,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;aAC7D;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,oCAAoC;IAC5B,0CAAmB,GAA3B,UAA4B,KAAK;QAAjC,iBAqBC;QAnBC,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SAC5B;QAED,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mHAAuB,EAAE;YAChE,UAAU,EAAE,iBAAiB,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,MAAM;SACjG,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,eAAe,EAAE,gBAAgB,EAAE,gBAAM;YAEhE,KAAI,CAAC,eAAe,GAAG,IAAI,CAAC;YAE5B,IAAI,MAAM,EAAE;gBACV,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,eAAe,EAAE,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC;aACzE;YAED,IAAM,SAAS,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YAC7B,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,yEAAe,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,qCAAc,GAAtB,UAAuB,MAAW,EAAE,IAAY,EAAE,QAAmB;QAArE,iBAeC;QAbC,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,MAAM,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC,gBAAM;YAE9D,KAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC;YAEvC,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;YAC9B,MAAM,GAAG,IAAI,CAAC;YAEd,IAAI,QAAQ,EAAE;gBACZ,QAAQ,CAAC,MAAM,CAAC,CAAC;aAClB;QAGH,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAEO,2CAAoB,GAA5B;QACE,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,2BAA2B,CAAC,KAAK,CAAC,CAAC;SACzC;IACH,CAAC;IAEO,kDAA2B,GAAnC,UAAoC,OAAgB;QAClD,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC;IAC9B,CAAC;IA/LgD;QAAhD,+DAAS,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,8DAAgB,EAAE,CAAC;wEAAS,8DAAgB;gDAAC;IAF/D,YAAY;QALxB,+DAAS,CAAC;YACT,QAAQ,EAAE,UAAU;YACpB,yFAAmC;;SAEpC,CAAC;+EAakB,+DAAc;YACF,6EAAiB;YAC5B,2DAAS;YACF,qEAAa;YACnB,wDAAU;YACT,sDAAQ;YACJ,kEAAmB;YACd,8EAAiB;OAnBpC,YAAY,CAkMxB;IAAD,mBAAC;CAAA,CAlMiC,wEAAa,GAkM9C;AAlMwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnB+B;AACF;AACX;AACiB;AACN;AACT;AAE7C,eAAe;AACoD;AACT;AAMf;AACsD;AAC3B;AAEtE,WAAW;AACiE;AACC;AACtB;AACE;AACJ;AACI;AACF;AACM;AACR;AACI;AACF;AACS;AACT;AACO;AACT;AACS;AACM;AACjB;AAEnD,YAAY;AAC4E;AACqB;AACP;AAClB;AACF;AACuB;AACR;AACI;AACA;AAClB;AACR;AACuB;AACA;AACd;AACY;AACO;AAC6B;AACH;AAChC;AACqB;AAC9B;AACuC;AAClC;AACZ;AACE;AACxB;AACM;AACsB;AACoC;AACxD;AACmC;AAEtG,SAAS;AACsF;AACM;AAErG,QAAQ;AAC+C;AACL;AACA;AACuC;AACH;AAChC;AACmC;AAChC;AAC6D;AACO;AACZ;AAqFjH;IAEE,mBAAoB,SAAmB;QAAnB,cAAS,GAAT,SAAS,CAAU;QAErC,6BAA6B;QAC7B,IAAM,aAAa,GAAG,8EAAmB,CAAC,qGAAc,EAAE,EAAC,QAAQ,EAAE,SAAS,EAAC,CAAC,CAAC;QACjF,cAAc,CAAC,MAAM,CAAC,uBAAuB,EAAE,aAAa,CAAC,CAAC;QAE9D,IAAI,+DAAS,EAAE,EAAE;YACf,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAClB,OAAO,CAAC,GAAG,CAAC,iDAAiD,CAAC,CAAC;YAC/D,OAAO,CAAC,GAAG,CAAC,iDAAiD,CAAC,CAAC;YAC/D,OAAO,CAAC,GAAG,CAAC,iDAAiD,CAAC,CAAC;YAC/D,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SACnB;QAED,uBAAuB;QACvB,yEAAO,CAAC,GAAG,CAAC,kFAAgB,EAAE,oFAAkB,EAAE,8EAAY,EAAE,uEAAK,EAAE,iFAAe,EAAE,yEAAO,EAAE,8EAAY,EAAE,0EAAQ,EACrH,6EAAW,EAAE,wEAAM,EAAE,gFAAc,EAAE,wEAAM,EAAE,wEAAM,EAAE,8EAAS,EAAE,uEAAK,EAAE,yEAAO,EAAE,4EAAU,EAAE,gFAAc,EAAE,+EAAa,EACzH,wEAAM,EAAE,yEAAO,EAAE,2EAAS,EAAE,4EAAU,EAAE,wEAAM,EAAE,4EAAU,EAAE,kFAAgB,EAAE,wEAAM,EAAE,wEAAM,EAAE,4EAAU,EAAE,wEAAM,EAAE,+EAAa,EAC/H,gFAAW,EAAE,uFAAqB,EAAE,0EAAQ,EAAE,yFAAoB,EAAE,8EAAY,EAAE,wEAAM,EAAE,6EAAW,EAAE,uEAAK,EAAE,0EAAQ,EAAE,2EAAO,EAC/H,yEAAO,EAAE,4EAAU,EAAE,2EAAS,EAAE,yEAAO,EAAE,yEAAO,EAAE,0EAAQ,EAAE,+EAAa,EAAE,6EAAW,EAAE,yEAAO,EAAE,2EAAS,EAAE,8EAAY,EAAE,wEAAM,CAAC,CAAC;IACtI,CAAC;IAtBU,SAAS;QAnFrB,8DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,2DAAY;gBACZ,qGAAsB;gBACtB,8EAAe;gBACf,gGAAe;gBACf,wEAAa;gBACb,0GAAsB;gBACtB,8FAAkB;gBAClB,+FAAmB;gBACnB,iGAAgB;gBAChB,mHAAyB;gBACzB,iGAAmB;gBACnB,0HAAiB;gBACjB,sHAAoB;gBACpB,8GAAkB;gBAClB,kHAAe;gBACf,kHAAe;gBACf,oHAAuB;gBACvB,8GAAqB;gBACrB,oHAAuB;gBACvB,wFAAgB;gBAChB,iGAAmB;gBACnB,sEAAc;gBACd,iEAAY;gBACZ,iEAAY;gBACZ,+GAAoB;gBACpB,+GAAoB;gBACpB,6GAAoB;gBACpB,iJAAyB;gBACzB,8IAAwB;gBACxB,8GAAc;gBACd,mIAAqB;gBACrB,qGAAsB;gBACtB,4IAAmB;gBACnB,oGAAiB;gBACjB,wIAAsB;gBACtB,gFAAc;gBACd,mHAAsB;gBACtB,wGAAe;gBACf,qGAAc;gBACd,wGAAmB;gBACnB,wEAAa;gBACb,qIAAqB;gBACrB,4IAAqB;gBACrB,gIAAiB;aAClB;YACD,eAAe,EAAE;gBACf,oHAAuB;gBACvB,8GAAqB;gBACrB,oHAAuB;gBACvB,+GAAoB;gBACpB,+GAAoB;gBACpB,qGAAc;gBACd,wGAAmB;aACpB;YACD,OAAO,EAAE;gBACP,uEAAa;gBACb,0DAAW;gBACX,mEAAmB,CAAC,OAAO,EAAE;gBAC7B,qEAAgB;gBAChB,uEAAe;gBACf,6FAAuB;gBACvB,oEAAgB;gBAChB,kFAAiB;gBACjB,4FAAwB;gBACxB,yEAAe;gBACf,yEAAe;gBACf,uEAAc;gBACd,6EAAiB;gBACjB,qEAAa;gBACb,yEAAe;gBACf,qEAAa;gBACb,uEAAe;gBACf,qEAAa;gBACb,gFAAkB;gBAClB,uEAAc;gBACd,8EAAiB;gBACjB,8EAAiB;gBACjB,oFAAoB;aACrB;YACD,SAAS,EAAE,CAAC,2DAAY,CAAC;SAC1B,CAAC;+EAG+B,sDAAQ;OAF5B,SAAS,CAuBrB;IAAD,gBAAC;CAAA;AAvBqB;;;;;;;;;;;;AC5KtB,mB;;;;;;;;;;;ACAA,+DAA+D,+I;;;;;;;;;;;;;;;;;ACAZ;AAGnD;IAOE,0BAAY,MAAW,EAAE,IAAY,EAAE,QAA4C,EAAE,OAAiC;QAAjC,yCAAiC;QAEpH,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACzB,CAAC;IACH,uBAAC;AAAD,CAAC;AAED;IAKE,yBAAY,IAAY,EAAE,YAA0B;QAElD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;IACnC,CAAC;IACH,sBAAC;AAAD,CAAC;AAWD;IAKE;QACE,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;IAC3B,CAAC;IAED,mCAAW,GAAX;QACE,IAAI,CAAC,wBAAwB,EAAE,CAAC;QAChC,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACjC,CAAC;IAED,wBAAwB;IAEjB,uCAAe,GAAtB,UAAuB,IAAY,EAAE,YAA0B;QAE7D,IAAI,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;YAC5C,MAAM,IAAI,KAAK,CAAC,yBAAyB,GAAG,IAAI,GAAG,kBAAkB,CAAC,CAAC;SACxE;QAED,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,IAAI,eAAe,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;IACtE,CAAC;IAED,8BAA8B;IACvB,0CAAkB,GAAzB,UAA0B,IAAY;QAEpC,IAAI,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;YAE5C,IAAI,aAAa,GAAoB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;YAE/D,aAAa,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;YACzC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC;YAElC,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;YACjC,aAAa,GAAG,IAAI,CAAC;SACtB;IACH,CAAC;IAEO,+CAAuB,GAA/B;QAEE,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,cAAc,EAAE;YAErC,IAAI,gBAAgB,GAAoB,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;YACjE,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YAC/C,gBAAgB,GAAG,IAAI,CAAC;SACzB;QAED,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC7B,CAAC;IAID,iBAAiB;IAEjB,+DAA+D;IACxD,wCAAgB,GAAvB,UAAwB,MAAW,EAAE,IAA4B,EAAE,QAA4C,EAAE,OAAiC;QAAjC,yCAAiC;QAEhJ,iCAAiC;QACjC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE;YAC/B,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;SACnE;QAED,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;YAC5B,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC;SACf;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAEpC,IAAM,WAAW,GAAG,MAAM,CAAC,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;YAEnD,wCAAwC;YACxC,IAAI,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;gBACpD,MAAM,IAAI,KAAK,CAAC,qBAAqB,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,qBAAqB,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;aAC3F;YAED,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,GAAG,IAAI,gBAAgB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;YAC7F,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;SACrD;IACH,CAAC;IAED,0DAA0D;IACnD,2CAAmB,GAA1B,UAA2B,MAAW,EAAE,IAA4B;QAElE,IAAM,WAAW,GAAG,MAAM,CAAC,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC;QAEhD,IAAI,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;YAEpD,IAAI,iBAAiB,GAAqB,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;YAC5E,iBAAiB,CAAC,MAAM,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,IAAI,EAAE,iBAAiB,CAAC,QAAQ,EAAE,iBAAiB,CAAC,OAAO,CAAC,CAAC;YAE5H,OAAO,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;YACzC,iBAAiB,GAAG,IAAI,CAAC;SAC1B;IACH,CAAC;IAEO,gDAAwB,GAAhC;QAEE,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,eAAe,EAAE;YAEtC,IAAI,iBAAiB,GAAqB,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;YACpE,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,MAAM,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAC3E,iBAAiB,GAAG,IAAI,CAAC;SAC1B;QAED,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;IAC9B,CAAC;IAEO,qCAAa,GAArB,UAAsB,OAAY;QAChC,IAAI,OAAO,KAAK,MAAM,EAAE;YACtB,OAAO,IAAI,CAAC;SACb;aAAM;YACL,OAAO,OAAO,YAAY,OAAO,IAAI,OAAO,YAAY,YAAY,CAAC;SACtE;IACH,CAAC;IApHU,aAAa;QATzB,+DAAS,CAAC;YACT,QAAQ,EAAE,UAAU;YACpB,qGAAoC;;SAErC,CAAC;QAEF;;oCAE4B;;;OACf,aAAa,CAqHzB;IAAD,oBAAC;CAAA;AArHyB;;;;;;;;;;;;ACxC1B,giB;;;;;;;;;;;ACAA,0BAA0B,4BAA4B,qBAAqB,0BAA0B,2OAA2O,4HAA4H,uBAAuB,qBAAqB,eAAe,gBAAgB,0BAA0B,4BAA4B,sDAAsD,uCAAuC,uCAAuC,6BAA6B,+CAA+C,iEAAiE,gEAAgE,+DAA+D,EAAE,yBAAyB,mGAAmG,mGAAmG,yCAAyC,qBAAqB,kBAAkB,mBAAmB,yBAAyB,kBAAkB,EAAE,oBAAoB,mGAAmG,mGAAmG,yBAAyB,eAAe,iBAAiB,yCAAyC,kBAAkB,EAAE,iCAAiC,6BAA6B,EAAE,+CAA+C,+7G;;;;;;;;;;;;;;;;;ACA9tD;AAS/C;IAME,+CAA+C;IAC/C;IAAgB,CAAC;IALR;QAAR,2DAAK,EAAE;;iDAAkB;IACjB;QAAR,2DAAK,EAAE;;kDAAmB;IAClB;QAAR,2DAAK,EAAE;wEAAY,KAAK;qDAAU;IAJxB,eAAe;QAN3B,+DAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,2GAAsC;;SAEvC,CAAC;;OAEW,eAAe,CAQ3B;IAAD,sBAAC;CAAA;AAR2B;;;;;;;;;;;;ACT5B,uiB;;;;;;;;;;;ACAA,yBAAyB,gBAAgB,EAAE,qBAAqB,qBAAqB,qBAAqB,2BAA2B,EAAE,mBAAmB,2BAA2B,EAAE,sHAAsH,yBAAyB,uBAAuB,EAAE,wDAAwD,uBAAuB,eAAe,gBAAgB,EAAE,kEAAkE,wBAAwB,gBAAgB,kBAAkB,EAAE,mBAAmB,yBAAyB,cAAc,kBAAkB,EAAE,iCAAiC,kCAAkC,EAAE,uCAAuC,gCAAgC,kCAAkC,EAAE,+CAA+C,2nG;;;;;;;;;;;;;;;;;ACAzyB;AAQjF;IAOE;IAAe,CAAC;IAEhB,mCAAW,GAAX,UAAY,OAAsB;QAChC,IAAI,OAAO,CAAC,IAAI,EAAE;YAChB,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;IACH,CAAC;IAEO,mCAAW,GAAnB;QAEE,IAAI,YAAqB,CAAC;QAE1B,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,IAAM,QAAQ,GAAW,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACtC,IAAI,QAAQ,CAAC,QAAQ,KAAK,IAAI,EAAE;gBAC9B,YAAY,GAAG,IAAI,CAAC;aACrB;SACF;QAED,wBAAwB;QACxB,IAAI,YAAY,KAAK,IAAI,CAAC,QAAQ,EAAE;YAClC,IAAI,CAAC,QAAQ,GAAG,YAAY,CAAC;SAC9B;IACH,CAAC;IA9BQ;QAAR,2DAAK,EAAE;wEAAO,KAAK;+CAAU;IACrB;QAAR,2DAAK,EAAE;;+CAAgB;IAHb,aAAa;QALzB,+DAAS,CAAC;YACT,QAAQ,EAAE,cAAc;YACxB,qGAAoC;;SAErC,CAAC;;OACW,aAAa,CAiCzB;IAAD,oBAAC;CAAA;AAjCyB;;;;;;;;;;;;ACR1B,mG;;;;;;;;;;;ACAA,2BAA2B,uBAAuB,kBAAkB,EAAE,+CAA+C,ub;;;;;;;;;;;;;;;;;;;;;;;;ACA/C;AACP;AAII;AAChB;AACyB;AACT;AACrB;AAEO;AAQrD;IAA4C,gFAAa;IAcvD;QAAA,YAEE,iBAAO,SAcR;QAZC,sFAAsF;QACtF,IAAI,yEAAe,CAAC,QAAQ,EAAE;YAC5B,KAAI,CAAC,eAAe,GAAG,yEAAe,CAAC,QAAQ,CAAC,GAAG,CAAC,yEAAe,CAAC,CAAC;YACrE,KAAI,CAAC,YAAY,GAAG,yEAAe,CAAC,QAAQ,CAAC,GAAG,CAAC,kEAAmB,CAAC,CAAC;YACtE,KAAI,CAAC,cAAc,GAAG,yEAAe,CAAC,QAAQ,CAAC,GAAG,CAAC,sFAAqB,CAAC,CAAC;YAC1E,KAAI,CAAC,UAAU,GAAG,yEAAe,CAAC,QAAQ,CAAC,GAAG,CAAC,6EAAiB,CAAC,CAAC;SACnE;QAED,KAAI,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAEtC,sBAAsB;QACtB,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,eAAe,EAAE,CAAC;;IACtC,CAAC;IAID,iBAAiB;IAEjB,4CAA4C;IAC5C,EAAE;IACF,wBAAwB;IACxB,+EAA+E;IAC/E,wBAAwB;IACxB,EAAE;IACF,+CAA+C;IAC/C,EAAE;IACF,wCAAwC;IACxC,EAAE;IACF,4BAA4B;IAC5B,oBAAoB;IACpB,yBAAyB;IACzB,qDAAqD;IACrD,iCAAiC;IACjC,wBAAwB;IACxB,sBAAsB;IACtB,mDAAmD;IACnD,oDAAoD;IACpD,aAAa;IACb,0CAA0C;IAC1C,WAAW;IACX,EAAE;IACF,uBAAuB;IACvB,EAAE;IACF,wDAAwD;IACxD,EAAE;IACF,eAAe;IACf,kCAAkC;IAClC,QAAQ;IACR,cAAc;IACd,EAAE;IACF,IAAI;IAIJ,YAAY;IAEZ,yCAAQ,GAAR;QAAA,iBA6BC;QA3BC,mEAAmE;QACnE,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YACzB,8CAA8C;YAC9C,OAAO;SACR;QAED,uBAAuB;QACvB,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,SAAS,CACtE,kBAAQ;YACN,IAAI,QAAQ,EAAE;gBACZ,qBAAqB;gBACrB,KAAI,CAAC,iBAAiB,CAAC,QAAoB,CAAC,CAAC;aAC9C;QACH,CAAC,CAAC,CAAC,CAAC;QAEN,IAAI,CAAC,eAAe,CAAC,gBAAgB,EAAE,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,SAAS,CAClF,gBAAM;YACJ,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC,CAAC;QAEN,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,SAAS,CAAC,iBAAO;YAClF,IAAI,OAAO,KAAK,CAAC,EAAE;gBACjB,KAAI,CAAC,YAAY,EAAE,CAAC;aACrB;QACH,CAAC,CAAC,CAAC,CAAC;IAEN,CAAC;IAID,SAAS;IAED,kDAAiB,GAAzB,UAA0B,QAAgB;QAExC,IAAI,QAAQ,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,EAAE;YAEtC,WAAW;YAEX,WAAW;YACX,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;gBACpB,QAAQ,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC;gBACxC,SAAS,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC;gBAC1C,SAAS,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC;aAAa,CAAC;YAEzD,OAAO;YACP,IAAM,SAAS,GAAa,IAAI,CAAC,cAAc,CAAC,0BAA0B,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACtG,IAAM,KAAK,GAAS,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;YAErF,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,KAAK,CAAC,EAAE,CAAC;YAEpC,cAAc;YACd,IAAM,mBAAmB,GAAG,SAAS,CAAC;YACtC,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,SAAS,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;YAElE,WAAW;YACX,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,GAAG,mBAAmB,CAAC,QAAQ,CAAC;YAE5D,iCAAiC;YACjC,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,gBAAgB,CAAC;mBAC1E,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,mBAAmB,CAAC,EAAE;gBAE3G,IAAM,MAAM,GAAgB,IAAI,WAAW,CACzC,UAAU,EACV;oBACE,OAAO,EAAE,IAAI;oBACb,UAAU,EAAE,IAAI;oBAChB,MAAM,EAAE;wBACN,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ;wBACtC,mBAAmB,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,aAAa,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;wBACzF,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM;qBAC7D;iBACF,CAAC,CAAC;gBAEL,IAAI,IAAI,CAAC,SAAS,EAAE;oBAClB,IAAI,IAAI,CAAC,SAAS,CAAC,aAAa,EAAE;wBAChC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;qBACpD;iBACF;aAEF;iBAAM;gBAEL,IAAI,CAAC,IAAI,GAAG,+DAAS,CAAC,IAAI,CAAC,KAAK,CAAS,CAAC;gBAC1C,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,WAAW,CAAC,CAAC;gBACvC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACtC;SACF;IACH,CAAC;IAEM,+CAAc,GAArB,UAAsB,MAAc;QAClC,WAAW;IACb,CAAC;IAEM,qDAAoB,GAA3B,UAA4B,IAAU;QACpC,WAAW;IACb,CAAC;IAEM,6CAAY,GAAnB;QACE,WAAW;IACb,CAAC;IAGD,QAAQ;IAED,gDAAe,GAAtB;QACE,OAAO;YACL,IAAI,EAAE,MAAM;YACZ,QAAQ,EAAE,SAAS;YACnB,WAAW,EAAE,SAAS;YACtB,QAAQ,EAAE,CAAC;YACX,aAAa,EAAE,CAAC;YAChB,EAAE,EAAE,CAAC,CAAC;SACC,CAAC;IACZ,CAAC;IA3LuB;QAAvB,+DAAS,CAAC,WAAW,CAAC;;6DAAW;IAFvB,sBAAsB;QANlC,+DAAS,CAAC;YACT,QAAQ,EAAE,oBAAoB;YAC9B,mIAA8C;;SAE/C,CAAC;;OAEW,sBAAsB,CA+LlC;IAAD,6BAAC;CAAA,CA/L2C,kEAAa,GA+LxD;AA/LkC;;;;;;;;;;;;ACnBnC,mB;;;;;;;;;;;ACAA,+DAA+D,2K;;;;;;;;;;;;;;;;;ACAkB;AAUjF;IAME;QAJU,sBAAiB,GAA0B,IAAI,0DAAY,EAAE,CAAC;QAEjE,oBAAe,GAAG,KAAK,CAAC;IAEf,CAAC;IAEjB,yCAAQ,GAAR,cAAY,CAAC;IAEb,4CAAW,GAAX;QACE,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAChC,CAAC;IAES,2CAAU,GAApB;QACE,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,QAAQ,EAAE,CAAC;IAClB,CAAC;IAES,yCAAQ,GAAlB;QACE,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACnC;IACH,CAAC;IAtBS;QAAT,4DAAM,EAAE;wEAAoB,0DAAY;qEAA+B;IAF7D,sBAAsB;QARlC,+DAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,mIAA8C;;SAE/C,CAAC;QAEF,iFAAiF;QACjF,sDAAsD;;;OACzC,sBAAsB,CAyBlC;IAAD,6BAAC;CAAA;AAzBkC;;;;;;;;;;;;;ACVnC;AAAA;AAAA;AAAA;AAAA;AAA6B;AAKiC;AAQ9D;IAeE;QARO,kBAAa,GAAG,CAAC,CAAC;QAElB,SAAI,GAAG,IAAI,iCAAI,CAAC;YACrB,eAAe,EAAG,EAAE,CAAI,sBAAsB;SAC/C,CAAC,CAAC;IAIY,CAAC;IAEhB,uBAAuB;IAChB,2BAAK,GAAZ,UAAa,KAAgB,EAAE,SAAiC,EAAE,OAA+B,EAAE,IAAY,EAAE,KAAkB,EAAE,SAAc;QAEjJ,MAAM;QACN,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;QAElD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;QAC9C,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAE3B,WAAW;QACX,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAC3B,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAEvB,0BAA0B;QAC1B,IAAI,SAAS,KAAK,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YAC/C,SAAS,CAAC,OAAO,EAAE,CAAC;SACrB;IACH,CAAC;IAEM,gCAAU,GAAjB,UAAkB,SAAiC;QACjD,WAAW;QAEX,OAAO;IACT,CAAC;IAEM,+BAAS,GAAhB,UAAiB,IAAmB;QAClC,WAAW;QAEX,OAAO;IACT,CAAC;IAEM,+BAAS,GAAhB;QACE,WAAW;QAEX,OAAO;IACT,CAAC;IAID,aAAa;IAEb,yCAAyC;IAClC,uCAAiB,GAAxB,UAAyB,KAAa;QAEpC,IAAM,MAAM,GAAG,8QAA8Q,CAAC;QAE9R,OAAO,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,UAAU,KAAK;YAE1C,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAM,gBAAgB;YACxD,OAAO,kBAAkB,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,oBAAoB,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,OAAO,CAAC;QACzG,CAAC,CAAC,CAAC;IACL,CAAC;IAGM,sCAAgB,GAAvB,UAAwB,KAAa;QAEnC,IAAM,MAAM,GAAG,wQAAwQ,CAAC;QAExR,OAAO,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,UAAU,KAAK;YAC1C,IAAM,OAAO,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC1C,OAAO,iBAAiB,GAAG,OAAO,GAAG,OAAO,GAAG,KAAK,GAAG,MAAM,CAAC;QAChE,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qFAAqF;IAC9E,6CAAuB,GAA9B,UAA+B,KAAa;QAE1C,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC;QAE7C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;SAC3F;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAID,QAAQ;IAER,+FAA+F;IACxF,4CAAsB,GAA7B,UAA8B,SAA0B,EAAE,KAAa;QAErE,IAAI,cAAc,GAAG,CAAC,CAAC;QACvB,IAAM,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC;QAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAEhC,IAAM,SAAS,GAAa,SAAS,CAAC,CAAC,CAAC,CAAC;YAEzC,IAAI,SAAS,GAAG,CAAC,CAAC;YAElB,IAAG,IAAI,CAAC,UAAU,EAAE;gBAClB,SAAS,GAAG,CAAC,+EAAiB,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC,CAAC;gBACpE,cAAc,IAAI,SAAS,CAAC;gBAC5B,IAAI,CAAC,aAAa,IAAI,SAAS,CAAC;aACjC;YAED,SAAS,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;YAE7C,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;SAC7B;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,mCAAmC;IAC5B,sCAAgB,GAAvB,UAAwB,KAAU;QAEhC,IAAI,IAAI,CAAC,SAAS,KAAK,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAChD,OAAO,KAAK,CAAC,OAAO,EAAE,CAAC;SACxB;aAAM;YACL,OAAO,KAAK,CAAC;SACd;IACH,CAAC;IAED,uDAAuD;IAChD,mCAAa,GAApB,UAAqB,KAAa;QAChC,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACxC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC;IAClD,CAAC;IAQH,kBAAC;AAAD,CAAC;;;;;;;;;;;;;ACjKD,+MAA+M,YAAY,4LAA4L,UAAU,kFAAkF,yBAAyB,s+B;;;;;;;;;;;ACA5gB,wCAAwC,iBAAiB,EAAE,sBAAsB,uBAAuB,uBAAuB,qBAAqB,iBAAiB,EAAE,8CAA8C,yBAAyB,EAAE,6BAA6B,kBAAkB,EAAE,mCAAmC,iBAAiB,EAAE,iCAAiC,mCAAmC,EAAE,6BAA6B,mCAAmC,EAAE,+CAA+C,ukC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACA9d;AACW;AAEoB;AAC5B;AACJ;AACX;AACqB;AACb;AACuB;AACb;AACsB;AAEQ;AACtC;AAEe;AAO7D;IAAoC,wEAAa;IAgB/C,wBACU,kBAAqC,EACrC,aAA2B,EAC3B,sBAA6C,EAC7C,oBAAyC,EACzC,cAA6B;IACrC,mDAAmD;IAC3C,mBAA8C;QAPxD,YASE,iBAAO,SACR;QATS,wBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,mBAAa,GAAb,aAAa,CAAc;QAC3B,4BAAsB,GAAtB,sBAAsB,CAAuB;QAC7C,0BAAoB,GAApB,oBAAoB,CAAqB;QACzC,oBAAc,GAAd,cAAc,CAAe;QAE7B,yBAAmB,GAAnB,mBAAmB,CAA2B;QAlBjD,mBAAa,GAAG,CAAC,CAAC;QAClB,uBAAiB,GAAG,CAAC,CAAC;QACtB,6BAAuB,GAAW,EAAE,CAAC;QAIrC,gBAAU,GAAe;YAC9B,EAAC,EAAE,EAAE,CAAC,EAAE,IAAI,EAAC,MAAM,EAAC;YACpB,EAAC,EAAE,EAAE,CAAC,EAAE,IAAI,EAAC,MAAM,EAAC;SACrB,CAAC;;IAYF,CAAC;IAED,iCAAQ,GAAR;QAEE,IAAM,aAAa,GAAG,0EAAiB,EAAE,CAAC;QAE1C,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,GAAG,CAAC,UAAS,GAAG;YAC1D,OAAO,aAAa,CAAC,GAAG,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;QACH,EAAE;QACF,+EAA+E;QAC/E,+BAA+B;QAC/B,MAAM;QACN,EAAE;QACF,4CAA4C;IAC9C,CAAC;IAEM,mCAAU,GAAjB;QAEE,IAAM,UAAU,GAAc,6EAAoB,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;QAE/E,mDAAmD;QACnD,IAAM,MAAM,GAAe,gEAAS,CAAC,IAAI,CAAC,sBAAsB,CAAC,aAAa,CAAoB,CAAC;QAEnG,2CAA2C;QAC3C,oEAAoE;QAEpE,KAAK,CAAC,IAAI,CAAC,sBAAsB,CAAC,aAAa,CAAC,MAAM,GAAG,MAAM,GAAG,MAAM,CAAC,MAAM,GAAG,YAAY,CAAC,CAAC;QAEhG,IAAM,IAAI,GAAe,wEAAS,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;QAEvD,IAAI,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE,KAAK;YAC/B,6DAAU,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,KAAK,GAAG,MAAM,CAAC,CAAC;QAC3D,CAAC,CAAC;IAEJ,CAAC;IAEM,0CAAiB,GAAxB;QAAA,iBA0BC;QAxBC,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;QAElC,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,SAAS,CAAE,cAAI;YAErE,IAAM,UAAU,GAAc,IAAI,CAAC,CAAC,CAAC,CAAC;YACtC,IAAM,WAAW,GAAW,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAE1E,IAAI,aAAqC,CAAC;YAC1C,IAAI,UAAU,CAAC,SAAS,EAAE;gBAExB,aAAa,GAAG,EAAE,CAAC;gBAEnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,WAAW,EAAE,CAAC,EAAE,EAAE;oBACrC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;iBACjC;aACF;iBAAM;gBACL,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;aACzB;YAED,IAAM,WAAW,GAAG,KAAI,CAAC,aAAa,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC,GAAG,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,WAAW,CAAC,EAAE,MAAM,CAAC,KAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC;YAEnL,KAAI,CAAC,cAAc,GAAG,WAAW,CAAC;YAClC,KAAI,CAAC,uBAAuB,GAAG,WAAW,CAAC;QAC7C,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAEO,oCAAW,GAAnB;QAAA,iBA0BC;QAxBC,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;QAElC,OAAO,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAExE,2DAAI,CAAC,CAAC,CAAC,EACP,gEAAS,CAAC,cAAI;YAEZ,KAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;YAElC,IAAI,IAAI,EAAE;gBAER,sBAAsB;gBACtB,OAAO,+CAAE,CAAC,IAAI,CAAC,CAAC;aAEjB;iBAAM;gBAEL,KAAK,CAAC,QAAQ,CAAC,CAAC;gBAEhB,KAAI,CAAC,uBAAuB,GAAG,OAAO,CAAC;gBAEvC,OAAO;aACR;QACH,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEM,qCAAY,GAAnB,UAAoB,IAAY;QAE9B,IAAM,UAAU,GAAW,6EAAoB,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC;QACjF,IAAM,UAAU,GAAW,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC;QAEhF,IAAI,SAAS,GAAU,UAAU,GAAG,GAAG,GAAG,IAAI,CAAC;QAE/C,IAAI,IAAI,KAAK,OAAO,EAAE;YACpB,SAAS,IAAK,GAAG,GAAG,UAAU,CAAC;SAChC;QAED,6DAAU,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,SAAS,GAAG,OAAO,CAAC,CAAC;IAC7D,CAAC;IAEM,qCAAY,GAAnB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAS,IAAc;YAC5C,KAAK,CAAC,kBAAkB,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,EAAE;gBAClD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,oBAAoB,CAAC,CAAC;YAChD,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,mFAAmF;IAC5E,wCAAe,GAAtB;QAEE,YAAY;QACZ,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,CAAC;QAElC,eAAe;QACf,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC;IACtC,CAAC;IAEM,0CAAiB,GAAxB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,sGAAsG;QACtG,IAAM,aAAa,GAAG,EAAE,CAAC;QACzB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAS,IAAe;YAC7C,aAAa,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG,KAAK,CAAC,oBAAoB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC;QACpG,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAE3B,YAAY;QACZ,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,CAAC;QAElC,eAAe;QACf,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC;QAEpC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAS,IAAe;YAC7C,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;YAClD,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,KAAK,IAAI,EAAE;gBACjD,KAAK,CAAC,oBAAoB,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,EAAE,aAAa,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;aAC/F;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,8BAAK,GAAZ;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAEM,0CAAiB,GAAxB;QAEE,IAAM,QAAQ,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;QACzE,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC;IACnE,CAAC;IAED,wCAAwC;IACjC,qCAAY,GAAnB;QACE,IAAM,MAAM,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,IAAI,CAAC,sBAAsB,CAAC,YAAY,EAAE,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC;QAC9G,MAAM,CAAC,IAAI,CAAC,wDAAwD,GAAG,MAAM,CAAC,CAAC;IACjF,CAAC;IAEM,oCAAW,GAAlB;QACE,KAAK,CAAC,iBAAiB,CAAC,CAAC;IAC3B,CAAC;IAvMU,cAAc;QAL1B,+DAAS,CAAC;YACT,QAAQ,EAAE,WAAW;YACrB,6GAAqC;;SAEtC,CAAC;+EAkB8B,6EAAiB;YACtB,mEAAY;YACH,uFAAqB;YACvB,kEAAmB;YACzB,qEAAa;YAER,+FAAyB;OAvB7C,cAAc,CAwM1B;IAAD,qBAAC;CAAA,CAxMmC,wEAAa,GAwMhD;AAxM0B;;;;;;;;;;;;ACvB3B,keAAke,4DAA4D,IAAI,yDAAyD,+CAA+C,iBAAiB,2aAA2a,sCAAsC,uIAAuI,8BAA8B,yM;;;;;;;;;;;ACAjxC,sCAAsC,uBAAuB,cAAc,8BAA8B,kBAAkB,EAAE,+BAA+B,uBAAuB,EAAE,2CAA2C,2BAA2B,0BAA0B,eAAe,iBAAiB,EAAE,uBAAuB,gBAAgB,2BAA2B,uBAAuB,EAAE,8CAA8C,uBAAuB,EAAE,iMAAiM,wBAAwB,EAAE,8GAA8G,0BAA0B,EAAE,8FAA8F,uBAAuB,yBAAyB,mBAAmB,yBAAyB,EAAE,iDAAiD,yBAAyB,2BAA2B,oCAAoC,EAAE,iDAAiD,yBAAyB,2BAA2B,EAAE,wBAAwB,8BAA8B,wBAAwB,8BAA8B,EAAE,0CAA0C,mBAAmB,yBAAyB,EAAE,6CAA6C,2BAA2B,EAAE,4DAA4D,yCAAyC,EAAE,yCAAyC,+BAA+B,yBAAyB,EAAE,+CAA+C,uyF;;;;;;;;;;;;;;;;;;;;;ACAzpD;AAC1B;AAEZ;AACyB;AACrB;AAS1D;IAOE,+BACU,sBAA6C,EAC7C,YAAyB,EAC1B,SAA8C,EAE9C,IAAS;QAJR,2BAAsB,GAAtB,sBAAsB,CAAuB;QAC7C,iBAAY,GAAZ,YAAY,CAAa;QAC1B,cAAS,GAAT,SAAS,CAAqC;QAE9C,SAAI,GAAJ,IAAI,CAAK;QAVX,aAAQ,GAAoB,EAAE,CAAC;QAC/B,kBAAa,GAAkB,EAAE,CAAC;IAUtC,CAAC;IAEJ,wCAAQ,GAAR;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,4BAA4B;QAC5B,IAAM,UAAU,GAAkB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAE7D,UAAU,CAAC,OAAO,CAAC,UAAS,GAAG,EAAE,KAAK;YAEpC,IAAM,QAAQ,GAAG,kEAAgB,CAAC,GAAG,CAAC,CAAC;YAEvC,IAAI,CAAC,QAAQ,EAAE;gBACb,8FAA8F;gBAC9F,OAAO;aACR;YAED,IAAG,QAAQ,CAAC,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;gBACvC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC;aACvB;YAED,IAAI,QAAQ,KAAK,SAAS,EAAE;gBAE1B,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC,EAAE;oBACxC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,kEAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;iBAClD;gBACD,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC/B;iBAAM;gBACL,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,kEAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;aAClD;QACH,CAAC,CAAC,CAAC;QAEH,cAAc;QACd,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YAC9B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,kEAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;SACjD;QAED,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;YACpC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;SAC/B;QAED,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YACnC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;SAC9B;IACH,CAAC;IAED,2CAAW,GAAX;IAEA,CAAC;IAGM,yCAAS,GAAhB;QACE,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACzF,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;IACzB,CAAC;IAED,wFAAwF;IACjF,+CAAe,GAAtB;QAEE,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAE5B,OAAO,KAAK,CAAC;SAEd;aAAM;YAEL,8CAA8C;YAC9C,IAAI,cAAc,GAAG,CAAC,CAAC;YACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC7C,IAAI,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;oBAC7B,cAAc,EAAE,CAAC;iBAClB;aACF;YAED,OAAO,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC;SAC7B;IACH,CAAC;IAEM,4CAAY,GAAnB,UAAoB,IAAY;QAC9B,OAAO,kEAAgB,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC;IACtC,CAAC;IAGD,wCAAwC;IAChC,+CAAe,GAAvB,UAAwB,OAAe;QAErC,IAAM,YAAY,GAAkB,IAAI,CAAC,sBAAsB,CAAC,YAAY,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QACrG,IAAM,SAAS,GAAW,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC7D,IAAM,OAAO,GAAkB,YAAY,CAAC,KAAK,CAAC,SAAS,GAAG,CAAC,EAAE,SAAS,GAAG,CAAC,CAAC,CAAC;QAEhF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAC,CAAC,CAAC;IAC3D,CAAC;IA1GU,qBAAqB;QAPjC,+DAAS,CAAC;YACT,QAAQ,EAAE,eAAe;YACzB,4IAA6C;YAE7C,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;QAaG,6GAAM,CAAC,iEAAe,CAAC;+EAHQ,sFAAqB;YAC/B,iEAAW;YACf,8DAAY;OAVrB,qBAAqB,CAgHjC;IAAD,4BAAC;CAAA;AAhHiC;;;;;;;;;;;;ACdlC,6HAA6H,OAAO,iGAAiG,iS;;;;;;;;;;;ACArO,yCAAyC,+BAA+B,EAAE,2BAA2B,iBAAiB,8BAA8B,EAAE,0BAA0B,0BAA0B,mCAAmC,EAAE,8BAA8B,2BAA2B,EAAE,+CAA+C,ugC;;;;;;;;;;;;;;;;;;ACA/N;AAClD;AAQxE;IAUE,2BAAoB,eAAkC;QAAlC,oBAAe,GAAf,eAAe,CAAmB;IAAG,CAAC;IAE1D,oCAAQ,GAAR;QACE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEM,oCAAQ,GAAf,UAAgB,KAAK;QAEnB,IAAI,SAAS,GAAW,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,KAAK,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1F,IAAM,aAAa,GAAW,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;QAExD,SAAS;QACT,IAAI,SAAS,KAAK,aAAa,EAAE;YAC/B,SAAS,EAAG,CAAC;SACd;QAED,eAAe;QACf,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;QAEnD,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;IACtC,CAAC;IAED,eAAe;IACR,sCAAU,GAAjB,UAAkB,KAAK;QAErB,KAAK,CAAC,eAAe,EAAE,CAAC;QACxB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QAEjC,IAAI,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC,CAAC;QAExD,IAAI,WAAW,GAAG,CAAC,EAAE;YAEnB,WAAW,EAAG,CAAC;YACf,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;SAEtD;aAAM;YACL,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAC5C;QAED,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;IACvC,CAAC;IAED,4EAA4E;IACrE,yCAAa,GAApB;QAEE,IAAM,WAAW,GAAkB,EAAE,CAAC;QAEtC,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;QACvC,MAAM,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;QAEpD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YAE1B,IAAI,MAAM,GAAG,CAAC,EAAE;gBACd,IAAI,MAAM,GAAG,CAAC,IAAI,CAAC,EAAE;oBACnB,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACvB;qBAAM;oBACL,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACvB;aACF;iBAAM;gBACL,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACvB;SACF;QAED,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC;IAChC,CAAC;IA3EQ;QAAR,2DAAK,EAAE;;mDAAc;IACb;QAAR,2DAAK,EAAE;;oDAAgB;IACf;QAAR,2DAAK,EAAE;;oDAAe;IACd;QAAR,2DAAK,EAAE;wEAAS,mDAAM;qDAAC;IALb,iBAAiB;QAN7B,+DAAS,CAAC;YACT,QAAQ,EAAE,kBAAkB;YAC5B,8JAAyC;YAEzC,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EAWqC,+DAAiB;OAV3C,iBAAiB,CA8E7B;IAAD,wBAAC;CAAA;AA9E6B;;;;;;;;;;;;ACT9B,uCAAuC,OAAO,wHAAwH,2PAA2P,kBAAkB,uB;;;;;;;;;;;ACAnb,gCAAgC,+BAA+B,EAAE,2BAA2B,iBAAiB,8BAA8B,EAAE,mCAAmC,gCAAgC,EAAE,+CAA+C,myB;;;;;;;;;;;;;;;;;;ACApI;AAC7D;AAQhE;IAME,+BAAoB,eAAkC;QAAlC,oBAAe,GAAf,eAAe,CAAmB;IAAG,CAAC;IAE1D,wCAAQ,GAAR,cAAY,CAAC;IAEb,2CAAW,GAAX,UAAY,OAAsB;QAChC,IAAI,OAAO,CAAC,MAAM,EAAE;YAClB,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;SACtC;IACH,CAAC;IAED,4EAA4E;IACrE,0CAAU,GAAjB,UAAkB,KAAa,EAAE,KAAc;QAE7C,IAAM,WAAW,GAAkB,EAAE,CAAC;QAEtC,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QAE5C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YAE1B,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,EAAE;oBAClB,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACvB;qBAAM;oBACL,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACvB;aACF;iBAAM;gBACL,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACvB;SACF;QAED,OAAO,WAAW,CAAC;IACrB,CAAC;IAnCQ;QAAR,2DAAK,EAAE;;wDAAe;IACd;QAAR,2DAAK,EAAE;wEAAQ,uDAAU;wDAAC;IAClB;QAAR,2DAAK,EAAE;;yDAAgB;IAJb,qBAAqB;QANjC,+DAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;YAChC,0KAA6C;YAE7C,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EAOqC,+DAAiB;OAN3C,qBAAqB,CAsCjC;IAAD,4BAAC;CAAA;AAtCiC;;;;;;;;;;;;ACTlC,uIAAuI,8BAA8B,aAAa,aAAa,mGAAmG,0BAA0B,0JAA0J,YAAY,2d;;;;;;;;;;;ACAle,yCAAyC,+BAA+B,2BAA2B,kBAAkB,EAAE,wCAAwC,yBAAyB,2BAA2B,EAAE,2CAA2C,wBAAwB,yBAAyB,4DAA4D,yBAAyB,EAAE,wDAAwD,oBAAoB,EAAE,iDAAiD,oBAAoB,EAAE,yCAAyC,yBAAyB,EAAE,4CAA4C,kCAAkC,uBAAuB,EAAE,iDAAiD,uBAAuB,EAAE,wDAAwD,oBAAoB,iDAAiD,sBAAsB,yBAAyB,yBAAyB,aAAa,cAAc,kBAAkB,mBAAmB,6BAA6B,wBAAwB,yCAAyC,iCAAiC,2BAA2B,EAAE,4DAA4D,qEAAqE,EAAE,iEAAiE,oEAAoE,EAAE,+CAA+C,mqF;;;;;;;;;;;;;;;;;;;ACAv2C;AAExE;AAImC;AAUhG;IAAqC,yEAAsB;IAczD,yBACU,YAAyB,EACzB,eAAkC;QAF5C,YAIE,iBAAO,SACR;QAJS,kBAAY,GAAZ,YAAY,CAAa;QACzB,qBAAe,GAAf,eAAe,CAAmB;QAVrC,iBAAW,GAAG,CAAC,CAAC;QAChB,WAAK,GAAsB,SAAS,CAAC;QAErC,sBAAgB,GAAmB,EAAE,CAAC;QAErC,cAAQ,GAAW,EAAE,CAAC;QACtB,0BAAoB,GAAwB,EAAE,CAAC;;IAOvD,CAAC;IAED,kCAAQ,GAAR;QAEE,iBAAM,QAAQ,WAAE,CAAC;QAEjB,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAS,IAAa;YAE1C,IAAI,IAAI,CAAC,QAAQ,EAAE;gBAEjB,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAElC,IAAM,OAAO,GAAW,KAAK,CAAC,YAAY,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;gBAEpF,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;gBACpC,KAAK,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAS,MAAc;oBAC7F,IAAI,MAAM,KAAK,CAAC,CAAC,EAAE;wBACjB,KAAK,CAAC,oBAAoB,EAAE,CAAC;qBAC9B;gBACH,CAAC,CAAC,CAAC,CAAC;aACL;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAC9B,CAAC;IAED,qCAAW,GAAX;QAEE,iBAAM,WAAW,WAAE,CAAC;QAEpB,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,sBAAsB;QACtB,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,UAAS,YAA0B;YACnE,YAAY,CAAC,WAAW,EAAE,CAAC;YAC3B,YAAY,GAAG,IAAI,CAAC;QACtB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;QAEjC,oDAAoD;QACpD,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE;YAC/B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC;SAC9B;QAED,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IACvB,CAAC;IAEM,uCAAa,GAApB,UAAqB,KAAwB;QAE3C,2DAA2D;QAC3D,yBAAyB;QACzB,oDAAoD;QACpD,4DAA4D;QAC5D,gEAAgE;QAChE,aAAa;QACb,mHAAmH;QACnH,kDAAkD;QAClD,8DAA8D;QAC9D,uEAAuE;QACvE,QAAQ;QACR,MAAM;QACN,WAAW;QACX,6DAA6D;QAC7D,iEAAiE;QACjE,sEAAsE;QACtE,IAAI;QACJ,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;IAEM,8CAAoB,GAA3B;QAEE,IAAI,YAAY,GAAW,CAAC,CAAC;QAC7B,IAAI,iBAAiB,GAAW,CAAC,CAAC;QAElC,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE;YAC/B,YAAY,EAAG,CAAC;YAChB,IAAM,OAAO,GAAW,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAC3C,iBAAiB,IAAI,OAAO,CAAC,SAAS,EAAE,CAAC;SAC1C;QAED,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC,CAAC,iBAAiB,GAAG,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3E,CAAC;IAEM,mCAAS,GAAhB,UAAiB,IAAY,EAAE,MAAc;QAC3C,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IAChD,CAAC;IAEM,mCAAS,GAAhB,UAAiB,IAAY;QAC3B,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,8EAA8E;IACtE,qCAAW,GAAnB;QAEE,IAAM,WAAW,GAAiB,EAAE,CAAC;QAErC,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE;YAE/B,IAAM,OAAO,GAAW,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAE3C,IAAM,QAAQ,GAAsB,OAAO,CAAC,UAAU,EAAE,CAAC;YACzD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACxC,IAAM,WAAW,GAAe,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAC5C,IAAI,WAAW,CAAC,SAAS,IAAI,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAE;oBAC3D,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;iBACzC;aACF;SACF;QAED,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;IAC7C,CAAC;IAlIyB;QAAzB,+DAAS,CAAC,aAAa,CAAC;wEAAc,wDAAU;wDAAC;IACzC;QAAR,2DAAK,EAAE;wEAAW,KAAK;qDAAU;IACzB;QAAR,2DAAK,EAAE;;qDAAoB;IAJjB,eAAe;QAN3B,+DAAS,CAAC;YACT,QAAQ,EAAE,QAAQ;YAClB,qIAAsC;YAEtC,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EAgBwB,iEAAW;YACR,+DAAiB;OAhBjC,eAAe,CAqI3B;IAAD,sBAAC;CAAA,CArIoC,oGAAsB,GAqI1D;AArI2B;;;;;;;;;;;;AChB5B,kwBAAkwB,eAAe,2a;;;;;;;;;;;ACAjxB,oDAAoD,mBAAmB,oBAAoB,EAAE,yCAAyC,yBAAyB,kCAAkC,EAAE,qDAAqD,6BAA6B,EAAE,2EAA2E,iCAAiC,EAAE,kLAAkL,0CAA0C,mCAAmC,0CAA0C,sCAAsC,gCAAgC,EAAE,8DAA8D,iCAAiC,EAAE,wHAAwH,gCAAgC,EAAE,gKAAgK,uBAAuB,EAAE,iDAAiD,yBAAyB,0BAA0B,EAAE,wDAAwD,sBAAsB,EAAE,gEAAgE,oBAAoB,EAAE,uFAAuF,mCAAmC,6BAA6B,EAAE,+CAA+C,2oE;;;;;;;;;;;;;;;;;;;;;ACA/iD;AACf;AAGN;AACf;AAG3C;IAAA;IAOA,CAAC;IAAD,qBAAC;AAAD,CAAC;;AAOD;IAOE,6BACU,UAA6C,EAC7C,YAAyB,EAE1B,IAAoB;QAHnB,eAAU,GAAV,UAAU,CAAmC;QAC7C,iBAAY,GAAZ,YAAY,CAAa;QAE1B,SAAI,GAAJ,IAAI,CAAgB;IAC1B,CAAC;IAEJ,sCAAQ,GAAR;QAEE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QAClC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;IACxC,CAAC;IAEM,wCAAU,GAAjB,UAAkB,QAAgB;QAEhC,uEAAuE;QACvE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAEvC,iCAAiC;QACjC,IAAI,QAAQ,CAAC,MAAM,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;YAC1C,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;SAC9C;QAED,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;QACvC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC5C,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;QAEvC,IAAM,QAAQ,GAAS,IAAI,CAAC,IAAY,CAAC;QAEzC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACrC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAEM,2CAAa,GAApB,UAAqB,MAAc;QACjC,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,EAAE,CAAC;IACvB,CAAC;IAEO,qCAAO,GAAf;QACE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAClC,CAAC;IAEM,sCAAQ,GAAf;QAEE,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,kDAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAS,IAAI;YACrC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACnB;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,MAAM,CAAC;IAChB,CAAC;IAxDwB;QAAxB,+DAAS,CAAC,YAAY,CAAC;wEAAa,wDAAU;2DAAC;IAFrC,mBAAmB;QAL/B,+DAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;YAC3B,sIAA2C;;SAE5C,CAAC;QAWG,6GAAM,CAAC,iEAAe,CAAC;+EAFJ,8DAAY;YACV,iEAAW;YAEpB,cAAc;OAXlB,mBAAmB,CA4D/B;IAAD,0BAAC;CAAA;AA5D+B;;;;;;;;;;;;ACtBhC,+QAA+Q,oDAAoD,8LAA8L,oBAAoB,4BAA4B,aAAa,gW;;;;;;;;;;;ACA9jB,gCAAgC,4CAA4C,EAAE,gBAAgB,kBAAkB,gBAAgB,iBAAiB,oCAAoC,uCAAuC,EAAE,wBAAwB,uBAAuB,wBAAwB,EAAE,sBAAsB,sBAAsB,yBAAyB,EAAE,8CAA8C,+BAA+B,4CAA4C,iDAAiD,2CAA2C,+CAA+C,kBAAkB,EAAE,yBAAyB,uBAAuB,EAAE,yBAAyB,uBAAuB,EAAE,mBAAmB,mBAAmB,gBAAgB,kCAAkC,uBAAuB,cAAc,EAAE,mCAAmC,oBAAoB,6BAA6B,EAAE,uCAAuC,kBAAkB,EAAE,yBAAyB,gBAAgB,uBAAuB,EAAE,qCAAqC,oBAAoB,EAAE,2DAA2D,yCAAyC,oBAAoB,4BAA4B,wBAAwB,uBAAuB,qBAAqB,gBAAgB,EAAE,2EAA2E,wBAAwB,EAAE,sEAAsE,wBAAwB,EAAE,4CAA4C,kBAAkB,uBAAuB,EAAE,wCAAwC,uBAAuB,EAAE,+CAA+C,u6G;;;;;;;;;;;;;;;;;;;ACAxqD;AACH;AACb;AAOrD;IAOE,iCACU,UAAiD,EACjD,aAAkC,EAEnC,IAAY;QAHX,eAAU,GAAV,UAAU,CAAuC;QACjD,kBAAa,GAAb,aAAa,CAAqB;QAEnC,SAAI,GAAJ,IAAI,CAAQ;IAClB,CAAC;IAEJ,0CAAQ,GAAR;QACE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QAC1E,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAC9C,CAAC;IAEM,sCAAI,GAAX;QACE,0LAA0L;QAE1L,IAAI,MAAM,GAAW,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAM,mBAAmB;QACvG,MAAM,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QAErF,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,UAAU,CAAC;YACT,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,EAAC,aAAa,EAAE,MAAM,EAAC,CAAC,CAAC;QAClD,CAAC,EAAE,GAAG,CAAC,CAAC;IACV,CAAC;IAEM,uCAAK,GAAZ,UAAa,KAAK;QAEhB,mBAAmB;QACnB,IAAI,KAAK,CAAC,GAAG,KAAK,OAAO,EAAE;YACzB,IAAI,CAAC,IAAI,EAAE,CAAC;SACb;IACH,CAAC;IAEM,0CAAQ,GAAf;QACE,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;IAC1B,CAAC;IAvCsB;QAAtB,+DAAS,CAAC,UAAU,CAAC;;kEAAe;IAF1B,uBAAuB;QALnC,+DAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;YAC3B,kJAA+C;;SAEhD,CAAC;QAWG,6GAAM,CAAC,iEAAe,CAAC;+EAFJ,8DAAY;YACT,kEAAmB;OATjC,uBAAuB,CA0CnC;IAAD,8BAAC;CAAA;AA1CmC;;;;;;;;;;;;ACTpC,mgE;;;;;;;;;;;ACAA,+DAA+D,+L;;;;;;;;;;;;;;;;;;ACAb;AACC;AAOnD;IAEE,wBACU,aAAkC;QAAlC,kBAAa,GAAb,aAAa,CAAqB;IACxC,CAAC;IAEL,iCAAQ,GAAR;IACA,CAAC;IAEM,oCAAW,GAAlB;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACxD,IAAI,CAAC,QAAQ,EAAE;YACb,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAC1C,KAAK,CAAC,mBAAmB,CAAC,CAAC;SAC5B;aAAM;YACL,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;YACpC,KAAK,CAAC,wBAAwB,CAAC,CAAC;SACjC;IACH,CAAC;IAlBU,cAAc;QAL1B,+DAAS,CAAC;YACT,QAAQ,EAAE,OAAO;YACjB,2IAAqC;;SAEtC,CAAC;+EAIyB,kEAAmB;OAHjC,cAAc,CAoB1B;IAAD,qBAAC;CAAA;AApB0B;;;;;;;;;;;;ACR3B,6TAA6T,YAAY,ykCAAykC,SAAS,83B;;;;;;;;;;;ACA35C,oCAAoC,mBAAmB,EAAE,+CAA+C,+f;;;;;;;;;;;;;;;;;;;;ACAjC;AAC4B;AAChD;AAGO;AAO1D;IAA8C,kFAAsB;IAmBlE,kCACU,aAAkC;QAD5C,YAGE,iBAAO,SACR;QAHS,mBAAa,GAAb,aAAa,CAAqB;QARrC,iBAAW,GAAe;YAC/B,EAAC,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAC;YACpC,EAAC,KAAK,EAAE,cAAc,EAAE,KAAK,EAAE,eAAe,EAAC;YAC/C,EAAC,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,cAAc,EAAC;SAC5C,CAAC;;IAOF,CAAC;IAED,2CAAQ,GAAR;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACxD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;QACtE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC5D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QAC9D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;QAChE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC5D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;QAEhE,8BAA8B;QAC9B,IAAI,CAAC,aAAa,GAAG,kEAAgB,EAAE,CAAC;QAExC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAS,IAAI;YACtC,IAAM,UAAU,GAAG,KAAK,CAAC,mBAAmB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;YAC3D,KAAK,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC;IAED,SAAS;IAET,iDAAiD;IAC1C,mDAAgB,GAAvB,UAAwB,KAAwB;QAC9C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;IAC7D,CAAC;IAEM,+CAAY,GAAnB,UAAoB,UAAU;QAC5B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;IACrD,CAAC;IAEM,sDAAmB,GAA1B,UAA2B,IAAY,EAAE,OAAgB,EAAE,MAAe;QAExE,OAAO,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;QACnC,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;QAEjC,OAAO,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;IACzE,CAAC;IAAA,CAAC;IA7DkB;QAAnB,+DAAS,CAAC,OAAO,CAAC;wEAAQ,wDAAU;2DAAC;IAF3B,wBAAwB;QALpC,+DAAS,CAAC;YACT,QAAQ,EAAE,kBAAkB;YAC5B,4KAAgD;;SAEjD,CAAC;+EAqByB,kEAAmB;OApBjC,wBAAwB,CAiEpC;IAAD,+BAAC;CAAA,CAjE6C,oGAAsB,GAiEnE;AAjEoC;;;;;;;;;;;;ACZrC,0RAA0R,sM;;;;;;;;;;;ACA1R,iEAAiE,mBAAmB,4BAA4B,EAAE,+BAA+B,wCAAwC,4BAA4B,iCAAiC,EAAE,uCAAuC,uCAAuC,EAAE,+CAA+C,+7B;;;;;;;;;;;;;;;;;ACArU;AAOlD;IAQE;QANO,WAAM,GAAG;YACd,EAAC,KAAK,EAAE,yCAAyC,EAAC;YAClD,EAAC,KAAK,EAAE,yCAAyC,EAAC;YAClD,EAAC,KAAK,EAAE,yCAAyC,EAAC;SACnD;IAEe,CAAC;IAEjB,wCAAQ,GAAR;IACA,CAAC;IAXU,qBAAqB;QALjC,+DAAS,CAAC;YACT,QAAQ,EAAE,cAAc;YACxB,gKAA4C;;SAE7C,CAAC;;OACW,qBAAqB,CAajC;IAAD,4BAAC;CAAA;AAbiC;;;;;;;;;;;;ACPlC,gPAAgP,YAAY,qaAAqa,YAAY,6OAA6O,YAAY,gCAAgC,cAAc,8L;;;;;;;;;;;ACAp9B,qCAAqC,SAAS,mBAAmB,gBAAgB,qBAAqB,iBAAiB,yBAAyB,EAAE,0BAA0B,wBAAwB,oBAAoB,wBAAwB,wBAAwB,2BAA2B,EAAE,oCAAoC,yCAAyC,EAAE,oCAAoC,yCAAyC,EAAE,oCAAoC,yCAAyC,EAAE,8CAA8C,oCAAoC,oCAAoC,+BAA+B,sBAAsB,2BAA2B,4BAA4B,2BAA2B,+BAA+B,EAAE,oDAAoD,yBAAyB,uBAAuB,8BAA8B,4BAA4B,mFAAmF,2EAA2E,EAAE,yDAAyD,2BAA2B,wBAAwB,qCAAqC,EAAE,0DAA0D,wDAAwD,4CAA4C,wCAAwC,mCAAmC,wBAAwB,+BAA+B,EAAE,iEAAiE,0BAA0B,qCAAqC,0CAA0C,iCAAiC,gCAAgC,kCAAkC,gCAAgC,8BAA8B,iEAAiE,iCAAiC,2DAA2D,mDAAmD,EAAE,8EAA8E,2BAA2B,EAAE,uEAAuE,6BAA6B,EAAE,mEAAmE,0BAA0B,2BAA2B,EAAE,yEAAyE,kCAAkC,sCAAsC,EAAE,yEAAyE,4BAA4B,6BAA6B,mCAAmC,6BAA6B,EAAE,wEAAwE,6BAA6B,2DAA2D,yBAAyB,0BAA0B,2BAA2B,sBAAsB,wBAAwB,iCAAiC,0BAA0B,iCAAiC,qCAAqC,4CAA4C,EAAE,0EAA0E,yCAAyC,EAAE,iFAAiF,yBAAyB,EAAE,+CAA+C,24X;;;;;;;;;;;;;;;;;;;;ACA34G;AAEG;AACgD;AACnC;AAOlE;IAA+C,mFAAsB;IAKnE,mCACU,aAAkC;QAD5C,YAGE,iBAAO,SACR;QAHS,mBAAa,GAAb,aAAa,CAAqB;QAJrC,wBAAkB,GAAqB,EAAE,CAAC;;IAOjD,CAAC;IAED,4CAAQ,GAAR;QAEE,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;QACvE,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC7B,CAAC;IAEO,uDAAmB,GAA3B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAC;QAE7B,IAAM,UAAU,GAAG,0EAAiB,EAAE,CAAC;QAEvC,KAAK,IAAM,GAAG,IAAI,UAAU,EAAE;YAC5B,IAAI,KAAK,CAAC,gBAAgB,IAAI,KAAK,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;gBAC1H,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,oBAAoB,KAAK,IAAI,EAAE;oBACjD,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;iBAChD;aACF;SACF;IACH,CAAC;IAGD,SAAS;IAEF,oDAAgB,GAAvB,UAAwB,OAAO;QAE7B,0BAA0B;QAE1B,IAAI,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE;YAEjD,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;YAC7B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,iBAAiB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAEnE,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;IACH,CAAC;IAjDU,yBAAyB;QALrC,+DAAS,CAAC;YACT,QAAQ,EAAE,mBAAmB;YAC7B,+KAAiD;;SAElD,CAAC;+EAOyB,kEAAmB;OANjC,yBAAyB,CAkDrC;IAAD,gCAAC;CAAA,CAlD8C,oGAAsB,GAkDpE;AAlDqC;;;;;;;;;;;;ACXtC,qqBAAqqB,iBAAiB,SAAS,eAAe,kEAAkE,yCAAyC,+FAA+F,eAAe,uJ;;;;;;;;;;;ACAv6B,yBAAyB,0BAA0B,2BAA2B,uBAAuB,eAAe,iBAAiB,2BAA2B,EAAE,iBAAiB,yBAAyB,EAAE,wBAAwB,yBAAyB,EAAE,iBAAiB,mBAAmB,6BAA6B,uBAAuB,yBAAyB,EAAE,oBAAoB,wCAAwC,oBAAoB,mCAAmC,EAAE,0BAA0B,oCAAoC,EAAE,mBAAmB,kBAAkB,EAAE,mBAAmB,gCAAgC,EAAE,qBAAqB,gCAAgC,EAAE,mBAAmB,+CAA+C,EAAE,kDAAkD,8BAA8B,EAAE,6CAA6C,wBAAwB,EAAE,sCAAsC,oBAAoB,uBAAuB,gBAAgB,gBAAgB,gCAAgC,EAAE,+CAA+C,2zF;;;;;;;;;;;;;;;;;;;;;;ACCvhC;AACO;AAGI;AACP;AAEO;AAEA;AAS/E;IA2BE,6BACU,eAAyC,EACzC,gBAAuC,EACvC,kBAAyC,EACzC,kBAAyC;QAHzC,oBAAe,GAAf,eAAe,CAA0B;QACzC,qBAAgB,GAAhB,gBAAgB,CAAuB;QACvC,uBAAkB,GAAlB,kBAAkB,CAAuB;QACzC,uBAAkB,GAAlB,kBAAkB,CAAuB;QAX5C,kBAAa,GAAgB,aAAa,CAAC;IAalD,CAAC;IAED,sCAAQ,GAAR;QACE,IAAI,CAAC,SAAS,GAAG,6EAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACpD,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAED,yCAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,OAAO,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,SAAS,GAAG,6EAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpD,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;IACH,CAAC;IAGD,yCAAW,GAAX;QACE,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,CAAC;IAC3C,CAAC;IAKD,QAAQ;IACA,+CAAiB,GAAzB;QAEE,uDAAuD;QACvD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,GAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;IACpG,CAAC;IAEO,oCAAM,GAAd;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC;QAEnE,IAAI,KAAK,GAAW,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,GAAG,CAAC;QAC9C,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG,GAAG,CAAC;SACtD;QAED,IAAI,IAAI,CAAC,KAAK,GAAG,CAAC,EAAE;YAElB,qBAAqB;YACrB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;YAEf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;gBAEnC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;aACpE;SAEF;aAAM;YAEL,cAAc;YACd,IAAI,CAAC,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC;SACtD;QAED,iCAAiC;QACjC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC;QAEnE,0BAA0B;QAC1B,IAAI,IAAI,CAAC,qBAAqB,EAAE;YAC9B,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,CAAC;SAC1C;QAED,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAC1D,UAAU,MAAwB;YAEhC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC;YAErE,IAAI,MAAM,IAAI,MAAM,CAAC,KAAK,EAAE;gBAE1B,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,IAAI,MAAM,CAAC,KAAK,KAAK,UAAU,EAAE;oBAEzD,IAAI,KAAK,CAAC,SAAS,KAAK,KAAK,IAAI,KAAK,CAAC,SAAS,KAAK,MAAM,EAAE;wBAE3D,KAAK,CAAC,MAAM,EAAE,CAAC;wBACf,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC;wBACtB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC;wBACvB,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;qBACnD;iBAEF;qBAAM,IAAI,MAAM,CAAC,KAAK,KAAK,UAAU,EAAE;oBAEtC,2EAA2E;oBAE3E,IAAI,MAAM,CAAC,IAAI,KAAK,MAAM,EAAE;wBAE1B,qDAAqD;wBACrD,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;wBACxD,IAAI,YAAY,KAAK,KAAK,CAAC,QAAQ,EAAE;4BACnC,KAAK,CAAC,aAAa,GAAG,aAAa,CAAC;4BACpC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;4BACxC,KAAK,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;yBACvC;qBACF;yBAAM;wBACL,KAAK,CAAC,aAAa,GAAG,QAAQ,CAAC;wBAC/B,KAAK,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;qBACvC;iBACF;qBAAM,IAAI,MAAM,CAAC,KAAK,KAAK,OAAO,EAAE;oBAEnC,KAAK,CAAC,kBAAkB,CAAC,CAAC;oBAC1B,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC;oBACtB,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;oBAC1B,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC;iBAEpB;qBAAM,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,IAAI,MAAM,CAAC,KAAK,KAAK,UAAU,EAAE;oBACtE,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;oBACrB,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC;oBAErB,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;oBACpC,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;iBAE9B;qBAAM,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,IAAI,MAAM,CAAC,KAAK,KAAK,SAAS,EAAE;oBACrE,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC;iBACpB;aACF;QACH,CAAC,EAAE,UAAU,KAAK;YAEhB,KAAK,CAAC,gBAAgB,CAAC,CAAC;YACxB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC;YACrE,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC1B,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC;YACtB,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC;QACrB,CAAC,CAAC,CAAC;QAEL,8CAA8C;QAC9C,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;IACvC,CAAC;IAED,iBAAiB;IAEV,2CAAa,GAApB,UAAqB,QAAgB;QAEnC,6BAA6B;QAC7B,IAAI,IAAI,CAAC,YAAY,KAAK,QAAQ,EAAE;YAClC,IAAI,CAAC,GAAG,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAK,wBAAwB;SACrD;IACH,CAAC;IAID,wDAAwD;IAEhD,uCAAS,GAAjB;QAEE,IAAI,IAAI,CAAC,kBAAkB,CAAC,KAAK,KAAK,QAAQ,EAAE;YAC9C,KAAK,CAAC,4BAA4B,CAAC,CAAC;YACpC,OAAO;SACR;QAED,IAAI,IAAI,CAAC;QAET,IAAI,OAAO,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;YACjC,IAAI,GAAG,0EAAW,CAAC,SAAS,GAAG,0EAAW,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC;SACpE;aAAM;YAEL,IAAI,GAAG,EAAE,CAAC;YAEV,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,UAAS,IAAI;gBAC7B,IAAI,CAAC,IAAI,CAAC,0EAAW,CAAC,SAAS,GAAG,0EAAW,CAAC,WAAW,GAAG,IAAI,CAAC,CAAC;YACpE,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,+DAAS,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/D,CAAC;IAED,iBAAiB;IACT,oCAAM,GAAd;QACE,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;QAClC,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;QAC7B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1B,CAAC;IAED,wCAAwC;IAChC,qCAAO,GAAf;QACE,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;QAClC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1B,CAAC;IApNQ;QAAR,2DAAK,EAAE;;wDAAiC;IAChC;QAAR,2DAAK,EAAE;;qDAAiC;IAChC;QAAR,2DAAK,EAAE;;sDAAiC;IAChC;QAAR,2DAAK,EAAE;wEAA0B,QAAQ;2DAAC;IAClC;QAAR,2DAAK,EAAE;wEAA0B,QAAQ;wDAAC;IAClC;QAAR,2DAAK,EAAE;;wDAAkC;IACjC;QAAR,2DAAK,EAAE;;0DAAkC;IACjC;QAAR,2DAAK,EAAE;;wDAAiC;IAChC;QAAR,2DAAK,EAAE;;kEAAkC;IAEjC;QAAR,2DAAK,EAAE;;qDAAiC;IAChC;QAAR,2DAAK,EAAE;;0DAAiC;IAChC;QAAR,2DAAK,EAAE;;sDAAiC;IAd9B,mBAAmB;QAP/B,+DAAS,CAAC;YACT,QAAQ,EAAE,YAAY;YACtB,yKAA0C;YAE1C,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EA8BkC,+DAAiB;YACjB,yEAAe;YACf,6EAAiB;YACjB,6EAAiB;OA/BxC,mBAAmB,CAuN/B;IAAD,0BAAC;CAAA;AAvN+B;;;;;;;;;;;;ACnBhC,+XAA+X,YAAY,mLAAmL,uGAAuG,quB;;;;;;;;;;;ACArqB,qDAAqD,mCAAmC,EAAE,eAAe,+BAA+B,8BAA8B,2BAA2B,iCAAiC,EAAE,cAAc,uBAAuB,EAAE,+CAA+C,2gC;;;;;;;;;;;;;;;;;;;;;;;;ACA5L;AAE3E;AAEgD;AAC3B;AACgB;AACZ;AACO;AAEI;AASvF;IAA4C,gFAAsB;IAuBhE,gCACU,uBAAgD,EAChD,eAAyC,EACzC,aAA2C,EAC3C,gBAAuC,EACvC,kBAAyC;QALnD,YAOE,iBAAO,SACR;QAPS,6BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,qBAAe,GAAf,eAAe,CAA0B;QACzC,mBAAa,GAAb,aAAa,CAA8B;QAC3C,sBAAgB,GAAhB,gBAAgB,CAAuB;QACvC,wBAAkB,GAAlB,kBAAkB,CAAuB;QAxB3C,gBAAU,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;QACzC,iBAAW,GAAG,EAAE,CAAC;QAEjB,wBAAkB,GAA4B,EAAE,CAAC;QAMjD,aAAO,GAAW,EAAE,CAAC,CAAsB,wCAAwC;QAMnF,qBAAe,GAAW,EAAE,CAAC,CAAmB,oCAAoC;QACnF,2BAAqB,GAAW,EAAE,CAAC,CAAO,8BAA8B;QACxE,0BAAoB,GAAW,EAAE,CAAC,CAAO,8BAA8B;;IAU/E,CAAC;IAED,yCAAQ,GAAR;QAEE,iBAAM,QAAQ,WAAE,CAAC;QAEjB,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;QACvE,IAAI,CAAC,WAAW,GAAG,6EAAoB,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC;QAE3F,IAAI,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,SAAS,CAAC,UAAS,MAAM;YACrE,KAAK,CAAC,kBAAkB,GAAG,MAAM,CAAC;QACpC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAE3B,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,KAAK,QAAQ,CAAC,CAAC;QAEtE,IAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,EAAE,CAAC,OAAO,CAAC,CAAC;QAC3E,IAAM,WAAW,GAAG,mEAAa,EAAE,CAAC;QAEpC,IAAI,WAAW,EAAE;YACf,IAAI,aAAa,KAAK,WAAW,CAAC,IAAI,EAAE;gBACtC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;aACrB;SACF;QAED,IAAI,CAAC,yBAAyB,EAAE,CAAC;IACnC,CAAC;IAED,4CAAW,GAAX;QACE,iBAAM,WAAW,WAAE,CAAC;QAEpB,IAAI,CAAC,2BAA2B,EAAE,CAAC;QACnC,IAAI,CAAC,0BAA0B,EAAE,CAAC;IACpC,CAAC;IAGD,QAAQ;IAEA,oDAAmB,GAA3B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAC;QAE7B,IAAM,UAAU,GAAG,0EAAiB,EAAE,CAAC;QAEvC,KAAK,IAAM,GAAG,IAAI,UAAU,EAAE;YAC5B,IAAI,KAAK,CAAC,gBAAgB,IAAI,KAAK,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK,MAAM,EAAE;gBAC1H,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;aAChD;SACF;IACH,CAAC;IAGO,0DAAyB,GAAjC;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,2BAA2B,EAAE,CAAC;QACnC,IAAI,CAAC,0BAA0B,EAAE,CAAC;QAElC,KAAK,CAAC,WAAW,GAAG,EAAE,CAAC;QAEvB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAS,IAAI;YACnC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;YACjD,IAAI,KAAK,CAAC,WAAW,CAAC,IAAI,GAAG,SAAS,CAAC,EAAE;gBACvC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAC9B;QACH,CAAC,CAAC;QAEF,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAS,IAAI;YAEpC,KAAK,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC;YACtC,KAAK,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,uBAAuB,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,WAAW,CAAC,CAAC,SAAS,CAAC,UAAS,MAAM;gBACvJ,uDAAuD;gBACvD,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;gBAC7B,KAAK,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;YACxC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,0DAAyB,GAAjC,UAAkC,IAAY;QAA9C,iBAUC;QARC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,CAAC,CAAC,SAAS,CAAC,gBAAM;YAC5H,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;YAC7C,KAAI,CAAC,eAAe,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG,MAAM,CAAC;YAChD,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,oBAAoB;QACpB,IAAI,CAAC,eAAe,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,CAAC,CAAC;IACvH,CAAC;IAEO,4DAA2B,GAAnC;QACE,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,qBAAqB,EAAE;YAC5C,IAAI,aAAa,GAAiB,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;YAClE,IAAI,aAAa,EAAE;gBACjB,aAAa,CAAC,WAAW,EAAE,CAAC;gBAC5B,aAAa,GAAG,IAAI,CAAC;aACtB;SACF;IACH,CAAC;IAEO,2DAA0B,GAAlC;QACE,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC3C,IAAI,aAAa,GAAiB,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YACjE,IAAI,aAAa,EAAE;gBACjB,aAAa,CAAC,WAAW,EAAE,CAAC;gBAC5B,aAAa,GAAG,IAAI,CAAC;aACtB;SACF;IACH,CAAC;IAED,0BAA0B;IACnB,+CAAc,GAArB,UAAsB,IAAY;QAChC,qCAAqC;QAErC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACtB,qEAAqE;YACrE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAI,qBAAqB;SACpE;aAAM;YACL,yEAAyE;YACzE,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAM,wBAAwB;SAC7E;IACH,CAAC;IAED,0BAA0B;IACnB,gDAAe,GAAtB,UAAuB,IAAY;QAEjC,8DAA8D;QAE9D,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;IAED,0BAA0B;IACnB,wCAAO,GAAd,UAAe,IAAY;QACzB,mEAAmE;QACnE,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,GAAG,SAAS,CAAC,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;IACrF,CAAC;IAGD,SAAS;IAET;;;qEAGiE;IAC1D,8CAAa,GAApB,UAAqB,KAAsB;QAEzC,IAAM,GAAG,GAAW,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAExC,IAAI,GAAG,KAAK,IAAI,CAAC,cAAc,EAAE;YAE/B,IAAI,gEAAU,EAAE,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAE3C,IAAM,OAAO,GAAG,gEAAU,EAAE,CAAC;gBAC7B,OAAO,CAAC,OAAO,CACb,+CAA+C,EAC/C,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,EAC/B,SAAS,EACT,CAAC,QAAQ,EAAE,UAAU,CAAC,CACvB,CAAC;aAEH;iBAAM;gBAEL,IAAI,IAAI,CAAC,kBAAkB,EAAE;oBAC3B,KAAK,CAAC,qBAAqB,CAAC,CAAC;iBAC9B;gBACD,IAAI,CAAC,eAAe,EAAE,CAAC;gBACvB,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;aACrC;SACF;IACH,CAAC;IAED,uCAAuC;IAC/B,gDAAe,GAAvB,UAAwB,QAAiB;QAEvC,QAAQ,GAAG,QAAQ,IAAI,CAAC,CAAC;QAEzB,IAAM,aAAa,GAAW,IAAI,CAAC,cAAc,CAAC;QAClD,IAAM,SAAS,GAAW,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAEtD,IAAI,QAAQ,KAAK,CAAC,IAAI,aAAa,KAAK,SAAS,EAAE;YACjD,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAE3B,6CAA6C;gBAC7C,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;aACrE;YACD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC;YAC3E,IAAI,CAAC,WAAW,GAAG,6EAAoB,CAAC,SAAS,CAAC,CAAC;YAInD,IAAI,CAAC,yBAAyB,EAAE,CAAC;YAEjC,iBAAM,UAAU,WAAE,CAAC;SACpB;aAAM;YACL,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,GAAG,aAAa,CAAC,CAAM,qBAAqB;SACxE;IAEH,CAAC;IAEM,mDAAkB,GAAzB,UAA0B,IAAY;QACpC,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,iBAAiB,CAAC,CAAC;QACtC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;IAC/G,CAAC;IAEM,kDAAiB,GAAxB,UAAyB,IAAY;QACnC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QACrB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,EAAE,GAAG,CAAC,CAAC;IAChF,CAAC;IAlP2B;QAA3B,+DAAS,CAAC,eAAe,CAAC;wEAAgB,wDAAU;iEAAC;IAF3C,sBAAsB;QAPlC,+DAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,sKAA8C;YAE9C,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EA0BoC,wFAAsB;YACxB,+DAAiB;YACjB,kEAAmB;YACnB,yEAAe;YACf,6EAAiB;OA5BxC,sBAAsB,CAqPlC;IAAD,6BAAC;CAAA,CArP2C,oGAAsB,GAqPjE;AArPkC;;;;;;;;;;;;ACnBnC,wOAAwO,UAAU,qGAAqG,MAAM,uRAAuR,iBAAiB,sI;;;;;;;;;;;ACAroB,sEAAsE,iCAAiC,EAAE,iBAAiB,iBAAiB,0BAA0B,gBAAgB,EAAE,+CAA+C,2vB;;;;;;;;;;;;;;;;;;;;ACApL;AAEiD;AAChD;AACE;AAOrD;IAA2C,+EAAsB;IAO/D,+BACU,aAAkC;QAD5C,YAGE,iBAAO,SACR;QAHS,mBAAa,GAAb,aAAa,CAAqB;QAJrC,mBAAa,GAAkB,CAAC,EAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAE,mBAAmB,EAAC,EAAE,EAAC,EAAE,EAAE,CAAC,EAAE,KAAK,EAAE,mBAAmB,EAAC,CAAC,CAAC;;IAOjH,CAAC;IAED,wCAAQ,GAAR;QACE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAE1D,IAAI,CAAC,IAAI,GAAG,6DAAO,EAAE,CAAC;QAEtB,IAAM,UAAU,GAAW,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACnE,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;SAC5B;IACH,CAAC;IAEM,iDAAiB,GAAxB,UAAyB,KAAsB;QAE7C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;QAEnD,IAAI,KAAK,CAAC,KAAK,KAAK,IAAI,CAAC,SAAS,EAAE;YAClC,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;IACH,CAAC;IAEM,gDAAgB,GAAvB,UAAwB,QAAQ;QAC9B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;IACjD,CAAC;IAnCU,qBAAqB;QALjC,+DAAS,CAAC;YACT,QAAQ,EAAE,eAAe;YACzB,mKAA6C;;SAE9C,CAAC;+EASyB,kEAAmB;OARjC,qBAAqB,CAsCjC;IAAD,4BAAC;CAAA,CAtC0C,oGAAsB,GAsChE;AAtCiC;;;;;;;;;;;;ACXlC,wGAAwG,cAAc,4ZAA4Z,YAAY,4+B;;;;;;;;;;;ACA9hB,sCAAsC,kBAAkB,+BAA+B,EAAE,iCAAiC,uBAAuB,gCAAgC,EAAE,4BAA4B,kBAAkB,2BAA2B,EAAE,gCAAgC,2BAA2B,EAAE,2DAA2D,2BAA2B,EAAE,wDAAwD,sCAAsC,+BAA+B,sCAAsC,kCAAkC,4BAA4B,4BAA4B,EAAE,gGAAgG,mBAAmB,EAAE,oIAAoI,+BAA+B,EAAE,2BAA2B,6CAA6C,sCAAsC,EAAE,+CAA+C,kBAAkB,EAAE,sEAAsE,iCAAiC,2BAA2B,EAAE,oEAAoE,mBAAmB,8BAA8B,4BAA4B,EAAE,2KAA2K,2BAA2B,4BAA4B,EAAE,mFAAmF,2BAA2B,4BAA4B,kCAAkC,EAAE,wBAAwB,uBAAuB,gBAAgB,8BAA8B,kBAAkB,EAAE,+BAA+B,uBAAuB,EAAE,2CAA2C,0BAA0B,iBAAiB,EAAE,uBAAuB,gBAAgB,iBAAiB,2BAA2B,uBAAuB,EAAE,gDAAgD,qBAAqB,uBAAuB,iBAAiB,0BAA0B,8BAA8B,uBAAuB,EAAE,0BAA0B,uBAAuB,sBAAsB,EAAE,0BAA0B,uBAAuB,uBAAuB,EAAE,qCAAqC,8BAA8B,6BAA6B,kBAAkB,oCAAoC,uBAAuB,8BAA8B,qBAAqB,EAAE,uDAAuD,yBAAyB,0BAA0B,EAAE,yDAAyD,uBAAuB,EAAE,2DAA2D,yBAAyB,mCAAmC,EAAE,sCAAsC,kBAAkB,yBAAyB,iBAAiB,+IAA+I,qEAAqE,0HAA0H,EAAE,6CAA6C,sCAAsC,uBAAuB,EAAE,2CAA2C,uBAAuB,2BAA2B,iBAAiB,+BAA+B,+BAA+B,oBAAoB,EAAE,wBAAwB,2BAA2B,iBAAiB,2BAA2B,wBAAwB,uBAAuB,EAAE,iCAAiC,6BAA6B,gCAAgC,uBAAuB,oBAAoB,2BAA2B,EAAE,+CAA+C,u2O;;;;;;;;;;;;;;;;;;ACAr9H;AACf;AAOhE;IAeE,iCACU,UAAiD,EACzB,IAAY;QAF9C,iBAYC;QAXS,eAAU,GAAV,UAAU,CAAuC;QACzB,SAAI,GAAJ,IAAI,CAAQ;QAbvC,cAAS,GAAkB;YAChC,EAAC,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,UAAU,EAAC;YACtC,EAAC,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,EAAC;YACnC,EAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAC;YAC9B,EAAC,KAAK,EAAE,aAAa,EAAE,KAAK,EAAE,SAAS,EAAC;YACxC,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAC;SACjC,CAAC;QAGM,qBAAgB,GAAY,KAAK,CAAC;QAOxC,UAAU,CAAC,YAAY,GAAG,IAAI,CAAC,CAAC,kCAAkC;QAElE,IAAI,UAAU,CAAC,aAAa,EAAE;YAC1B,UAAU,CAAC,aAAa,EAAE,CAAC,SAAS,CAAC,gBAAM;gBAC3C,UAAU,CAAC,KAAK,CAAC,KAAI,CAAC,gBAAgB,CAAC,CAAC;YAC1C,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,0CAAQ,GAAR,cAAkB,CAAC;IAEZ,yCAAO,GAAd,UAAe,IAAI;QACjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;QAC9B,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACjD,CAAC;IAED,yBAAyB;IAClB,mDAAiB,GAAxB,UAAyB,KAAK;QAC5B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;IAChC,CAAC;IArC0B;QAA1B,+DAAS,CAAC,cAAc,CAAC;wEAAe,wDAAU;iEAAC;IAFzC,uBAAuB;QALnC,+DAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;YAC3B,kJAA+C;;SAEhD,CAAC;QAkBG,6GAAM,CAAC,iEAAe,CAAC;+EADJ,8DAAY;OAhBvB,uBAAuB,CAwCnC;IAAD,8BAAC;CAAA;AAxCmC;;;;;;;;;;;;ACRpC,8X;;;;;;;;;;;ACAA,mJAAmJ,mBAAmB,EAAE,sDAAsD,yBAAyB,iBAAiB,EAAE,6BAA6B,iBAAiB,EAAE,+BAA+B,qCAAqC,EAAE,wBAAwB,wSAAwS,wHAAwH,EAAE,oCAAoC,iCAAiC,EAAE,+CAA+C,u3E;;;;;;;;;;;;;;;;;;;;ACAr3B;AACV;AAGU;AACE;AAS7D;IAA+C,mFAAa;IAS1D,mCACU,MAAsB,EACtB,cAA6B;QAFvC,YAGE,iBAAO,SACR;QAHS,YAAM,GAAN,MAAM,CAAgB;QACtB,oBAAc,GAAd,cAAc,CAAe;;IAEvC,CAAC;IAED,4CAAQ,GAAR;QAAA,iBAOC;QANC,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAM;YAC/D,KAAI,CAAC,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACtC,KAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpC,KAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;QACpC,CAAC,CACF,CAAC,CAAC;IACL,CAAC;IAED,iBAAiB;IAEV,4CAAQ,GAAf,UAAgB,QAAgB;QAC9B,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC;IAC/B,CAAC;IAEM,4CAAQ,GAAf,UAAgB,QAAgB;QAC9B,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;IACzB,CAAC;IAEM,8CAAU,GAAjB,UAAkB,QAAgB;QAChC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC3B,CAAC;IApCU,yBAAyB;QALrC,+DAAS,CAAC;YACT,QAAQ,EAAE,uBAAuB;YACjC,iJAAiD;;SAElD,CAAC;+EAWkB,8DAAc;YACN,qEAAa;OAX5B,yBAAyB,CAqCrC;IAAD,gCAAC;CAAA,CArC8C,uEAAa,GAqC3D;AArCqC;;;;;;;;;;;;ACdtC,yLAAyL,0BAA0B,4DAA4D,sCAAsC,8CAA8C,6BAA6B,oH;;;;;;;;;;;ACAhY,yBAAyB,mBAAmB,uBAAuB,2BAA2B,cAAc,YAAY,iBAAiB,iBAAiB,+BAA+B,2IAA2I,4IAA4I,kLAAkL,wCAAwC,oCAAoC,uDAAuD,qBAAqB,EAAE,WAAW,oBAAoB,iBAAiB,EAAE,uBAAuB,yBAAyB,cAAc,sEAAsE,sEAAsE,mBAAmB,EAAE,6BAA6B,sBAAsB,2BAA2B,qBAAqB,6BAA6B,yBAAyB,mBAAmB,0BAA0B,mBAAmB,mBAAmB,cAAc,aAAa,qCAAqC,0BAA0B,EAAE,uCAAuC,6BAA6B,2BAA2B,+BAA+B,oBAAoB,oDAAoD,qBAAqB,2BAA2B,kCAAkC,gCAAgC,EAAE,WAAW,0BAA0B,EAAE,YAAY,2BAA2B,EAAE,+CAA+C,u0H;;;;;;;;;;;;;;;;;;;;;ACC/uD;AAEO;AACxB;AAGU;AASxD;IAyBE;QAhBU,kBAAa,GAAyB,IAAI,0DAAY,EAAU,CAAC;QAEpE,iBAAY,GAAG,CAAC,CAAC;QACjB,mBAAc,GAAG,CAAC,CAAC;QAGlB,qBAAgB,GAAG,CAAC,CAAC;IAUd,CAAC;IAIhB,kBAAkB;IAElB,qCAAQ,GAAR;QACE,IAAM,aAAa,GAAG,IAAI,2DAAc,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAClE,aAAa,CAAC,GAAG,CAAC,IAAI,uDAAU,CAAC,EAAC,SAAS,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAE,wEAA2B,EAAC,CAAC,CAAC,CAAC;QACvG,aAAa,CAAC,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACpD,CAAC;IAED,4CAAe,GAAf;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACnB,OAAO;SACR;QAED,sCAAsC;QACtC,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;QACzB,IAAM,WAAW,GAAW,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC;QACxD,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,UAAS,IAAU,EAAE,KAAK;YAErD,0CAA0C;YAC1C,IAAI,KAAK,KAAK,CAAC,IAAI,KAAK,KAAK,WAAW,GAAG,CAAC,EAAE;gBAC5C,IAAM,iBAAiB,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBAC7E,KAAK,CAAC,cAAc,GAAG,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;aACvE;iBAAM;gBACL,KAAK,CAAC,cAAc,GAAG,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aACpE;QACH,CAAC,CAAC,CAAC;QAEH,iBAAiB;QACjB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC;QAE1D,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC;QAE3I,IAAI,CAAC,SAAS,GAAI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;QACvE,IAAI,CAAC,UAAU,GAAI,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC;QAExD,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,YAAY,CAAC;aAChC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC;aACrC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAElD,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,WAAW,EAAE,CAAC;IACrB,CAAC;IAED,wCAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,OAAO,CAAC,YAAY,IAAI,OAAO,CAAC,YAAY,CAAC,YAAY,EAAE;YAE7D,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC;YACzC,IAAM,MAAM,GAAW,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,CAAC,KAAK,CAAC;YAC/E,IAAM,IAAI,GAAW,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC;YAC3E,IAAM,MAAM,GAAW,IAAI,GAAG,MAAM,CAAC;YACrC,IAAM,QAAQ,GAAW,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,SAAS,CAAC,CAAC;YAEtE,MAAM;YACN,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;YACxE,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,GAAG,GAAG,CAAC;YAC7D,IAAM,YAAY,GAAG,CAAC,QAAQ,GAAG,UAAU,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC;YAC3E,IAAI,CAAC,SAAS,GAAG,CAAC,YAAY,GAAG,UAAU,CAAC,CAAC;YAE7C,WAAW;YACX,IAAM,kBAAkB,GAAG,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC;YACxD,IAAM,cAAc,GAAG,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;YAEhF,gCAAgC;YAChC,IAAI,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;YAC7D,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,KAAK,MAAM,EAAE;gBAClC,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,GAAG,cAAc,CAAC;aAC3E;YAED,IAAI,CAAC,cAAc,GAAG,CAAC,YAAY,GAAG,CAAC,kBAAkB,GAAG,CAAC,CAAC,CAAC,CAAC;YAChE,IAAI,CAAC,YAAY,GAAG,cAAc,CAAC;SACpC;QAED,IAAI,OAAO,CAAC,MAAM,EAAE;YAElB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;YACtE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC;YAEvD,kBAAkB;YAClB,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnB,IAAM,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACpE,IAAI,GAAG,EAAE;oBACP,GAAG,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,GAAG,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,CAAC;oBAClF,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC,CAAC;oBAC/C,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,CAAC;iBAClD;aACF;YAED,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,QAAQ,EAAE,CAAC;gBAChB,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF;IACH,CAAC;IAKD,OAAO;IAEC,qCAAQ,GAAhB;QAEE,IAAM,GAAG,GAAW,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,GAAG,CAAC,GAAG,0EAAW,CAAC,IAAI,CAAC;QACjF,IAAM,GAAG,GAAW,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,0EAAW,CAAC,IAAI,CAAC;QAClF,IAAI,SAAiB,CAAC;QAEtB,IAAM,UAAU,GAAe,EAAE,CAAC;QAElC,IAAI,OAAO,GAAG,CAAC,CAAC;QAEhB,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAE1B,IAAM,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;QAExD,eAAe;QACf,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;QAC1B,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,sEAAkB,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC,EAC1F,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAE7E,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC;QAEhC,IAAI,SAAiB,CAAC;QACtB,IAAI,iBAAiB,GAAG,CAAC,CAAC;QAE1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,oBAAoB,GAAG,EAAE,CAAC,EAAE;YAEzG,IAAM,QAAQ,GAAa,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;YAElD,4CAA4C;YAC5C,IAAI,OAAO,GAAG,CAAC,EAAE;gBACf,iBAAiB,GAAG,CAAC,QAAQ,CAAC,aAAa,GAAG,0EAAW,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;aACzF;YAED,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,sEAAkB,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC,EAC1F,QAAQ,CAAC,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;YAE5D,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,SAAS,GAAG,iBAAiB,EAAE,SAAS,CAAC,CAAC,CAAC;YACjE,OAAO,IAAI,CAAC,CAAC;YACb,SAAS,GAAG,QAAQ,CAAC;SACtB;QAED,+BAA+B;QAC/B,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC,CAAC;QAC7C,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,CAAC;QAEvC,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;SACzB;QAED,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACxE,CAAC;IAEO,wCAAW,GAAnB;QAEE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACtD,IAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,EAAC,CAAC,CAAC;SAC5N;IAEH,CAAC;IAED,+BAA+B;IACvB,yCAAY,GAApB,UAAqB,KAAK;QACxB,OAAO,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC;IACrD,CAAC;IAID,iBAAiB;IAEV,oCAAO,GAAd,UAAe,KAAiB;QAE9B,IAAM,OAAO,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;QAClE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACnC,CAAC;IAED,iBAAiB;IACT,qCAAQ,GAAhB,UAAiB,KAAK;QAEpB,wCAAwC;QACxC,IAAM,KAAK,GAAW,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,KAAK,IAAI,CAAC,CAAC;QACpE,IAAM,OAAO,GAAG,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;QAC5D,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACnC,CAAC;IApNkB;QAAlB,+DAAS,CAAC,MAAM,CAAC;wEAAO,wDAAU;oDAAC;IACb;QAAtB,+DAAS,CAAC,UAAU,CAAC;wEAAW,wDAAU;wDAAC;IAEnC;QAAR,2DAAK,EAAE;;yDAAwB;IACvB;QAAR,2DAAK,EAAE;;4DAAyB;IACxB;QAAR,2DAAK,EAAE;;sDAAyB;IAEvB;QAAT,4DAAM,EAAE;wEAAgB,0DAAY;6DAAsC;IAThE,kBAAkB;QAN9B,+DAAS,CAAC;YACT,QAAQ,EAAE,qBAAqB;YAC/B,2IAAyC;;SAG1C,CAAC;;OACW,kBAAkB,CAwN9B;IAAD,yBAAC;CAAA;AAxN8B;;;;;;;;;;;;AChB/B,4EAA4E,+DAA+D,4B;;;;;;;;;;;ACA3I,yBAAyB,mBAAmB,oBAAoB,cAAc,YAAY,iBAAiB,gBAAgB,cAAc,eAAe,wBAAwB,yBAAyB,iBAAiB,EAAE,kBAAkB,yBAAyB,0BAA0B,cAAc,gBAAgB,iBAAiB,6BAA6B,4BAA4B,kBAAkB,yCAAyC,EAAE,uBAAuB,mBAAmB,EAAE,8BAA8B,6BAA6B,EAAE,6BAA6B,6BAA6B,EAAE,+CAA+C,+hD;;;;;;;;;;;;;;;;;;;;ACApiB;AAC5D;AACe;AAEd;AAS3D;IASE,yBAAY,QAAoB;QAJzB,oBAAe,GAAkB,EAAE,CAAC;QAKzC,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;IAC7B,CAAC;IAED,kCAAQ,GAAR,cAAkB,CAAC;IAEnB,qCAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,IAAI,CAAC,WAAW,EAAE;YAEpB,uBAAuB;YACvB,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE;gBACrD,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;aAChI;YAED,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;YACzD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;YACxD,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;YAE1B,IAAM,OAAO,GAAkB,qEAAiB,CAAC,iBAAiB,EAAE,mBAAmB,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;YAE7G,IAAM,KAAK,GAAG,IAAI,CAAC;YAEnB,IAAM,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;YAEzC,gBAAgB;YAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,EAAE,CAAC,EAAE,EAAE;gBAEtC,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBAE9B,IAAM,SAAS,GAAW,sEAAkB,CAAC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,EACpF,MAAM,CAAC,WAAW,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,CAAC,CAAC;gBAE7D,iCAAiC;gBACjC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE;oBAE5B,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC;oBAC/C,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;oBACpD,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC;iBAC5E;qBAAM;oBAEL,KAAK,CAAC,eAAe,CAAC,IAAI,CACxB;wBACE,MAAM,EAAE,SAAS;wBACjB,KAAK,EAAE,MAAM,CAAC,OAAO,CAAC;wBACtB,KAAK,EAAE,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO;qBAE9C,CAAC,CAAC;iBACN;aACF;SACF;IACH,CAAC;IA1DQ;QAAR,2DAAK,EAAE;;wDAAmB;IAClB;QAAR,2DAAK,EAAE;wEAAS,KAAK;mDAAS;IAHpB,eAAe;QAP3B,+DAAS,CAAC;YACT,QAAQ,EAAE,QAAQ;YAClB,+IAAsC;YAEtC,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EAWsB,wDAAU;OATrB,eAAe,CA6D3B;IAAD,sBAAC;CAAA;AA7D2B;;;;;;;;;;;;ACb5B,4EAA4E,kCAAkC,mDAAmD,aAAa,KAAK,aAAa,sB;;;;;;;;;;;ACAhM,yBAAyB,mBAAmB,oBAAoB,cAAc,YAAY,iBAAiB,iBAAiB,cAAc,eAAe,wBAAwB,yBAAyB,iBAAiB,EAAE,kBAAkB,yBAAyB,0BAA0B,cAAc,gBAAgB,iBAAiB,6BAA6B,kBAAkB,yCAAyC,EAAE,+BAA+B,2BAA2B,yBAAyB,oDAAoD,kBAAkB,mBAAmB,iCAAiC,0BAA0B,iCAAiC,sDAAsD,wBAAwB,2CAA2C,2CAA2C,EAAE,uBAAuB,mBAAmB,iCAAiC,EAAE,uBAAuB,iBAAiB,EAAE,+CAA+C,+oE;;;;;;;;;;;;;;;;;;;ACAz4B;AAC7C;AAEd;AAS3D;IASE,yBAAY,QAAoB;QAJzB,oBAAe,GAAkB,EAAE,CAAC;QAKzC,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;IAC7B,CAAC;IAAA,CAAC;IAEF,kCAAQ,GAAR,cAAkB,CAAC;IAEnB,qCAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,IAAI,CAAC,WAAW,EAAE;YAEpB,cAAc;YAEd,uBAAuB;YACvB,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE;gBACpD,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;aACjI;YAED,IAAI,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;YACvD,IAAI,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;YACtD,IAAI,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;YAExB,IAAI,KAAK,GAAG,IAAI,CAAC;YAEjB,IAAM,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;YAEzC,gBAAgB;YAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,EAAE,CAAC,EAAE,EAAE;gBAEtC,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBAE9B,IAAM,SAAS,GAAW,sEAAkB,CAAC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,EACpF,MAAM,CAAC,WAAW,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,CAAC,CAAC;gBAE7D,iCAAiC;gBACjC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE;oBAE5B,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;oBACpD,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,SAAS,GAAG,CAAC,CAAC;oBACnD,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;iBACrD;gBAED,WAAW;qBACN;oBAEH,KAAK,CAAC,eAAe,CAAC,IAAI,CACxB;wBACE,KAAK,EAAE,MAAM,CAAC,OAAO,CAAC;wBACtB,MAAM,EAAE,SAAS,GAAG,CAAC;wBACrB,KAAK,EAAE,MAAM,CAAC,OAAO,CAAC;qBACvB,CAAC,CAAC;iBACN;aAEF;SACF;IACH,CAAC;IA7DQ;QAAR,2DAAK,EAAE;;wDAAmB;IAClB;QAAR,2DAAK,EAAE;wEAAS,KAAK;mDAAS;IAHpB,eAAe;QAP3B,+DAAS,CAAC;YACT,QAAQ,EAAE,QAAQ;YAClB,+IAAsC;YAEtC,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EAWsB,wDAAU;OATrB,eAAe,CAgE3B;IAAD,sBAAC;CAAA;AAhE2B;;;;;;;;;;;;ACZ5B,gDAAgD,SAAS,sDAAsD,SAAS,uOAAuO,oBAAoB,+HAA+H,oBAAoB,gaAAga,SAAS,mB;;;;;;;;;;;ACA/6B,yBAAyB,uBAAuB,0BAA0B,mBAAmB,iBAAiB,kCAAkC,wBAAwB,sBAAsB,EAAE,gCAAgC,qBAAqB,uBAAuB,qBAAqB,mBAAmB,wBAAwB,EAAE,oBAAoB,wBAAwB,qBAAqB,aAAa,yBAAyB,mBAAmB,EAAE,wBAAwB,uCAAuC,EAAE,WAAW,uBAAuB,cAAc,mBAAmB,iBAAiB,EAAE,gCAAgC,yBAAyB,oBAAoB,kBAAkB,8BAA8B,EAAE,kDAAkD,yBAAyB,yBAAyB,oBAAoB,EAAE,kBAAkB,qBAAqB,yBAAyB,6BAA6B,mBAAmB,kBAAkB,+BAA+B,kBAAkB,mBAAmB,iBAAiB,kDAAkD,oDAAoD,yBAAyB,sBAAsB,yBAAyB,yCAAyC,yCAAyC,EAAE,YAAY,mBAAmB,uBAAuB,qBAAqB,EAAE,uBAAuB,4BAA4B,qBAAqB,kBAAkB,kBAAkB,yBAAyB,gCAAgC,yBAAyB,sBAAsB,kBAAkB,EAAE,+CAA+C,26G;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCpkD;AAChB;AACpC;AACuB;AACP;AACQ;AACkB;AACtB;AAC+B;AACF;AACf;AAMJ;AAEF;AAa3D;IAAuC,2EAAa;IAwClD,2BACU,aAAkC,EAClC,eAAsC,EACtC,cAAoC,EACpC,kBAAqC,EACrC,cAA6B,EAC7B,YAAyB;QANnC,YAQE,iBAAO,SACR;QARS,mBAAa,GAAb,aAAa,CAAqB;QAClC,qBAAe,GAAf,eAAe,CAAuB;QACtC,oBAAc,GAAd,cAAc,CAAsB;QACpC,wBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,oBAAc,GAAd,cAAc,CAAe;QAC7B,kBAAY,GAAZ,YAAY,CAAa;QA1CzB,iBAAW,GAAyB,IAAI,0DAAY,EAAU,CAAC;QAoBlE,cAAQ,GAAmC,EAAE,CAAC;;IAyBrD,CAAC;IAID,kBAAkB;IAElB,oCAAQ,GAAR;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,cAAc,GAAG,kEAAgB,EAAE,CAAC;QAEzC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC7D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;QAErE,kFAAkF;QAClF,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,UAAS,IAAY;YAC7C,KAAK,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;YACnC,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,4BAA4B;QAC5B,KAAK,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;QACrC,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,KAAK,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;IACjC,CAAC;IAED,2CAAe,GAAf;QAEE,+DAA+D;QAC/D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,EAAE,MAAM,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;QACrG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC;QAExG,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;aAC1C,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC;aACrC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC;aAC9C,IAAI,CAAC,EAAC,SAAS,EAAE,KAAK,EAAC,CAAC,CAAC;QAE5B,IAAI,CAAC,gBAAgB,GAAG,GAAG,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;aACnD,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC;aACrC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC;aAC9C,IAAI,CAAC,EAAC,SAAS,EAAE,KAAK,EAAC,CAAC;aACxB,KAAK,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;QAEhC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;IAC3B,CAAC;IAED,uCAAW,GAAX,UAAY,OAAsB;QAEhC,0GAA0G;QAC1G,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,OAAO;SACR;QAED,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,WAAW,EAAE;YAEvC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBACrB,OAAO;aACR;YAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAClE,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QAED,IAAI,OAAO,CAAC,MAAM,EAAE;YAElB,OAAO,CAAC,GAAG,CAAC,iCAAiC,CAAC,CAAC;YAC/C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;YAC7D,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QAED,IAAI,OAAO,CAAC,MAAM,EAAE;YAElB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,EAAE,MAAM,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;YACrG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC;YAExG,kBAAkB;YAClB,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAM,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACrE,IAAI,GAAG,EAAE;oBACP,GAAG,CAAC,YAAY,CAAC,SAAS,EAAE,MAAM,GAAG,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,CAAC;oBAClF,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC,CAAC;oBAC/C,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,CAAC;iBAClD;aACF;SACF;QAED,IAAI,OAAO,CAAC,iBAAiB,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,UAAU,EAAE;YAEnE,IAAI,IAAI,CAAC,UAAU,KAAK,UAAU,EAAE;gBAClC,IAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;YAED,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;IACH,CAAC;IAED,yDAAyD;IACjD,4CAAgB,GAAxB,UAAyB,IAAY;QAArC,iBAWC;QATC,IAAM,UAAU,GAAI,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QAE3D,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,gBAAM;YACtF,KAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC;YACnC,IAAI,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC5C,KAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;YACD,KAAI,CAAC,QAAQ,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED,6EAA6E;IACrE,kDAAsB,GAA9B,UAA+B,IAAY;QAEzC,IAAM,UAAU,GAAI,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QAC3D,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IACtE,CAAC;IAED,0FAA0F;IAClF,4CAAgB,GAAxB;QAEE,IAAI,SAAkB,CAAC;QAEvB,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACzB,SAAS,GAAG,IAAI,CAAC;SAClB;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YAChC,IAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;YAC3C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;gBAChC,IAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;gBACrC,IAAI,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,mBAAmB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,EAAE;oBACzG,SAAS,GAAG,IAAI,CAAC;oBACjB,MAAM;iBACP;aACF;SACF;aAAM;YACL,SAAS,GAAG,KAAK,CAAC;SACnB;QAED,IAAI,CAAC,SAAS,EAAE,CAAC;QAEjB,wBAAwB;QACxB,IAAI,IAAI,CAAC,eAAe,KAAK,SAAS,EAAE;YACtC,IAAI,CAAC,eAAe,GAAG,SAAS,CAAC;YACjC,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC;SACxC;IACH,CAAC;IAEO,qCAAS,GAAjB;QAEE,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACpE,IAAI,SAAkB,CAAC;QAEvB,IAAI,UAAU,EAAE;YACd,SAAS,GAAG,IAAI,CAAC;SAClB;QAED,wBAAwB;QACxB,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;YAC/B,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;YAC1B,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC;SACxC;IACH,CAAC;IAEO,oCAAQ,GAAhB;QAEE,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAE9B,OAAO;QACP,IAAI,CAAC,SAAS,EAAE,CAAC;QAEjB,IAAI,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;YAC7B,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,OAAO;QACP,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,SAAS,EAAE,CAAC;QAEjB,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;IACH,CAAC;IAKH,gBAAgB;IAEN,wCAAY,GAApB,UAAqB,QAAwB,EAAE,OAAwB;QAAlD,0CAAwB;QAAE,yCAAwB;QAErE,kBAAkB;QAClB,IAAI,IAAI,CAAC,WAAW,IAAI,QAAQ,EAAE;YAChC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;SAC1B;aAAM;YACL,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;SAC/B;QAED,gBAAgB;QAChB,IAAI,IAAI,CAAC,gBAAgB,IAAI,OAAO,EAAE;YAEpC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;YAED,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;SAE/B;aAAM;YACL,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;SACjC;QAED,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QACvD,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;IAClE,CAAC;IAEO,qCAAS,GAAjB;QAEE,mDAAmD;QAEnD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;QACzD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;QACxD,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAE1B,IAAM,UAAU,GAAe,EAAE,CAAC;QAElC,IAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;QAE1C,IAAI,iBAAyB,CAAC;QAE9B,IAAM,eAAe,GAAW,aAAa,CAAC,MAAM,CAAC;QACrD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,EAAE,CAAC,EAAE,EAAE;YAExC,IAAM,SAAS,GAAa,aAAa,CAAC,CAAC,CAAC,CAAC;YAE7C,4CAA4C;YAC5C,iBAAiB,GAAG,SAAS,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC;YAE1D,IAAM,UAAU,GAAW,uEAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,CAAC,CAAC;YAExH,kBAAkB;YAClB,IAAI,CAAC,KAAK,CAAC,EAAE;gBACX,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,0EAAW,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;gBAC5D,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,0EAAW,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC;aACxD;YAED,YAAY;YACZ,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,GAAG,iBAAiB,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;YAE9E,gBAAgB;YAChB,IAAI,CAAC,KAAK,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClC,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,SAAS,GAAG,0EAAW,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC;gBACvE,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,SAAS,GAAG,0EAAW,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;aAC7E;SACF;QAED,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,EAAE;YAEtC,IAAM,SAAS,GAAa,aAAa,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACpE,IAAM,qBAAqB,GAAG,SAAS,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC;YAEpE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,qBAAqB,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;YAC/E,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,SAAS,GAAG,qBAAqB,EAAE,IAAI,CAAC,UAAU,CAAC;SACxF;QAED,YAAY;QAEZ,IAAI,KAAK,GAAW,wBAAwB,CAAC;QAE7C,IAAI,IAAI,CAAC,WAAW,IAAI,cAAc,EAAE;YACtC,KAAK,GAAG,yBAAyB,CAAC;SACnC;aAAM,IAAI,IAAI,CAAC,WAAW,KAAK,WAAW,EAAE;YAC3C,KAAK,GAAG,sBAAsB,CAAC;SAChC;QAED,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,iEAAO,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;aACrE,MAAM,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,EAAC,CAAC,CAAC;IAC5D,CAAC;IAEO,qCAAS,GAAjB;QAEE,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YACzE,OAAO;SACR;QAED,IAAM,UAAU,GAAQ,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC1C,IAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;QAE1C,mBAAmB;QACnB,IAAI,UAAU,EAAE;YAEd,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;YACzD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;YACxD,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;YAE1B,IAAI,UAAU,GAAe,EAAE,CAAC;YAEhC,IAAM,OAAO,GAAW,CAAC,IAAI,CAAC,WAAW,KAAK,cAAc,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,uBAAuB,CAAC;YAEpG,IAAM,eAAe,GAAW,aAAa,CAAC,MAAM,CAAC;oCAC5C,CAAC;gBAER,IAAM,SAAS,GAAa,aAAa,CAAC,CAAC,CAAC,CAAC;gBAE7C,IAAI,UAAU,GAAG,CAAC,CAAC;gBAEnB,IAAM,cAAc,GAAG;oBACrB,qDAAqD;oBACrD,OAAO,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBACrI,CAAC,CAAC;gBAEF,gCAAgC;gBAChC,IAAI,SAAS,CAAC,SAAS,IAAI,cAAc,EAAE,EAAE;oBAE3C,YAAY;oBACZ,UAAU,GAAG,uEAAkB,CAAC,OAAK,UAAU,EAAE,SAAS,CAAC,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,CAAC,CAAC;oBAC1G,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAK,SAAS,GAAG,CAAC,SAAS,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;iBAErG;qBAAM,IAAI,SAAS,CAAC,SAAS,GAAG,cAAc,EAAE,EAAE;oBAEjD,gCAAgC;oBAEhC,IAAM,QAAQ,GAAG,OAAK,WAAW,CAAC,IAAI,CAAC,iEAAO,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC;yBACpF,MAAM,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,GAAG,CAAC,EAAE,OAAO,EAAE,OAAO,EAAC,CAAC,CAAC;oBAElF,UAAU,GAAG,EAAE,CAAC;iBACjB;;;YA1BH,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,EAAE,CAAC,EAAE;wBAA/B,CAAC;aA2BT;YAED,wDAAwD;YACxD,IAAI,UAAU,CAAC,MAAM,IAAI,CAAC,EAAE;gBAE1B,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,iEAAO,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC;qBACpF,MAAM,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,GAAG,CAAC,EAAE,OAAO,EAAE,OAAO,EAAC,CAAC,CAAC;aACnF;SACF;IACH,CAAC;IAEO,qCAAS,GAAjB;QAEE,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;QACzD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;QACxD,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAE1B,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QAElC,eAAe;QACf,IAAI,UAAU,EAAE;YAEd,IAAM,KAAK,GAAG,IAAI,CAAC;YACnB,IAAM,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;YAEtE,IAAM,UAAU,GAAW,UAAU,CAAC,MAAM,CAAC;YAC7C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;gBAEnC,IAAM,IAAI,GAAQ,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;gBAEjE,2BAA2B;gBAC3B,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,IAAI,eAAe,EAAE;oBAC7C,OAAO;iBACR;gBAED,IAAI,CAAC,IAAI,EAAE;oBACT,OAAO,CAAC,GAAG,CAAC,sBAAsB,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;iBAC/C;gBAED,IAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAE3C,4BAA4B;gBAC5B,IAAM,aAAa,GAAkB,EAAE,CAAC;gBAExC,IAAM,eAAe,GAAG,SAAS,CAAC,MAAM,CAAC;gBACzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,EAAE,CAAC,EAAE,EAAE;oBAExC,IAAM,KAAK,GAAW,SAAS,CAAC,CAAC,CAAC,CAAC;oBAEnC,2FAA2F;oBAC3F,IAAM,QAAQ,GAAY,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,mBAAmB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;oBAEnF,IAAI,QAAQ,KAAK,IAAI,EAAE;wBACrB,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;qBAC3B;iBACF;gBAED,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;oBAE5B,IAAM,gBAAgB,GAAW,uEAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;oBAEtI,IAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,EAAE,aAAa,CAAC,CAAC;oBAE5F,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAC,IAAI,EAAC,CAAC,CAAC,CAAC;oBACjE,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,EAAE,gBAAgB,CAAC,CAAC;iBACjG;aAEF;SACF;IACH,CAAC;IAED,iCAAiC;IACzB,sCAAU,GAAlB;QAEE,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;QACzD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;QACxD,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAE1B,wDAAwD;QACxD,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAW,SAAS;QAE1D,IAAM,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QAErE,IAAI,0DAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE;YAErD,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC;YAE7C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAG,EAAE;gBAEhC,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,IAAI,CAAC,gBAAgB,EAAE,MAAM,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,CAAC;gBACtH,IAAI,QAAQ,GAAG,uEAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;gBAChG,QAAQ,GAAG,QAAQ,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;gBAEvD,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;gBAC3D,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;aACzB;SACF;IACH,CAAC;IAEO,2CAAe,GAAvB;QAEE,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACd,OAAO;SACR;QAED,IAAM,QAAQ,GAAY,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,sBAAsB,CAAC,CAAC,CAAC;QAEtG,8FAA8F;QAC9F,cAAc;QAEd,IAAI,IAAI,CAAC,WAAW,EAAE;YAEpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC;YAE3C,IAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC;YAE/C,IAAI,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,QAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,KAAK,KAAK;gBACzE,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,QAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,KAAK,QAAQ,EAAE;gBAC5E,OAAO,CAAC,yDAAyD;aAClE;iBAAM;gBAEL,IAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;SACF;QAED,oBAAoB;QACpB,IAAI,QAAQ,EAAE;YAEZ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,IAAI,CAAC,gBAAgB,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;YAC/F,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;SAEnG;aAAM;YAEL,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,qBAAqB,CAAC,IAAI,CAAC,gBAAgB,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;YAClG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;SAClG;QAED,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC;QAC3C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QAE3C,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAEvD,CAAC;IAEO,4CAAgB,GAAxB;QACE,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YAC1B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;IACH,CAAC;IAGH,iBAAiB;IAEf,iDAAiD;IACzC,wCAAY,GAApB,UAAqB,KAAiB;QAEpC,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QAC/B,KAAK,CAAC,eAAe,EAAE,CAAC;QACxB,KAAK,CAAC,wBAAwB,EAAE,CAAC;IACnC,CAAC;IAED,gCAAgC;IACxB,0CAAc,GAAtB,UAAuB,KAAiB;QACtC,KAAK,CAAC,eAAe,EAAE,CAAC;QACxB,KAAK,CAAC,wBAAwB,EAAE,CAAC;QAEjC,IAAM,MAAM,GAAgB,IAAI,WAAW,CACzC,aAAa,EACb;YACE,OAAO,EAAE,IAAI;YACb,UAAU,EAAE,IAAI;YAChB,MAAM,EAAE,IAAI,CAAC,IAAI;SAClB,CAAC,CAAC;QAEL,gBAAgB;QAChB,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IACvD,CAAC;IAEO,+CAAmB,GAA3B;QAEE,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAG,aAAa;QACzD,IAAM,GAAG,GAAW,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAE,YAAY;QACxD,IAAM,KAAK,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAE1B,IAAI,CAAC,eAAe,EAAE,CAAC;QAEvB,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,EAAE;YAEjC,IAAM,iBAAiB,GAAY,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAEjJ,IAAI,cAAc,GAAG,CAAC,CAAC;YAEvB,IAAI,iBAAiB,EAAE;gBACrB,cAAc,GAAG,uEAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;aAC5H;iBAAM;gBACL,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE;oBACvD,cAAc,GAAG,uEAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;iBACpH;qBAAM;oBACL,cAAc,GAAG,uEAAkB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,0EAAW,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;iBACrH;aACF;YAED,+BAA+B;YAC/B,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;gBAC/B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,EAAE,cAAc,CAAC,CAAC;aAC7G;iBAAM;gBAEL,IAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,gBAAgB,CACrD,EAAC,QAAQ,EAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,EAAC,EAC9E,EAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,EAAE,SAAS,EAAE,cAAc,EAAC,CAAC,CAAC;gBAE/G,IAAI,SAAS,GAAG,OAAO,EAAE;oBACvB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,EAAE,cAAc,CAAC,CAAC;iBAC7G;qBAAM;oBACL,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,EAAC,QAAQ,EAAE,GAAG,EAAG,IAAI,EAAE,EAAE,EAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,EAAE,cAAc,CAAC,CAAC;iBACjJ;aACF;YAED,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,CAAC;YACjG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;SAC5C;IACH,CAAC;IAEM,+CAAmB,GAA1B,UAA2B,IAAY,EAAE,OAAgB,EAAE,MAAe;QAExE,OAAO,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;QACnC,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;QAEjC,OAAO,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC;IACzE,CAAC;IAAA,CAAC;IA5lBgB;QAAjB,+DAAS,CAAC,KAAK,CAAC;wEAAM,wDAAU;kDAAC;IAExB;QAAT,4DAAM,EAAE;wEAAc,0DAAY;0DAAsC;IAEhE;QAAR,2DAAK,EAAE;;mDAA2B;IAC1B;QAAR,2DAAK,EAAE;;0DAA2B;IAC1B;QAAR,2DAAK,EAAE;wEAAsB,KAAK;qDAAS;IACnC;QAAR,2DAAK,EAAE;;qDAA8B;IAC7B;QAAR,2DAAK,EAAE;;qDAA6B;IAC5B;QAAR,2DAAK,EAAE;;qDAA6B;IAG5B;QAAR,2DAAK,EAAE;;mDAA2B;IAC1B;QAAR,2DAAK,EAAE;;gEAA6B;IAC5B;QAAR,2DAAK,EAAE;;yDAA6B;IAhB1B,iBAAiB;QAT7B,+DAAS,CAAC;YACT,QAAQ,EAAE,mBAAmB;YAC7B,wJAAyC;YAEzC,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;QAEF,uCAAuC;QACvC,4EAA4E;;+EA0CjD,kEAAmB;YACjB,sFAAqB;YACtB,qFAAoB;YAChB,+DAAiB;YACrB,sEAAa;YACf,kEAAW;OA9CxB,iBAAiB,CA+lB7B;IAAD,wBAAC;CAAA,CA/lBsC,uEAAa,GA+lBnD;AA/lB6B;;;;;;;;;;;;AChC9B,6OAA6O,WAAW,qRAAqR,iBAAiB,8BAA8B,m2B;;;;;;;;;;;ACA5jB,0CAA0C,uBAAuB,iBAAiB,kBAAkB,qBAAqB,EAAE,8CAA8C,mBAAmB,mBAAmB,8CAA8C,iCAAiC,yBAAyB,cAAc,mBAAmB,aAAa,gDAAgD,EAAE,yBAAyB,+BAA+B,mBAAmB,iBAAiB,iBAAiB,uBAAuB,wBAAwB,EAAE,sFAAsF,kCAAkC,EAAE,sFAAsF,kCAAkC,EAAE,gFAAgF,kCAAkC,EAAE,sFAAsF,kCAAkC,EAAE,wHAAwH,kBAAkB,oBAAoB,EAAE,iEAAiE,kBAAkB,oBAAoB,EAAE,iEAAiE,kBAAkB,oBAAoB,EAAE,2DAA2D,kBAAkB,oBAAoB,EAAE,+CAA+C,+7F;;;;;;;;;;;;;;;;;;;;;;ACCv6C;AAEpD;AACT;AACsC;AAC1C;AACoB;AAevE;IAA0C,8EAAsB;IA+B9D,8BACU,OAAkC,EAClC,MAA0C,EAC1C,oBAA+C,EAC/C,WAA6C,EAC7C,eAA6C;QALvD,YAQE,iBAAO,SAER;QATS,aAAO,GAAP,OAAO,CAA2B;QAClC,YAAM,GAAN,MAAM,CAAoC;QAC1C,0BAAoB,GAApB,oBAAoB,CAA2B;QAC/C,iBAAW,GAAX,WAAW,CAAkC;QAC7C,qBAAe,GAAf,eAAe,CAA8B;QA3B7C,iBAAW,GAAyB,IAAI,0DAAY,EAAU,CAAC;QAC/D,iBAAW,GAAyB,IAAI,0DAAY,EAAU,CAAC;QAOlE,YAAM,GAA6B,EAAE,CAAC;QAQrC,mBAAa,GAAS,CAAC,CAAC;QACxB,mBAAa,GAAS,CAAC,CAAC;QAExB,aAAO,GAAe,MAAM,CAAC;QAYnC,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,EAAE,MAAM,CAAC,UAAU,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;;IAC5G,CAAC;IAKH,kBAAkB;IAEhB,uCAAQ,GAAR;QAEE,iBAAM,QAAQ,WAAE,CAAC;QAEjB,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEjG,IAAM,MAAM,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC;QAElF,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;QAE9D,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC7B,CAAC;IAED,8CAAe,GAAf;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,MAAM,CAAC,qBAAqB,CAAC;YAC3B,IAAG,KAAK,CAAC,aAAa,EAAE;gBACtB,KAAK,CAAC,cAAc,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;aACjE;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,0CAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,OAAO,CAAC,QAAQ,EAAE;YACpB,IAAI,OAAO,CAAC,QAAQ,CAAC,YAAY,EAAE;gBACjC,IAAI,IAAI,CAAC,cAAc,EAAE;oBACvB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,GAAG,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;oBACrG,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;iBAC/D;aACF;SACF;IACH,CAAC;IAGH,YAAY;IAEH,6CAAc,GAArB,UAAsB,MAAc;QAClC,iBAAM,cAAc,YAAC,MAAM,CAAC,CAAC;QAC7B,IAAI,MAAM,KAAK,UAAU,EAAE;YACzB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;SACvB;QACD,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAEM,mDAAoB,GAA3B,UAA4B,IAAU;QAEpC,iCAAiC;QACjC,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,UAAU,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,aAAa,EAAE;YACnF,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,OAAO,KAAK,UAAU,EAAG;gBACrD,IAAI,CAAC,YAAY,EAAE,CAAC;gBACpB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aACzB;SACF;QAED,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;IACtC,CAAC;IAEM,2CAAY,GAAnB;QACE,iBAAM,YAAY,WAAE,CAAC;QACrB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAC9C,CAAC;IAEO,4CAAa,GAArB,UAAsB,MAAc;QAClC,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,cAAc,EAAE;YACpC,IAAM,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;YACnF,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;SACnD;IACH,CAAC;IAGH,oBAAoB;IAEV,kDAAmB,GAA3B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC,CAAC;QAC3E,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAC,UAAS,MAAM;YAC7G,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC,CAAC;QAEJ,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,CAAC,wBAAwB,CAAC,SAAS,CAAC,UAAS,MAAM;YACpG,IAAI,KAAK,CAAC,cAAc,EAAE;gBACxB,KAAK,CAAC,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;gBACpC,KAAK,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;aACtC;QACH,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED,0DAA0D;IAClD,6CAAc,GAAtB,UAAuB,KAAY;QAE/B,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,KAAK,CAAC,MAAM,KAAK,KAAK,CAAC,cAAc,CAAC,UAAU,CAAC,aAAa,EAAE;YAElE,KAAK,CAAC,cAAc,EAAE,CAAC;YACvB,KAAK,CAAC,eAAe,EAAE,CAAC;YAExB,KAAK,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,CAAE,yCAAyC;YAEpF,IAAM,aAAa,GAAW,CAAE,CAAC,KAAK,CAAC,cAAc,CAAC,mBAAmB,EAAE,GAAG,KAAK,CAAC,CAAC;YACrF,IAAM,MAAM,GAAW,KAAK,CAAC,cAAc,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC;YACjF,IAAM,SAAS,GAAW,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC,CAAC;YAC5D,IAAM,YAAY,GAAW,aAAa,GAAG,CAAC,SAAS,GAAG,MAAM,CAAC,CAAC;YAClE,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,GAAG,aAAa,GAAG,YAAY,GAAG,KAAK,CAAC;SACvF;IACL,CAAC;IAEM,sCAAO,GAAd,UAAe,QAAc;QAC3B,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,GAAG,QAAQ,CAAC,EAAE,GAAG,CAAC,CAAC;QACnD,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;IACvE,CAAC;IAED,oEAAoE;IAC7D,uCAAQ,GAAf,UAAgB,KAAK;QAEnB,IAAM,IAAI,GAAG,IAAI,CAAC;QAElB,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAEhC,IAAI,CAAC,YAAY,GAAG,UAAU,CAAC;YAC7B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,EAAE,MAAM,CAAC,UAAU,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;YAC1G,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,EAAC,CAAC,CAAC;YACtD,IAAI,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC,EAAE,GAAG,CAAC,CAAC;IACV,CAAC;IAEM,uCAAQ,GAAf,UAAgB,QAAkC,EAAE,KAAa;QAC7D,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;QAC3B,IAAI,CAAC,OAAO,EAAE,CAAC;IACnB,CAAC;IAKH,QAAQ;IAEN,4FAA4F;IAC5F,iEAAiE;IACzD,gDAAiB,GAAzB,UAA0B,YAAoB;QAE5C,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;QAE7F,IAAI,QAAiB,CAAC;QACtB,IAAI,OAAiB,CAAC;QAEtB,KAAiB,UAAa,EAAb,+BAAa,EAAb,2BAAa,EAAb,IAAa,EAAE;YAA3B,IAAM,EAAE;YAEX,IAAM,QAAQ,GAAG,EAAE,CAAC,gBAAgB,CAAS,CAAC;YAE9C,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,IAAI,GAAG,QAAQ,EAAE;gBACzC,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC;aAC1B;YAED,IAAI,CAAC,OAAO,IAAI,QAAQ,CAAC,GAAG,GAAG,OAAO,EAAE;gBACtC,OAAO,GAAG,QAAQ,CAAC,GAAG,CAAC;aACxB;SACF;QAED,OAAO,EAAC,IAAI,EAAE,aAAa,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,EAAC,CAAC;IACjI,CAAC;IAED,+EAA+E;IACvE,+CAAgB,GAAxB;QAEE,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QAEjB,IAAM,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC;QAE5D,IAAM,SAAS,GAAG,CAAC,MAAM,GAAG,IAAI,CAAE,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;QAEtD,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,GAAG,SAAS,CAAC,GAAG,SAAS,CAAC;QAC3E,IAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,SAAS,CAAC,GAAG,SAAS,CAAC;QAE1E,KAAK,IAAI,CAAC,GAAG,UAAU,EAAG,CAAC,GAAG,QAAQ,EAAE,CAAC,IAAI,SAAS,EAAE;YACtD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAC,SAAS,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;SACxD;QAED,wBAAwB;QACxB,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE;YAC/F,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;SACnB;QACD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAC,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,KAAK,EAAC,CAAC,CAAC;QAE7G,wBAAwB;QACxB,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE;YACzE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;SACrB;QACD,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,EAAC,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,KAAK,EAAC,CAAC,CAAC;IAChH,CAAC;IAED,mEAAmE;IAC3D,sCAAO,GAAf;QAEE,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC;QACrC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,gBAAgB,EAAE,CAAC;QAE5D,yBAAyB;QACzB,IAAI,SAAS,KAAM,IAAI,CAAC,aAAa,EAAE;YACrC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAC,YAAY,EAAE,IAAI,CAAC,aAAa,EAAE,OAAO,EAAE,IAAI,CAAC,cAAc,CAAC,+BAA+B,EAAE,EAAC,CAAC,CAAC;YAE1H,+BAA+B;YAC/B,IAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC5D,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,QAAQ,CAAC,IAAI,KAAK,IAAI,CAAC,WAAW,CAAC,IAAI,IAAI,QAAQ,CAAC,GAAG,KAAK,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE;gBACzG,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;gBAC5B,IAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;SACF;IACH,CAAC;IAED,oCAAoC;IAC5B,6CAAc,GAAtB,UAAuB,MAAc;QAEnC,2FAA2F;QAC3F,IAAI,IAAI,CAAC,gBAAgB,IAAI,CAAC,MAAM,EAAE;YACpC,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;SAC5C;aAAM,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,MAAM,EAAE;YAC3C,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;SAC/E;QAED,IAAI,CAAC,gBAAgB,GAAG,MAAM,CAAC;IACjC,CAAC;IAKH,aAAa;IAEX,+EAA+E;IACxE,6CAAc,GAArB,UAAsB,KAAa,EAAE,OAAY;QAC/C,OAAO,OAAO,CAAC,EAAE,CAAC;IACpB,CAAC;IA3RwB;QAAxB,+DAAS,CAAC,YAAY,CAAC;wEAAa,wDAAU;4DAAC;IACnB;QAA5B,+DAAS,CAAC,gBAAgB,CAAC;wEAAiB,wDAAU;gEAAC;IAC3B;QAA5B,+DAAS,CAAC,gBAAgB,CAAC;wEAAiB,+EAAwB;gEAAC;IAE7D;QAAR,2DAAK,EAAE;;2DAAkB;IACjB;QAAR,2DAAK,EAAE;;0DAAkB;IAEhB;QAAT,4DAAM,EAAE;wEAAc,0DAAY;6DAAsC;IAC/D;QAAT,4DAAM,EAAE;wEAAc,0DAAY;6DAAsC;IAV9D,oBAAoB;QAPhC,+DAAS,CAAC;YACT,QAAQ,EAAE,wBAAwB;YAClC,oJAA4C;YAE5C,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;+EAkCsC,sDAAM;YACN,8DAAc;YACd,kEAAmB;YACnB,8EAAiB;YACjB,+DAAiB;OApC5C,oBAAoB,CA8RhC;IAAD,2BAAC;CAAA,CA9RyC,oGAAsB,GA8R/D;AA9RgC;;;;;;;;;;;;ACtBjC,uI;;;;;;;;;;;ACAA,+DAA+D,2K;;;;;;;;;;;;;;;;;ACAO;AAQtE;IAIE;IAAgB,CAAC;IAEjB,kCAAQ,GAAR,cAAkB,CAAC;IAEnB,yCAAe,GAAf;QAEE,uDAAuD;QACvD,IAAM,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACxE,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;IAC9D,CAAC;IAXQ;QAAR,2DAAK,EAAE;;iDAAe;IAFZ,eAAe;QAL3B,+DAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;YAC3B,8HAAuC;;SAExC,CAAC;;OACW,eAAe,CAc3B;IAAD,sBAAC;CAAA;AAd2B;;;;;;;;;;;;ACR5B,slC;;;;;;;;;;;ACAA,2BAA2B,oBAAoB,gBAAgB,EAAE,+CAA+C,2e;;;;;;;;;;;;;;;;;;ACA9D;AACR;AAU1C;IAIE;QAFO,SAAI,GAAW,kDAAQ,CAAC,QAAQ,CAAC;IAEzB,CAAC;IAEhB,qCAAQ,GAAR,cAAkB,CAAC;IANR,kBAAkB;QAR9B,+DAAS,CAAC;YACT,QAAQ,EAAE,YAAY;YACtB,4HAA0C;;SAE3C,CAAC;QAEF,4HAA4H;QAC5H,sGAAsG;;;OACzF,kBAAkB,CAO9B;IAAD,yBAAC;CAAA;AAP8B;;;;;;;;;;;;;ACX/B;AAAA;AAAA;AAAA;AAAA;AAA6B;AAG2C;AAExE;IAME,iCAAY,GAAU;QACpB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;IAClB,CAAC;IAED,sEAAsE;IAC/D,sDAAoB,GAA3B,UAA4B,QAAkB,EAAE,UAAmB,EAAE,SAAoB;QAEvF,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,aAAa,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;QAExE,IAAM,MAAM,GAAG,6CAAO,CAAC,EAAC,WAAW,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAC,CAAC;aAC9E,SAAS,CAAC,QAAQ,CAAC;aACnB,UAAU,CAAC,aAAa,CAAC;aACzB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEpB,gEAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC/B,IAAI,CAAC,WAAW,GAAG,8DAAU,CAAC,IAAI,EAAE;YAClC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAC9B,SAAS,EAAE,CAAC;QACd,CAAC,CAAC,CAAC;QAEH,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC;QAEvC,OAAO,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED,qDAAqD;IAC9C,wDAAsB,GAA7B,UAA8B,QAAkB,EAAE,UAAmB,EAAE,SAAoB;QAEzF,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,eAAe,GAAG,IAAI,CAAC,uBAAuB,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;QAE5E,IAAM,QAAQ,GAAG,+CAAS,CAAC,EAAC,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAC,CAAC;aAC9D,SAAS,CAAC,QAAQ,CAAC;aACnB,UAAU,CAAC,eAAe,CAAC;aAC3B,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEpB,iEAAiE;QACjE,IAAI,QAAQ,CAAC,UAAU,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,sBAAsB,CAAC,EAAE;YACpE,eAAe,CAAC,SAAS,GAAG,MAAM,CAAC;SACpC;aAAM;YACL,eAAe,CAAC,SAAS,GAAG,OAAO,CAAC;SACrC;QAED,wBAAwB;QACxB,IAAM,SAAS,GAAG,QAAQ,CAAC,UAAU,EAAE,CAAC;QACxC,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAS,KAAY;YACvD,KAAK,CAAC,eAAe,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;QAEH,gEAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACjC,IAAI,CAAC,aAAa,GAAG,8DAAU,CAAC,IAAI,EAAE;YACpC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;YAClC,SAAS,EAAE,CAAC;QACd,CAAC,CAAC,CAAC;QAEH,eAAe,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC;QAE3C,OAAO,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAEO,yDAAuB,GAA/B,UAAgC,IAAY,EAAE,UAAmB;QAE/D,IAAI,UAAU,CAAC;QACf,IAAI,IAAI,KAAK,OAAO,IAAI,IAAI,KAAK,SAAS,EAAE;YAC1C,IAAM,MAAM,GAA+C,QAAQ,CAAC,aAAa,CAAC,uBAAuB,CAAQ,CAAC;YAClH,UAAU,GAAG,MAAM,CAAC;SACrB;QAED,UAAU,CAAC,gBAAgB,CAAC,QAAQ,EAAE,cAAM,eAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,EAArC,CAAqC,CAAC,CAAC;QAEnF,iBAAiB;QACjB,IAAI,UAAU,EAAE;YACd,KAAK,IAAM,GAAG,IAAI,UAAU,EAAE;gBAC5B,UAAU,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC;aACnC;SACF;QAED,0CAA0C;QAC1C,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QACtC,OAAO,UAAU,CAAC;IACpB,CAAC;IACH,8BAAC;AAAD,CAAC;;;;;;;;;;;;;AC7FD,yCAAyC,UAAU,gCAAgC,WAAW,qLAAqL,OAAO,kBAAkB,aAAa,wI;;;;;;;;;;;ACAzT,yBAAyB,8BAA8B,EAAE,+BAA+B,0BAA0B,EAAE,0CAA0C,2BAA2B,qBAAqB,gBAAgB,oBAAoB,EAAE,kDAAkD,gCAAgC,yBAAyB,sBAAsB,6BAA6B,oCAAoC,iEAAiE,6BAA6B,0BAA0B,wCAAwC,EAAE,iFAAiF,sBAAsB,EAAE,2CAA2C,oCAAoC,EAAE,yBAAyB,gCAAgC,EAAE,oCAAoC,+BAA+B,EAAE,4CAA4C,iCAAiC,qCAAqC,EAAE,4BAA4B,yBAAyB,EAAE,4BAA4B,2BAA2B,6BAA6B,EAAE,6BAA6B,2BAA2B,4BAA4B,EAAE,+CAA+C,m6G;;;;;;;;;;;;;;;;;;;;;;;ACAjuC;AAC1B;AACoC;AACI;AACuB;AAEnB;AAOzE;IAkBE,wBAAoB,cAA6B;QAA7B,mBAAc,GAAd,cAAc,CAAe;QAJxC,cAAS,GAAiB,EAAE,CAAC;QAE/B,aAAQ,GAAW,EAAE,CAAC;IAEuB,CAAC;IAErD,iCAAQ,GAAR;QACE,qEAAqE;QACrE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;SAC1B;IACH,CAAC;IAEM,4BAAG,GAAV;QAEE,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACvC,OAAO,CAAC,IAAI,CAAC,kDAAkD,CAAC,CAAC;YACjE,OAAO;SACR;QAED,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,gFAAgF;QAChF,gEAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAEzB,IAAM,SAAS,GAAG,UAAS,MAAM;YAC/B,IAAI,MAAM,KAAK,SAAS,EAAE;gBACxB,gEAAY,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAC3B;iBAAM;gBACL,iEAAa,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAC5B;QACH,CAAC;QAED,qCAAqC;QACrC,IAAM,SAAS,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,gFAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;QAChF,IAAI,SAAS,EAAE;YACb,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC;YACxC,SAAS,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC;SACnD;QAED,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,gFAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;QACzF,IAAI,YAAY,EAAE;YAChB,YAAY,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,GAAG,CAAC,0EAAW,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC;YACzH,YAAY,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC;SACtD;QAED,IAAM,iBAAiB,GAAmB;YACxC,IAAI,EAAc,MAAM;YACxB,KAAK,EAAa,IAAI,CAAC,KAAK;YAC5B,QAAQ,EAAU,SAAS;YAC3B,WAAW,EAAO,YAAY;YAC9B,SAAS,EAAS,IAAI,CAAC,SAAS;YAChC,aAAa,EAAK,MAAM;SACzB,CAAC;QAEF,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,MAAM,EAAE,iBAAiB,EAAE,SAAS,CAAC,CAAC;IACvE,CAAC;IAEM,6CAAoB,GAA3B;QACE,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,oBAAoB,CAAC,EAAE;YACnD,OAAO,4BAA4B,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;SACnF;aAAM;YACL,OAAO,kDAAkD,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;SACzG;IACH,CAAC;;IA5EQ;QAAR,2DAAK,EAAE;4FAAkB,oCAAC,oBAAD,8CAAQ;oDAAC;IAC1B;QAAR,2DAAK,EAAE;4FAAkB,oCAAC,oBAAD,8CAAQ;uDAAC;IAC1B;QAAR,2DAAK,EAAE;;oDAAyB;IACxB;QAAR,2DAAK,EAAE;;yDAAyB;IAExB;QAAR,2DAAK,EAAE;;iDAAyB;IACxB;QAAR,2DAAK,EAAE;;uDAAyB;IAExB;QAAR,2DAAK,EAAE;;qDAAyB;IAExB;QAAR,2DAAK,EAAE;;sDAA0B;IACzB;QAAR,2DAAK,EAAE;wEAAkB,oDAAQ;iDAAC;IAC1B;QAAR,2DAAK,EAAE;;qDAA8B;IAd3B,cAAc;QAL1B,+DAAS,CAAC;YACT,QAAQ,EAAE,uBAAuB;YACjC,kIAAqC;;SAEtC,CAAC;+EAmBoC,qEAAa;OAlBtC,cAAc,CA+E1B;IAAD,qBAAC;CAAA;AA/E0B;;;;;;;;;;;;ACb3B,sCAAsC,WAAW,qB;;;;;;;;;;;ACAjD,yBAAyB,mBAAmB,gBAAgB,iBAAiB,EAAE,8BAA8B,8BAA8B,yCAAyC,EAAE,yBAAyB,6BAA6B,8BAA8B,EAAE,qCAAqC,qBAAqB,EAAE,wHAAwH,kBAAkB,oBAAoB,EAAE,iEAAiE,kBAAkB,oBAAoB,EAAE,iEAAiE,kBAAkB,oBAAoB,EAAE,2DAA2D,kBAAkB,oBAAoB,EAAE,wBAAwB,iBAAiB,wBAAwB,yBAAyB,yBAAyB,+CAA+C,uCAAuC,uEAAuE,uCAAuC,EAAE,mCAAmC,uBAAuB,eAAe,gBAAgB,gBAAgB,iBAAiB,uBAAuB,8BAA8B,yCAAyC,yCAAyC,gDAAgD,gDAAgD,gBAAgB,EAAE,mCAAmC,uBAAuB,aAAa,mCAAmC,uCAAuC,EAAE,8BAA8B,uBAAuB,aAAa,cAAc,mCAAmC,uCAAuC,EAAE,sCAAsC,gDAAgD,mBAAmB,uBAAuB,2BAA2B,mBAAmB,gBAAgB,oBAAoB,cAAc,gBAAgB,2BAA2B,uBAAuB,oBAAoB,uBAAuB,uCAAuC,uCAAuC,EAAE,yCAAyC,sCAAsC,kIAAkI,EAAE,8BAA8B,yBAAyB,iBAAiB,EAAE,gFAAgF,uBAAuB,8BAA8B,EAAE,iCAAiC,mCAAmC,EAAE,iHAAiH,qEAAqE,kCAAkC,2DAA2D,uCAAuC,uCAAuC,EAAE,mCAAmC,uBAAuB,8BAA8B,mBAAmB,yCAAyC,qCAAqC,+BAA+B,EAAE,qCAAqC,eAAe,gBAAgB,qBAAqB,yCAAyC,EAAE,+CAA+C,gBAAgB,iBAAiB,EAAE,yCAAyC,cAAc,eAAe,EAAE,mDAAmD,gCAAgC,0BAA0B,uBAAuB,mBAAmB,8BAA8B,EAAE,+CAA+C,0CAA0C,EAAE,gDAAgD,2CAA2C,EAAE,8BAA8B,QAAQ,kCAAkC,kCAAkC,mBAAmB,EAAE,SAAS,kCAAkC,kCAAkC,mBAAmB,EAAE,UAAU,qCAAqC,qCAAqC,mBAAmB,EAAE,EAAE,sBAAsB,QAAQ,kCAAkC,kCAAkC,mBAAmB,EAAE,SAAS,kCAAkC,kCAAkC,mBAAmB,EAAE,UAAU,qCAAqC,qCAAqC,mBAAmB,EAAE,EAAE,+CAA+C,+wP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACA3+I;AACqC;AACK;AACZ;AACd;AACN;AAYhB;AAEwB;AAE2C;AAGvB;AACO;AACE;AACP;AAClB;AACiB;AACT;AACT;AACsB;AACS;AAC5B;AACE;AACuB;AACrB;AAEoB;AAE5C;AAcjC;IAAyC,6EAAsB;IAgD7D,6BACU,MAAsC,EACtC,cAA4C,EAC5C,eAA6C,EAC7C,mBAA0C,EAC1C,oBAA2C,EAC3C,kBAAyC,EACzC,cAAqC,EACrC,YAAmC;QAR7C,YAUE,iBAAO,SACR;QAVS,YAAM,GAAN,MAAM,CAAgC;QACtC,oBAAc,GAAd,cAAc,CAA8B;QAC5C,qBAAe,GAAf,eAAe,CAA8B;QAC7C,yBAAmB,GAAnB,mBAAmB,CAAuB;QAC1C,0BAAoB,GAApB,oBAAoB,CAAuB;QAC3C,wBAAkB,GAAlB,kBAAkB,CAAuB;QACzC,oBAAc,GAAd,cAAc,CAAuB;QACrC,kBAAY,GAAZ,YAAY,CAAuB;QA7BrC,kBAAY,GAAG,KAAK,CAAC;QAOrB,mBAAa,GAAkB,EAAE,CAAC;QAElC,mBAAa,GAAe,EAAE,CAAC;QAE/B,qBAAe,GAAG,CAAC,CAAC,CAAC,CAAO,+BAA+B;QAE3D,iBAAW,GAAe,EAAE,CAAC;QAC7B,kBAAY,GAAQ,kDAAY,EAAE,CAAC;;IAkB3C,CAAC;IAID,kBAAkB;IAElB,sCAAQ,GAAR;QACE,iBAAM,QAAQ,WAAE,CAAC;QAEjB,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;QACxE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QACpE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;QAErE,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAS,MAAM;YAE1F,IAAI,MAAM,KAAK,OAAO,EAAE;gBAEtB,IAAM,cAAc,GAAQ,KAAK,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;gBAE7D,sBAAsB;gBACtB,IAAI,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE;oBAC9D,iEAAY,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;oBAChC,iEAAY,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;oBAClC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;iBAChC;aACF;iBAAM,IAAI,MAAM,KAAK,SAAS,EAAE;gBAC/B,IAAM,YAAY,GAAQ,KAAK,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;gBAC3D,KAAK,CAAC,oBAAoB,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;aAC7C;QACH,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED,yCAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,IAAI,CAAC,YAAY,EAAE;YAErB,IAAI,OAAO,CAAC,YAAY,EAAE;gBACxB,IAAI,CAAC,YAAY,EAAE,CAAC;gBACpB,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACtC;SACF;IACH,CAAC;IAED,6CAAe,GAAf;QAEE,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAErC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SACvC;IACH,CAAC;IAED,yCAAW,GAAX;QAEE,iBAAM,WAAW,WAAE,CAAC;QAEpB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAEtC,IAAI,IAAI,CAAC,IAAI,EAAC;YACZ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAS,KAAK;gBAChC,KAAK,CAAC,MAAM,EAAE,CAAC;YACjB,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACnB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SAClB;IACH,CAAC;IAKD,QAAQ;IAEA,uCAAS,GAAjB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,kBAAkB;QAClB,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,EAAE;YACvC,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3B,OAAO;SACR;QAED,sEAAsE;QACtE,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACrC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,+EAAkB,CAAC,IAAI,EAAE,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;SACrG;QAED,8DAA8D;QAC9D,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,aAAa,EAAE;YAC3C,IAAM,eAAe,GAAG,4EAAe,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,CAAC;YAClF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;SAC7D;QAED,IAAI,CAAC,IAAI,GAAG,IAAI,2CAAK,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,EAAE;YAC5C,aAAa,EAAE,EAAE;YACjB,aAAa,EAAE,EAAE;YACjB,OAAO,EAAE,KAAK;YACd,OAAO,EAAE,EAAE;YACX,WAAW,EAAE,KAAK,EAAE,kBAAkB,EAAE,KAAK;YAC7C,MAAM,EAAE,IAAI,CAAC,WAAW;YACxB,QAAQ,EAAE,CAAC;YACX,YAAY,EAAE,IAAI;YAClB,iBAAiB,EAAE,KAAK;YACxB,kBAAkB,EAAE,IAAI,CAAM,aAAa;SAC5C,CAAC,CAAC;QAEH,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,IAAI,CAAC,wBAAwB,GAAG,IAAI,4FAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvE,IAAI,CAAC,4BAA4B,EAAE,CAAC;QAEpC,0BAA0B;QAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAE9B,gFAAgF;QAChF,IAAI,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,EAAE;YAC7C,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,IAAU;gBACpE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YACxB,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAMD,YAAY;IACJ,uCAAS,GAAjB,UAAkB,IAAU;QAE1B,IAAM,MAAM,GAAe,EAAE,CAAC;QAE9B,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QAE5C,IAAM,YAAY,GAAG,oDAAc,CAAC,MAAM,CAAC,CAAC;QAC5C,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE9B,mDAAmD;QACnD,IAAI,IAAI,CAAC,WAAW,EAAE;YAGpB,IAAI,SAAS,GAAW,mDAAkB,CAAC,iFAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,iFAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAElH,+CAA+C;YAC/C,4BAA4B;YAC5B,IAAI,SAAS,GAAG,2EAAW,CAAC,IAAI,EAAE;gBAChC,OAAO;aACR;iBAAM;gBACL,SAAS,GAAG,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,2EAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,2EAAW,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC;aACrF;YAED,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC;YAE5J,IAAM,MAAM,GAAa,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;YAElF,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAEtC,IAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,iFAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,iFAAgB,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAC;YAC9H,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC3B,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5B;IACH,CAAC;IAEO,iDAAmB,GAA3B,UAA4B,IAAU;QAEpC,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAM,IAAI,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;QACrE,IAAI,CAAC,cAAc,CAAC,qBAAqB,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;QACrE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QAEvF,IAAM,KAAK,GAAG,oEAAQ,CAAC,EAAC,SAAS,EAAE,aAAa,EAAE,IAAI,EAAE,QAAQ,EAAC,CAAC,CAAC;QACnE,IAAM,QAAQ,GAAG,EAAC,IAAI,EAAE,KAAK,EAAG,IAAI,EAAE,IAAI,EAAC,CAAC;QAC5C,IAAM,UAAU,GAAG,8CAAQ,CAAC,iFAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,QAAQ,CAAC,CAAC;QAC1E,OAAO,UAAU,CAAC;IACpB,CAAC;IAeO,0DAA4B,GAApC;QAEE,UAAU;QACV,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;SAC9B;QAED,UAAU;QACV,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,OAAO,EAAE,CAAC;YACvC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YAC9B,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;SACrC;aAAM;YAEL,0CAA0C;YAC1C,+CAAS,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACpC;IACH,CAAC;IAED;uDACmD;IAC3C,gDAAkB,GAA1B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,qCAAqC;QACrC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,UAAS,CAAM;YAEnC,+DAA+D;YAC/D,IAAI,KAAK,CAAC,gBAAgB,EAAE;gBAE1B,iEAAY,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;gBAChC,iEAAY,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;gBAElC,OAAO;aACR;YAED,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;QAE/B,CAAC,CAAC,CAAC;IACL,CAAC;IAGD,6EAA6E;IACrE,mDAAqB,GAA7B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7D,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAS,OAAO;gBAC5C,IAAI,KAAK,CAAC,IAAI,IAAI,OAAO,EAAE;oBACzB,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS;iBAC3C;YACH,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC;QAC1B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;IAC/B,CAAC;IAED,uGAAuG;IAC/F,8CAAgB,GAAxB;QAEE,IAAM,QAAQ,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,IAAI,GAAG,eAAe,CAAC,CAAC;QAE/G,IAAI,QAAQ,EAAE;YACZ,0DAA0D;YAC1D,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,IAAI,GAAG,GAAG,GAAG,QAAQ,GAAG,oBAAoB,CAAC;SACnH;aAAM;YACL,OAAO,2EAAW,CAAC,aAAa,CAAC;SAClC;IACH,CAAC;IAED,0FAA0F;IAClF,iDAAmB,GAA3B,UAA4B,CAAM;QAEhC,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,kBAAkB,GAAG,iFAAgB,CAAC,CAAC,CAAC,MAAM,CAAC;QACrD,IAAI,OAAiB,CAAC;QACtB,IAAI,cAA+B,CAAC;QAEpC,iFAAiF;QACjF,gFAAgF;QAChF,IAAM,aAAa,GAAG,oDAAc,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;QAEtG,IAAI,CAAC,aAAa,EAAE;YAClB,OAAO,CAAK,WAAW;SACxB;aAAM;YACL,IAAM,KAAK,GAAS,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YACtG,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,yBAAyB,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;YAC3F,OAAO,GAAG,0FAAyB,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC;SAC5D;QAED,IAAM,eAAe,GAAa,iFAAgB,CAAC,OAAO,CAAC,CAAC,CAAI,sBAAsB;QAEtF,8EAA8E;QAC9E,IAAM,SAAS,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC,CAAC;QAEnG,IAAI,SAAS,EAAE;YAEb,IAAI,CAAC,eAAe,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAC1D,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,MAAM,EAAE,eAAe,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,aAAa,CAAC,CAAC;YAElG,gBAAgB;YAChB,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAS,OAAO;gBAC5C,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;SAEJ;aAAM;YAEL,IAAI,CAAC,eAAe,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAC1D,IAAI,CAAC,gBAAgB,CAAC,eAAe,EAAE,OAAO,CAAC,aAAa,CAAC,CAAC;YAE9D,uCAAuC;YACvC,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;SAC5B;IACH,CAAC;IAED,+BAA+B;IACvB,4CAAc,GAAtB,UAAuB,QAAkB,EAAE,MAAgB,EAAE,gBAAwB,EAAE,cAAsB;QAE3G,IAAM,0BAA0B,GAAQ,uEAAmB,CAAC,gBAAgB,CAAC,CAAC;QAC9E,IAAM,wBAAwB,GAAQ,uEAAmB,CAAC,cAAc,CAAC,CAAC;QAE1E,IAAM,MAAM,GAAY,CAAE,0BAA0B,CAAC,QAAQ,GAAG,GAAG,GAAG,0BAA0B,CAAC,IAAI,GAAG,YAAY,CAAC;QACrH,IAAM,YAAY,GAAW,WAAW,GAAG,wBAAwB,CAAC,IAAI,GAAG,GAAG,GAAG,wBAAwB,CAAC,QAAQ,CAAC;QACnH,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,wBAAwB,CAAC,oBAAoB,CAAC,QAAQ,EAC5E;YACE,KAAK,EAAE,MAAM;YACb,WAAW,EAAE,YAAY;YACzB,QAAQ,EAAE,QAAQ;YAClB,WAAW,EAAE,MAAM;YACnB,QAAQ,EAAE,gBAAgB;YAC1B,aAAa,EAAE,cAAc;YAC7B,SAAS,EAAE,IAAI,CAAC,eAAe;SAChC,EAAE,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAE5C,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,uBAAuB,EAAE,CAAC,CAAC,CAAC;IACxG,CAAC;IAED,iCAAiC;IACzB,8CAAgB,GAAxB,UAAyB,QAAkB,EAAE,cAAsB;QAEjE,IAAM,wBAAwB,GAAQ,uEAAmB,CAAC,cAAc,CAAC,CAAC;QAE1E,wBAAwB,CAAC,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,MAAM,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAE/I,IAAI,CAAC,wBAAwB,CAAC,sBAAsB,CAAC,QAAQ,EAAE;YAC7D,QAAQ,EAAE,QAAQ;YAClB,WAAW,EAAE,QAAQ;YACrB,KAAK,EAAE,wBAAwB,CAAC,IAAI,GAAG,GAAG,GAAG,wBAAwB,CAAC,QAAQ;YAC9E,QAAQ,EAAE,CAAC;YACX,aAAa,EAAE,cAAc;YAC7B,SAAS,EAAE,IAAI,CAAC,eAAe;SAChC,EAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC3C,CAAC;IAGD,mBAAmB;IAEnB,qEAAqE;IACrE,2EAA2E;IACnE,0CAAY,GAApB;QAEE,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO;SACR;QAED,oBAAoB;QACpB,IAAM,cAAc,GAAG,EAAC,KAAK,EAAE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAC,CAAC;QACvH,IAAM,kBAAkB,GAAkB,EAAE,CAAC;QAC7C,IAAM,gBAAgB,GAAkB,EAAE,CAAC;QAE3C,IAAI,cAAc,CAAC,KAAK,GAAG,cAAc,CAAC,GAAG,GAAG,CAAC,EAAE;YACjD,IAAI,CAAC,qBAAqB,GAAG,cAAc,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,cAAc,CAAC,GAAG,GAAG,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;SACjH;aAAM;YACL,IAAI,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC;SACjC;QAED,4CAA4C;QAC5C,KAAK,IAAI,CAAC,GAAG,cAAc,CAAC,KAAK,EAAE,CAAC,IAAI,cAAc,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;YAC/D,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE;gBAClE,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aAC1B;SACF;QAED,gDAAgD;QAChD,IAAM,mBAAmB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;QACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,mBAAmB,EAAE,CAAC,EAAE,EAAE;YAE5C,IAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;YAErC,IAAI,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBACzC,kBAAkB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aAClC;iBAAM;gBACL,gBAAgB,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;aAC/D;SACF;QAED,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,CAAC;QAClC,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC;QAEtC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;IACnE,CAAC;IAED,qBAAqB;IACb,wCAAU,GAAlB,UAAmB,OAAsB;QAEvC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;YACxB,OAAO;SACR;QAED,IAAM,cAAc,GAAG,OAAO,CAAC,MAAM,CAAC;QAEtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC,EAAE,EAAE;YAEvC,IAAM,OAAO,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YAE3B,IAAI,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC/C,OAAO;aACR;YAED,IAAM,KAAK,GAAG,KAAK,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YAElE,IAAI,CAAC,KAAK,EAAE;gBACV,OAAO;aACR;YAED,IAAI,KAAK,CAAC,EAAE,KAAK,KAAK,CAAC,YAAY,EAAE;gBACnC,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,WAAW,CAAC;aACxC;YAED,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;YAElC,KAAK,CAAC,UAAU,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;YACjC,KAAK,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;YAChC,KAAK,CAAC,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;YAChC,KAAK,CAAC,UAAU,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;SAClC;IACH,CAAC;IAED,yEAAyE;IACjE,0CAAY,GAApB,UAAqB,OAAsB;QAEzC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;YACxB,OAAO;SACR;QAED,IAAM,cAAc,GAAG,OAAO,CAAC,MAAM,CAAC;QACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,EAAE,CAAC,EAAE,EAAE;YAEvC,IAAM,OAAO,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YAE3B,IAAI,KAAK,CAAC,eAAe,KAAK,OAAO,GAAG,CAAC,EAAE;gBACzC,iEAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAC/B,iEAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;aAClC;YAED,IAAI;gBAEF,IAAI,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,IAAI,EAAE;oBAE9C,uCAAuC;oBACvC,KAAK,IAAM,GAAG,IAAI,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE;wBAE9C,yBAAyB;wBACzB,IAAI,GAAG,KAAK,OAAO,EAAE;4BACnB,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC;yBACpE;wBAED,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;wBAE1D,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,OAAO,EAAE;4BACxC,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;yBACjD;wBAED,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;wBACzC,OAAO,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;qBAC1C;oBAED,kBAAkB;oBAClB,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC;oBACpC,OAAO,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;oBACpC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;oBAEpE,sHAAsH;iBACvH;aACF;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;aAChB;SAEF;IACH,CAAC;IAED,wHAAwH;IAExH,0BAA0B;IAClB,wCAAU,GAAlB,UAAmB,IAAU,EAAE,KAAa;QAE1C,IAAM,UAAU,GAAe,EAAE,CAAC;QAElC,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;QAE/C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,EAAE,CAAC,EAAE,EAAE;YAEzC,IAAM,GAAG,GAAa,IAAI,8CAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;YAEzH,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACtB;QAED,iBAAiB;QACjB,IAAM,UAAU,GAAG,IAAI,gDAAU,CAAC,UAAU,EAAE;YAC5C,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC;SACrD,CAAC,CAAC;QAEH,UAAU,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAO,iCAAiC;QAEvE,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,KAAK,GAAG,UAAU,CAAC;QAE7C,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACvC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IAEO,uCAAS,GAAjB,UAAkB,IAAU,EAAE,KAAa;QAA3C,iBAwCC;QAtCC,IAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAE5D,IAAM,QAAQ,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;QAExD,IAAI,WAAW,GAAe,EAAE,CAAC;QAEjC,IAAI,QAAQ,EAAE;YAEZ,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ;gBAE9B,SAAS,cAAc;oBAErB,qDAAqD;oBACrD,OAAO,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,QAAQ,CAAC,QAAQ,GAAG,2EAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAC9H,CAAC;gBAED,gCAAgC;gBAChC,IAAI,QAAQ,CAAC,SAAS,IAAI,cAAc,EAAE,EAAE;oBAE1C,YAAY;oBACZ,IAAM,GAAG,GAAa,IAAI,8CAAQ,CAAC,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,SAAS,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC;oBAC9F,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBAEvB;qBAAM,IAAI,QAAQ,CAAC,SAAS,GAAG,cAAc,EAAE,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;oBAE1E,KAAI,CAAC,aAAa,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;oBAEvC,WAAW,GAAG,EAAE,CAAC;iBAClB;YAEH,CAAC,CAAC,CAAC;YAEH,wDAAwD;YACxD,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBAE1B,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;aACxC;SACF;IACH,CAAC;IAED,yBAAyB;IACjB,2CAAa,GAArB,UAAsB,SAAqB,EAAE,KAAa;QAExD,IAAM,OAAO,GAAW,CAAC,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,QAAQ,EAAE,KAAK,cAAc,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,uBAAuB,CAAC;QAExI,iBAAiB;QACjB,IAAM,SAAS,GAAG,IAAI,gDAAU,CAAC,SAAS,EAAE;YAC1C,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC;SAC3C,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,SAAS,CAAC;QAE3C,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAEO,gDAAkB,GAA1B,UAA4B,GAAQ,EAAE,oBAA6B;QAEjE,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAM,IAAI,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;QAErE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;QAEjD,IAAM,eAAe,GAAI,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAEtD,IAAM,KAAK,GAAG,oEAAQ,CAAC,EAAC,SAAS,EAAE,SAAS,GAAG,eAAe,EAAE,IAAI,EAAE,QAAQ,EAAC,CAAC,CAAC;QACjF,IAAI,QAAQ,GAAG,EAAC,IAAI,EAAE,KAAK,EAAG,GAAG,EAAE,GAAG,EAAC,CAAC;QAExC,kCAAkC;QAClC,IAAI,oBAAoB,EAAE;YACxB,QAAQ,GAAG,mDAAI,QAAQ,EAAK,oBAAoB,CAAC,CAAC;SACnD;QAED,IAAM,UAAU,GAAG,8CAAQ,CAAC,iFAAgB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,QAAQ,CAAC,CAAC;QACtE,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAC,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC,CAAC;QAE1E,OAAO,UAAU,CAAC;IACpB,CAAC;IAAA,CAAC;IAEF,YAAY;IACJ,uCAAS,GAAjB,UAAkB,IAAU,EAAE,KAAa;QAEzC,IAAI,YAAY,GAAe,EAAE,CAAC;QAElC,IAAI,IAAI,CAAC,EAAE,KAAK,CAAC,EAAE;YACjB,mBAAmB;YACnB,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;SAC1E;QAED,mCAAmC;QACnC,IAAI,IAAI,CAAC,QAAQ,EAAE;YAEjB,IAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;YAErE,IAAI,IAAI,CAAC,IAAI,EAAE;gBAEb,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;gBACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;oBAEnC,IAAM,IAAI,GAAQ,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;oBAEhE,+CAA+C;oBAC/C,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,IAAI,eAAe,EAAE;wBAC7C,OAAO;qBACR;oBAED,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC;iBAClD;aACF;SACF;QAED,IAAM,YAAY,GAAG,oDAAc,CAAC,YAAY,CAAC,CAAC;QAClD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,OAAO,GAAG,YAAY,CAAC;QACjD,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAGD,gHAAgH;IACxG,wCAAU,GAAlB,UAAmB,IAAU,EAAE,KAAa;QAE1C,IAAM,YAAY,GAAe,EAAE,CAAC;QAEpC,IAAM,UAAU,GAAe,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;QAE/E,IAAI,UAAU,EAAE;YACd,IAAM,OAAO,GAAG,UAAU,CAAC,MAAM,CAAC;YAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;gBAChC,IAAM,KAAK,GAAQ,UAAU,CAAC,CAAC,CAAC,CAAC;gBACjC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC;aACnD;SACF;QAED,IAAM,WAAW,GAAG,oDAAc,CAAC,YAAY,CAAC,CAAC;QACjD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,KAAK,GAAG,WAAW,CAAC;QAC9C,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC;IAED,gDAAgD;IACxC,sCAAQ,GAAhB,UAAiB,IAAS;QAExB,IAAM,OAAO,GAAG;YACd,WAAW,EAAE,IAAI;YACjB,kBAAkB,EAAE,EAAC,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAC;SAChD,CAAC;QAEF,IAAM,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC3D,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACjE,CAAC;IAEO,uCAAS,GAAjB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACtD;QAED,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAEhD,IAAM,aAAa,GAAG,IAAI,8CAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YAE9F,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;YAE1C,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,EAAE,UAAU,CAAC;oBAEtC,IAAM,aAAa,GAAG,oDAAc,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,EAC1D,KAAK,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;oBAE5C,IAAI,aAAa,EAAE;wBAEjB,uDAAuD;wBACvD,IAAM,KAAK,GAAS,KAAK,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;wBACvG,IAAM,cAAc,GAAoB,KAAK,CAAC,eAAe,CAAC,yBAAyB,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;wBAEpH,IAAM,eAAe,GAAW,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,GAAG,2EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;wBAErG,IAAI,iBAAiB,UAAC;wBACtB,IAAI,QAAQ,GAAG,EAAE,CAAC;wBAElB,IAAM,SAAS,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC,CAAC;wBACpG,IAAI,SAAS,EAAE;4BACb,iBAAiB,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,2EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,gBAAgB,CAAC;4BAClG,QAAQ,GAAG,eAAe,GAAG,eAAe,CAAC;yBAC9C;6BAAM;4BACL,iBAAiB,GAAG,UAAU,CAAC;4BAC/B,QAAQ,GAAG,MAAM,GAAG,eAAe,CAAC;yBACrC;wBAED,KAAK,CAAC,wBAAwB,CAAC,oBAAoB,CAAC,CAAC,CAAC,MAAM,EAC1D;4BACE,QAAQ,EAAE,CAAC,CAAC,MAAM;4BAClB,KAAK,EAAE,iBAAiB;4BACxB,WAAW,EAAE,QAAQ;4BACrB,QAAQ,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC,QAAQ;4BACpC,aAAa,EAAE,eAAe;4BAC9B,UAAU,EAAE,IAAI;yBACjB,EAAE,KAAK,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;qBAC/C;gBACH,CAAC,CAAC,CAAC;aACJ;YAED,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACnC;IACH,CAAC;IAEO,wCAAU,GAAlB;QAEE,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,OAAO;SACR;QAED,0BAA0B;QAE1B,IAAM,OAAO,GAAe,EAAE,CAAC;QAE/B,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;QAC3C,IAAI,iBAAiB,GAAG,CAAC,CAAC;QAE1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;YAEjC,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAExC,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,EAAE;gBAElC,KAAK,IAAM,GAAG,IAAI,SAAS,CAAC,OAAO,CAAC,OAAO,EAAE;oBAE3C,IAAM,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;oBAE/C,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;2BAC1E,OAAO,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;wBAEpG,IAAI,iBAAiB,GAAG,CAAC,EAAE;4BACzB,iBAAiB,EAAE,CAAC;4BACpB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;yBACvB;qBACF;iBACF;aACF;SACF;QAED,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YAEtB,IAAM,MAAM,GAAG,IAAI,oDAAc,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAE7D,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;YAEjB,wDAAwD;YACxD,IAAI,IAAI,CAAC,qBAAqB,KAAK,CAAC,CAAC,EAAE;gBACrC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,EAAE,EAAE,EAAC,OAAO,EAAE,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,EAAE,EAAC,CAAC,CAAC;aAClG;iBAAM;gBACL,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,WAAW,CAAC;gBACvG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,UAAU,CAAC,EAAE,YAAY,CAAC,WAAW,CAAC,CAAC,EAAE,KAAK,EAAE,EAAC,OAAO,EAAE,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,EAAE,EAAC,CAAC,CAAC;aAC1I;SACF;IACH,CAAC;IAEO,4CAAc,GAAtB,UAAuB,KAAe,EAAE,YAAsB;QAC5D,IAAI,IAAI,CAAC,IAAI,EAAE;YAEb,IAAI,QAAQ,GAAG,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC;YAEvD,IAAI,YAAY,EAAE;gBAChB,QAAQ,GAAG,YAAY,CAAC;aACzB;YAED,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,SAAS,CAAC,EAAE,EAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,EAAE,EAAC,CAAC,CAAC;SACrG;IACH,CAAC;IAEM,0CAAY,GAAnB;QACE,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzC;IACH,CAAC;IAED,iBAAiB;IAEjB,+CAA+C;IACvC,4CAAc,GAAtB,UAAwB,KAAiB;QAEvC,qBAAqB;QACrB,iEAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,WAAW,CAAC,CAAC;QACvC,iEAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,aAAa,CAAC,CAAC;QAEzC,wCAAwC;QACxC,IAAI,CAAC,MAAM,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAEzD,IAAM,MAAM,GAAgB,IAAI,WAAW,CACzC,aAAa,EACb;YACE,OAAO,EAAE,IAAI;YACb,UAAU,EAAE,IAAI;YAChB,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC;SACrB,CAAC,CAAC;QAEL,mCAAmC;QACnC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IACrD,CAAC;IAGM,4CAAc,GAArB,UAAsB,MAAc;QAElC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,iBAAM,cAAc,YAAC,MAAM,CAAC,CAAC;QAC7B,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAEM,kDAAoB,GAA3B,UAA4B,IAAU;QAEpC,iBAAM,oBAAoB,YAAC,IAAI,CAAC,CAAC;QAEjC,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,wBAAwB;QACxB,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;SACzC;QAED,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;IACH,CAAC;IAGD,sBAAsB;IAEtB,iDAAiD;IACzC,gDAAkB,GAA1B,UAA2B,KAAa,EAAE,IAAU;QAElD,IAAI,cAAc,GAAe,EAAE,CAAC;QAEpC;;8BAEsB;QAEtB,wEAAwE;QACxE,IAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;QACrF,IAAM,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC;QAEvE,oDAAoD;QACpD,IAAM,OAAO,GAAa;YACxB,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,YAAY,CAAC;YACjH,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,YAAY,CAAC;YACrH,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,YAAY,CAAC;YACrH,QAAQ,EAAE,CAAC;YACX,aAAa,EAAE,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,2EAAW,CAAC,IAAI;SAChD,CAAC;QAEF;;;;;;+EAMuE;QAEvE,wEAAwE;QAExE,IAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;QAEvE,IAAM,UAAU,GAAa,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC/C,IAAM,cAAc,GAAa,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACrF,IAAM,WAAW,GAAW,SAAS,CAAC,WAAW,CAAC;QAClD,IAAM,WAAW,GAAW,IAAI,CAAC,WAAW,CAAC;QAE7C,IAAM,iBAAiB,GAAW;YAChC,QAAQ,EAAE,CAAC,OAAO,CAAC,QAAQ,GAAG,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC;YAClE,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC;SACtE,CAAC;QAEF,IAAM,qBAAqB,GAAW;YACpC,QAAQ,EAAE,CAAC,OAAO,CAAC,QAAQ,GAAG,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC;YAClE,SAAS,EAAE,CAAC,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC;SACtE,CAAC;QAEF,IAAM,WAAW,GAAG,IAAI,8CAAQ,CAAC,qBAAqB,CAAC,UAAU,CAAC,EAAE,qBAAqB,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3G,IAAM,OAAO,GAAG,IAAI,8CAAQ,CAAC,iBAAiB,CAAC,UAAU,CAAC,EAAE,iBAAiB,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;QAC/F,IAAM,OAAO,GAAG,IAAI,8CAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QACrE,IAAM,OAAO,GAAG,IAAI,8CAAQ,CAAC,UAAU,CAAC,QAAQ,EAAE,UAAU,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QAC3E,IAAM,WAAW,GAAG,IAAI,8CAAQ,CAAC,cAAc,CAAC,QAAQ,EAAE,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QAEvF,IAAM,WAAW,GAAG,UAAU,SAAc,EAAE,SAAc;YAC1D,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC;QAClG,CAAC;QAED,IAAM,YAAY,GAAG,WAAW,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QACnD,IAAM,gBAAgB,GAAG,WAAW,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;QAC3D,IAAM,aAAa,GAAG,WAAW,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QACpD,IAAM,iBAAiB,GAAG,WAAW,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;QAE5D,IAAM,SAAS,GAAG,YAAY,GAAG,gBAAgB,CAAC;QAClD,IAAM,UAAU,GAAG,aAAa,GAAG,iBAAiB,CAAC;QAErD,IAAM,kBAAkB,GAAG,aAAa,GAAG,gBAAgB,CAAC;QAE5D,IAAI,SAAkB,CAAC;QACvB,IAAI,SAAkB,CAAC;QAEvB,IAAI,SAAS,GAAG,CAAC,EAAE;YACjB,IAAI,kBAAkB,GAAG,SAAS,EAAE;gBAClC,SAAS,GAAG,IAAI,CAAC;aAClB;iBAAM;gBACL,SAAS,GAAG,IAAI,CAAC;aAClB;SACF;aAAM;YACL,IAAI,kBAAkB,GAAG,SAAS,EAAE;gBAClC,SAAS,GAAG,IAAI,CAAC;aAClB;iBAAM;aACN;SACF;QAED,IAAI,SAAS,EAAE;YACb,IAAI,UAAU,GAAG,CAAC,EAAE;gBAClB,SAAS,GAAG,IAAI,CAAC;aAClB;SACF;QAED,+BAA+B;QAC/B,IAAM,WAAW,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,gBAAgB,CAAC;QACvE,IAAM,YAAY,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC;QAE1D,qDAAqD;QACrD,IAAM,aAAa,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,YAAY,GAAG,GAAG,CAAC,CAAC;QAEvD,IAAI,MAAM,GAAW,WAAW,GAAG,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC;QACtD,MAAM,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC,MAAM,GAAG,EAAE,CAAC;QAEjD,mBAAmB;QACnB,IAAI,MAAM,GAAG,GAAG,EAAE;YAChB,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC;SAChC;aAAM,IAAI,MAAM,GAAG,CAAC,GAAG,EAAE;YACxB,MAAM,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC;SACvC;QAED,IAAM,SAAS,GAAG,CAAC,2EAAW,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,aAAa,CAAC;QAEzD,IAAM,MAAM,GAAa,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;QAEvE,IAAM,UAAU,GAAG,+CAAS,CAAC,EAAC,SAAS,EAAE,aAAa,EAAE,IAAI,EAAE,qBAAqB,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,QAAQ,EAAC,CAAC,CAAC;QACjH,cAAc,CAAC,IAAI,CAAC,8CAAQ,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAC,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAC,CAAC,CAAC,CAAC;QAEhH,IAAM,SAAS,GAAG,IAAI,8CAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QAErE,IAAI,SAAS,GAAG,CAAC,EAAE;YACjB,cAAc,GAAG,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC;SAC/E;QAED,OAAO,cAAc,CAAC;IACxB,CAAC;IAED,0DAA0D;IAClD,0CAAY,GAApB,UAAqB,KAAe,EAAE,KAAa,EAAE,MAAc;QAEjE,IAAM,KAAK,GAAG,UAAS,GAAW;YAChC,OAAO,GAAG,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC;QAC7B,CAAC;QAED,IAAM,KAAK,GAAG,UAAS,GAAW;YAChC,OAAO,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC;QAC7B,CAAC;QAED,IAAM,IAAI,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC;QACpC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAErB,IAAM,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QAElE,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;YACpD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;QAErD,IAAM,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;YAC7D,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,EACd,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;YAC/B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;QAElB,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE;YAAE,OAAO;SAAE;QAE3C,OAAO,EAAC,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,EAAC,CAAC;IACvE,CAAC;IAED,4BAA4B;IACpB,+CAAiB,GAAzB,UAA0B,IAAU;QAClC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO;SACR;QACD,OAAO,8CAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,EAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,uBAAuB,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAC,CAAC,CAAC;IAC3J,CAAC;IAED,gEAAgE;IACxD,0CAAY,GAApB,UAAqB,MAAW,EAAE,MAAW,EAAE,cAAwB,EAAE,YAAsB,EAAE,KAAc,EAAE,KAAc;QAE7H,IAAM,SAAS,GAAe,EAAE,CAAC;QAEjC,IAAM,OAAO,GAAG,KAAK,IAAI,CAAC,CAAC;QAE3B,IAAM,MAAM,GAAG,IAAI,gDAAU,CAAC,EAAE,EAAE;YAChC,KAAK,EAAE,KAAK,IAAI,oBAAoB;YACpC,SAAS,EAAE,OAAO,GAAG,GAAG,GAAG,GAAG,GAAG,OAAO,GAAG,GAAG;YAC9C,MAAM,EAAE,OAAO;YACf,OAAO,EAAE,CAAC;YACV,YAAY,EAAE,CAAC;YACf,KAAK,EAAE,EAAE;SACV,CAAC,CAAC;QAEH,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;QAEtC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAEvB,IAAM,gBAAgB,GAAG,UAAU,KAAU,EAAE,YAAoB;YAEjE,IAAM,MAAM,GAAG,CAAC,YAAY,KAAK,CAAC,CAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;YAEhD,OAAO,yDAAmB,CAAC,KAAK,EAAE;gBAChC,QAAQ,EAAE,CAAC;wBACT,MAAM,EAAE,YAAY,GAAG,GAAG;wBAC1B,MAAM,EAAE,CAAC;wBACT,MAAM,EAAE,8CAAQ,CAAC,SAAS,CAAC;4BACzB,SAAS,EAAE,CAAC;4BACZ,SAAS,EAAE,MAAM;4BACjB,OAAO,EAAE,KAAK;4BACd,WAAW,EAAE;gCACX,KAAK,EAAE,KAAK;gCACZ,MAAM,EAAE,CAAC;6BAAC;yBACb,CAAC;qBACH,CAAC;aACH,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,IAAI,cAAc,EAAE;YAClB,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;SAC7C;QAED,IAAI,YAAY,EAAE;YAChB,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC;SAC/C;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;IAEO,kDAAoB,GAA5B,UAA6B,KAAa;QAExC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAG,IAAI,CAAC,IAAI,EAAE;YACZ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,KAAK;gBACjC,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,KAAK,KAAK,EAAE;oBACvD,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;iBAC/B;YACH,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IA3mCqB;QAArB,+DAAS,CAAC,SAAS,CAAC;wEAAU,wDAAU;wDAAC;IAGjC;QAAR,2DAAK,EAAE;wEAAO,MAAM;qDAAC;IACb;QAAR,2DAAK,EAAE;;6DAAsB;IACrB;QAAR,2DAAK,EAAE;;6DAAwB;IACvB;QAAR,2DAAK,EAAE;;4DAAwB;IACvB;QAAR,2DAAK,EAAE;;sDAAe;IAEd;QAAR,2DAAK,EAAE;;yDAAgB;IACf;QAAR,2DAAK,EAAE;;0DAAiB;IAGhB;QAAR,2DAAK,EAAE;;6DAAuB;IAGtB;QAAR,2DAAK,EAAE;;6DAAuB;IACtB;QAAR,2DAAK,EAAE;;6DAAuB;IAGtB;QAAR,2DAAK,EAAE;;yDAAmB;IAtBhB,mBAAmB;QAV/B,+DAAS,CAAC;YACT,QAAQ,EAAE,aAAa;YACvB,+HAA2C;YAE3C,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;QAEF,uCAAuC;QACvC,yDAAyD;QACzD,sCAAsC;;+EAkDF,8DAAc;YACd,qFAAoB;YACpB,uFAAqB;YACrB,gFAAkB;YAClB,mEAAmB;YACnB,+EAAiB;YACjB,sEAAa;YACb,kEAAW;OAxDlC,mBAAmB,CA+mC/B;IAAD,0BAAC;CAAA,CA/mCwC,oGAAsB,GA+mC9D;AA/mC+B;;;;;;;;;;;;ACvDhC,iCAAiC,YAAY,mOAAmO,SAAS,qDAAqD,cAAc,0C;;;;;;;;;;;ACA5V,sCAAsC,oBAAoB,gBAAgB,iBAAiB,2BAA2B,kBAAkB,EAAE,iBAAiB,wBAAwB,eAAe,qCAAqC,EAAE,iBAAiB,uBAAuB,eAAe,0DAA0D,EAAE,mBAAmB,uBAAuB,aAAa,cAAc,uBAAuB,wBAAwB,iBAAiB,kBAAkB,kCAAkC,EAAE,yBAAyB,uBAAuB,mBAAmB,sBAAsB,EAAE,kCAAkC,uBAAuB,oBAAoB,EAAE,yBAAyB,yBAAyB,mBAAmB,oBAAoB,iBAAiB,kBAAkB,oCAAoC,oCAAoC,uCAAuC,uCAAuC,EAAE,+BAA+B,kBAAkB,yBAAyB,mBAAmB,oBAAoB,cAAc,oCAAoC,EAAE,wBAAwB,yBAAyB,cAAc,oBAAoB,iBAAiB,kBAAkB,oCAAoC,+BAA+B,yBAAyB,2DAA2D,2DAA2D,8EAA8E,8EAA8E,EAAE,6BAA6B,QAAQ,2DAA2D,2DAA2D,EAAE,QAAQ,2DAA2D,2DAA2D,EAAE,SAAS,4DAA4D,4DAA4D,EAAE,SAAS,4DAA4D,4DAA4D,EAAE,SAAS,4DAA4D,4DAA4D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,UAAU,4DAA4D,4DAA4D,EAAE,EAAE,qBAAqB,QAAQ,2DAA2D,2DAA2D,EAAE,QAAQ,2DAA2D,2DAA2D,EAAE,SAAS,4DAA4D,4DAA4D,EAAE,SAAS,4DAA4D,4DAA4D,EAAE,SAAS,4DAA4D,4DAA4D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,SAAS,6DAA6D,6DAA6D,EAAE,UAAU,4DAA4D,4DAA4D,EAAE,EAAE,+CAA+C,+rK;;;;;;;;;;;;;;;;;;ACAl6I;AAClD;AAQ7D;IAWE,6DAA6D;IAC7D,gCACU,eAAkC,EAClC,cAA6B;QAD7B,oBAAe,GAAf,eAAe,CAAmB;QAClC,mBAAc,GAAd,cAAc,CAAe;QAVhC,UAAK,GAAG,MAAM,CAAC;QAKf,sBAAiB,GAAkB,EAAE,CAAC;IAM1C,CAAC;IAEJ,yCAAQ,GAAR;QAAA,iBA4BC;QA1BC,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,GAAW;YAEhD,IAAI,+DAAS,EAAE,EAAE;gBACf,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;aACtD;YAED,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,MAAM,EAAE;gBAEtD,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,SAAS,EAAE;oBAC7B,KAAI,CAAC,OAAO,GAAG,IAAI,CAAC;iBACrB;qBAAM;oBACL,KAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,MAAM,CAAW,CAAC;iBAC3C;aAEF;iBAAM,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,MAAM,EAAE;gBAE5D,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,SAAS,EAAE;oBAC5B,KAAI,CAAC,OAAO,GAAG,KAAK,CAAC;iBACvB;qBAAM;oBACL,KAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC;iBAC1B;aACH;YAED,KAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;QAEvC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,gDAAgD;IAChD,4CAAW,GAAX,UAAY,OAAsB;QAChC,IAAI,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;IACnD,CAAC;IAhDQ;QAAR,2DAAK,EAAE;;8DAAqB;IAFlB,sBAAsB;QANlC,+DAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,wIAA8C;;SAE/C,CAAC;+EAe2B,+DAAiB;YAClB,qEAAa;OAd5B,sBAAsB,CAmDlC;IAAD,6BAAC;CAAA;AAnDkC;;;;;;;;;;;;ACTnC,kuB;;;;;;;;;;;ACAA,iCAAiC,kBAAkB,uCAAuC,qCAAqC,kBAAkB,EAAE,yBAAyB,mBAAmB,sBAAsB,EAAE,kCAAkC,2BAA2B,eAAe,sBAAsB,sBAAsB,6BAA6B,kEAAkE,sBAAsB,EAAE,yBAAyB,sBAAsB,uBAAuB,yBAAyB,kCAAkC,+IAA+I,oEAAoE,0HAA0H,EAAE,4BAA4B,uBAAuB,cAAc,YAAY,kBAAkB,EAAE,+CAA+C,uvF;;;;;;;;;;;;;;;;;;;;;ACA3+B;AACJ;AAGJ;AACY;AACF;AAU7D;IAAyC,6EAAa;IAYpD,6BACU,aAAkC,EAClC,gBAAiC,EACjC,MAAsB,EACtB,OAAe;QAJzB,YAME,iBAAO,SACR;QANS,mBAAa,GAAb,aAAa,CAAqB;QAClC,sBAAgB,GAAhB,gBAAgB,CAAiB;QACjC,YAAM,GAAN,MAAM,CAAgB;QACtB,aAAO,GAAP,OAAO,CAAQ;;IAGzB,CAAC;IAID,kBAAkB;IAElB,sCAAQ,GAAR;QACE,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;QAC/D,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC3B,CAAC;IAID,gBAAgB;IAER,+CAAiB,GAAzB;QAAA,iBAgBC;QAdC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,mCAAmC;QACnC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE/F,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAM;YAC/D,KAAI,CAAC,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACtC,KAAI,CAAC,WAAW,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;QACpC,CAAC,CACF,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,SAAS,CAAC,UAAS,MAAM;YAC7F,KAAK,CAAC,UAAU,GAAG,CAAC,MAAM,KAAK,UAAU,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAID,SAAS;IAEF,wCAAU,GAAjB,UAAkB,IAAS;QAEzB,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QACzC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAC7E,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;QAE9B;wFACgF;QAChF,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC;QACnD,gGAAgG;IAClG,CAAC;IAEO,yCAAW,GAAnB,UAAoB,MAAc,EAAE,QAAc,EAAE,SAAe;QAEjE,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YAErC,SAAS,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,GAAG,CAAC,EAAL,CAAK,CAAC,CAAC;YAEhC,IAAI,CAAC,SAAS,GAAG;gBACf,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;gBAC3C,KAAK,EAAE,IAAI,CAAC,GAAG,CAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC;aAC5D,CAAC;YAEF,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;SACnC;QAED,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACnC,IAAI,CAAC,eAAe,GAAG,QAAQ,CAAC;SACjC;QAED,MAAM,GAAG,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;QAEzC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,WAAuB,CAAC;IAC1E,CAAC;IAzFU,mBAAmB;QAN/B,+DAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;YAC3B,+HAA2C;;SAE5C,CAAC;+EAeyB,kEAAmB;YAChB,yEAAe;YACzB,8DAAc;YACb,sDAAM;OAhBd,mBAAmB,CA0F/B;IAAD,0BAAC;CAAA,CA1FwC,uEAAa,GA0FrD;AA1F+B;;;;;;;;;;;;AChBhC,mhBAAmhB,oBAAoB,yoB;;;;;;;;;;;ACAviB,sCAAsC,eAAe,EAAE,kBAAkB,uBAAuB,4BAA4B,2OAA2O,4HAA4H,uBAAuB,qBAAqB,eAAe,gBAAgB,0BAA0B,eAAe,kBAAkB,4BAA4B,qBAAqB,sDAAsD,uCAAuC,uCAAuC,gBAAgB,+BAA+B,+DAA+D,EAAE,0BAA0B,mGAAmG,mGAAmG,EAAE,4BAA4B,yBAAyB,aAAa,cAAc,kBAAkB,mBAAmB,mCAAmC,iBAAiB,yBAAyB,iCAAiC,EAAE,0BAA0B,yBAAyB,eAAe,iBAAiB,EAAE,yBAAyB,iBAAiB,EAAE,mBAAmB,wCAAwC,gBAAgB,iBAAiB,sBAAsB,EAAE,6BAA6B,iBAAiB,0BAA0B,EAAE,oBAAoB,eAAe,wBAAwB,EAAE,sBAAsB,eAAe,uBAAuB,EAAE,+CAA+C,29H;;;;;;;;;;;;;;;;;;ACAjwD;AAGkC;AAO/F;IAAsC,0EAAsB;IAO1D;eACE,iBAAO;IACT,CAAC;IAID,kBAAkB;IAElB,mCAAQ,GAAR;QAAA,iBAOC;QANC,iBAAM,QAAQ,WAAE,CAAC;QAEjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QAC7D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,SAAS,CAAC,gBAAM;YAC3E,KAAI,CAAC,WAAW,GAAG,MAAM,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,sCAAW,GAAX;QAEE,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;QAEhC,iBAAM,WAAW,WAAE,CAAC;IACtB,CAAC;IAID,iBAAiB;IAEV,kCAAO,GAAd;QACE,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;IACxC,CAAC;IAKD,QAAQ;IAED,yCAAc,GAArB,UAAsB,MAAc;QAClC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAEM,+CAAoB,GAA3B,UAA4B,IAAU;QAEpC,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,KAAK,UAAU,EAAE;YAC3C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;SACzC;IACH,CAAC;IArDU,gBAAgB;QAL5B,+DAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,8HAAuC;;SAExC,CAAC;;OACW,gBAAgB,CAsD5B;IAAD,uBAAC;CAAA,CAtDqC,oGAAsB,GAsD3D;AAtD4B;;;;;;;;;;;;ACV7B,qEAAqE,oBAAoB,+EAA+E,oBAAoB,uLAAuL,oBAAoB,sKAAsK,mBAAmB,oX;;;;;;;;;;;ACAhkB,yBAAyB,gBAAgB,gBAAgB,WAAW,uBAAuB,kBAAkB,yBAAyB,yBAAyB,EAAE,sBAAsB,yHAAyH,EAAE,+EAA+E,4BAA4B,oBAAoB,EAAE,4BAA4B,oBAAoB,EAAE,6BAA6B,qBAAqB,EAAE,4BAA4B,4BAA4B,mBAAmB,yCAAyC,4BAA4B,EAAE,4BAA4B,2BAA2B,mBAAmB,kEAAkE,6BAA6B,EAAE,4BAA4B,2BAA2B,EAAE,uCAAuC,mCAAmC,EAAE,+CAA+C,26D;;;;;;;;;;;;;;;;;;;;;;;ACAn6B;AACjC;AACP;AAEe;AAC3B;AACY;AACJ;AAO3D;IAkBE,6BACU,uBAAgD,EAChD,gBAAyC,EACzC,aAA6C,EAC7C,MAAwC,EACxC,OAAgC,EAChC,gBAAyC,EACzC,cAAuC;QAPjD,iBA6BC;QA5BS,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,qBAAgB,GAAhB,gBAAgB,CAAyB;QACzC,kBAAa,GAAb,aAAa,CAAgC;QAC7C,WAAM,GAAN,MAAM,CAAkC;QACxC,YAAO,GAAP,OAAO,CAAyB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAyB;QACzC,mBAAc,GAAd,cAAc,CAAyB;QAtBvC,aAAQ,GAAyB,IAAI,0DAAY,EAAU,CAAC;QAE/D,iBAAY,GAA0B,MAAM,CAAC;QAC7C,kBAAa,GAAyB,MAAM,CAAC;QAC7C,kBAAa,GAA0B,KAAK,CAAC;QAC7C,oBAAe,GAAwB,KAAK,CAAC;QAoBlD,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,UAAC,KAAK;YAE3B,IAAI,KAAK,YAAY,6DAAa,IAAI,KAAK,CAAC,KAAK,CAAC,EAAE;gBAElD,KAAI,CAAC,UAAU,GAAG,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAE3D,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;oBACnC,KAAI,CAAC,YAAY,GAAG,MAAM,CAAC;oBAC3B,KAAI,CAAC,aAAa,GAAG,MAAM,CAAC;oBAC5B,KAAI,CAAC,WAAW,GAAG,MAAM,CAAC;iBAC3B;qBAAM,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;oBACzC,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,aAAa,GAAG,MAAM,CAAC;iBACjD;qBAAM;oBACL,KAAI,CAAC,YAAY,GAAG,MAAM,CAAC;oBAC3B,KAAI,CAAC,aAAa,GAAG,MAAM,CAAC;oBAC5B,KAAI,CAAC,WAAW,GAAG,OAAO,CAAC;iBAC5B;aACF;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAID,kBAAkB;IAElB,sCAAQ,GAAR;QAAA,iBAoBC;QAlBC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,SAAS,CAAC,uBAAa;YAC/F,KAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACtC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC,SAAS,CAAE,yBAAe;YAC/G,KAAI,CAAC,eAAe,GAAG,eAAe,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACtD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,SAAS,CAAE,eAAK;YACpD,KAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACvB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC,SAAS,CAAC,gBAAM;YACnD,KAAI,CAAC,cAAc,GAAG,MAAM,CAAC;QAC/B,CAAC,CAAC;IACJ,CAAC;IAED,yCAAW,GAAX,UAAY,OAAsB;QAEhC,oGAAoG;QACpG,qIAAqI;QACrI,IAAI,OAAO,CAAC,cAAc,CAAC,WAAW,KAAK,KAAK,IAAI,IAAI,CAAC,cAAc,KAAK,IAAI,EAAE;YAChF,IAAI,CAAC,uBAAuB,CAAC,YAAY,EAAE,CAAC;SAC7C;IACH,CAAC;IAID,iBAAiB;IAEV,6CAAe,GAAtB;QACE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IACjC,CAAC;IAEM,yCAAW,GAAlB;QACE,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC;QAC3B,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;QAC5B,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;QAClC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC,EAAE,EAAC,WAAW,EAAE,EAAC,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,kBAAkB,CAAC,EAAC,EAAC,CAAC,CAAC;QACrG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;IAC1C,CAAC;IAEM,0CAAY,GAAnB;QACE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC9B,CAAC;IAEM,+CAAiB,GAAxB;QACE,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC;IACvC,CAAC;IAzGQ;QAAR,2DAAK,EAAE;;+DAAyB;IACvB;QAAT,4DAAM,EAAE;wEAAW,0DAAY;yDAAsC;IAH3D,mBAAmB;QAL/B,+DAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;YAChC,4HAA0C;;SAE3C,CAAC;+EAoBoC,wFAAsB;YACtB,yEAAe;YACf,kEAAmB;YACnB,8DAAc;YACd,sDAAM;YACN,yEAAe;YACf,qEAAa;OAzBtC,mBAAmB,CA4G/B;IAAD,0BAAC;CAAA;AA5G+B;;;;;;;;;;;;ACdhC,kN;;;;;;;;;;;ACAA,+DAA+D,+K;;;;;;;;;;;;;;;;;ACAR;AAOvD;IAKE;IAAe,CAAC;IAEhB,oCAAQ,GAAR,cAAY,CAAC;IALJ;QAAR,2DAAK,EAAE;;4DAAwB;IACvB;QAAR,2DAAK,EAAE;;8DAA0B;IAHvB,iBAAiB;QAL7B,+DAAS,CAAC;YACT,QAAQ,EAAE,iBAAiB;YAC3B,iIAAwC;;SAEzC,CAAC;;OACW,iBAAiB,CAQ7B;IAAD,wBAAC;CAAA;AAR6B;;;;;;;;;;;;ACP9B,2C;;;;;;;;;;;ACAA,yBAAyB,2BAA2B,gBAAgB,qCAAqC,uCAAuC,EAAE,wBAAwB,yCAAyC,EAAE,0BAA0B,mBAAmB,gBAAgB,EAAE,+CAA+C,u2B;;;;;;;;;;;;;;;;;;;ACY5S;AACyD;AACA;AAWhF;IAYE,8BACU,eAAkC,EAClC,yBAAmD;QADnD,oBAAe,GAAf,eAAe,CAAmB;QAClC,8BAAyB,GAAzB,yBAAyB,CAA0B;QAZ9B,aAAQ,GAAG,KAAK,CAAC;QAIvC,WAAM,GAAW,MAAM,CAAC;IASjC,CAAC;IAED,uCAAQ,GAAR;QACE,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAED,0CAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACnB,OAAO;SACR;QAED,IAAI,OAAO,CAAC,IAAI,EAAE;YAEhB,IAAI,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,KAAK,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE;gBAE/D,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;gBACzD,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;gBAEpC,0DAA0D;gBAC1D,IAAI,IAAI,CAAC,SAAS,YAAY,2FAAoB,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,MAAM;uBAC7E,IAAI,CAAC,SAAS,YAAY,2FAAoB,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,MAAM,EAAE;oBACnF,IAAI,CAAC,WAAW,EAAE,CAAC;oBACnB,IAAI,CAAC,MAAM,EAAE,CAAC;oBACd,OAAO;iBACR;aACF;SACF;QAED,IAAI,OAAO,CAAC,MAAM,EAAE;YAClB,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC;SACrD;QAED,IAAI,OAAO,CAAC,IAAI,EAAE;YAChB,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC;YAChD,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE;gBAC7B,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC;aAC7B;SACF;QAED,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;IAClD,CAAC;IAED,0CAAW,GAAX;QACE,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;YAC7B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;SAC3B;IACH,CAAC;IAEO,qCAAM,GAAd;QAEE,IAAM,aAAa,GAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,CAAC,2FAAoB,CAAC,CAAC,CAAC,2FAAoB,CAAC;QAExG,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,UAAU,CAAC,CAAC;QAEnD,IAAM,OAAO,GAAG,IAAI,CAAC,yBAAyB,CAAC,uBAAuB,CAAC,aAAa,CAAC,CAAC;QAEtF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAE7D,6BAA6B;QAC7B,IAAI,CAAC,SAAS,GAAS,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;QAEnD,cAAc;QACd,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QAChC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QACpC,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAChD,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;IACtC,CAAC;IAjF8B;QAA9B,iEAAW,CAAC,gBAAgB,CAAC;;0DAAkB;IACI;QAAnD,+DAAS,CAAC,WAAW,EAAE,EAAE,IAAI,EAAE,8DAAgB,EAAE,CAAC;wEAAY,8DAAgB;2DAAC;IAEvE;QAAR,2DAAK,EAAE;;sDAAc;IACb;QAAR,2DAAK,EAAE;;wDAAyB;IACxB;QAAR,2DAAK,EAAE;;2DAAmB;IAPhB,oBAAoB;QAThC,+DAAS,CAAC;YACT,QAAQ,EAAE,kBAAkB;YAC5B,2IAA4C;;SAE7C,CAAC;QAEF;;6DAEqD;;+EAcxB,+DAAiB;YACP,sEAAwB;OAdlD,oBAAoB,CAqFhC;IAAD,2BAAC;CAAA;AArFgC;;;;;;;;;;;;ACzBjC,+SAA+S,yEAAyE,gFAAgF,qEAAqE,sDAAsD,oEAAoE,wBAAwB,yDAAyD,4B;;;;;;;;;;;ACAxtB,yBAAyB,4BAA4B,uCAAuC,EAAE,cAAc,kCAAkC,kCAAkC,sCAAsC,EAAE,+CAA+C,utB;;;;;;;;;;;;;;;;;;ACAzK;AAExC;AAOtD;IAaE;QALiB,WAAM,GAAW,MAAM,CAAC;QAGlC,aAAQ,GAAmB,EAAE,CAAC;IAEtB,CAAC;IAVhB,sBAAI,2CAAS;aAAb;YACE,OAAO,wBAAwB,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC1E,CAAC;;;OAAA;IAAA,CAAC;IAUF,uCAAQ,GAAR;QACE,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,0CAAW,GAAX,UAAY,OAAsB;QAChC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;IACvB,CAAC;IAEM,yCAAU,GAAjB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QAEnB,IAAI,IAAI,CAAC,IAAI,EAAE;YAEb,4BAA4B;YAC5B,IAAM,YAAU,GAAkB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAEhE,YAAU,CAAC,OAAO,CAAC,UAAS,GAAG,EAAE,KAAK;gBAEpC,IAAI,GAAG,KAAK,UAAU,EAAE;oBACtB,OAAO;iBACR;gBAED,IAAM,QAAQ,GAAG,kEAAgB,CAAC,GAAG,CAAC,CAAC;gBAEvC,IAAI,QAAQ,KAAK,SAAS,EAAE;oBAE1B,IAAI,YAAU,CAAC,MAAM,GAAG,CAAC,IAAI,KAAK,KAAK,CAAC,EAAE;wBACxC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,kEAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;qBAClD;oBACD,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBAC/B;qBAAM;oBACL,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,kEAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;iBAClD;YACH,CAAC,CAAC,CAAC;YAEH,cAAc;YACd,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC9B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,kEAAgB,CAAC,SAAS,CAAC,CAAC,CAAC;aACjD;SACF;IACH,CAAC;IAtDD;QADC,iEAAW,CAAC,OAAO,CAAC;;;yDAGpB;IAEQ;QAAR,2DAAK,EAAE;;sDAAW;IACF;QAAhB,2DAAK,CAAC,QAAQ,CAAC;;wDAAyB;IAChC;QAAR,2DAAK,EAAE;;2DAAmB;IAThB,oBAAoB;QALhC,+DAAS,CAAC;YACT,QAAQ,EAAE,eAAe;YACzB,8IAA6C;;SAE9C,CAAC;;OACW,oBAAoB,CA0DhC;IAAD,2BAAC;CAAA;AA1DgC;;;;;;;;;;;;ACTjC,yYAAyY,8BAA8B,8iB;;;;;;;;;;;ACAva,mCAAmC,iBAAiB,2BAA2B,yBAAyB,EAAE,mBAAmB,uBAAuB,kBAAkB,EAAE,qBAAqB,kCAAkC,mBAAmB,iBAAiB,qBAAqB,gBAAgB,uBAAuB,EAAE,4DAA4D,8BAA8B,2BAA2B,EAAE,0FAA0F,mCAAmC,yBAAyB,EAAE,+CAA+C,uzC;;;;;;;;;;;;;;;;;;;;;;ACExmB;AACmE;AAErD;AAC2B;AAKb;AACI;AAUvD;IAAsC,0EAAsB;IAyB1D,0BACU,aAAkC,EAClC,YAAyB,EACzB,eAAkC;QAH5C,YAKE,iBAAO,SACR;QALS,mBAAa,GAAb,aAAa,CAAqB;QAClC,kBAAY,GAAZ,YAAY,CAAa;QACzB,qBAAe,GAAf,eAAe,CAAmB;QAxBlC,mBAAa,GAAsB,IAAI,0DAAY,EAAO,CAAC;QAS9D,kBAAY,GAAgC,IAAI,oDAAe,CAAC,EAAE,CAAC,CAAC,CAAS,oDAAoD;QAKjI,eAAS,GAAG,EAAE,CAAC;QACd,uBAAiB,GAAG,CAAC,CAAC;QAGtB,sBAAgB,GAA0B,EAAE,CAAC;;IASrD,CAAC;IAED,kBAAkB;IAElB,mCAAQ,GAAR;QAAA,iBAmCC;QAjCC,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,iBAAM,QAAQ,WAAE,CAAC;QAEjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAE1G,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,SAAS,CACtD,cAAI;YACF,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;QACjC,CAAC,CAAC,CAAC,CAAC;QAEN,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAS,MAAM;YACzF,IAAI,MAAM,KAAK,OAAO,EAAE;gBAEtB,IAAM,cAAc,GAAQ,KAAK,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;gBAC7D,IAAM,gBAAgB,GAAe,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;gBACnE,gBAAgB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;gBACtC,KAAK,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;aAEvC;iBAAM,IAAI,MAAM,KAAK,SAAS,EAAE;gBAE/B,IAAM,YAAY,GAAQ,KAAK,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;gBAC3D,IAAM,KAAK,GAAe,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;gBAExD,IAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC;gBAC7B,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;oBAC/B,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,YAAY,CAAC,EAAE,EAAE;wBACnC,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;wBACnB,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;wBAC3B,MAAM;qBACP;iBACF;aACF;QACH,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED,sCAAW,GAAX,UAAY,OAAsB;QAEhC,IAAI,OAAO,CAAC,SAAS,IAAI,OAAO,CAAC,QAAQ,EAAE;YACzC,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,IAAI,OAAO,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;IACH,CAAC;IAED,sCAAW,GAAX;QACE,iBAAM,WAAW,WAAE,CAAC;IACtB,CAAC;IAEO,gCAAK,GAAb;QAEE,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAC3B,IAAI,WAAW,GAAG,EAAE,CAAC;QACrB,IAAM,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;QAEtE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,4BAA4B;QAC5B,IAAI,IAAI,CAAC,SAAS,EAAE;YAElB,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;gBAChC,IAAM,KAAK,GAAS,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBACtC,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;oBACvC,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;iBAC9C;aACF;SAEF;aAAM,IAAI,IAAI,CAAC,QAAQ,EAAE;YACxB,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC;SAC7B;QAED,IAAM,UAAU,GAAG,WAAW,CAAC,MAAM,CAAC;QACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,EAAE,CAAC,EAAE,EAAE;YACnC,IAAM,MAAM,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;YAE9B,2BAA2B;YAC3B,IAAM,IAAI,GAAG,KAAK,CAAC,cAAc,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAErD,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,eAAe,EAAE;gBAC5C,IAAI,CAAC,IAAI,IAAI,YAAY,CAAC;aAC3B;YACD,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACnC;QAED,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAM,QAAQ,GAAS,CAAC,IAAI,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,iBAAM,eAAe,WAAE,CAAC;YAEvF,IAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YAEpD,IAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;YACrD,IAAI,MAAM,EAAE;gBACV,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;aAChC;YAED,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YAC3B,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;SACrC;aAAM;YACL,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC1C,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aACzC;SACF;IACH,CAAC;IAID,wBAAwB;IAEjB,yCAAc,GAArB,UAAsB,MAAc;QAElC,iCAAiC;QACjC,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,KAAK,UAAU,IAAI,MAAM,KAAK,UAAU,EAAE;YAChF,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;QACD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;QAC/B,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,CAAM,sCAAsC;IAClF,CAAC;IAEM,+CAAoB,GAA3B,UAA4B,IAAU;QAEpC,IAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;QACrD,IAAI,UAAsB,CAAC;QAE3B,iBAAiB;QACjB,IAAI,QAAQ,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,EAAE;YAEtC,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aACjD;YAED,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;aAC/B;SAEF;aAAM,IAAI,IAAI,CAAC,QAAQ,EAAE;YAExB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;YAE7C,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SACjD;QAED,IAAI,MAAM,EAAE;YACV,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACxC;QAED,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;IACjC,CAAC;IAEO,6CAAkB,GAA1B,UAA2B,MAAkB;QAE3C,IAAI,MAAM,EAAE;YACV,IAAM,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC;YAEtD,0DAA0D;YAC1D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,EAAE,CAAC,EAAE,EAAE;gBACzC,IAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBAEtC,IAAI,MAAM,CAAC,WAAW,EAAE;oBACtB,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;wBAClB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,GAAG,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC;qBAC1F;yBAAM;wBACL,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,GAAG,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC;qBAC3F;iBACF;aACF;SACF;IACH,CAAC;IAID,iBAAiB;IAEV,0CAAe,GAAtB,UAAuB,GAAQ,EAAE,KAAU;QAEzC,IAAI,MAAmB,CAAC;QAExB,IAAI,GAAG,CAAC,IAAI,KAAK,MAAM,EAAE;YAEvB,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;YACtC,OAAO;SAER;aAAM;YAEL,MAAM,GAAG,IAAI,WAAW,CACtB,aAAa,EACb;gBACE,OAAO,EAAE,IAAI;gBACb,UAAU,EAAE,IAAI;gBAChB,MAAM,EAAE,GAAG;aACZ,CAAC,CAAC;SACN;QAED,QAAQ,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IACrE,CAAC;IAEM,uCAAY,GAAnB;QAEE,iBAAM,YAAY,WAAE,CAAC;QAErB,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,OAAO;SACR;QAED,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAI,IAAI,CAAC,SAAS,EAAE;YAElB,qBAAqB,CAAC;gBAEpB,IAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAI,gGAAgG;gBACxI,IAAI,eAAe,GAAG,QAAQ,CAAC;gBAE/B,IAAI,KAAK,CAAC,iBAAiB,EAAE;oBAC3B,eAAe,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,GAAG,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;iBACrG;gBAED,KAAK,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC,GAAG,eAAe,EAAE,MAAM,CAAC,CAAC;YAChG,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAEO,8CAAmB,GAA3B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAM,WAAW,GAAW,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;QAE5E,IAAI,WAAiB,CAAC;QAEtB,uCAAuC;QACvC,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,YAAY,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,CAAC,EAAE,EAAE;YAExD,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE;gBAEV,IAAI,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;oBACpD,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oBAC1D,MAAM;iBACP;aACF;SACF;QAED,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO;SACR;QAED,IAAI,UAAU,GAAW,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QAEnF,MAAM,CAAC,qBAAqB,CAAC;YAE3B,IAAM,SAAS,GAAG,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC;YAEvD,IAAI,KAAK,CAAC,iBAAiB,EAAE;gBAC3B,UAAU,GAAG,SAAS,GAAG,UAAU,GAAG,KAAK,CAAC,iBAAiB,CAAC;gBAC9D,IAAI,UAAU,GAAG,CAAC,EAAE;oBAClB,UAAU,GAAG,CAAC,CAAC;iBAChB;qBAAK,IAAK,UAAU,GAAG,SAAS,EAAE;oBACjC,UAAU,GAAG,SAAS,CAAC;iBACxB;aACF;YAED,kEAAkE;YAClE,IAAM,MAAM,GAAG,CAAC,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC;YAEpE,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAClD,KAAK,CAAC,SAAS,CAAC,cAAc,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,mCAAQ,GAAf,UAAgB,KAAK;QAEnB,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3C,OAAO,CAAC,UAAU;SACnB;QAED,IAAI,CAAC,wBAAwB,EAAE,CAAC;QAEhC,IAAM,gBAAgB,GAAkB,EAAE,CAAC;QAC3C,IAAM,aAAa,GAAkB,EAAE,CAAC;QACxC,IAAM,cAAc,GAAkB,EAAE,CAAC;QAEzC,iBAAiB;QACjB,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;QAElE,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;QAEhE,mGAAmG;QACnG,KAAK,IAAI,CAAC,GAAG,WAAW,EAAE,CAAC,GAAG,WAAW,GAAG,CAAC,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YAE7E,IAAM,IAAI,GAAe,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;YAEzD,sBAAsB;YACtB,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;gBAChC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACzB,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAC5B,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;aACxC;SACF;QAED,8HAA8H;QAC9H,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;QAEpE,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;QAED,IAAM,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;QACnF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,KAAK,CAAC,EAAE,EAAE,gBAAgB,EAAE,aAAa,EAAE,iBAAiB,EAAE,cAAc,EAAC,CAAC,CAAC;IAClH,CAAC;IAIO,mDAAwB,GAAhC;QACE,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC;QACzD,IAAI,IAAI,CAAC,UAAU,GAAG,cAAc,CAAC,KAAK,EAAE;YAC1C,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC;SAC7B;aAAM,IAAI,IAAI,CAAC,UAAU,GAAG,cAAc,CAAC,GAAG,EAAE;YAC/C,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC;SAC7B;aAAM,IAAI,IAAI,CAAC,UAAU,IAAI,cAAc,CAAC,KAAK,IAAI,IAAI,CAAC,UAAU,IAAI,cAAc,CAAC,GAAG,EAAE;YAC3F,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;SAC/B;IACH,CAAC;IAGD,QAAQ;IAEA,wCAAa,GAArB,UAAsB,IAAgB;QAEpC,IAAI,CAAC,IAAI,EAAE;YACT,OAAO;SACR;QAED,uFAAuF;QACvF,IAAI,CAAC,IAAI,CACP,UAAS,CAAC,EAAE,CAAC;YACX,IAAM,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,IAAI,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;YAChG,IAAM,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,IAAI,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;YAChG,OAAO,MAAM,GAAG,MAAM,CAAC;QACzB,CAAC,CAAC,CAAC;QAEL,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,IAAI,CAAC,OAAO,EAAE,CAAC;SAChB;QAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;QAC9C,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAE,CAAC,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;QAEtG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,aAAG,IAAI,UAAG,CAAC,IAAI,KAAK,MAAM,EAAnB,CAAmB,CAAC,CAAC;QAC7D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAI,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QACtC,IAAI,CAAC,SAAS,CAAC,iBAAiB,EAAE,CAAC,CAAE,yCAAyC;IAChF,CAAC;IAED,+EAA+E;IACxE,yCAAc,GAArB,UAAsB,KAAa,EAAE,OAAY;QAC/C,OAAO,OAAO,CAAC,EAAE,CAAC;IACpB,CAAC;IAxYqB;QAArB,+DAAS,CAAC,SAAS,CAAC;wEAAY,+EAAwB;uDAAC;IAEhD;QAAT,4DAAM,EAAE;wEAAgB,0DAAY;2DAAgC;IAE5D;QAAR,2DAAK,EAAE;wEAAa,KAAK;uDAAO;IACxB;QAAR,2DAAK,EAAE;wEAAY,KAAK;sDAAO;IACvB;QAAR,2DAAK,EAAE;;uDAAiB;IAChB;QAAR,2DAAK,EAAE;;sDAAmB;IAClB;QAAR,2DAAK,EAAE;;0DAAsB;IACrB;QAAR,2DAAK,EAAE;;+DAA6B;IAX1B,gBAAgB;QAR5B,+DAAS,CAAC;YACT,QAAQ,EAAE,UAAU;YACpB,sHAAwC;YAExC,eAAe,EAAE,qEAAuB,CAAC,MAAM;;SAChD,CAAC;QAEF,wDAAwD;;+EA2B7B,kEAAmB;YACpB,iEAAW;YACR,+DAAiB;OA5BjC,gBAAgB,CA2Y5B;IAAD,uBAAC;CAAA,CA3YqC,oGAAsB,GA2Y3D;AA3Y4B;;;;;;;;;;;;ACtB7B,+GAA+G,YAAY,2pBAA2pB,YAAY,8FAA8F,yEAAyE,IAAI,yDAAyD,2B;;;;;;;;;;;ACAtgC,8BAA8B,2BAA2B,EAAE,oBAAoB,2CAA2C,EAAE,iBAAiB,kCAAkC,EAAE,oBAAoB,iCAAiC,EAAE,WAAW,uCAAuC,EAAE,cAAc,kCAAkC,kCAAkC,sCAAsC,EAAE,oBAAoB,iBAAiB,0BAA0B,EAAE,sBAAsB,iBAAiB,yBAAyB,EAAE,+CAA+C,mgD;;;;;;;;;;;;;;;;;ACAjf;AAQvF;IAmCE,8BACU,eAAkC;QAAlC,oBAAe,GAAf,eAAe,CAAmB;QAlC5C,8EAA8E;QACnD,WAAM,GAAG,IAAI,CAAC;QACV,eAAU,GAAG,KAAK,CAAC;QACnB,eAAU,GAAG,KAAK,CAAC;QACtB,YAAO,GAAG,KAAK,CAAC;QACA,aAAQ,GAAG,IAAI,CAAC;IA8BzD,CAAC;IAxBa,sBAAI,wCAAM;aAAV,UAAW,KAAa;YAEvC,IAAI,KAAK,EAAE;gBACT,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;aACzB;YAGD,IAAI,KAAK,KAAK,UAAU,EAAE;gBACxB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aACtD;iBAAM,IAAI,KAAK,KAAK,UAAU,EAAE;gBAC/B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aACtD;iBAAM,IAAI,KAAK,KAAK,OAAO,EAAE;gBAC5B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;aACzD;iBAAM;gBACL,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aAC1D;QACH,CAAC;;;OAAA;IAMD,uCAAQ,GAAR,cAAkB,CAAC;IApCQ;QAA1B,iEAAW,CAAC,YAAY,CAAC;;wDAAe;IACV;QAA9B,iEAAW,CAAC,gBAAgB,CAAC;;4DAAoB;IACnB;QAA9B,iEAAW,CAAC,gBAAgB,CAAC;;4DAAoB;IACtB;QAA3B,iEAAW,CAAC,aAAa,CAAC;;yDAAiB;IACA;QAA3C,iEAAW,CAAC,6BAA6B,CAAC;;0DAAiB;IAInD;QAAR,2DAAK,EAAE;;sDAAW;IACV;QAAR,2DAAK,EAAE;;2DAAmB;IACV;QAAhB,2DAAK,CAAC,QAAQ,CAAC;;;sDAoBf;IAjCU,oBAAoB;QALhC,+DAAS,CAAC;YACT,QAAQ,EAAE,eAAe;YACzB,8IAA6C;;SAE9C,CAAC;+EAqC2B,+DAAiB;OApCjC,oBAAoB,CAwChC;IAAD,2BAAC;CAAA;AAxCgC;;;;;;;;;;;;ACRjC,2FAA2F,cAAc,GAAG,QAAQ,4K;;;;;;;;;;;ACApH,yBAAyB,uBAAuB,kBAAkB,aAAa,kBAAkB,wCAAwC,uBAAuB,EAAE,0BAA0B,mBAAmB,6BAA6B,yBAAyB,qBAAqB,EAAE,iBAAiB,6BAA6B,EAAE,qBAAqB,6CAA6C,EAAE,kBAAkB,oCAAoC,EAAE,qBAAqB,mCAAmC,EAAE,iBAAiB,WAAW,EAAE,gCAAgC,0BAA0B,EAAE,iBAAiB,cAAc,EAAE,gCAAgC,uBAAuB,EAAE,+CAA+C,umD;;;;;;;;;;;;;;;;;ACAjqB;AASpE;IAME;IAAgB,CAAC;IAJK,sBAAI,2CAAO;aAAX,cAAuB,OAAO,IAAI,CAAC,YAAY,CAAC,EAAC;;;OAAA;IAAA,CAAC;IAMxE,yCAAQ,GAAR,cAAY,CAAC;IANS;QAArB,iEAAW,CAAC,OAAO,CAAC;;;yDAAkD;IAChD;QAAtB,2DAAK,CAAC,cAAc,CAAC;;gEAAsB;IAC3B;QAAhB,2DAAK,CAAC,QAAQ,CAAC;;0DAAgB;IAJrB,sBAAsB;QAPlC,+DAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,iJAA8C;;SAE/C,CAAC;QAEF,wFAAwF;;;OAC3E,sBAAsB,CAUlC;IAAD,6BAAC;CAAA;AAVkC;;;;;;;;;;;;;;;;;;;;ACTM;AACG;AAG5C,oBAAoB;AACsE;AAO1F;IAEE,uBAAoB,OAAkB;QAAlB,YAAO,GAAP,OAAO,CAAW;IAAG,CAAC;IAK1C,gBAAgB;IACT,kCAAU,GAAjB,UAAkB,IAAY,EAAE,UAAkB,EAAE,QAAmB;QAAvE,iBA+BC;QA7BC,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE5B,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,IAAI,IAAI,CAAC,yBAAyB,EAAE;YAClC,IAAI,CAAC,yBAAyB,CAAC,WAAW,EAAE,CAAC;YAC7C,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;SACvC;QAED,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;QAEjE,2CAA2C;QAC3C,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC,gBAAM;gBAEjF,6CAA6C;gBAE7C,KAAI,CAAC,yBAAyB,CAAC,WAAW,EAAE,CAAC;gBAC7C,KAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC;gBAEtC,IAAI,QAAQ,EAAE;oBACZ,QAAQ,CAAC,MAAM,CAAC,CAAC;iBAClB;gBAED,KAAI,CAAC,cAAc,GAAG,IAAI,CAAC;YAC7B,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAEO,2CAAmB,GAA3B,UAA4B,IAAY,EAAE,UAAkB;QAE1D,IAAI,IAAI,KAAK,MAAM,EAAE;YACnB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,uGAAmB,EAAE;gBAC5C,SAAS,EAAE,KAAK;gBAChB,KAAK,EAAE,KAAK;gBACZ,MAAM,EAAE,KAAK;gBACb,IAAI,EAAE,UAAU;aACjB,CAAC,CAAC;SACJ;aAAM;YACL,OAAO,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAC;YAC1D,OAAO;SACR;IACH,CAAC;IAEO,4CAAoB,GAA5B;QACE,yBAAyB;QACzB,2BAA2B;QAC3B,6CAA6C;QAC7C,IAAI;IACN,CAAC;IA7DU,aAAa;QALzB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,mFAAmF;;+EAGpD,2DAAS;OAF3B,aAAa,CA8DzB;IAAD,oBAAC;CAAA;AA9DyB;;;;;;;;;;;;;;;;;;;;;;ACZiB;AAIG;AACC;AACI;AACT;AAO1C;IASE,uBAAoB,oBAAyC;QAAzC,yBAAoB,GAApB,oBAAoB,CAAqB;QAP7D,eAAe;QACP,gBAAW,GAAW,sEAAsE;YAClG,0GAA0G;YAC1G,oEAAoE,CAAC;QAMrE,IAAI,CAAC,sBAAsB,GAAG,oBAAoB,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;IACrF,CAAC;IAED;;;;0DAIsD;IAC/C,mCAAW,GAAlB,UAAmB,gBAAqB,EAAE,GAAQ,EAAE,QAAwB;QAE1E,4DAA4D;QAC5D,IAAI,CAAC,QAAQ,EAAE;YACb,QAAQ,GAAG,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACjC;QAED,IAAM,eAAe,GAAG,QAAQ,CAAC,MAAM,CAAC;QAExC,IAAI,OAAO,CAAC;QACZ,IAAI,YAAoB,CAAC;QACzB,IAAI,YAAY,GAAW,CAAC,CAAC;QAC7B,IAAI,SAAS,GAAW,EAAE,CAAC;QAE3B,IAAM,OAAO,GAAG,kEAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QAE9C,IAAI,CAAC,OAAO,IAAI,eAAe,GAAG,CAAC,EAAE;YACnC,YAAY,GAAG,kEAAgB,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC;SACnD;aAAM;YACL,YAAY,GAAG,OAAO,CAAC,KAAK,CAAC;SAC9B;QAED,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE,gBAAgB,EAAE,YAAY,CAAC,CAAC;QAEtE,cAAc;QACd,IAAM,OAAO,GAAG,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,eAAe,CAAC;QAC5D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;SAC/B;QAED,IAAK,eAAe,GAAG,CAAC,EAAE;YACxB,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC7B,SAAS,GAAG,EAAE,CAAC;YACf,YAAY,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;SAChC;QAED,cAAc;QACd,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAEvB,yBAAyB;YACzB,IAAM,WAAW,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YAE9C,kCAAkC;YAClC,IAAI,WAAW,GAAG,CAAC,EAAE;gBACnB,QAAQ,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aAC/D;SACF;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YAE1B,IAAI,KAAK,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;YAExB,IAAI,KAAK,EAAE;gBAET,2DAA2D;gBAC3D,IAAI,CAAC,KAAK,CAAC,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;oBAClC,KAAK,GAAG,UAAU,CAAC;iBACpB;gBAED,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAC3E,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,GAAG,YAAY,EAC/D,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,YAAY,CAAC,CAAC,CAAC;aACzF;SACF;QACD,OAAO,OAAO,CAAC;IACjB,CAAC;IAEO,yCAAiB,GAAzB,UAA0B,GAAe,EAAE,gBAAqB,EAAE,KAAa;QAE7E,IAAI,OAAO,CAAC;QAEZ,IAAI,GAAG,CAAC,QAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC,sBAAsB,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE;YACxF,OAAO,GAAG,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;SAC5D;aAAM;YACL,OAAO,GAAG,IAAI,CAAC,qBAAqB,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;SAC/D;QAED,OAAO,OAAO,CAAC;IACjB,CAAC;IAEM,0CAAkB,GAAzB,UAA0B,MAAW,EAAE,EAAU,EAAE,KAAiB,EAAE,OAAuB,EAAE,OAAqB;QAAjE,iCAAiB;QAAE,qCAAmB,IAAI;QAAE,qCAAmB,EAAE;QAElH,IAAI,QAAQ,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC;QAC9B,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC,MAAM,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QAEhG,OAAO,QAAQ,CAAC;IAClB,CAAC;IAED,iGAAiG;IAC1F,0CAAkB,GAAzB,UAA2B,MAAW,EAAE,KAAa,EAAE,KAAiB,EAAE,OAAsB;QAAzC,iCAAiB;QAAE,wCAAsB;QAE9F,IAAM,OAAO,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC;QAC/B,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC;QACvC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;QACtC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAC9B,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;QAC5B,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC,MAAM,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC,MAAM,CAAC,EAAC,KAAK,EAAE,8DAAU,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,GAAG,KAAK,EAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAE/L,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,iGAAiG;IAC1F,6CAAqB,GAA5B,UAA8B,MAAW,EAAE,KAAa,EAAE,KAAiB,EAAE,OAAsB;QAAzC,iCAAiB;QAAE,wCAAsB;QAEjG,IAAM,OAAO,GAAG,MAAM,CAAC,KAAK,EAAE,CAAC;QAC/B,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC;QACzC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;QACtC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAC9B,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;QAC5B,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QAC/B,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC;QACrC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,EAAC,KAAK,EAAE,8DAAU,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,GAAG,KAAK,EAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAE7J,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,8DAA8D;IAC9D,8GAA8G;IAC9G,qEAAqE;IAC9D,oCAAY,GAAnB,UAAoB,MAAa;QAE/B,uCAAuC;QACvC,IAAI,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,GAAG,MAAM,CAAC,CAAC;QAE1D,IAAI,OAAO,KAAK,IAAI,EAAE;YACpB,MAAM,GAAG,SAAS,CAAC;YACnB,OAAO,CAAC,GAAG,CAAC,6CAA6C,EAAE,MAAM,CAAC,CAAC;SACpE;QAED,OAAO,SAAS,GAAG,MAAM,CAAC;IAC5B,CAAC;IAED,4GAA4G;IACrG,+CAAuB,GAA9B;QAEE,4BAA4B;QAC5B,IAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC/C,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAEtC,uBAAuB;QACvB,IAAM,KAAK,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;QACtE,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;QACvD,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QAE7E,iBAAiB;QACjB,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC7C,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC9B,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAE7B,OAAO,mEAAQ,CAAC,EAAC,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAC,CAAC,CAAC;IACvD,CAAC;IAzKU,aAAa;QALzB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,uEAAuE;;+EAU3B,kEAAmB;OATlD,aAAa,CAuLzB;IAAD,oBAAC;CAAA;AAvLyB;;;;;;;;;;;;;;;;;;;;;ACXsC;AACD;AACK;AACN;AAG9D,sCAAsC;AACtC;IAA6B,iEAAW;IAEtC;eACE,iBAAO;IACT,CAAC;IAED,iFAAiF;IACjF,uBAAK,GAAL,UAAM,KAAgB,EAAE,SAAiC,EAAE,OAAe,EAAE,IAAY,EAAE,KAAkB,EAAE,SAAc;QAE1H,iBAAM,KAAK,YAAC,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;QAE/D,iDAAiD;QACjD,IAAI,CAAC,gBAAgB,GAAG;YACtB,EAAC,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,WAAW,EAAC;YACnC,EAAC,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,WAAW,EAAC;YACpC,EAAC,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,YAAY,EAAC;YACrC,EAAC,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAC;YACtC,EAAC,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAC;YACjC,EAAC,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAC;SAAC,CAAC;QAIlC,YAAY;QAEZ,wBAAwB;QACxB,IAAI,UAA2B,CAAC;QAChC,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;YACjC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAA0B,CAAC,CAAC;SAC/D;aAAM;YACL,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;SAChD;QAED,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,GAAG,0EAAW,CAAC,IAAI,CAAC;QAIrD,4DAA4D;QAE5D,OAAO,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;QAChD,IAAM,SAAS,GAAS,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAClD,IAAM,KAAK,GAAe,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAEzF,OAAO,CAAC,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;IAChE,CAAC;IAED,4BAAU,GAAV,UAAW,SAAwB;QAEjC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,QAAQ;QACR,IAAI,UAAU,GAAoB,EAAE,CAAC;QAErC,SAAS,CAAC,OAAO,CAAC,UAAS,WAAmB,EAAE,KAAa;YAE3D,WAAW,GAAG,KAAK,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;YAEzD,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAEzB,IAAM,WAAW,GAAS,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;YAEzD,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YACzB,6DAA6D;YAC7D,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC7C,gCAAgC;gBAChC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;aACzD;YAED,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,gBAAgB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YAE9E,IAAM,OAAO,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;YACjD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAG,EAAE;gBAEjC,IAAM,QAAQ,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBAE9C,kCAAkC;gBAClC,IAAI,QAAQ,CAAC,UAAU,CAAC,cAAc,CAAC,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;oBAE1E,QAAQ,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;oBAEtE,IAAI,iBAAiB,GAAoB,wFAAwB,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;oBAEjH,IAAI,YAAY,SAAQ,CAAC;oBAEzB,6DAA6D;oBAC7D,IAAI,OAAO,KAAK,CAAC,KAAK,CAAC,MAAM,KAAK,QAAQ,EAAE;wBAC1C,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC;qBACnC;yBAAM;wBACL,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;qBAC1C;oBAED,IAAM,MAAM,GAAW,mFAAqB,CAAC,iBAAiB,EAAE,YAAY,CAAC,CAAC;oBAE9E,iBAAiB,GAAG,KAAK,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,MAAM,CAAC,CAAC;oBAC5E,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;iBACnD;aACF;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,UAAU,CAAC;IACpB,CAAC;IAED,mEAAmE;IACnE,2BAAS,GAAT,UAAU,IAAmB;QAE3B,IAAM,WAAW,GAAW,IAAI,CAAC,MAAM,CAAC,CAAK,SAAS;QACtD,IAAM,WAAW,GAAe,EAAE,CAAC;QAEnC,mHAAmH;QACnH,IAAM,gBAAgB,GACpB,EAAC,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG,EAAE,SAAS,EAAE,EAAE,EAAE,UAAU,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,WAAW,EAAE,GAAG,EAAE,WAAW,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAE,WAAW,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,UAAU,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,mBAAmB,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,aAAa,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,yBAAyB,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,mBAAmB,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAC,CAAC;QAClmH,IAAI,MAAM,GAAW,CAAC,CAAC;QAEvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,CAAC,EAAE,EAAE;YAEpC,IAAM,IAAI,GAAW,IAAI,CAAC,CAAC,CAAC,CAAC;YAE7B,+BAA+B;YAC/B,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,eAAe,EAAE;gBACpC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;aAChB;iBAAM;gBAEL,IAAI,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;gBACpB,MAAM,EAAE,CAAC;gBAET,kBAAkB;gBAClB,IAAI,CAAC,UAAU,CAAC,GAAG,EAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,EAAa,CAAC;gBACxH,OAAO,IAAI,CAAC,UAAU,CAAC,CAAC;gBACxB,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC;gBACzB,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC;gBAEzB,yBAAyB;gBACzB,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC;gBAEpB,6CAA6C;gBAC7C,IAAI,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;gBAEnD,sDAAsD;gBACtD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;oBAE/B,IAAM,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;oBACvG,IAAM,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;oBACvG,IAAM,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;oBACvG,IAAI,aAAa,KAAK,IAAI,EAAE;wBAC1B,WAAW,GAAG,IAAI,CAAC;qBACpB;yBAAM,IAAI,aAAa,KAAK,IAAI,EAAE;wBACjC,WAAW,GAAG,IAAI,CAAC;qBACpB;yBAAM,IAAI,aAAa,KAAK,IAAI,IAAI,aAAa,KAAK,KAAK,EAAE;wBAC5D,WAAW,GAAG,MAAM,CAAC;qBACtB;yBAAM,IAAI,aAAa,KAAK,IAAI,IAAI,aAAa,KAAK,IAAI,IAAI,aAAa,KAAK,IAAI,IAAI,aAAa,KAAK,MAAM,EAAE;wBACjH,WAAW,GAAG,IAAI,CAAC;qBACpB;yBAAM,IAAI,aAAa,KAAK,IAAI,IAAI,aAAa,KAAK,MAAM,EAAE;wBAC7D,WAAW,GAAG,IAAI,CAAC;qBACpB;yBAAM,IAAI,aAAa,KAAK,KAAK,IAAI,aAAa,KAAK,MAAM,IAAI,aAAa,KAAK,MAAM,EAAE;wBAC1F,WAAW,GAAG,MAAM,CAAC;qBACtB;yBAAM,IAAI,aAAa,KAAK,MAAM,EAAE;wBACnC,WAAW,GAAG,MAAM,CAAC;qBACtB;yBAAM,IAAI,aAAa,KAAK,MAAM,IAAI,aAAa,KAAK,MAAM,IAAI,aAAa,KAAK,MAAM;2BACtF,aAAa,KAAK,MAAM,IAAI,aAAa,KAAK,MAAM,IAAI,aAAa,KAAK,MAAM,IAAI,aAAa,KAAK,MAAM;2BAC5G,aAAa,KAAK,KAAK,IAAI,aAAa,KAAK,KAAK,IAAI,aAAa,KAAK,MAAM,EAAE;wBACnF,WAAW,GAAG,IAAI,CAAC;qBACpB;yBAAM,IAAI,aAAa,KAAK,MAAM,EAAE;wBACnC,WAAW,GAAG,IAAI,CAAC;qBACpB;yBAAM;wBACL,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;qBAC7D;oBACD,uCAAuC;iBACxC;gBAED,IAAI,CAAC,MAAM,CAAC,GAAG,gBAAgB,CAAC,WAAW,CAAC,CAAC;gBAC7C,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;oBACjB,IAAI,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;iBAC1B;gBAED,sBAAsB;gBAEtB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;gBAEjD,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;gBACxF,IAAM,WAAW,GAAG,UAAU,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAEnD,IAAI,CAAC,OAAO,CAAC,GAAG,WAAW,CAAC,KAAK,EAAE,CAAC;gBAEpC,UAAU,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBAE3C,4BAA4B;gBAC5B,IAAM,iBAAiB,GAAG,UAAU,CAAC,MAAM,CAAC,UAAU,OAAe;oBACnE,OAAO,OAAO,KAAK,EAAE,CAAC;gBACxB,CAAC,CAAC,CAAC;gBAEH,IAAM,YAAY,GAAW,iBAAiB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBAExF,IAAI,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;gBAC7D,IAAI,CAAC,YAAY,CAAC,GAAG,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;gBAE3C,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC;gBAEpB,WAAW,CAAC,IAAI,CAAC,IAAW,CAAC,CAAC;aAC/B;SACF;QAED,4BAA4B;QAE5B,kFAAkF;QAClF,IAAM,kBAAkB,GAAG,CAAC,YAAY,EAAE,YAAY,EAAE,aAAa,EAAE,aAAa,EAAE,YAAY,EAAE,YAAY,EAAE,YAAY;YAC1H,aAAa,EAAE,WAAW,EAAE,YAAY,EAAE,aAAa,EAAE,SAAS,EAAE,kBAAkB,EAAE,cAAc,EAAE,YAAY,CAAC;QAEzH,IAAM,QAAQ,GAAG,WAAW,CAAC,MAAM,CAAC;QACpC,IAAM,QAAQ,GAAG,kBAAkB,CAAC,MAAM,CAAC;QAE3C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;YAEjC,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC;YACpB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;gBAEjC,IAAI,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,EAAE;oBACxD,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,SAAS,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,SAAS,GAAG,0EAAW,CAAC,IAAI,CAAC;oBACzF,UAAU,GAAG,CAAC,CAAC;oBACf,MAAM;iBACP;aACF;YAED,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE;gBACrB,kBAAkB,CAAC,MAAM,CAAE,UAAU,EAAC,CAAC,CAAC,CAAC;aAC1C;YAED,IAAI,kBAAkB,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,MAAM;aACP;SACF;QAED,OAAO,WAAW,CAAC;IACrB,CAAC;IAEO,qCAAmB,GAA3B,UAA4B,KAAa;QAEvC,IAAI,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,CAAK,aAAa;QACnE,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC,CAAG,YAAY;QAClE,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC,CAAI,aAAa;QAEnE,OAAO,YAAY,CAAC;IACtB,CAAC;IAED,8CAA8C;IACtC,oCAAkB,GAA1B,UAA2B,KAAa,EAAE,MAAqB;QAE7D,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACjB,IAAI,MAAM,GAAQ,KAAK,CAAC;QAExB,IAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;QAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAEhC,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YAEjC,IAAI,CAAC,KAAK,OAAO,GAAG,CAAC,EAAE;gBACrB,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aAC3B;SACF;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;IAEO,iCAAe,GAAvB,UAAwB,KAAa;QACnC,OAAO,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACxD,CAAC;IACH,cAAC;AAAD,CAAC,CAxQ4B,2EAAW,GAwQvC;;;;;;;;;;;;;;;;;;;;;;AC/Q+D;AACD;AACK;AACN;AAG9D,mDAAmD;AACnD;IAA6B,iEAAW;IAEtC;eACE,iBAAO;IACT,CAAC;IAED,iFAAiF;IACjF,uBAAK,GAAL,UAAM,KAAgB,EAAE,SAAiB,EAAE,OAAe,EAAE,IAAY,EAAE,KAAkB,EAAE,SAAc;QAE1G,iBAAM,KAAK,YAAC,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;QAE/D,iDAAiD;QACjD,IAAI,CAAC,gBAAgB,GAAG;YACtB,EAAC,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,WAAW,EAAC;YACnC,EAAC,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,WAAW,EAAC;YACpC,EAAC,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,YAAY,EAAC;YACrC,EAAC,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAC;SAAC;QAGzC,YAAY;QAEZ,wBAAwB;QACxB,IAAM,UAAU,GAAoB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,SAAmB,CAAC,CAAC;QAE9E,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,GAAG,0EAAW,CAAC,IAAI,CAAC;QAErD,4DAA4D;QAE5D,OAAO,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;QAChD,IAAM,SAAS,GAAS,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAClD,IAAM,KAAK,GAAe,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAEzF,OAAO,CAAC,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IACjD,CAAC;IAED,4BAAU,GAAV,UAAW,SAAiB;QAE1B,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,QAAQ;QACR,IAAI,UAAU,GAAoB,EAAE,CAAC;QAErC,SAAS,GAAG,KAAK,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;QACrD,IAAM,WAAW,GAAU,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAExD,IAAM,OAAO,GAAe,KAAK,CAAC,gBAAgB,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;QAEzF,+CAA+C;QACjD,OAAO,CAAC,OAAO,CAAC,UAAS,KAAK;YAE5B,IAAM,iBAAiB,GAAoB,KAAK,CAAC,gBAAgB,CAAC,wFAAwB,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC;YACpI,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;QAEH,IAAM,YAAY,GAAW,KAAK,CAAC,KAAK,CAAC,MAAgB,CAAC;QAC1D,IAAM,MAAM,GAAW,mFAAqB,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;QAEvE,UAAU,GAAG,KAAK,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;QAEhD,UAAU,GAAG,KAAK,CAAC,sBAAsB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;QAE9D,OAAO,UAAU,CAAC;IACpB,CAAC;IAED,6CAA6C;IAC7C,kCAAgB,GAAhB,UAAiB,SAA0B;QAEzC,IAAM,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC;QACjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,IAAM,SAAS,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;YAE/B,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;gBACxB,SAAS,CAAC,SAAS,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;aACrF;SACF;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,2BAAS,GAAT,UAAU,IAAmB;QAE3B,IAAI,CAAC,OAAO,CAAC,UAAS,GAAG,EAAE,KAAK;YAE9B,GAAG,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;YAElB,kBAAkB;YAClB,GAAG,CAAC,UAAU,CAAC,GAAG,EAAC,QAAQ,EAAE,GAAG,CAAC,UAAU,CAAC,EAAE,SAAS,EAAE,GAAG,CAAC,WAAW,CAAC,EAAE,SAAS,EAAE,GAAG,CAAC,WAAW,CAAC,EAAa,CAAC;YACpH,OAAO,GAAG,CAAC,UAAU,CAAC,CAAC;YACvB,OAAO,GAAG,CAAC,WAAW,CAAC,CAAC;YACxB,OAAO,GAAG,CAAC,WAAW,CAAC,CAAC;YAExB,WAAW;YACX,IAAI,GAAG,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;gBAC5B,8BAA8B;gBAC9B,IAAM,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBACxC,GAAG,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;gBACxB,GAAG,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,IAAI,SAAS,CAAC;aACvC;iBAAM;gBACL,GAAG,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;aAC1D;YAED,4CAA4C;YAC5C,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;gBAChB,IAAI,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;oBAC9C,GAAG,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,SAAS,CAAC;iBAC9E;qBAAM;oBACL,GAAG,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,WAAW,CAAC;iBAC1C;aACF;YAED,wBAAwB;YAExB,6CAA6C;YAC7C,IAAM,WAAW,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,CAAC;YAE/C,GAAG,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;YAExB,IAAI,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE;gBACzE,GAAG,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC;aACrB;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;gBACvG,GAAG,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;aACtB;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC;mBAClG,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;gBACpG,GAAG,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC;aACvB;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;gBACvC,GAAG,CAAC,MAAM,CAAC,GAAG,aAAa,CAAC;aAC7B;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;gBACzE,GAAG,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;aACtB;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;gBAC3C,GAAG,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC;aACvB;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;gBAC9C,GAAG,CAAC,MAAM,CAAC,GAAG,WAAW,CAAC;aAC3B;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;gBACzE,GAAG,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;aACtB;iBAAM,IAAI,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;gBACxC,GAAG,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;aACtB;YAED,kCAAkC;YAClC,OAAO,GAAG,CAAC,KAAK,CAAC,CAAC;YAClB,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC;QACrB,CAAC,CAAC,CAAC;QAEH,OAAO,IAAkB,CAAC;IAC5B,CAAC;IACH,cAAC;AAAD,CAAC,CAjJ4B,2EAAW,GAiJvC;;;;;;;;;;;;;;;;;;;;AC3JmD;AACY;AAIhE;IAAA;IA+EA,CAAC;IA7EC,oDAAoD;IACpD,gCAAgC;IAEhC,gCAAS,GAAT,UAEE,KAA8B,EAC9B,WAA8B,EAC9B,WAA8B,EAE9B,kBAA6C,EAC7C,KAAyC,EACzC,KAA6C,EAC7C,QAA6C;QAH7C,+DAA6C;QAC7C,iCAAyC;QACzC,qCAA6C;QAC7C,2CAA6C;QAI7C,IAAI,YAAY,GAAW,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC;QAClE,IAAI,eAAuB,CAAC;QAC5B,IAAI,OAAO,GAAW,GAAG,CAAC;QAE1B,oBAAoB;QACpB,IAAI,YAAY,KAAK,QAAQ,EAAE;YAC7B,IAAI,YAAY,KAAK,OAAO,IAAI,YAAY,KAAK,MAAM,EAAE;gBACvD,KAAK,GAAG,KAAK,GAAG,0EAAW,CAAC,IAAI,CAAC;aAClC;YACD,IAAI,YAAY,KAAK,MAAM,IAAI,YAAY,KAAK,MAAM,EAAE;gBACtD,KAAK,GAAG,KAAK,GAAG,0EAAW,CAAC,IAAI,CAAC;aAClC;YACD,YAAY,GAAG,QAAQ,CAAC;SACzB;QAED,uDAAuD;QACvD,IAAI,WAAW,KAAK,OAAO,IAAI,WAAW,KAAK,MAAM,EAAE;YAErD,IAAI,KAAK,GAAG,0EAAW,CAAC,IAAI,IAAI,GAAG,IAAI,KAAK,KAAK,IAAI,EAAE;gBAErD,eAAe,GAAG,MAAM,CAAC,CAAC,KAAK,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;gBACpE,OAAO,GAAG,KAAK,CAAC;aAEjB;iBAAM;gBAEL,eAAe,GAAG,MAAM,CAAC,CAAC,KAAK,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;gBAChE,OAAO,GAAG,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;gBAClD,OAAO,GAAG,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC;aAEnD;SAEF;aAAM,IAAI,WAAW,KAAK,MAAM,IAAI,WAAW,KAAK,MAAM,EAAE;YAE3D,eAAe,GAAG,MAAM,CAAC,CAAC,KAAK,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;YAChE,OAAO,GAAG,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;YAClD,OAAO,GAAG,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC;SAEnD;aAAM;YAEL,eAAe,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;SAChD;QAED,eAAe;QACf,IAAI,kBAAkB,EAAE;YAEtB,IAAI,KAAK,GAAG,EAAE,EAAE;gBACd,OAAO,GAAG,GAAG,eAAe,GAAG,GAAG,GAAG,OAAO,GAAG,YAAY,CAAC;aAC7D;iBAAM;gBACL,OAAO,UAAU,CAAC;aACnB;SACF;aAAM,IAAI,QAAQ,EAAE;YAEnB,IAAM,eAAe,GAAG,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC;YAEzD,OAAO,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,GAAG,GAAG,GAAG,OAAO,GAAG,GAAG,GAAG,eAAe,CAAC;SAE1E;aAAM;YACL,kBAAkB;YAClB,OAAO,OAAO,GAAG,GAAG,GAAG,eAAe,CAAC;SACxC;IACH,CAAC;IA9EU,YAAY;QAFxB,0DAAI,CAAC,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC;OAEd,YAAY,CA+ExB;IAAD,mBAAC;CAAA;AA/EwB;;;;;;;;;;;;;;;;;;ACL2B;AAKpD;IAAA;IAeA,CAAC;IAbC,gCAAS,GAAT,UAAU,KAAa,EAAE,YAAqB;QAE5C,IAAI,KAAK,KAAK,CAAC,EAAE;YACf,OAAO,SAAS,CAAC;SAClB;QAED,IAAM,EAAE,GAAG,IAAI,CAAC;QAChB,IAAM,GAAG,GAAG,YAAY,IAAI,CAAC,CAAC;QAC9B,IAAM,MAAM,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACzE,IAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;QAEtD,OAAO,UAAU,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC;IAChF,CAAC;IAdU,YAAY;QAHxB,0DAAI,CAAC;YACJ,IAAI,EAAE,UAAU;SACjB,CAAC;OACW,YAAY,CAexB;IAAD,mBAAC;CAAA;AAfwB;;;;;;;;;;;;;;;;;;ACL2B;AAMpD;IAAA;IAsBA,CAAC;IApBC,kCAAS,GAAT,UAAU,OAAoC;QAE5C,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO;SACR;QAED,IAAM,QAAQ,GAAe,OAAO,CAAC,QAAQ,EAAE,CAAC;QAEhD,uFAAuF;QACvF,QAAQ,CAAC,IAAI,CACX,UAAS,CAAC,EAAE,CAAC;YAEX,IAAM,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,IAAI,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;YAChG,IAAM,MAAM,GAAG,CAAC,CAAC,CAAC,WAAW,IAAI,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;YAEhG,OAAO,MAAM,GAAG,MAAM,CAAC;QACzB,CAAC,CAAC,CAAC;QAEL,OAAO,QAAQ,CAAC;IAClB,CAAC;IArBU,cAAc;QAF1B,0DAAI,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC;OAEhB,cAAc,CAsB1B;IAAD,qBAAC;CAAA;AAtB0B;;;;;;;;;;;;;;;;;;;;ACNgB;AACM;AACa;AAO9D;IAOE;QALQ,gBAAW,GAA6B,IAAI,oDAAe,CAAC,KAAK,CAAC,CAAC;QAGpE,UAAK,GAAG,SAAS,CAAC;QAGvB,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;IAC5D,CAAC;IAEM,yCAAa,GAApB;QACE,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;QAC3E,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;QAC5E,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC3B,CAAC;IAEM,wCAAY,GAAnB;QACE,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;QAC9E,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;QAC/E,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IAEM,6CAAiB,GAAxB;QAEE,IAAI,CAAC,mEAAa,EAAE,EAAE;YACpB,OAAO,EAAC,KAAK,EAAE,CAAC,EAAE,OAAO,EAAE,oBAAoB,EAAC,CAAC;SAClD;QAED,IAAM,WAAW,GAAG,mEAAa,EAAE,CAAC;QACpC,IAAM,UAAU,GAAQ,SAAS,CAAC;QAClC,IAAM,aAAa,GAAG,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC;QAEjD,IAAM,OAAO,GAAG,EAAE,CAAC;QACnB,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,GAAI,oBAAoB,CAAC;QACrD,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,qBAAqB,CAAC;QACtD,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,GAAO,iBAAiB,CAAC;QAClD,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,GAAI,oBAAoB,CAAC;QACrD,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,GAAI,oBAAoB,CAAC;QACrD,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,GAAI,oBAAoB,CAAC;QACrD,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,GAAO,yBAAyB,CAAC;QAC1D,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,GAAO,uBAAuB,CAAC;QAExD,uDAAuD;QAEvD,OAAO,EAAC,KAAK,EAAE,aAAa,EAAE,OAAO,EAAE,OAAO,CAAC,aAAa,CAAC,EAAC,CAAC;IACjE,CAAC;IAEM,qCAAS,GAAhB;QAEE,IAAI,CAAC,mEAAa,EAAE,EAAE;YACpB,OAAO,SAAS,CAAC;SAClB;QAED,oBAAoB;QACpB,IAAM,WAAW,GAAG,mEAAa,EAAE,CAAC;QACpC,IAAM,UAAU,GAAQ,SAAS,CAAC;QAClC,IAAM,aAAa,GAAG,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC;QAEjD,OAAO,CAAC,aAAa,KAAK,WAAW,CAAC,IAAI,IAAI,aAAa,KAAK,WAAW,CAAC,OAAO,CAAC,EAAC,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC;IAC7G,CAAC;IAEO,6CAAiB,GAAzB,UAA0B,KAAa;QAErC,IAAM,SAAS,GAAY,SAAS,CAAC,MAAM,CAAC;QAE5C,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,KAAK,SAAS,EAAE;YAC7C,IAAI,CAAC,KAAK,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC;YAChD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAClC;IACH,CAAC;IAtEU,iBAAiB;QAL7B,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,4GAA4G;;;OAC/F,iBAAiB,CAuE7B;IAAD,wBAAC;CAAA;AAvE6B;;;;;;;;;;;;;;;;;;;;;;;;ACTa;AACO;AACU;AACK;AAC1B;AACkB;AACN;AASnD;IASE,yBACU,kBAAqC,EACrC,WAAuB,EACvB,oBAAyC;QAFzC,uBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,gBAAW,GAAX,WAAW,CAAY;QACvB,yBAAoB,GAApB,oBAAoB,CAAqB;QAR3C,iBAAY,GAAG,EAAE,CAAC;QAClB,eAAU,GAAG,EAAE,CAAC;QAChB,YAAO,GAAG,EAAE,CAAC;QACb,mBAAc,GAA6B,IAAI,oDAAe,CAAC,KAAK,CAAC,CAAC;QAQ5E,IAAI,CAAC,uBAAuB,GAAI,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAK,EAAE,CAAC,CAAC;IACnF,CAAC;IAED,2DAA2D;IACpD,0CAAgB,GAAvB,UAAwB,IAAY;QAElC,IAAI,GAAG,GAAe,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;QAE9C,IAAI,CAAC,GAAG,EAAE;YACR,GAAG,GAAG,IAAI,sEAAU,CAAC,IAAI,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;YACjG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;YAC9B,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SACpC;QAED,OAAO,GAAG,CAAC;IACb,CAAC;IAEM,0CAAgB,GAAvB,UAAwB,SAAkB,EAAE,KAAsB;QAAtB,qCAAsB;QAEhE,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAE3B,IAAI,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,EAAE;YAE5C,KAAK,CAAC,yDAAyD,CAAC,CAAC;YACjE,OAAO;SAER;aAAM;YAEL,IAAI,mBAAmB,GAAG,EAAE,CAAC;YAE7B,IAAI,SAAS,EAAE;gBAEb,0CAA0C;gBAC1C,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,YAAY,EAAE;oBAEnC,IAAI,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;wBAC3B,mBAAmB,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;qBACnD;iBACF;aAEF;iBAAM;gBACL,YAAY;gBACZ,mBAAmB,GAAG,IAAI,CAAC,YAAY,CAAC;aACzC;YAED,KAAK,IAAM,GAAG,IAAI,mBAAmB,EAAE;gBAErC,IAAI,GAAG,GAAe,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;gBAC7C,GAAG,CAAC,cAAc,EAAE,CAAC;gBACrB,GAAG,GAAG,IAAI,CAAC;gBAEX,IAAI,GAAG,GAAiB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;gBAC7C,GAAG,CAAC,WAAW,EAAE,CAAC;gBAClB,GAAG,GAAG,IAAI,CAAC;aACZ;YAED,IAAI,CAAC,SAAS,EAAE;gBACd,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;gBACvB,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;gBACrB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;aACnB;SACF;IACH,CAAC;IAEO,4CAAkB,GAA1B,UAA2B,IAAY,EAAE,UAAsB;QAA/D,iBAUC;QARC,iBAAiB;QACjB,IAAM,cAAc,GAAiB,UAAU,CAAC,IAAI,CAAC,SAAS,CAC5D,gBAAM;YACF,KAAI,CAAC,mBAAmB,EAAE,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,eAAe,CAAC;QACvD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,cAAc,CAAC;IACzC,CAAC;IAEO,6CAAmB,GAA3B;QAEE,IAAI,SAAS,GAAG,KAAK,CAAC;QAEtB,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,OAAO,EAAE;YAE9B,IAAM,cAAc,GAA6B,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAEnE,IAAI,cAAc,CAAC,QAAQ,EAAE,KAAK,IAAI,EAAE;gBACtC,SAAS,GAAG,IAAI,CAAC;aAClB;SACF;QAED,IAAI,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,KAAK,SAAS,EAAE;YAChD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACrC;IACH,CAAC;IA3GU,eAAe;QAP3B,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,qBAAqB;QACrB,mFAAmF;QACnF,iFAAiF;;+EAWjD,qEAAiB;YACxB,+DAAU;YACD,kEAAmB;OAZxC,eAAe,CA4G3B;IAAD,sBAAC;CAAA;AA5G2B;;;;;;;;;;;;;;;;;;;;;ACfa;AACO;AAC4B;AAC3B;AAQjD;IAOE;IAAe,CAAC;IAGhB,WAAW;IACE,6CAAiB,GAA9B;;;;4BAES,qBAAM,IAAI,CAAC,aAAa,EAAE;4BAAjC,sBAAO,SAA0B,EAAC;;;;KACnC;IAGO,yCAAa,GAArB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,OAAO,GAAQ,MAAM,CAAC;QAE5B,OAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;YAE1C,IAAI,KAAK,CAAC,IAAI,EAAE;gBACd,OAAO,CAAC,IAAI,CAAC,CAAC;gBACd,OAAO;aACR;YAED,IAAI,oEAAc,EAAE,EAAE;gBAEpB,8BAA8B;gBAE9B,OAAO,CAAC,yBAAyB,CAAC,gEAAU,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,UAAU,UAAU;oBAErF,KAAK,CAAC,IAAI,GAAG,UAAU,CAAC;oBACxB,KAAK,CAAC,OAAO,GAAG,UAAU,CAAC,CAAG,WAAW;oBACzC,KAAK,CAAC,QAAQ,GAAG,oEAAiB,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC;oBACvD,OAAO,CAAC,KAAK,CAAC,kBAAkB,GAAG,IAAI,CAAC,CAAC;gBAE3C,CAAC,EAAE,UAAU,KAAK;oBAChB,MAAM,CAAC,KAAK,CAAC,CAAC;oBACd,KAAK,CAAC,oBAAoB,GAAG,KAAK,CAAC,CAAC;gBACtC,CAAC,CAAC,CAAC;aAEJ;iBAAM;gBAEL,2BAA2B;gBAC3B,IAAM,kBAAkB,GAAG,MAAM,CAAC,mBAAmB,CAAC,IAAI,MAAM,CAAC,yBAAyB,CAAC,CAAC;gBAE5F,IAAI,kBAAkB,EAAE;oBAEtB,gDAAgD;oBAChD,kBAAkB,CAAC,CAAC,EAAE,CAAC,EAAE,UAAU,UAAU;wBAE3C,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;wBAE1C,KAAK,CAAC,IAAI,GAAG,UAAU,CAAC;wBACxB,KAAK,CAAC,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC;wBAChC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;wBAEzC,OAAO,CAAC,KAAK,CAAC,kBAAkB,GAAG,IAAI,CAAC,CAAC;oBAE3C,CAAC,EAAE,UAAU,KAAK;wBAChB,OAAO,CAAC,KAAK,CAAC,CAAC;wBACf,KAAK,CAAC,oBAAoB,GAAG,KAAK,CAAC,CAAC;oBACtC,CAAC,CAAC,CAAC;iBACJ;qBAAM;oBACL,OAAO,CAAC,KAAK,CAAC,CAAC;oBACf,KAAK,CAAC,yEAAyE,CAAC,CAAC;iBAClF;aACF;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAID,YAAY;IAEZ,0HAA0H;IACnH,0CAAc,GAArB,UAAsB,QAAgB,EAAE,MAAM,EAAE,QAAkB,EAAE,aAA4B;QAA5B,oDAA4B;QAE9F,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,YAAY,GAAkB,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAExD,IAAM,KAAK,GAAG,UAAU,iBAAgC,EAAE,EAAE,EAAE,EAAY;YAExE,KAAK,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,UAAS,SAAS;gBAE7E,iBAAiB,CAAC,KAAK,EAAE,CAAC;gBAE1B,IAAI,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE;oBAChC,KAAK,CAAC,iBAAiB,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;iBACzC;qBAAM;oBACL,EAAE,CAAC,SAAS,CAAC,CAAC;iBACf;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,KAAK,CAAC,YAAY,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;IACxC,CAAC;IAED,gHAAgH;IACzG,yCAAa,GAApB,UAAqB,OAAe,EAAE,MAAM,EAAE,aAAsB,EAAE,QAAkB;QAEtF,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC;QAE3C,IAAI,MAAM,KAAK,OAAO,IAAI,CAAC,MAAM,EAAE;YACjC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACjB,OAAO;SACR;QAED,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,EAAC,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAC,EAAE,UAAS,SAAS;YAE/E,QAAQ,CAAC,SAAS,CAAC,CAAC;QAEtB,CAAC,EAAE,UAAS,KAAK;YAEf,IAAI,KAAK,IAAI,aAAa,EAAE;gBAC1B,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;aACnD;iBAAM;gBAEL,OAAO,CAAC,GAAG,CAAC,YAAY,GAAG,OAAO,GAAG,kBAAkB,CAAC,CAAC;gBACzD,QAAQ,CAAC,OAAO,CAAC,CAAC;aACnB;QAEH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,6FAA6F;IACrF,4CAAgB,GAAxB,UAAyB,OAAe,EAAE,MAAM,EAAE,QAAkB;QAElE,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC;QAE3C,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,EAAC,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAC,EAAE,UAAS,SAAS;YAE9E,QAAQ,CAAC,SAAS,CAAC,CAAC;QAEtB,CAAC,EAAE,UAAS,KAAK;YACf,IAAI,KAAK,CAAC,IAAI,KAAK,EAAE,EAAE;gBACrB,KAAK,CAAC,aAAa,CAAC,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;aACvD;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,gDAAgD;IACzC,oCAAQ,GAAf,UAAgB,IAAS,EAAE,MAAW,EAAE,QAAgB,EAAE,QAAkB;QAE1E,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,YAAY,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACzC,IAAM,QAAQ,GAAG,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACvD,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAC3B,IAAM,YAAY,GAAG,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAE5C,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,MAAM,EAAE,UAAS,SAAS;YAC1D,KAAK,CAAC,WAAW,CAAC,SAAS,EAAE,QAAQ,EAAE,UAAS,SAAS;gBACvD,KAAK,CAAC,UAAU,CAAC,SAAS,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,4BAA4B;IACpB,uCAAW,GAAnB,UAAoB,QAAQ,EAAE,QAAgB,EAAE,QAAkB,EAAE,QAAwB;QAAxB,0CAAwB;QAE1F,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,QAAQ,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC;QAEjD,IAAI,QAAQ,KAAK,OAAO,IAAI,CAAC,QAAQ,EAAE;YACrC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACnB,OAAO;SACR;QAED,+DAA+D;QAC/D,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAC,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,QAAQ,EAAC,EAAE,UAAS,SAAS;YAEjF,QAAQ,CAAC,SAAS,CAAC,CAAC;QAEtB,CAAC,EAAE,UAAS,KAAK;YAEf,OAAO,CAAC,GAAG,CAAC,sBAAsB,GAAG,KAAK,CAAC,CAAC;YAE5C,KAAK,CAAC,QAAQ,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAE/C,CAAC,CAAC,CAAC;IACL,CAAC;IAED,0BAA0B;IAClB,sCAAU,GAAlB,UAAmB,IAAI,EAAE,IAAS,EAAE,QAAkB;QAEpD,IAAI,IAAI,YAAY,IAAI,KAAK,KAAK,EAAE;YAClC,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;gBAC5B,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;aAC7B;YACD,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,EAAC,IAAI,EAAG,kBAAkB,EAAC,CAAC,CAAC;SACtD;QAED,IAAI,CAAC,YAAY,CAAC,UAAU,UAAU;YAEpC,UAAU,CAAC,UAAU,GAAG;gBACtB,QAAQ,CAAC,SAAS,CAAC,CAAC;YACtB,CAAC,CAAC;YAEF,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC;gBACjC,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;YACxC,CAAC,CAAC;YAEF,UAAU,CAAC,OAAO,GAAG,UAAU,CAAC;gBAC9B,QAAQ,CAAC,OAAO,CAAC,CAAC;gBAClB,OAAO,CAAC,GAAG,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC;YACzC,CAAC,CAAC;YAEF,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,oBAAoB;IACb,iCAAK,GAAZ;QAEE,OAAO,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC;QACrD,kBAAkB;IACpB,CAAC;IAED,qEAAqE;IAC9D,oCAAQ,GAAf,UAAgB,SAAS,EAAE,QAAgB,EAAE,QAAkB;QAE7D,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE;YACjC,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,IAAI,EAAE,UAAU,MAAM;gBAEnD,IAAI,MAAM,KAAK,OAAO,EAAE;oBACtB,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;iBAC5C;qBAAM;oBACL,QAAQ,CAAC,MAAM,CAAC,CAAC;iBAClB;YACH,CAAC,EAAE,KAAK,CAAC,CAAC;SACX;IACH,CAAC;IAED,yCAAyC;IACjC,oCAAQ,GAAhB,UAAiB,QAAQ,EAAE,QAAgB,EAAE,QAAkB;QAE7D,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,QAAQ,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC;QAEjD,IAAI,QAAQ,KAAK,OAAO,IAAI,CAAC,QAAQ,EAAE;YACrC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACnB,OAAO;SACR;QAED,+DAA+D;QAC/D,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAC,MAAM,EAAE,KAAK,EAAC,EAAE,UAAS,SAAS;YAE5D,KAAK,CAAC,aAAa,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QAE3C,CAAC,EAAE,UAAS,KAAK;YAEf,OAAO,CAAC,GAAG,CAAC,OAAO,GAAG,QAAQ,GAAG,kBAAkB,CAAC,CAAC;YACrD,QAAQ,CAAC,OAAO,CAAC,CAAC;QACpB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,iCAAiC;IACzB,yCAAa,GAArB,UAAsB,SAAS,EAAE,QAAkB;QAEjD,SAAS,CAAC,IAAI,CAAC,UAAU,IAAI;YAE3B,IAAI,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;YAE9B,MAAM,CAAC,SAAS,GAAG;gBACjB,OAAO,CAAC,GAAG,CAAC,sBAAsB,EAAE,SAAS,CAAC,CAAC;gBAE/C,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;gBAEvB,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;oBAC5B,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;iBACzB;gBAED,QAAQ,CAAC,IAAI,CAAC,CAAC;YACjB,CAAC,CAAC;YAEF,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAE1B,CAAC,EAAE,UAAS,KAAK;YACf,QAAQ,CAAC,OAAO,CAAC,CAAC;YAClB,KAAK,CAAC,oBAAoB,GAAG,KAAK,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,iCAAK,GAAZ,UAAa,QAAgB,EAAE,KAAsB;QAAtB,qCAAsB;QAEnD,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAM,WAAW,GAA4B,IAAI,oDAAe,CAAS,EAAC,KAAK,EAAC,YAAY,EAAC,CAAC,CAAC;QAE/F,IAAI,4DAAM,EAAE,EAAE;YAEZ,IAAI,UAAU,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAK,iEAAiE;YAE3G,IAAM,aAAa,GAAkB,QAAQ,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;YAChE,aAAa,CAAC,GAAG,EAAE,CAAC;YACpB,IAAM,aAAa,GAAG,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;YAE3D,IAAM,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,gEAAU,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC,CAAC;YACzE,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,gEAAU,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC,CAAC;YAEtF,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;YAE9B,4DAAM,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,WAAW,EAAE,UAAS,CAAC;gBACzC,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,EAAC,CAAC,CAAC;gBAEvD,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;gBAE3B,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,UAAU,EAAC,CAAC,CAAC;YACxC,CAAC,EAAE,UAAS,aAAa;gBACvB,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,aAAa,CAAC,MAAM,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,EAAC,CAAC,CAAC;YACxG,CAAC,CAAC,CAAC;SACJ;aAAM;YAEL,KAAK,CAAC,6CAA6C,CAAC;YAEpD,WAAW,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,OAAO,EAAC,CAAC,CAAC;SACpC;QAED,OAAO,WAAW,CAAC;IACrB,CAAC;IAEO,sCAAU,GAAlB,UAAmB,QAAuB;QACxC,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACvB,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC;YAC9C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACxC,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC;aACnE;YACD,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;SAC1B;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,6DAA6D;IAC7D,+BAA+B;IAC/B,EAAE;IACF,IAAI;IAEJ,2CAA2C;IACpC,sCAAU,GAAjB,UAAkB,QAAgB;QAEhC,IAAM,aAAa,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC1C,IAAM,SAAS,GAAW,aAAa,CAAC,GAAG,EAAE,CAAC;QAC9C,IAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;QAEjD,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE,IAAI,EAAE,UAAS,QAAQ;YACrD,QAAQ,CAAC,OAAO,CAAC,SAAS,EAAE,EAAC,MAAM,EAAE,KAAK,EAAC,EAAE,UAAS,SAAS;gBAC7D,SAAS,CAAC,MAAM,CAAC,UAAU,IAAI;oBAC7B,4BAA4B;oBAC5B,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;gBAC9B,CAAC,EAAE,UAAU,GAAG;oBACd,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,4BAA4B;gBAChD,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACL,CAAC,EAAE,KAAK,CAAC,CAAC;IACZ,CAAC;IAED,wCAAwC;IACjC,2CAAe,GAAtB,UAAuB,aAAqB,EAAE,QAAkB;QAE9D,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,IAAI,EAAE,UAAS,QAAQ;YACxD,IAAI,QAAQ,KAAK,OAAO,EAAE;gBAExB;uEACuD;gBACvD,QAAQ,CAAC,iBAAiB,CAAC,UAAU,SAAS;oBAE5C,QAAQ,CAAC,SAAS,CAAC,CAAC;gBACtB,CAAC,EAAE,UAAU,KAAK;oBAChB,6DAA6D;oBAC7D,KAAK,CAAC,0BAA0B,GAAG,KAAK,CAAC,CAAC;oBAC1C,QAAQ,CAAC,KAAK,CAAC,CAAC;gBAClB,CAAC,CAAC,CAAC;aAEJ;iBAAM;gBAEL,QAAQ,CAAC,QAAQ,CAAC,CAAC;aACpB;QACH,CAAC,EAAE,KAAK,CAAC,CAAC;IACZ,CAAC;IApYU,iBAAiB;QAN7B,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,8DAA8D;QAC9D,6DAA6D;;;OAChD,iBAAiB,CAqY7B;IAAD,wBAAC;CAAA;AArY6B;;;;;;;;;;;;;;;;;;;ACXa;AACQ;AAOnD;IAEE;QAEQ,oBAAe,GAAiC,IAAI,oDAAe,CAAS,EAAE,CAAC,CAAC;QACjF,YAAO,GAA2B,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;IAH9D,CAAC;IAKT,mCAAW,GAAlB;QAEE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAC,CAAC,CAAC;IAC5D,CAAC;IAEM,mCAAW,GAAlB;QAEE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAC,CAAC,CAAC;IAC5D,CAAC;IAEM,mCAAW,GAAlB;QAEE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAC,CAAC,CAAC;IAC/D,CAAC;IAEM,mCAAW,GAAlB,UAAmB,OAAe;QAEhC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAC,CAAC,CAAC;IAC9E,CAAC;IAEM,kCAAU,GAAjB,UAAkB,KAAa,EAAE,MAAgB;QAE/C,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAC,EAAC,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAC,EAAC,CAAC,CAAC;IACnG,CAAC;IAED,2BAA2B;IACpB,mCAAW,GAAlB,UAAmB,IAAa;QAE9B,IAAI,CAAC,IAAI,EAAE;YACT,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;aAAM;YACL,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC;SACzD;IACH,CAAC;IAxCU,aAAa;QALzB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,sFAAsF;;;OACzE,aAAa,CAyCzB;IAAD,oBAAC;CAAA;AAzCyB;;;;;;;;;;;;;;;;;;;;;;;ACR2B;AACF;AACE;AACa;AAEA;AAChB;AAQlD;IAsBE;;;mDAG+C;IAE/C,yBACU,aAAkC,EAClC,eAAsC;QADtC,kBAAa,GAAb,aAAa,CAAqB;QAClC,oBAAe,GAAf,eAAe,CAAuB;QAzBhD,qBAAqB;QACb,oBAAe,GAAiC,IAAI,oDAAe,CAAS,MAAM,CAAC,CAAC;QACpF,cAAS,GAAuC,IAAI,oDAAe,CAAS,SAAS,CAAC,CAAC;QACvF,gBAAW,GAAqC,IAAI,oDAAe,CAAS,CAAC,CAAC,CAAC;QAEvF,qBAAqB;QACd,mBAAc,GAA2B,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;QAC7E,aAAQ,GAAiC,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;QACvE,eAAU,GAA+B,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;QAOxE,kBAAa,GAAe,KAAK,CAAC;QAClC,yBAAoB,GAAQ,EAAE,CAAC;QAWrC,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;QAEhC,IAAI,oEAAc,EAAE,EAAE;YACpB,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YACzD,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SAC5D;IACH,CAAC;IAED,qCAAqC;IAC9B,wCAAc,GAArB,UAAsB,KAAsB;QAAtB,qCAAsB;QAE1C,IAAM,SAAS,GAAY,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAEjF,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC;QAE5D,IAAI,IAAI,CAAC,aAAa,EAAE;YAEtB,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;YAEpC,IAAI,SAAS,EAAE;gBACb,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;gBACzB,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;iBAAM;gBACL,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;SAEF;aAAM;YACL,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;YACpC,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;IACH,CAAC;IAED,oBAAoB;IACZ,2CAAiB,GAAzB;QACE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC;IACpE,CAAC;IAEO,wCAAc,GAAtB;QAEE,IAAM,aAAa,GAAG;YACpB,kBAAkB,EAAE,IAAI;YACxB,UAAU,EAAE,IAAI;YAChB,eAAe,EAAE,IAAI;SACtB,CAAC;QAEF,IAAI,SAAS,CAAC,WAAW,EAAE;YAEzB,IAAI,CAAC,gBAAgB,GAAI,SAAS,CAAC,WAAW,CAAC,aAAa,CAC1D,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAC9B,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,EACnC,aAAa,CAAC,CAAC;SAClB;aAAM;YACL,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;SAChC;IACH,CAAC;IAEO,uCAAa,GAArB,UAAsB,QAAyB;QAAzB,2CAAyB;QAE7C,IAAI,SAAS,CAAC,WAAW,EAAE;YACzB,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC;YAEvD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAEzB,IAAI,CAAC,QAAQ,EAAE;gBACb,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gBAC/B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC,CAAC;gBAC9C,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;gBAC9B,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;aACjC;SACF;IACH,CAAC;IAEO,wCAAc,GAAtB,UAAuB,QAAa;QAElC,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;YAEhC,IAAM,UAAU,GAAoB,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC;YAE9G,IAAI,aAAa,GAAa,UAAU,CAAC,CAAC,CAAC,CAAC;YAE5C,IAAM,aAAa,GAAW,QAAQ,GAAG,0EAAW,CAAC,IAAI,CAAC;YAE1D,IAAI,aAAa,IAAI,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,aAAa,EAAE;gBACpE,wIAAwI;gBACxI,aAAa,GAAG,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;aACnD;iBAAM;gBACL,sDAAsD;gBACtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;oBAC9C,IAAI,UAAU,CAAC,CAAC,CAAC,CAAC,aAAa,IAAI,aAAa,IAAI,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,aAAa,IAAI,aAAa,EAAE;wBACpG,aAAa,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,aAAa,GAAG,aAAa,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,aAAa,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;wBACxK,MAAM;qBACP;iBACF;aACF;YAED,QAAQ,GAAG;gBACT,MAAM,EAAE;oBACN,QAAQ,EAAE,aAAa,CAAC,QAAQ;oBAChC,SAAS,EAAE,aAAa,CAAC,SAAS;oBAClC,QAAQ,EAAE,aAAa,CAAC,SAAS;iBAClC;gBACD,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE;aAChC,CAAC;YAEF,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;SAEtC;aAAM,IAAI,QAAQ,EAAC;YAElB,kDAAkD;YAClD,IAAI,CAAC,IAAI,CAAC,iBAAiB;gBACzB,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,KAAK,QAAQ,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC;oBAC/E,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,KAAK,QAAQ,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC;oBACjF,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,KAAK,QAAQ,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,EAAE;gBAEjF,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;aAChC;YAED,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC;SACnC;IACH,CAAC;IAEO,yCAAe,GAAvB,UAAwB,QAAgB,EAAE,QAAyB;QAAzB,2CAAyB;QACjE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC9B,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;IACtC,CAAC;IAEO,6CAAmB,GAA3B,UAA4B,KAAK;QAE/B,IAAI,aAAa,CAAC;QAElB,QAAQ,KAAK,CAAC,IAAI,EAAE;YAClB,KAAK,KAAK,CAAC,iBAAiB;gBAC1B,aAAa,GAAG,sBAAsB,CAAC;gBACvC,MAAM;YACR,KAAK,KAAK,CAAC,oBAAoB;gBAC7B,aAAa,GAAG,uBAAuB,CAAC;gBACxC,MAAM;YACR,KAAK,KAAK,CAAC,OAAO;gBAChB,aAAa,GAAG,mBAAmB,CAAC;gBACpC,MAAM;YACR,KAAK,KAAK,CAAC,aAAa;gBACtB,aAAa,GAAG,gBAAgB,CAAC;gBACjC,MAAM;SACT;QAED,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;IACnC,CAAC;IAEO,4CAAkB,GAA1B,UAA2B,KAAa;QACtC,qBAAqB;QACrB,IAAI,KAAK,KAAK,IAAI,CAAC,oBAAoB,EAAE;YACvC,IAAI,CAAC,oBAAoB,GAAG,KAAK,CAAC;YAClC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;SACtD;IACH,CAAC;IAEM,sCAAY,GAAnB;QACE,IAAI,IAAI,CAAC,eAAe,CAAC,KAAK,KAAK,UAAU,EAAE;YAC7C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;SAC7C;IACH,CAAC;IAGD,4CAA4C;IAEpC,kCAAQ,GAAhB,UAAiB,KAAK;QACpB,IAAI,IAAI,CAAC,aAAa,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YAChD,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;SACrB;IACH,CAAC;IAEO,mCAAS,GAAjB,UAAkB,KAAK;QACrB,IAAI,IAAI,CAAC,aAAa,KAAK,KAAK,IAAI,IAAI,CAAC,OAAO,EAAE;YAChD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;YAC1B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;SACtB;IACH,CAAC;IAhNU,eAAe;QAN3B,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF;oFAC4E;;+EA6BjD,kEAAmB;YACjB,8EAAqB;OA7BrC,eAAe,CAiN3B;IAAD,sBAAC;CAAA;AAjN2B;;;;;;;;;;;;;;;;;;;;;;;;;;ACdwB;AACD;AACa;AACD;AAC1B;AAEM;AACK;AACO;AACS;AAyBhE;IAeE,qBACU,aAAkC,EAClC,eAAsC,EACtC,KAAiB,EACjB,kBAAqC;QAHrC,kBAAa,GAAb,aAAa,CAAqB;QAClC,oBAAe,GAAf,eAAe,CAAuB;QACtC,UAAK,GAAL,KAAK,CAAY;QACjB,uBAAkB,GAAlB,kBAAkB,CAAmB;QANvC,uBAAkB,GAAG,KAAK,CAAC;QAQjC,IAAI,CAAC,WAAW,GAAG,IAAI,oDAAe,CAAC,YAAY,CAAC,CAAC;QACrD,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAK,EAAE,CAAC,CAAC;QAExE,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAED,iCAAW,GAAX;QAEE,IAAI,IAAI,CAAC,kBAAkB,EAAE;YAC3B,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;YACtC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;SAChC;QAED,IAAI,IAAI,CAAC,uBAAuB,EAAE;YAChC,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;YAC3C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;SACrC;QAED,kBAAkB;QAClB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;IACjC,CAAC;IAEO,yCAAmB,GAA3B;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAM,MAAM,GAAU,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;QAC1D,IAAM,gBAAgB,GAAW,CAAC,MAAM,CAAC,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;QAE5E,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAE,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,gBAAgB,GAAG,QAAQ,CAAC,CAAC,SAAS,CAAC,UAAS,MAAM;YAC9H,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC1C,KAAK,CAAC,WAAW,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAS,MAAe;YAC1G,IAAI,MAAM,KAAK,IAAI,EAAE;gBACnB,KAAK,CAAC,WAAW,EAAE,CAAC;aACrB;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,uEAAuE;IAC/D,iCAAW,GAAnB,UAAoB,KAAkB;QAEpC,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YAC9B,OAAO;SACR;QAED,IAAM,cAAc,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAE/C,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YAEvB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;YAExB,qCAAqC;YACrC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;SAE5B;aAAM;YAEL,sBAAsB;YACtB,IAAI,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;SACvC;IACH,CAAC;IAEO,oCAAc,GAAtB,UAAuB,KAAkB;QAEvC,IAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC;QAC7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAEhC,IAAM,KAAK,GAAS,KAAK,CAAC,CAAC,CAAC,CAAC;YAC7B,IAAM,QAAQ,GAAW,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;YAEjE,IAAI,QAAQ,EAAE;gBACZ,IAAI,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE;oBAC7B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;iBACtE;qBAAM;oBACL,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;iBACpE;aACF;iBAAM;gBACL,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;gBAC7C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;aACpE;YAED,0BAA0B;YAC1B,IAAI,CAAC,KAAK,OAAO,GAAG,CAAC,EAAE;gBACrB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACvB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aAChC;SACF;IACH,CAAC;IAED,wDAAwD;IACjD,8BAAQ,GAAf,UAAgB,IAAY,EAAE,EAAU;QAEtC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,OAAO;SACR;QAED,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IACtC,CAAC;IAED,iDAAiD;IAC1C,iCAAW,GAAlB;QACE,OAAO,IAAI,CAAC,SAAS,CAAC;IACxB,CAAC;IAED,6EAA6E;IACtE,gCAAU,GAAjB,UAAkB,MAAc,EAAE,IAAY,EAAE,EAAU;QAExD,IAAM,MAAM,GAAgB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;QACzD,IAAI,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;QAC5B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAEhC,IAAM,KAAK,GAAS,MAAM,CAAC,CAAC,CAAC,CAAC;YAE9B,IAAI,KAAK,CAAC,EAAE,KAAK,MAAM,EAAE;gBAEvB,IAAI,CAAC,SAAS,GAAG,+DAAS,CAAC,KAAK,CAAS,CAAC;gBAE1C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC1C,MAAM;aACP;SACF;QAED,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QAC7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAEhC,IAAM,KAAK,GAAS,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YAEnC,IAAI,KAAK,CAAC,EAAE,KAAK,MAAM,EAAE;gBACvB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACzB,MAAM;aACP;SACF;QAED,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAEO,oCAAc,GAAtB;QACE,IAAM,MAAM,GAAU,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;QAC1D,IAAM,gBAAgB,GAAW,CAAC,MAAM,CAAC,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;QAC5E,IAAI,CAAC,aAAa,CAAC,KAAK,CAAE,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,gBAAgB,GAAG,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IAC1G,CAAC;IAEO,sCAAgB,GAAxB;QAEE,IAAM,MAAM,GAAU,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;QAC1D,IAAM,gBAAgB,GAAW,CAAC,MAAM,CAAC,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;QAC5E,IAAM,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAE,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,gBAAgB,GAAG,QAAQ,CAAC,CAAC;QAEnG,IAAI,YAAY,KAAK,IAAI,IAAI,YAAY,KAAK,SAAS,IAAI,YAAY,KAAK,EAAE,EAAE;YAC9E,OAAO;SACR;QAED,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;QAEvC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAChC,CAAC;IAEM,8BAAQ,GAAf,UAAgB,IAAU;QAExB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;SAClB;QAED,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEvB,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;QAEzB,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;SAC9C;QAED,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAED,wCAAwC;IACjC,uCAAiB,GAAxB;QACE,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED;+GAC2G;IACnG,iCAAW,GAAnB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,mBAAmB;QACnB,IAAI,IAAI,CAAC,kBAAkB,CAAC,KAAK,KAAK,QAAQ,EAAE;YAC9C,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;YAC/B,OAAO;SACR;QAED,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE;YAE5D,IAAM,eAAe,GAAgB,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAElE,SAAS;YACT,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;gBAE9B,IAAM,MAAM,GAAU,KAAK,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC;gBAC3D,IAAM,gBAAgB,GAAW,CAAC,MAAM,CAAC,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;gBAE5E,gCAAgC;gBAChC,IAAM,OAAO,GAAG,IAAI,QAAQ,EAAE,CAAC;gBAC/B,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;gBACrC,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;gBAC9C,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;gBACjE,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC,CAAC;gBAExD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,0EAAW,CAAC,MAAM,EAAE,OAAO,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC;gBAC5F,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAS,MAAc;oBAE/E,IAAI,MAAM,KAAK,SAAS,EAAE;wBAExB,wEAAwE;wBACxE,IAAI,KAAK,CAAC,kBAAkB,EAAE;4BAC5B,KAAK,CAAC,kBAAkB,GAAG,KAAK,CAAC;4BACjC,KAAK,CAAC,+DAA+D,CAAC,CAAC;yBACxE;wBAED,KAAK,CAAC,oBAAoB,EAAE,CAAC;qBAC9B;yBAAM;wBACL,KAAK,CAAC,2CAA2C,CAAC,CAAC;qBACpD;oBAED,KAAK,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;oBACxC,KAAK,CAAC,mBAAmB,GAAG,IAAI,CAAC;gBACnC,CAAC,EAAE,UAAS,KAAK;oBAEf,iBAAiB;oBACjB,KAAK,CAAC,2CAA2C,CAAC,CAAC;gBACrD,CAAC,CAAC,CAAC;aACJ;SACF;IACH,CAAC;IAEO,0CAAoB,GAA5B;QAEE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAS,IAAU;YACrC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;aACpB;QACH,CAAC,CAAC,CAAC;QAEH,mBAAmB;QACnB,IAAI,CAAC,cAAc,EAAE,CAAC;QAEtB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;IACzC,CAAC;IAEO,2CAAqB,GAA7B;QAEE,IAAM,eAAe,GAAgB,EAAE,CAAC;QAExC,wEAAwE;QACxE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAS,IAAU;YAErC,IAAI,IAAI,CAAC,KAAK,EAAE;gBAEd,IAAM,MAAM,GAAS,+DAAS,CAAC,IAAI,CAAS,CAAC;gBAC7C,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aAC9B;QACH,CAAC,CAAC,CAAC;QAEH,OAAO,eAA8B,CAAC;IACxC,CAAC;IAlSU,WAAW;QAtBvB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF;;;;;;;;;;;;;;;UAeE;QAEF,2EAA2E;;+EAiBhD,kEAAmB;YACjB,8EAAqB;YAC/B,+DAAU;YACG,qEAAiB;OAnBpC,WAAW,CAmSvB;IAAD,kBAAC;CAAA;AAnSuB;;;;;;;;;;;;;;;;;;;AClCmB;AACM;AAQjD;IAOE;QAHQ,iBAAY,GAA4B,IAAI,oDAAe,CAAC,IAAI,CAAC,CAAC;QAIxE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC;IAC9D,CAAC;IAEM,0CAAa,GAApB;QACE,8BAA8B;QAC9B,qHAAqH;QACrH,+BAA+B;QAC/B,QAAQ;QACR,IAAI;IACN,CAAC;IAEM,yCAAY,GAAnB;QACE,8BAA8B;QAC9B,gEAAgE;QAChE,kCAAkC;QAClC,IAAI;IACN,CAAC;IAEO,+CAAkB,GAA1B,UAA2B,KAAK;QAC9B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;IAC5C,CAAC;IA5BU,kBAAkB;QAN9B,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,kHAAkH;QAClH,qIAAqI;;;OACxH,kBAAkB,CA8B9B;IAAD,yBAAC;CAAA;AA9B8B;;;;;;;;;;;;;;;;;;;;;;;;;ACTqB;AAEP;AACa;AACP;AACa;AAChB;AAEU;AACH;AAQvD;IAYE,qBACU,aAAkC,EAClC,eAAsC,EACtC,kBAAqC,EACrC,KAAiB;QAHjB,kBAAa,GAAb,aAAa,CAAqB;QAClC,oBAAe,GAAf,eAAe,CAAuB;QACtC,uBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,UAAK,GAAL,KAAK,CAAY;QAdnB,iBAAY,GAAG,CAAC,CAAC;QACjB,iBAAY,GAAG,KAAK,CAAC;QAGrB,kBAAa,GAAkB,EAAE,CAAC,CAAE,oCAAoC;IAWhF,CAAC;IAED,YAAY;IAEZ,iCAAW,GAAX;QACE,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;QAC3C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;IACtC,CAAC;IAED,oEAAoE;IACpE,gEAAgE;IAChE,+CAA+C;IAC/C,oGAAoG;IAC7F,2BAAK,GAAZ;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC;QACjE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC;QAEpG,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAS,MAAM;YAEjG,iCAAiC;YACjC,IAAI,MAAM,KAAK,KAAK,CAAC,YAAY,IAAI,MAAM,KAAK,IAAI,EAAE;gBACpD,KAAK,CAAC,YAAY,GAAG,MAAM,CAAC;gBAC5B,KAAK,CAAC,SAAS,EAAE,CAAC;aACnB;iBAAM;gBACL,KAAK,CAAC,YAAY,GAAG,MAAM,CAAC;aAC7B;QAEH,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,+BAAS,GAAjB;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAI,QAAQ,GAAG,CAAC,CAAC;QAEjB,IAAM,uBAAuB,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACrD,IAAI,kBAAkB,GAAG,CAAC,CAAC;QAC3B,IAAI,KAAK,CAAC,OAAO,CAAC,uBAAuB,CAAC,EAAE;YAC1C,kBAAkB,GAAG,uBAAuB,CAAC,QAAQ,CAAC,CAAC;SACxD;QAED,kBAAkB;QAClB,IAAI,mBAAmB,GAAG,mDAAM,CAC9B,uBAAuB,EACvB,IAAI,CAAC,iBAAiB,EAAE,CACzB,CAAC,SAAS,CAAC,UAAS,MAAM;YAEzB,IAAI,QAAQ,KAAK,kBAAkB,EAAE;gBAEnC,iDAAiD;gBACjD,IAAI,MAAM,IAAI,CAAC,mEAAa,CAAC,MAAM,CAAC,EAAE;oBAEpC,IAAM,WAAW,GAAiB,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,UAAS,GAAG;wBAEpE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE;4BAC3C,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC,CAAK,8EAA8E;yBAC3G;wBAED,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC;oBACrB,CAAC,CAAC,CAAC;oBAEH,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;oBAC5D,KAAK,CAAC,oBAAoB,EAAE,CAAC;iBAC9B;gBAED,wDAAwD;gBACxD,KAAK,CAAC,YAAY,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;gBAC1C,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,gBAAgB,GAAG,qBAAqB,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;gBAC9F,mBAAmB,CAAC,WAAW,EAAE,CAAC;gBAClC,mBAAmB,GAAG,IAAI,CAAC;aAC5B;iBAAM;gBACL,QAAQ,EAAG,CAAC;aACb;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAGD,sHAAsH;IAC/G,mCAAa,GAApB;QAEE,0BAA0B;QAC1B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC,IAAI,EAAE,CAAC;QAEzF,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,KAAK,CAAC,CAAC,EAAE;YAExD,IAAM,eAAa,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;YAE/C,IAAI,eAAa,EAAE;gBAEjB,IAAM,UAAU,GAA8B,EAAE,CAAC;gBAEjD,IAAM,IAAI,GAAW,mCAAmC,GAAG,IAAI,CAAC,gBAAgB,GAAG,aAAa,CAAC;gBACjG,IAAM,OAAO,GAAG,eAAa,CAAC,MAAM,CAAC;wCAE5B,CAAC;oBACR,IAAM,iBAAiB,GAAuB,OAAK,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,eAAa,CAAC,CAAC,CAAC,CAAC,CAAC;oBACtF,iBAAiB,CAAC,SAAS,CAAC,UAAS,MAAM;wBACzC,eAAa,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC;oBACnC,CAAC,CAAC,CAAC;oBAEH,UAAU,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;;;gBANrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE;4BAAvB,CAAC;iBAOT;gBAED,OAAO,UAAU,CAAC;aAEnB;iBAAM;gBAEL,OAAO,+CAAE,CAAC,IAAI,CAAC,CAAC;aACjB;SAEF;aAAM;YAEL,OAAO,+CAAE,CAAC,IAAI,CAAC,CAAC;SACjB;IACH,CAAC;IAED,kCAAkC;IAC3B,iCAAW,GAAlB,UAAmB,MAA4B;QAA/C,iBA0BC;QAxBC,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAM,iBAAe,GAA8B,EAAE,CAAC;YAEtD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;gBAC1B,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC;aACnB;YAED,IAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;YAE9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;gBAChC,iBAAe,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACxD;YAED,IAAI,OAAK,GAAG,CAAC,CAAC;YACd,mDAAM,CAAC,iBAAe,CAAC,CAAC,SAAS,CAAC,UAAC,MAAM;gBAEvC,OAAK,EAAE,CAAC;gBACR,IAAI,OAAK,KAAK,iBAAe,CAAC,MAAM,EAAE;oBACpC,KAAI,CAAC,oBAAoB,EAAE,CAAC;iBAC7B;YACH,CAAC,CAAC;SACH;aAAM;YACL,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;IACH,CAAC;IAGD,4FAA4F;IAC5F,sDAAsD;IACtD,sGAAsG;IACtG,mDAAmD;IAC5C,mCAAa,GAApB,UAAqB,IAAY,EAAE,QAAkB,EAAE,MAAsB;QAAtB,sCAAsB;QAE3E,IAAM,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAE5G,IAAI,OAAe,CAAC;QAEpB,IAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;QAC1C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,GAAG,EAAE;gBACpC,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;gBAChC,OAAO,CAAC,aAAa,EAAE,CAAC,CAAI,uCAAuC;gBACnE,MAAM;aACP;SACF;QAED,IAAI,CAAC,OAAO,IAAI,MAAM,EAAE;YACtB,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YACzC,OAAO,GAAG,IAAI,mDAAM,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,CAAC;YAC/E,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAClC;QAED,OAAO,OAAO,CAAC;IACjB,CAAC;IAEO,yCAAmB,GAA3B,UAA4B,IAAY,EAAE,QAAkB;QAE1D,IAAM,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAE3G,IAAI,kBAAgC,CAAC;QAErC,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;QACzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAEhC,IAAM,MAAM,GAAU,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAC3C,IAAI,MAAM,CAAC,SAAS,KAAK,EAAE,EAAE;gBAE3B,IAAI,CAAC,kBAAkB,EAAE;oBACvB,kBAAkB,GAAG,EAAE,CAAC;iBACzB;gBACD,kBAAkB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACjC;SACF;QAED,OAAO,kBAAkB,CAAC;IAC5B,CAAC;IAED,+CAA+C;IAC/C,iFAAiF;IACzE,uCAAiB,GAAzB;QAEE,IAAI,MAAM,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC;QACpC,IAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAEzC,IAAM,IAAI,GAAW,mCAAmC,GAAG,UAAU,GAAG,aAAa;YACnF,sBAAsB;YACtB,WAAW,GAAG,MAAM,GAAG,EAAE,CAAC;QAE5B,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IAED;;wCAEoC;IAC5B,qCAAe,GAAvB;QAEE,IAAM,eAAe,GAAiB,EAAE,CAAC;QAEzC,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;QACzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;SAEjC;IACH,CAAC;IAED,kFAAkF;IAC1E,uCAAiB,GAAzB;QAEE,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,KAAK,CAAC,CAAC,EAAE;YACzD,OAAO;SACR;QAED,IAAM,OAAO,GAAG,EAAE,CAAC;QACnB,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;QACzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE;gBACjC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;aACpC;SACF;QAED,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC;IACpD,CAAC;IAGO,sCAAgB,GAAxB,UAAyB,KAAY;QAEnC,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAI,UAAU,GAAU,+DAAS,CAAC,KAAK,CAAU,CAAC;QAClD,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;QAE3B,IAAM,UAAU,GAAW,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC;QACpE,IAAM,IAAI,GAAW,mCAAmC,GAAG,UAAU,GAAG,QAAQ,CAAC;QACjF,IAAM,OAAO,GAAW,OAAO,CAAC;QAEhC,IAAI,WAA+B,CAAC;QAEpC,IAAI,UAAU,CAAC,IAAI,IAAI,UAAU,CAAC,KAAK,GAAG,CAAC,EAAE;YAE3C,iBAAiB;YACjB,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,GAAG,GAAG,GAAG,UAAU,CAAC,IAAI,GAAG,OAAO,EAAE,UAAU,CAAC,CAAC;SAClF;aAAM,IAAI,UAAU,CAAC,IAAI,EAAE;YAE1B,mBAAmB;YACnB,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,UAAU,CAAC,IAAI,GAAG,OAAO,CAAC,CAAC;SACzE;aAAM;YAEL,cAAc;YACd,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,OAAO,EAAE,UAAU,CAAC,CAAC;SAC3D;QAED,IAAI,IAAI,GAAG,WAAW,CAAC,SAAS,CAC9B,UAAS,MAAM;YAEb,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC;YAEvB,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;gBACf,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;aAC7B;YAED,IAAI,MAAM,KAAK,IAAI,EAAE;gBACnB,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;gBAChE,KAAK,GAAG,IAAI,CAAC;aACd;YAED,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,IAAI,GAAG,IAAI,CAAC;QACd,CAAC,CACF,CAAC;QAEF,UAAU,GAAG,IAAI,CAAC;QAClB,OAAO,WAAW,CAAC;IACrB,CAAC;IAEO,0CAAoB,GAA5B;QACE,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,gBAAgB,GAAG,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;IACjF,CAAC;IAzTU,WAAW;QANvB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAGF,6GAA6G;;+EAclF,kEAAmB;YACjB,8EAAqB;YAClB,qEAAiB;YAC9B,+DAAU;OAhBhB,WAAW,CA0TvB;IAAD,kBAAC;CAAA;AA1TuB;;;;;;;;;;;;;;;;;;;;;ACjB4B;AACW;AACZ;AACd;AAOrC;IAQE,2BAAoB,aAAkC;QAAlC,kBAAa,GAAb,aAAa,CAAqB;QAEpD,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,4BAA4B;QAC5B,KAAK,CAAC,uBAAuB,GAAG,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,UAAS,MAAM;YAEjG,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAErC,KAAK,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;QAElC,CAAC,CAAC,CAAC;QAEH,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;QAE3D,KAAK,CAAC,iBAAiB,GAAG,IAAI,oDAAe,CAAC,QAAQ,CAAC,CAAC;QACxD,KAAK,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;QAClC,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAK,EAAE,CAAC,CAAC;IACtF,CAAC;IAEO,6CAAiB,GAAzB,UAA0B,IAAY;QAEpC,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAM,MAAM,GAAmB,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QAExF,MAAM,CAAC,OAAO,CAAC,UAAS,CAAC;YACvB,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;QAEH,IAAI,IAAI,CAAC,kBAAkB,EAAE;YAC3B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,UAAU,CAAC;gBACzC,KAAK,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC;IACnC,CAAC;IAED,2CAA2C;IACnC,6CAAiB,GAAzB,UAA0B,IAAY;QAEpC,IAAI,IAAI,KAAK,SAAS,IAAI,CAAC,IAAI,EAAE;YAC/B,OAAO;SACR;QAED,IAAM,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC;QAC5B,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAE7C,KAAK,CAAC,IAAI,GAAG,UAAU,CAAC;QACxB,KAAK,CAAC,GAAG,GAAG,YAAY,CAAC;QACzB,KAAK,CAAC,IAAI,GAAG,aAAa,GAAG,IAAI,GAAG,MAAM,CAAC;QAC3C,KAAK,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QAEtC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;IAC3B,CAAC;IAEO,qDAAyB,GAAjC,UAAkC,IAAY;QAE5C,IAAI,IAAI,KAAK,SAAS,EAAE;YACtB,OAAO;SACR;QAED,IAAM,KAAK,GAAG,QAAQ,CAAC,gBAAgB,CAAC,cAAc,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QACzE,IAAI,KAAK,EAAE;YACT,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SACrC;IACH,CAAC;IAED,uCAAW,GAAX;QAEE,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;QAC3C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;IACtC,CAAC;IAjFU,iBAAiB;QAL7B,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,iEAAiE;;+EAS5B,kEAAmB;OAR3C,iBAAiB,CAkF7B;IAAD,wBAAC;CAAA;AAlF6B;;;;;;;;;;;;;;;;;;;;;;;;;ACVW;AACyB;AACJ;AAEP;AACS;AACb;AACL;AACmE;AAYjH;IAKE,mCACU,gBAAwC,EACxC,cAAoC,EACpC,kBAAqC,EACrC,aAAkC;QAHlC,qBAAgB,GAAhB,gBAAgB,CAAwB;QACxC,mBAAc,GAAd,cAAc,CAAsB;QACpC,uBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,kBAAa,GAAb,aAAa,CAAqB;IACzC,CAAC;IAEJ,6BAA6B;IACvB,2CAAO,GAAb,UAAc,KAA6B,EAAE,KAA0B;;;;gBAE/D,KAAK,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;gBACpB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;gBAEpB,IAAI,CAAC,QAAQ,EAAE,CAAC;gBAEhB,yBAAyB;gBACzB,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,4BAA4B,CAAC,EAAE;oBAE3D,sBAAO,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE,MAAM;4BACzC,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,UAAS,KAAK;gCACrD,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;4BACnC,CAAC,CAAC,CAAC;wBACL,CAAC,CAAC,EAAC;iBAEJ;qBAAM;oBAEL,sBAAO,IAAI,CAAC,UAAU,EAAE,EAAC;iBAC1B;;;;KACF;IAGD,wDAAwD;IACxD,iEAAiE;IAC1D,4CAAQ,GAAf;QAEE,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,6BAA6B;QAC7B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC,CAAC;QAE9C,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAE1D,IAAI,SAAS,KAAK,KAAK,EAAE;YAEvB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;YAE3C,iCAAiC;YACjC,IAAM,cAAc,GAAkB,kEAAgB,EAAE,CAAC;YAEzD,kFAAkF;YAClF,cAAc,CAAC,OAAO,CAAC,UAAS,IAAY;gBAC1C,IAAM,UAAU,GAAI,MAAM,GAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC3E,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;YAEH,4BAA4B;YAC5B,KAAK,IAAM,GAAG,IAAI,0EAAW,CAAC,qBAAqB,EAAE;gBAEnD,IAAM,MAAM,GAAG,0EAAW,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;gBAEtD,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,IAAI,EAAE;oBAC7C,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;iBACvC;aACF;SACF;IACH,CAAC;IAED,yHAAyH;IACzH,gCAAgC;IACxB,8CAAU,GAAlB,UAAmB,KAAa;QAE9B,IAAI,KAAK,EAAE;YACT,yBAAyB;YAEzB,wBAAwB;YACxB,IAAI,OAAO,IAAI,CAAC,gEAAU,EAAE,EAAE;gBAC5B,gEAAU,CAAC,OAAO,CAAC,CAAC;gBACpB,+DAAS,CAAC,MAAM,CAAC,CAAC;gBAClB,+DAAS,CAAC,MAAM,CAAC,CAAC;gBAClB,mEAAa,CAAC,UAAU,CAAC,CAAC;gBAC1B,4DAAM,CAAC,GAAG,CAAC,CAAC;gBACZ,gEAAU,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC;aACvC;SACF;aAAM;YACL,0BAA0B;SAC3B;QAED,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,OAAO,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,EAAE,CAAC,IAAI,CAAC,UAAe,MAAM;;;;gCAC3E,qBAAM,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,SAAS,EAAE;;4BAAlD,SAAkD,CAAC;4BACnD,sBAAO,KAAK,CAAC,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,EAAC;;;;SAC7E,CAAC,CAAC;IACL,CAAC;IAnGU,yBAAyB;QAHrC,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;+EAO4B,gFAAsB;YACxB,4EAAoB;YAChB,qEAAiB;YACtB,kEAAmB;OATjC,yBAAyB,CAoGrC;IAAD,gCAAC;CAAA;AApGqC;;;;;;;;;;;;;;;;;;ACpBK;AAO3C;IAIE;IAAgB,CAAC;IAEV,0CAAW,GAAlB,UAAmB,IAAU;QAC3B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;IACxB,CAAC;IAEM,6CAAc,GAArB,UAAsB,MAA8B;QAElD,IAAI,CAAE,IAAI,CAAC,SAAS,EAAE;YACpB,OAAO;SACR;QAED,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;YAC9B,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC;SACnB;QAED,IAAM,YAAY,GAA4B,EAAE,CAAC;QAEjD,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,MAAM,CAAC,OAAO,CAAC,UAAS,EAAE;YACxB,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC;IAC9D,CAAC;IAED,kDAAkD;IAC3C,6CAAc,GAArB;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;IAChC,CAAC;IAlCU,oBAAoB;QAJhC,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;;OAEW,oBAAoB,CAmChC;IAAD,2BAAC;CAAA;AAnCgC;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPQ;AACR;AAM+B;AACjB;AACD;AACQ;AACe;AACmB;AAI3C;AAO7C;IAOE,+BACU,cAA6B;QAA7B,mBAAc,GAAd,cAAc,CAAe;IACpC,CAAC;IAGG,4CAAY,GAAnB,UAAoB,IAAW;QAC7B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IACzB,CAAC;IAEM,4CAAY,GAAnB;QACE,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB,CAAC;IAEM,+CAAe,GAAtB;QACE,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC;IACjC,CAAC;IAEM,0CAAU,GAAjB,UAAkB,EAAU;QAC1B,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAClC,CAAC;IAEM,gDAAgB,GAAvB,UAAwB,EAAO,EAAE,EAAO;QACtC,OAAO,kDAAkB,CACvB,EAAC,QAAQ,EAAE,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,CAAC,SAAS,EAA6B,EAC5E,EAAC,QAAQ,EAAE,EAAE,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,CAAC,SAAS,EAA6B,EAC1E,CAAC,EAAE,CAAC,CAAC,CAAC;IACZ,CAAC;IAEM,4CAAY,GAAnB,UAAoB,GAAkB;QAEpC,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,OAAO,GAAe,EAAE,CAAC;QAE/B,GAAG,CAAC,OAAO,CAAC,UAAS,EAAE;YACrB,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;QAEH,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,qFAAqF;IACrF,qGAAqG;IAC9F,6CAAa,GAApB,UAAqB,KAAgB,EAAE,SAA0B,EAAE,IAAgB,EAAE,SAAiB,EAAE,KAAmB;QAEzH,IAAI,CAAC,UAAU,GAAG,+DAAS,CAAC,KAAK,CAAU,CAAC;QAC5C,IAAI,CAAC,UAAU,CAAC,OAAO,GAAG,KAAK,CAAC,YAAY,CAAC;QAE7C,6BAA6B;QAC7B,OAAO,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QACtC,OAAO,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACnC,OAAO,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACnC,OAAO,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;QAE3C,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,SAAS,CAAC;QAEtC,mBAAmB;QACnB,yBAAyB;QACzB,yBAAyB;QACzB,oBAAoB;QACpB,IAAI;QAEJ,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC;QAE5B,wBAAwB;QACxB,0FAA0F;QAC1F,IAAI,CAAC,aAAa,GAAG,wFAAwB,CAAC,SAAS,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;QAEjF,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,qBAAqB,CAAC,CAAC;QAEvD,gCAAgC;QAChC,IAAM,UAAU,GAAkB,EAAE,CAAC;QAErC,kCAAkC;QAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAClD,UAAU,CAAC,IAAI,CAAC,EAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,SAAS,EAAC,CAAC,CAAC;SACzG;QAED,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,oDAAoB,CAAC,UAAsC,CAAC,GAAG,0EAAW,CAAC,IAAI,CAAC;QAC7G,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QAC9E,IAAI,CAAC,UAAU,CAAC,cAAc,GAAG,iEAAa,CAAC,IAAI,CAAC,aAAa,EAAE,EAAC,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,SAAS,CAAC,MAAM,GAAG,CAAC,EAAC,CAAC,CAAC;QAE1G,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,6BAA6B,CAAC,CAAC;QAE/D,gCAAgC;QAChC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAE9D,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;QAEjD,8CAA8C;QAC9C,IAAM,mBAAmB,GAAoB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,UAAS,IAAI;YAChF,OAAO,IAAI,CAAC,WAAuB,CAAC;QACtC,CAAC,CACF,CAAC;QAEF,yEAAyE;QACzE,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,CAAC;QAEzC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;QAErD,mCAAmC;QACnC,IAAI,CAAC,UAAU,CAAC,YAAY,GAAG,EAAE,CAAC;QAElC,IAAI,IAAI,EAAE;YACR,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YACnD,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC;SACzD;aAAM;YACL,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SAC5C;QAED,WAAW;QACX,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,2BAA2B,CAAC,KAAK,CAAC,CAAC;QAEhE,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB,CAAC;IAED,yFAAyF;IACzF,gHAAgH;IAChH,4EAA4E;IAC5E,kFAAkF;IAClF,kFAAkF;IAClF,kFAAkF;IAClF,kFAAkF;IAClF,kFAAkF;IAClF,kFAAkF;IAClF,6EAA6E;IACrE,4CAAY,GAApB,UAAqB,SAA0B;QAE7C,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;QAEhD,IAAM,MAAM,GAA8B,EAAE,CAAC;QAE7C,IAAI,UAA4B,CAAC;QACjC,IAAI,WAAW,GAAW,CAAC,CAAC;QAE5B,YAAY;QACZ,IAAI,SAAS,GAAa,CAAC,CAAC;QAC5B,IAAI,gBAAgB,GAAM,CAAC,CAAC;QAC5B,IAAI,cAAc,GAAQ,CAAC,CAAC;QAE5B,iBAAiB;QACjB,IAAI,UAAU,GAAY,CAAC,CAAC;QAC5B,IAAI,UAAU,GAAY,CAAC,CAAC;QAE5B,iBAAiB;QACjB,IAAM,cAAc,GAAsB,EAAE,CAAC;QAC7C,IAAI,cAAc,GAAsB,EAAE,CAAC,CAAC,WAAW;QAEvD,IAAM,gBAAgB,GAAoB,SAAS,CAAC,MAAM,CAAC,CAAM,UAAU;QAE3E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,EAAE,CAAC,EAAE,EAAE;YAEzC,IAAM,SAAS,GAAa,SAAS,CAAC,CAAC,CAAa,CAAC;YAGrD,YAAY;YACZ,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;gBACxB,SAAS,CAAC,SAAS,GAAG,CAAC,CAAC;aACzB;YAED,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,GAAG,0EAAW,CAAC,IAAI,CAAC;YAE7D,IAAI,gBAAgB,GAAG,CAAC,CAAC;YAEzB,oCAAoC;YACpC,IAAI,UAAU,EAAE;gBAEd,SAAS,GAAG,SAAS,CAAC,aAAa,GAAG,UAAU,CAAC,aAAa,CAAC;gBAE/D,cAAc,IAAI,SAAS,CAAC;gBAC5B,gBAAgB,IAAI,SAAS,CAAC;gBAE9B,gCAAgC;gBAChC,gBAAgB,GAAG,SAAS,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;gBAC9D,IAAI,gBAAgB,GAAG,CAAC,EAAE;oBACxB,UAAU,IAAI,gBAAgB,CAAC;iBAChC;qBAAM;oBACL,UAAU,IAAI,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;iBAC1C;aACF;YAED,SAAS,CAAC,QAAQ,GAAG,cAAc,GAAG,CAAC,MAAM,CAAC,MAAM,GAAG,0EAAW,CAAC,IAAI,CAAC,CAAC,CAAK,oBAAoB;YAElG,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YAE/B,yEAAyE;YACzE,IAAI,gBAAgB,GAAG,0EAAW,CAAC,IAAI,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,KAAK,CAAC,EAAE;gBAErE,IAAM,kBAAkB,GAAoB,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC;gBAEjI,IAAM,aAAa,GAAS,iEAAa,CAAC,kBAAkB,EAAE,EAAC,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,kBAAkB,CAAC,MAAM,EAAC,CAAC,CAAC;gBAE1G,WAAW;gBACX,MAAM,CAAC,IAAI,CAAC;oBACV,EAAE,EAAgB,MAAM,CAAC,MAAM,GAAG,CAAC;oBACnC,cAAc,EAAI,aAAa;oBAC/B,SAAS,EAAS,+DAAS,CAAC,cAAc,CAAoB;oBAC9D,aAAa,EAAK,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;oBACxC,aAAa,EAAK,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;oBACxC,WAAW,EAAO,kFAAkB,CAAC,gDAAgB,CAAC,cAAc,CAAC,CAAC;oBACtE,SAAS,EAAS,KAAK;oBACvB,WAAW,EAAO,KAAK;oBACvB,WAAW,EAAO,KAAK;oBACvB,QAAQ,EAAU,EAAE;iBACrB,CAAC,CAAC;gBAEH,aAAa;gBACb,gBAAgB,IAAI,0EAAW,CAAC,IAAI,CAAC;gBACrC,UAAU,GAAG,UAAU,GAAG,CAAC,CAAC;gBAC5B,cAAc,CAAC,MAAM,CAAC,CAAC,EAAE,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAI,cAAc;gBACtE,cAAc,GAAG,EAAE,CAAC;gBACpB,6CAA6C;gBAE7C,2DAA2D;gBAC3D,KAAiB,UAAc,EAAd,iCAAc,EAAd,4BAAc,EAAd,IAAc,EAAE;oBAA5B,IAAM,EAAE;oBACX,EAAE,CAAC,QAAQ,IAAI,0EAAW,CAAC,IAAI,CAAC;iBACjC;aACF;YAED,iDAAiD;YACjD,UAAU,GAAG,SAAS,CAAC;YACvB,WAAW,GAAG,SAAS,CAAC;SAEzB;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;IAED;qHACiH;IAC1G,8CAAc,GAArB,UAAsB,SAA0B;QAC9C,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC;IAClE,CAAC;IAED;mFAC+E;IACvE,mDAAmB,GAA3B,UAA4B,SAA0B,EAAE,WAAwB;QAE9E,IAAM,WAAW,GAAoB,EAAE,CAAC;QACxC,IAAM,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC;QAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE;YAEnC,IAAI,KAAK,SAAU,CAAC;YAEpB,IAAI,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;gBACrB,KAAK,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;aACtB;iBAAM;gBACL,KAAK,GAAG,gDAAgB,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAC5D;YAED,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACzB;QAED,IAAI,WAAW,EAAE;YACf,WAAW,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;SAClC;aAAM;YACL,WAAW,GAAG,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;SACxC;QAED,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1B,OAAO,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;SAC3D;aAAM;YACL,OAAO,WAAW,CAAC;SACpB;IACH,CAAC;IAED,mBAAmB;IACnB,oIAAoI;IAC5H,0DAA0B,GAAlC,UAAmC,QAAkB,EAAE,YAAoC,EAAE,MAAe,EAAE,KAAc;QAE1H,MAAM,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QAE5B,IAAM,WAAW,GAAG,MAAM,CAAC;QAE3B,IAAM,eAAe,GAAoB,YAAY,CAAC,MAAM,CAAC,CAAC;QAE9D,IAAM,WAAW,GAAG,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,WAAW,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QACpF,IAAM,SAAS,GAAG,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,WAAW,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,WAAW,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;QAE/K,IAAM,kBAAkB,GAAoB,eAAe,CAAC,KAAK,CAAC,WAAW,EAAE,SAAS,GAAG,CAAC,CAAC,CAAC;QAE9F,IAAI,iBAAiB,GAAoB,sDAAsB,CAAC,QAAQ,EAAE,kBAAkB,CAAoB,CAAC;QAEjH,IAAI,MAAM,KAAK,YAAY,CAAC,MAAM,GAAG,CAAC,IAAI,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE;YAEtE,OAAO;YACP,MAAM,EAAG,CAAC;YACV,OAAO,IAAI,CAAC,0BAA0B,CAAC,QAAQ,EAAE,YAAY,EAAE,MAAM,EAAE,WAAW,GAAG,kBAAkB,CAAC,OAAO,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;SAEhK;aAAM;YAEL,oBAAoB;YACpB,iBAAiB,GAAG,iBAAiB,CAAC,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;YAEjD,cAAc;YACd,iBAAiB,CAAC,OAAO,CAAC,UAAS,CAAW;gBAC5C,CAAC,CAAC,GAAG,GAAG,WAAW,GAAG,kBAAkB,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAC9E,CAAC,CAAC,CAAC;YAEH,OAAO,iBAAiB,CAAC;SAC1B;IACH,CAAC;IAED;sDACkD;IAC3C,0DAA0B,GAAjC,UAAkC,QAAkB,EAAE,KAAiB;QAAjB,iCAAiB;QAErE,IAAM,aAAa,GAAe,IAAI,CAAC,0BAA0B,CAAC,QAAQ,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;QACvG,IAAI,cAAc,GAAe,EAAE,CAAC;QACpC,IAAM,yBAAyB,GAAe,EAAE,CAAC;QAEjD,IAAM,QAAQ,GAAG,aAAa,CAAC,MAAM,CAAC;QACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;YAEjC,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;YAC1D,IAAM,iBAAiB,GAAoB,IAAI,CAAC,yBAAyB,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YAE3F,0DAA0D;YAC1D,IAAM,UAAU,GAAoB,iBAAiB,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAClE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAG,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC3C,UAAU,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;aAChD;YAED,cAAc,GAAG,cAAc,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SACpD;QAED,cAAc,GAAG,+DAAS,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC;QAEvD,cAAc,CAAC,MAAM,CAAC,UAAS,KAAK;YAClC,OAAO,KAAK,CAAC,SAAS,KAAK,cAAc,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;QACzD,CAAC,CAAC,CAAC,GAAG,CAAC,UAAS,KAAK;YACnB,yBAAyB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;QAEH,OAAO,yBAAyB,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC;IACvD,CAAC;IAED,+FAA+F;IAC/F,2CAA2C;IACpC,yDAAyB,GAAhC,UAAiC,QAAkB,EAAE,WAAiB;QACpE,OAAO,sDAAsB,CAAC,EAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC,SAAS,EAA6B,EACpH,WAAW,CAAC,SAAS,CAAC,CAAC;IAC3B,CAAC;IAGD,yDAAyD;IACjD,gDAAgB,GAAxB,UAAyB,IAAgB,EAAE,KAAkB;QAE3D,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC;QAEzD,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;QAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,CAAC,EAAE,EAAE;YAEpC,IAAM,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;YAErB,oBAAoB;YACpB,IAAI,CAAC,QAAQ,GAAG,kFAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAElD,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,yCAAyC;YAEtD,KAAK,CAAC,cAAc,CAAC,WAAW,CAAC,wBAAwB,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;YACrE,OAAO,CAAC,GAAG,CAAC,wBAAwB,GAAG,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,CAAC;YAE7E,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,0EAAW,CAAC,IAAI,CAAC;YAErE,0FAA0F;YAC1F,IAAM,qBAAqB,GAAQ,KAAK,CAAC,0BAA0B,CAAC,EAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAa,EAAE,CAAC,CAAC,CAAC;YAC3J,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;YAE/E,IAAM,WAAW,GAAG,KAAK,CAAC,0BAA0B,CAAC,IAAI,CAAC,QAAQ,EAAE,YAAY,EAAE,qBAAqB,CAAC,CAAC;YAEzG,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;YAC3C,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,EAAE,CAAC;YAEjC,kCAAkC;YAClC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,aAAa,EAAE;gBAC9C,WAAW,CAAC,eAAe,CAAC,aAAa,GAAG,EAAE,CAAC;aAChD;YACD,WAAW,CAAC,eAAe,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAExD,iCAAiC;YACjC,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,qBAAqB,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YAE3D,kBAAkB;YAClB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE;gBACtB,YAAY,CAAC,IAAI,GAAG,EAAE,CAAC;aACxB;YAED,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAGhC,kFAAkF;YAClF,qGAAqG;YACrG,uDAAuD;YACvD,IAAM,YAAY,GAAkB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAElE,IAAM,eAAe,GAAG,YAAY,CAAC,MAAM,CAAC;YAC5C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,EAAE,CAAC,EAAE,EAAE;gBAExC,IAAM,KAAK,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;gBAE9B,8BAA8B;gBAC9B,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;oBACxD,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;iBAC3C;gBACD,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAEnD,YAAY,CAAC,QAAQ,CAAC,KAAK,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC;gBAEzC,oCAAoC;gBACpC,IAAI,kEAAgB,CAAC,KAAK,CAAC,IAAI,kEAAgB,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE;oBAC9D,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC;iBACjC;qBAAM;oBACL,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC;iBACjC;aACF;YAED,IAAI,YAAY,CAAC,WAAW,EAAE;gBAC5B,0BAA0B;gBAC1B,IAAI,YAAY,CAAC,cAAc,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE;oBAC9D,YAAY,CAAC,cAAc,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;iBAC5D;qBAAM,IAAI,YAAY,CAAC,cAAc,CAAC,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE;oBACpE,YAAY,CAAC,cAAc,CAAC,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;iBAC3D;aACF;SACF;IACH,CAAC;IAEO,2DAA2B,GAAnC,UAAoC,KAAkB;QAEpD,IAAI,CAAC,KAAK,EAAE;YACV,OAAO;SACR;QAED,IAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC;QAC7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;YAChC,IAAM,KAAK,GAAS,KAAK,CAAC,CAAC,CAAC,CAAC;YAE7B,8DAA8D;YAC9D,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;gBACtB,IAAM,qBAAqB,GAAG,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;gBACpF,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;gBAC/E,IAAM,WAAW,GAAG,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,WAAW,EAAE,YAAY,EAAE,qBAAqB,CAAC,CAAC;gBAC5G,KAAK,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;aAC7C;SACF;QAGD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,uBAAuB;IACf,0DAA0B,GAAlC,UAAmC,QAAkB,EAAE,WAAiB,EAAE,gBAAwB;QAEhG,wDAAwD;QAExD,IAAM,gBAAgB,GAAG,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QACxE,IAAM,mBAAmB,GAAG,WAAW,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QAE3E,yFAAyF;QACzF,IAAM,mBAAmB,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;QAC1F,IAAM,IAAI,GAAG,gBAAgB,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,mBAAmB,CAAC,QAAQ,GAAG,gBAAgB,CAAC,QAAQ,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QACnI,IAAM,IAAI,GAAG,gBAAgB,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,mBAAmB,CAAC,SAAS,GAAG,gBAAgB,CAAC,SAAS,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QACtI,IAAM,IAAI,GAAG,gBAAgB,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,mBAAmB,CAAC,SAAS,GAAG,gBAAgB,CAAC,SAAS,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QACtI,IAAM,KAAK,GAAG,gBAAgB,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC,mBAAmB,CAAC,QAAQ,GAAG,gBAAgB,CAAC,QAAQ,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QACpI,IAAM,MAAM,GAAG,gBAAgB,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC,mBAAmB,CAAC,aAAa,GAAG,gBAAgB,CAAC,aAAa,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAC;QAEpJ,gHAAgH;QAEhH,cAAc;QACd,OAAO;YACL,WAAW,EAAE,EAAC,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,aAAa,EAAE,MAAM,EAAC;YACvG,eAAe,EAAE,gBAAgB;YACjC,QAAQ,EAAE,+EAAiB,CAAC,EAAC,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAC,EAAE,EAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,CAAC,SAAS,EAAC,CAAC;SAC7H,CAAC;IACJ,CAAC;IAED,kGAAkG;IAC3F,wCAAQ,GAAf,UAAgB,MAAuB,EAAE,SAAiB,EAAE,cAA8B;QAA9B,sDAA8B;QAExF,IAAM,WAAW,GAAW,SAAS,KAAK,SAAS,CAAC,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;QAEhF,MAAM,GAAG,cAAc,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;QACrF,MAAM,GAAG,IAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QAE3D,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,sCAAsC;IAC9B,uDAAuB,GAA/B,UAAgC,MAAM,EAAE,WAAW;QAEjD,IAAI,SAAS,GAAa,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QACzD,IAAM,SAAS,GAAoB,CAAC,SAAS,CAAC,CAAC;QAC/C,IAAI,KAAe,CAAC;QAEpB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YAEjD,iBAAiB;YACjB,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YACvC,IAAI,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,SAAS,CAAC,GAAG,WAAW,EAAE;gBAC3D,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBACtB,SAAS,GAAG,KAAK,CAAC;aACnB;SACF;QAED,IAAI,SAAS,KAAK,KAAK,EAAE;YACvB,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACvB;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;IAEO,8CAAc,GAAtB,UAAuB,KAAa;QAClC,OAAO,EAAC,SAAS,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,EAAE,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,EAAE,SAAS,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,EAAC,CAAC;IAC7H,CAAC;IAED,sFAAsF;IAC9E,uDAAuB,GAA/B,UAAgC,MAAM,EAAE,WAAW;QAEjD,IAAI,GAAG,GAAG,MAAM,CAAC,MAAM,EACrB,WAAW,GAAG,OAAO,UAAU,KAAK,WAAW,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,EACpE,OAAO,GAAG,IAAI,WAAW,CAAC,GAAG,CAAC,EAE9B,KAAK,GAAG,CAAC,EACT,IAAI,GAAG,GAAG,GAAG,CAAC,EAEd,KAAK,GAAG,EAAE,EACV,SAAS,GAAG,EAAE,EAEd,CAAC,EAAE,SAAS,EAAE,MAAM,EAAE,KAAK,CAAC;QAE9B,OAAO,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAEnC,OAAO,IAAI,EAAE;YAEX,SAAS,GAAG,CAAC,CAAC;YAEd,KAAK,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,EAAE;gBAEjC,MAAM,GAAG,IAAI,CAAC,yBAAyB,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;gBAEhF,IAAI,MAAM,GAAG,SAAS,EAAE;oBACtB,KAAK,GAAG,CAAC,CAAC;oBACV,SAAS,GAAG,MAAM,CAAC;iBACpB;aACF;YAED,IAAI,SAAS,GAAG,WAAW,EAAE;gBAC3B,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACnB,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;aACvC;YAED,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;YACnB,KAAK,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC;SACrB;QAED,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YACxB,IAAI,OAAO,CAAC,CAAC,CAAC,EAAE;gBACd,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;aAC3B;SACF;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;IAID;;;;MAIE;IAEF,mCAAmC;IAC3B,kDAAkB,GAA1B,UAA2B,EAAE,EAAE,EAAE;QAE/B,IAAM,EAAE,GAAW,EAAE,CAAC,QAAQ,GAAG,EAAE,CAAC,QAAQ,EAC1C,EAAE,GAAW,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,SAAS,EACxC,EAAE,GAAW,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAElD,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;IACrC,CAAC;IAED,4CAA4C;IACpC,yDAAyB,GAAjC,UAAkC,CAAC,EAAE,EAAE,EAAE,EAAE;QAEzC,IAAI,CAAC,GAAW,EAAE,CAAC,QAAQ,EACzB,CAAC,GAAW,EAAE,CAAC,SAAS,EACxB,CAAC,GAAW,EAAE,CAAC,SAAS,EAExB,EAAE,GAAW,EAAE,CAAC,QAAQ,GAAG,CAAC,EAC5B,EAAE,GAAW,EAAE,CAAC,SAAS,GAAG,CAAC,EAC7B,EAAE,GAAW,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC;QAEhC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;YAEpC,IAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC;gBACjF,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;YAEhC,IAAI,CAAC,GAAG,CAAC,EAAE;gBACT,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC;gBAChB,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC;gBACjB,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC;aAElB;iBAAM,IAAI,CAAC,GAAG,CAAC,EAAE;gBAChB,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;gBACZ,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;aACb;SACF;QAED,EAAE,GAAG,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;QACpB,EAAE,GAAG,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC;QACrB,EAAE,GAAG,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC;QAErB,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;IACrC,CAAC;IAnnBU,qBAAqB;QALjC,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF,uHAAuH;;+EAS3F,6DAAa;OAR5B,qBAAqB,CAonBjC;IAAD,4BAAC;CAAA;AApnBiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvBS;AACoD;AACzD;AACW;AACD;AACC;AACI;AAGa;AACF;AAEpB;AACS;AACV;AAM3C;IAME,gEAAgE;IAChE,8BACU,aAAkC,EAClC,aAA2B,EAC3B,OAAe,EACf,cAA6B,EAC7B,gBAAiC,EACjC,eAAsC,EACtC,cAAoC,EACpC,YAAyB;QAPzB,kBAAa,GAAb,aAAa,CAAqB;QAClC,kBAAa,GAAb,aAAa,CAAc;QAC3B,YAAO,GAAP,OAAO,CAAQ;QACf,mBAAc,GAAd,cAAc,CAAe;QAC7B,qBAAgB,GAAhB,gBAAgB,CAAiB;QACjC,oBAAe,GAAf,eAAe,CAAuB;QACtC,mBAAc,GAAd,cAAc,CAAsB;QACpC,iBAAY,GAAZ,YAAY,CAAa;IAChC,CAAC;IAGJ;;;uBAGmB;IACnB,sCAAO,GAAP,UAAQ,KAA6B,EAAE,KAA0B;QAAjE,iBA8DC;QA5DC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QACxE,IAAM,UAAU,GAAW,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAEvE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,EAAE,KAAK,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,KAAK,UAAU,EAAE;YAEnH,OAAO,+CAAE,CAAC,EAAC,KAAK,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,EAAC,CAAC,CAAC;SAE/D;aAAM;YAEL,OAAO,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,IAAI,CAAC,cAAc,EAAE,UAAU,CAAC,CAAC,IAAI,CAEnF,2DAAI,CAAC,CAAC,CAAC,EAAiB,sBAAsB;YAC9C,gEAAS,CAAC,cAAI;gBAEZ,IAAI,IAAI,EAAE;oBAER,cAAc;oBACd,KAAI,CAAC,YAAY,GAAG,IAAI,CAAC,CAAC,CAAU,CAAC;oBACrC,KAAI,CAAC,eAAe,CAAC,YAAY,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;oBAErD,2CAA2C;oBAC3C,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE;wBAEX,oEAAoE;wBACpE,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC,CAAC,CAAS,CAAC;wBACnC,KAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAI,CAAC,WAAW,CAAC,CAAC;wBAGlD,oBAAoB;wBACpB,IAAI,UAAU,KAAK,CAAC,EAAE;4BACpB,KAAI,CAAC,WAAW,GAAG,+DAAW,CAAC,KAAI,CAAC,WAAW,EAAE,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;yBAClF;qBACF;oBAED,yCAAyC;oBACzC,IAAM,mBAAmB,GAAoB,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,IAAI;wBACzE,OAAO,IAAI,CAAC,WAAuB,CAAC;oBACtC,CAAC,CACF,CAAC;oBAEF,KAAI,CAAC,eAAe,CAAC,cAAc,CAAC,mBAAmB,CAAC,CAAC;oBACzD,KAAI,CAAC,cAAc,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;oBAErD,wDAAwD;oBACxD,KAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;oBAC1B,KAAI,CAAC,cAAc,CAAC,WAAW,CAAC,2BAA2B,CAAC,CAAC;oBAE7D,KAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;oBAElC,OAAO,+CAAE,CAAC,EAAC,KAAK,EAAE,KAAI,CAAC,YAAY,EAAE,IAAI,EAAE,KAAI,CAAC,WAAW,EAAC,CAAC,CAAC;iBAE/D;qBAAM;oBAEL,KAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;oBAClC,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;oBAClC,OAAO;iBACR;YACH,CAAC,CAAC,CACH,CAAC;SACH;IACL,CAAC;IArFU,oBAAoB;QAJhC,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;+EAUyB,kEAAmB;YACnB,2DAAY;YAClB,sDAAM;YACC,6DAAa;YACX,kEAAe;YAChB,8EAAqB;YACtB,4EAAoB;YACtB,0DAAW;OAfxB,oBAAoB,CAsFhC;IAAD,2BAAC;CAAA;AAtFgC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpBU;AACO;AACN;AAClB;AAE2B;AACJ;AACiB;AAGF;AACT;AACW;AACP;AACF;AAEzD,qBAAqB;AACrB,qDAAqD;AACrD,mDAAmD;AACR;AACA;AAa3C;IAOE,qDAAqD;IACrD,oDAAoD;IAEpD,sBACU,KAAiB,EACjB,aAAkC,EAClC,cAA6B,EAC7B,eAAsC,EACtC,cAAoC,EACpC,kBAAqC;QALrC,UAAK,GAAL,KAAK,CAAY;QACjB,kBAAa,GAAb,aAAa,CAAqB;QAClC,mBAAc,GAAd,cAAc,CAAe;QAC7B,oBAAe,GAAf,eAAe,CAAuB;QACtC,mBAAc,GAAd,cAAc,CAAsB;QACpC,uBAAkB,GAAlB,kBAAkB,CAAmB;QAd/C,uHAAuH;QACvH,oIAAoI;QAC5H,gBAAW,GAAY,IAAI,yDAAO,EAAE,CAAC,CAAG,uCAAuC;QAC/E,eAAU,GAAY,IAAI,yDAAO,EAAE,CAAC;QACpC,eAAU,GAAY,IAAI,yDAAO,EAAE,CAAC;IAWzC,CAAC;IAEJ,6CAA6C;IAC7C,+HAA+H;IAC/H,4DAA4D;IACrD,sCAAe,GAAtB,UAAuB,OAAe;QAEpC,IAAI,UAAqB,CAAC;QAC1B,IAAM,YAAY,GAAG,EAAE,CAAC;QAExB,KAAK,IAAM,GAAG,IAAI,0EAAW,CAAC,iBAAiB,EAAE;YAC/C,IAAI,0EAAW,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,OAAO,EAAE;gBACrD,UAAU,GAAG,0EAAW,CAAC,iBAAiB,CAAC,GAAG,CAAc,CAAC;aAC9D;SACF;QAED,IAAM,iBAAiB,GAAG,+CAAE,CAAC,UAAU,CAAC,CAAC,CAAK,wCAAwC;QAEtF,YAAY,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAErC,uBAAuB;QACvB,yBAAyB;QACzB,2DAA2D;QAC3D,uDAAuD;QACvD,gEAAgE;QAEhE,qDAAqD;QAErD,IAAM,UAAU,GAAW,cAAc,CAAC;QAE1C,IAAI,UAAU,CAAC,SAAS,EAAE;YAExB,KAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;gBACxC,IAAM,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,QAAQ,GAAG,QAAQ,GAAG,CAAC,GAAG,MAAM,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC;gBAC1H,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;aACrC;SACF;aAAM;YACL,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,QAAQ,GAAG,WAAW,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC;YACtG,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAC3B;QAED,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,QAAQ,GAAG,SAAS,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC;QAClG,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAExB,gCAAgC;QAChC,IAAI,KAAyB,CAAC;QAC9B,IAAI,UAAU,CAAC,WAAW,EAAE;YAC1B,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,QAAQ,GAAG,WAAW,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC;YAC/F,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1B;QAED,iCAAiC;QACjC,IAAI,MAA0B,CAAC;QAC/B,IAAI,UAAU,CAAC,QAAQ,EAAE;YACvB,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,GAAG,UAAU,CAAC,QAAQ,GAAG,YAAY,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC;YACjG,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAC3B;QAED,OAAO,qDAAQ,CAAC,YAAY,CAAC,CAAC;IAChC,CAAC;IAED;;;wHAGoH;IAC7G,4CAAqB,GAA5B,UAA6B,OAAe,EAAE,SAAiB;QAE7D,IAAM,KAAK,GAAG,IAAI,CAAC;QACnB,IAAM,UAAU,GAAG,8EAAoB,CAAC,OAAO,CAAC,CAAC;QACjD,IAAM,gBAAgB,GAAW,CAAC,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;QAErE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,qBAAqB,CAAC,CAAC;QAErD,IAAM,QAAQ,GAAG,UAAe,IAAY,EAAE,YAAqB;;;oBAEjE,sBAAO,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE,MAAM;4BAEzC,IAAM,SAAS,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,GAAG,gBAAgB,GAAG,OAAO,CAAC,CAAC,CAAC,IAAI,GAAG,OAAO,CAAC;4BAE5F,KAAK,CAAC,kBAAkB,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,EAAE,SAAS,EAAE,UAAe,MAAM;;;wCAEjF,IAAI,MAAM,IAAI,MAAM,KAAK,OAAO,EAAE;4CAEhC,OAAO,CAAC,MAAM,CAAC,CAAC;yCAEjB;6CAAM;4CAEL,6CAA6C;4CAC7C,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,eAAe,GAAG,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,SAAS,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC,CAAC,CAAC,SAAS,CAAC,UAAU,IAAI;gDACnH,OAAO,CAAC,IAAI,CAAC,CAAC;4CAChB,CAAC,CAAC,CAAC;yCACJ;;;;6BACF,CAAC,CAAC;wBACP,CAAC,CAAC,EAAC;;;SACJ,CAAC;QAGF,yEAAyE;QACzE,IAAM,YAAY,GAAG,EAAE,CAAC;QAExB,IAAM,UAAU,GAAG,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC3C,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAE9B,IAAI,UAAU,CAAC,WAAW,EAAE;YAC1B,IAAM,SAAS,GAAG,QAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;YAC1C,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAC9B;QAED,OAAO,qDAAQ,CAAC,YAAY,CAAC,CAAC;IAChC,CAAC;IAED,kEAAkE;IAC3D,qCAAc,GAArB,UAAsB,KAAgB,EAAE,SAAiC,EAAE,IAAY,EAAE,IAAY,EAAE,KAAa,EAAE,SAAiB;QAErI,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;QAEtD,wBAAwB;QACxB,IAAM,OAAO,GAAG,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC,KAAK,CAAC,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;QAExG,IAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,CAC/C,OAAO,CAAC,CAAC,CAAc,EACvB,OAAO,CAAC,CAAC,CAAqB,EAC9B,OAAO,CAAC,CAAC,CAAe,EACxB,SAAS,EACT,OAAO,CAAC,CAAC,CAAgB,CAC1B,CAAC;QAEF,IAAI,KAAK,CAAC;QACV,IAAI,OAAO,CAAC,CAAC,CAAC,EAAE;YACd,KAAK,GAAG,4DAAS,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,WAAW,CAAC,CAAC;YAEzE,IAAI,SAAS,KAAK,CAAC,EAAE;gBACnB,KAAK,GAAG,8DAAW,CAAC,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;aACjD;YAED,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SACxC;QAGD,OAAO,EAAC,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAC,CAAC;IACtC,CAAC;IA7JU,YAAY;QAVxB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;QAEF;;;;;WAKG;;+EAYgB,+DAAU;YACF,kEAAmB;YAClB,6DAAa;YACZ,8EAAqB;YACtB,4EAAoB;YAChB,sEAAiB;OAhBpC,YAAY,CA8JxB;IAAD,mBAAC;CAAA;AA9JwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjCgB;AACO;AACG;AACa;AACW;AACZ;AACT;AACU;AACF;AACP;AACR;AACI;AAED;AAOlD;IAWE,gCACU,OAAgC,EAChC,aAA6C,EAC7C,qBAA8C,EAC9C,sBAA+C,EAC/C,kBAA2C,EAC3C,gBAAyC;QALzC,YAAO,GAAP,OAAO,CAAyB;QAChC,kBAAa,GAAb,aAAa,CAAgC;QAC7C,0BAAqB,GAArB,qBAAqB,CAAyB;QAC9C,2BAAsB,GAAtB,sBAAsB,CAAyB;QAC/C,uBAAkB,GAAlB,kBAAkB,CAAyB;QAC3C,qBAAgB,GAAhB,gBAAgB,CAAyB;QAZ5C,gBAAW,GAAQ,EAAE,CAAC,CAAO,oCAAoC;QAChE,cAAS,GAAQ,EAAE,CAAC,CAAQ,yCAAyC;QAE7E,wDAAwD;QAChD,eAAU,GAAkB,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;QAW7D,uCAAuC;QACvC,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,GAAG,IAAI,oDAAe,CAAC,KAAK,CAAC,CAAC;QAC5E,IAAI,CAAC,WAAW,CAAC,iBAAiB,CAAC,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAK,EAAE,CAAC,CAAC;QAExE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,CAAC;QAC3F,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,CAAC;IAC7F,CAAC;IAED,wCAAO,GAAP;QAAA,iBAuEC;QArEC,OAAO,IAAI,CAAC,kBAAkB,EAAE,CAAC,IAAI,CAEnC,2DAAI,CAAC,CAAC,CAAC,EACP,gEAAS,CAAC,cAAI;YAEV,IAAI,IAAI,EAAE;gBAER,IAAM,kBAAkB,GAAG,UAAS,KAAK;oBACvC,IAAI,KAAK,IAAI,KAAK,YAAY,kEAAY,EAAE;wBAC1C,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,EAAE;4BACxB,OAAO,KAAK,CAAC,IAAI,CAAC,CAAM,uBAAuB;yBAChD;6BAAM;4BACL,OAAO,IAAI,CAAC,CAAY,sBAAsB;yBAC/C;qBACF;yBAAM;wBACL,OAAO,KAAK,CAAC,CAAa,uBAAuB;qBAClD;gBACH,CAAC,CAAC;gBAEF,IAAM,OAAK,GAAG,KAAI,CAAC;gBACnB,IAAM,SAAS,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC9C,IAAM,SAAS,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;wCAInC,GAAG;oBAEZ,IAAM,MAAM,GAAc,SAAS,CAAC,GAAG,CAAC,CAAC;oBAEzC,KAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAS,IAAI;wBAEnC,IAAM,cAAc,GAAW,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,CAAC;wBAEpE,IAAI,IAAI,KAAK,OAAO,IAAI,CAAC,OAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE;4BAErE,gEAAgE;4BAChE,IAAI,MAAM,CAAC,IAAI,GAAG,SAAS,CAAC,EAAE;gCAC5B,OAAK,CAAC,aAAa,CAAC,KAAK,CAAC,cAAc,EAAE,MAAM,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC;6BACrE;yBACF;oBACH,CAAC,CAAC,CAAC;;gBAjBL;wHACwG;gBACxG,KAAK,IAAM,GAAG,IAAI,SAAS;4BAAhB,GAAG;iBAgBb;gBAED,mCAAmC;gBACnC,IAAI,SAAS,EAAE;oBAEb,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,kBAAkB,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;oBACnE,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,kBAAkB,EAAE,SAAS,CAAC,CAAC;oBACxD,yEAAgB,CAAC,SAAS,CAAC,CAAC;iBAE7B;qBAAM;oBAEL;6GACyF;oBACzF,IAAM,WAAW,GAAQ,KAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;oBACzE,IAAI,WAAW,EAAE;wBACf,yEAAgB,CAAC,WAAW,CAAC,CAAC;qBAC/B;yBAAM;wBACL,yEAAgB,CAAC,SAAS,CAAC,CAAC;qBAC7B;iBACF;gBACD,OAAO,+CAAE,CAAC,SAAS,CAAC,CAAC;aACtB;iBAAM;gBACL,KAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAClC,OAAO,+CAAE,CAAC,OAAO,CAAC,CAAC;aACpB;QACH,CAAC,CACF,CACF,CAAC;IACJ,CAAC;IAED;wDACoD;IAC7C,mDAAkB,GAAzB;QAEE,IAAI,sBAAsB,GAAG,IAAI,CAAC;QAElC,IAAI,oEAAa,EAAE,EAAE;YACnB,sBAAsB,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,KAAK,QAAQ,CAAC,CAAC;SAC7E;QAED,WAAW;QACX,wEAAwE;QACxE,IAAM,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;QACxE,IAAI,SAA0B,CAAC;QAE/B,IAAI,eAAe,EAAE;YACnB,SAAS,GAAG,+CAAE,CAAC,eAAe,CAAC,CAAC;SACjC;aAAM;YACL,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;SACvF;QAGD,WAAW;QACX,oDAAoD;QACpD,IAAI,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;QAEnE,IAAI,SAA0B,CAAC;QAE/B,IAAI,CAAC,YAAY,EAAE;YACjB,YAAY,GAAG,CAAC,CAAC;SAClB;QAED,IAAI,YAAY,GAAG,0EAAW,CAAC,mBAAmB,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,IAAI,sBAAsB,EAAE;YACnG,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAO,0EAAW,CAAC,SAAS,GAAG,0EAAW,CAAC,WAAW,GAAG,cAAc,EACpH,KAAK,CAAC,CAAC;SACZ;aAAM;YACL,SAAS,GAAG,+CAAE,CAAC,IAAI,CAAC,CAAC;SACtB;QAED,OAAO,qDAAQ,CAAC,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC,CAAC;IAC1C,CAAC;IAKD;;;2EAGuE;IAChE,6CAAY,GAAnB,UAAoB,gBAAiC;QAAjC,2DAAiC;QAEnD,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,OAAO,EAAE,CAAC,SAAS,CAAC,UAAU,MAAM;YAEvC,KAAK,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAE/C,IAAM,cAAc,GAAG,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;YAEzE,IAAI,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;YAE/D,IAAI,gBAAgB,EAAE;gBACpB,OAAO,GAAG,EAAE,WAAW,EAAE,6EAAoB,CAAC,cAAc,CAAC,EAAE,CAAC;aACjE;oCAGU,GAAG;gBAEZ,IAAM,UAAU,GAAc,OAAO,CAAC,GAAG,CAAC,CAAC;gBAE3C,sCAAsC;gBACtC,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,UAAS,IAAY;oBAE5C,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,WAAW,CAAC,EAAE;wBAElE,mEAAmE;wBACnE,IAAM,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,IAAI,oDAAe,CAAC,KAAK,CAAC,CAAC;wBACxF,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,WAAW,CAAC,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAK,EAAE,CAAC,CAAC;wBAElG,4BAA4B;wBAC5B,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,CAAC,CAAC,SAAS,CAAC;4BAC9E,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAE,6DAA6D;wBAC1F,CAAC,CAAC,CAAC;qBACJ;oBAED,wBAAwB;oBACxB,IAAM,cAAc,GAAG,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,SAAS,CAAC,CAAC;oBAE9F,IAAI,cAAc,KAAK,UAAU,CAAC,IAAI,GAAG,SAAS,CAAC,EAAE;wBAEnD,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBAEzD,IAAI,cAAc,KAAK,UAAU,CAAC,EAAE,EAAE;4BACpC,wCAAwC;4BACxC,KAAK,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;yBAC/C;qBACF;yBAAM;wBACL,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;qBAC3D;gBACH,CAAC,CAAC,CAAC;;YAlCL,iBAAiB;YACjB,KAAK,IAAM,GAAG,IAAI,OAAO;wBAAd,GAAG;aAkCb;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IA3MU,sBAAsB;QAJlC,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;+EAcoC,sDAAM;YACN,kEAAmB;YACnB,4EAAoB;YACpB,8EAAqB;YACrB,sEAAiB;YACjB,kEAAe;OAjBxC,sBAAsB,CA4MlC;IAAD,6BAAC;CAAA;AA5MkC;;;;;;;;;;;;;ACjBnC;AAAA;AAAA;IAAA;IAsOA,CAAC;IApOC,4CAA4C;IAC9B,iBAAQ,GAAmB;QACvC;YACE,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,QAAQ;SACf,EAAE;YACD,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,EAAE;YACT,QAAQ,EAAE,KAAK;YACf,IAAI,EAAE,YAAY;SACnB,EAAE;YACD,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,cAAc;YACrB,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;YACZ,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,CAAC,SAAS,EAAE,MAAM,EAAE,eAAe,CAAC;YAC5C,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,UAAU;YACjB,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,YAAY;YAClB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,SAAS;YACf,KAAK,EAAE,SAAS;YAChB,OAAO,EAAE,KAAK;YACd,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,cAAc;YACpB,MAAM,EAAE,CAAC,OAAO,EAAE,WAAW,CAAC;YAC9B,WAAW,EAAE,IAAI;SAClB,EAAC;YACA,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;YACZ,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,SAAS;YACf,KAAK,EAAE,SAAS;YAChB,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,KAAK;YACX,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,UAAU;YACjB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,OAAO;YACb,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,WAAW;YACjB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,WAAW;YACjB,KAAK,EAAE,WAAW;YAClB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;YACZ,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,OAAO;YACd,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,OAAO;YACb,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,CAAC,YAAY,EAAE,OAAO,CAAC;YAC/B,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,YAAY;YAClB,KAAK,EAAE,aAAa;YACpB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,UAAU;YAChB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,UAAU;YAChB,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,OAAO,CAAC;YACxC,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,aAAa;YACnB,KAAK,EAAE,aAAa;YACpB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;YACZ,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,WAAW;YACjB,KAAK,EAAE,YAAY;YACnB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,SAAS;YACf,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,WAAW;YACjB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,QAAQ;YACd,KAAK,EAAE,QAAQ;YACf,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,aAAa;YACnB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,OAAO;YACd,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,WAAW;YACjB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,UAAU;YAChB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,QAAQ;YACf,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,UAAU;YAChB,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,UAAU;YACjB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,SAAS;YACf,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,KAAK;YACX,KAAK,EAAE,MAAM;YACb,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;SACb,EAAE;YACD,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,OAAO;YACd,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,KAAK;SACZ,EAAE;YACD,IAAI,EAAE,QAAQ;YACd,KAAK,EAAE,8BAA8B;YACrC,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,OAAO;YACb,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,CAAC,WAAW,EAAE,OAAO,CAAC;YAC9B,WAAW,EAAE,IAAI;SAClB,EAAE;YACD,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,aAAa;YACpB,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;SACb;QAED,UAAU;QACV;YACE,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,KAAK;YACf,IAAI,EAAE,SAAS;YACf,WAAW,EAAE,IAAI;SAClB;QAED,UAAU;QACV;YACE,IAAI,EAAE,SAAS;YACf,KAAK,EAAE,SAAS;YAChB,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,sBAAsB;SAC7B;QAED,gBAAgB;QAChB;YACE,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,MAAM;YACb,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,MAAM;SACb;QAED,oBAAoB;QACpB;YACE,IAAI,EAAE,SAAS;YACf,KAAK,EAAE,EAAE;YACT,KAAK,EAAE,SAAS;YAChB,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,iBAAiB;SACxB;KAEF,CAAC;IAGJ,eAAC;CAAA;AAtOoB;;;;;;;;;;;;;ACDrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8C;AACG;AACZ;AACI;AAezC,sDAAsD;AACtD;IASE,oBAAY,SAAiB,EAAE,MAAc,EAAE,MAAqB;QAL5D,YAAO,GAAkB,EAAE,CAAC,CAAM,2BAA2B;QAC7D,WAAM,GAAG,CAAC,CAAC,CAAuB,UAAU;QAMlD,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC5B,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QAEtB,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAEvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACpB,CAAC;IAEO,8BAAS,GAAjB,UAAkB,MAAoB;QAEpC,IAAI,MAAM,EAAE;YAEV,IAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;YAC9B,IAAM,KAAK,GAAG,6DAAO,EAAE,CAAC;YAExB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;gBAEhC,IAAM,MAAM,GAAU,MAAM,CAAC,CAAC,CAAC,CAAC;gBAChC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBAEhC,qBAAqB;gBACrB,IAAI,MAAM,CAAC,MAAM,KAAK,KAAK,EAAE;oBAC3B,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;iBACzB;gBAED,IAAI,CAAC,MAAM,EAAG,CAAC;aAChB;SACF;IACH,CAAC;IAEM,+BAAU,GAAjB,UAAkB,KAAa,EAAE,KAAsB;QAAtB,qCAAsB;QAErD,sDAAsD;QACtD,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,KAAK,EAAE;YAE5B,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;YAC7B,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC;YAC/B,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YAChD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;SAE7B;aAAM;YACL,IAAI,CAAC,SAAS,GAAG;gBACf,MAAM,EAAE,IAAI,CAAC,OAAO;gBACpB,SAAS,EAAE,IAAI,CAAC,UAAU;gBAC1B,KAAK,EAAE,KAAK;gBACZ,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE;gBAC/B,QAAQ,EAAE,IAAI;gBACd,MAAM,EAAE,6DAAO,EAAE;aAClB;YAED,IAAI,IAAI,CAAC,MAAM,GAAG,EAAE,EAAE;gBACpB,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;SAEF;QAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QAExC,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,EAAE,EAAE;YAC5B,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;SACtB;IACH,CAAC;IAEM,6BAAQ,GAAf;QAEE,IAAI,MAAM,GAAG,CAAC,CAAC;QACf,IAAI,MAAM,GAAG,CAAC,CAAC;QAEf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAE5C,IAAM,WAAW,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAI,qCAAqC;YAE7E,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC;YAC1C,MAAM,IAAI,WAAW,CAAC;SACvB;QAED,OAAO,MAAM,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9C,CAAC;IAEM,iCAAY,GAAnB;QAEE,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;SAC7B;aAAM;YACL,OAAO,CAAC,CAAC;SACV;IACH,CAAC;IAEM,oCAAe,GAAtB,UAAuB,iBAAiC;QAAjC,4DAAiC;QACtD,IAAI,IAAI,CAAC,SAAS,EAAE;YAElB,IAAM,gBAAgB,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YACpE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC;YAEzC,IAAI,iBAAiB,EAAE;gBACrB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;aACvB;YACD,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;IACH,CAAC;IACH,iBAAC;AAAD,CAAC;;AAED;IAYE,gBAAY,IAAY,EAAE,QAAkB,EAAE,MAAqB;QAL3D,aAAQ,GAAmB,EAAE,CAAC,CAAQ,uEAAuE;QAOnH,IAAM,KAAK,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,EAAE,GAAG,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAE1G,IAAM,QAAQ,GAAY,kEAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAEvD,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;YACtB,OAAO,CAAC,IAAI,CAAC,2DAA2D,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;YACvF,OAAO;SACR;QAED,KAAK,CAAC,eAAe,CAAC,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;QAE/C,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAEM,wBAAO,GAAd;QACE,IAAI,IAAI,CAAC,qBAAqB,EAAE;YAC9B,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;YAClC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;SACnC;IACH,CAAC;IAEM,8BAAa,GAApB;QAEE,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;YAC/B,IAAI,CAAC,qBAAqB,GAAG,IAAI,oDAAe,CAAC,CAAC,CAAC,CAAC,CAAC;YACrD,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,4DAAK,EAAE,CAAC,CAAC;SACtF;IACH,CAAC;IAED,wBAAwB;IAChB,gCAAe,GAAvB,UAAwB,MAAoB,EAAE,OAAsB;QAApE,iBAmCC;QAjCC,IAAI,WAAW,GAAG,CAAC,CAAC;QAEpB,IAAI,MAAM,EAAE;YAEV,IAAM,sBAAsB,GAAW,EAAE,CAAC;YAC1C,IAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC;YAC9B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,EAAE,EAAE;gBAEhC,IAAM,MAAM,GAAU,MAAM,CAAC,CAAC,CAAC,CAAC;gBAEhC,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;oBAC1C,sBAAsB,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;iBAC5C;gBAED,sBAAsB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACpD;YAED,8DAA8D;YAC9D,KAAK,IAAM,GAAG,IAAI,sBAAsB,EAAE;gBACxC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,EAAE,sBAAsB,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC/E,WAAW,EAAG,CAAC;aAChB;SACF;QAED,4BAA4B;QAC5B,IAAI,OAAO,CAAC,MAAM,KAAK,WAAW,EAAE;YAElC,OAAO,CAAC,OAAO,CAAC,UAAC,MAAc;gBAC7B,IAAI,CAAC,KAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;oBACzC,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,IAAI,UAAU,CAAC,KAAI,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;iBACzD;YACH,CAAC,CAAC;SACH;IACH,CAAC;IAED,wDAAwD;IACxD,2BAA2B;IACpB,gCAAe,GAAtB,UAAuB,MAAc,EAAE,MAAc,EAAE,KAAsB;QAAtB,qCAAsB;QAE3E,IAAM,UAAU,GAAe,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACrD,UAAU,CAAC,UAAU,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;QAErC,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAEM,gCAAe,GAAtB;QAEE,IAAI,YAAY,GAAG,CAAC,CAAC;QACrB,IAAI,iBAAiB,GAAG,CAAC,CAAC;QAE1B,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE;YAE/B,IAAM,OAAO,GAAe,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAC/C,IAAM,YAAY,GAAG,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YAE7C,IAAI,YAAY,EAAE;gBAChB,YAAY,EAAG,CAAC;gBAChB,iBAAiB,IAAI,YAAY,CAAC;aACnC;SACF;QAED,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,CAAC,iBAAiB,GAAG,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QAE1E,UAAU;QACV,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;IACxD,CAAC;IAEM,0BAAS,GAAhB;QACE,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAEM,0BAAS,GAAhB,UAAiB,IAAY;QAC3B,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAEM,2BAAU,GAAjB;QAEE,IAAM,YAAY,GAAsB,EAAE,CAAC;QAE3C,KAAK,IAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE;YAC/B,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;SACvC;QAED,OAAO,YAAY,CAAC;IACtB,CAAC;IACH,aAAC;AAAD,CAAC;;;;;;;;;;;;;;AC9QD;AAAA;AAAA;AAAA;IAAA;IAMA,CAAC;IAAD,WAAC;AAAD,CAAC;;AAED;IAKE,mBAAY,SAAiB,EAAE,QAAgB;QAC7C,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC3B,CAAC;IACH,gBAAC;AAAD,CAAC;;;;;;;;;;;;;;ACjBD;AAAA;AAAO,IAAM,WAAW,GAAG;IAEzB,UAAU,EAAE,IAAI;IAChB,aAAa,EAAE,KAAK;IAEpB,OAAO,EAAE,KAAK;IAEd,QAAQ;IACR,qBAAqB;IACrB,gDAAgD;IAChD,6BAA6B;IAE7B,eAAe;IACf,SAAS,EAAE,+BAA+B;IAC1C,WAAW,EAAE,QAAQ;IAErB,MAAM,EAAE,iDAAiD;IAGzD,mBAAmB,EAAE,QAAQ;IAC7B,aAAa,EAAE,gGAAgG;IAE/G,IAAI,EAAE,QAAQ;IACd,IAAI,EAAE,MAAM;IACZ,UAAU,EAAE,CAAC;IAEb,mBAAmB;IACnB,qBAAqB,EAAE;QAErB,aAAa,EAAE,CAAC;QAChB,eAAe,EAAE,EAAE;QACnB,SAAS,EAAE,CAAC;QACZ,QAAQ,EAAE,IAAI;QACd,WAAW,EAAE,IAAI;QACjB,YAAY,EAAE,KAAK;QACnB,UAAU,EAAE,KAAK;QAEjB,mBAAmB,EAAE,GAAG;QACxB,cAAc,EAAE,IAAI;QACpB,oBAAoB,EAAE,EAAE;QACxB,UAAU,EAAE,IAAI;QAEhB,+CAA+C;QAC/C,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,WAAW,EAAE,KAAK;QAClB,OAAO,EAAE,IAAI;QAEb,WAAW;QACX,cAAc,EAAE,CAAC;QACjB,oBAAoB,EAAE,EAAE;QACxB,aAAa,EAAE,CAAC,CAAC;QACjB,QAAQ,EAAE,OAAO;QAEjB,mBAAmB;QACnB,eAAe,EAAE,KAAK;QACtB,UAAU,EAAE,SAAS;QACrB,YAAY,EAAE,KAAK,CAAa,6CAA6C;KAC9E;IAGD,qDAAqD;IACrD,iBAAiB,EAAE;QACjB;YACE,IAAI,EAAE,MAAM;YACZ,EAAE,EAAE,CAAC;YACL,YAAY,EAAE,KAAK;YACnB,YAAY,EAAE,KAAK;YACnB,WAAW,EAAE,KAAK;YAClB,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,KAAK;YACb,QAAQ,EAAE,OAAO;YACjB,oBAAoB,EAAE,GAAG;YACzB,SAAS,EAAE,KAAK;SACjB,EAAE;YACD,IAAI,EAAE,KAAK;YACX,EAAE,EAAE,CAAC;YACL,YAAY,EAAE,KAAK;YACnB,YAAY,EAAE,KAAK;YACnB,WAAW,EAAE,KAAK;YAClB,QAAQ,EAAE,IAAI;YACd,MAAM,EAAE,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI;gBACpE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;gBACrE,KAAK,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC;YAC1C,QAAQ,EAAE,MAAM;YAChB,oBAAoB,EAAE,GAAG;YACzB,SAAS,EAAE,IAAI;YACf,KAAK,EAAE,EAAE;SACV,EAAE;YACD,IAAI,EAAE,KAAK;YACX,EAAE,EAAE,CAAC;YACL,YAAY,EAAE,KAAK;YACnB,YAAY,EAAE,KAAK;YACnB,WAAW,EAAE,KAAK;YAClB,MAAM,EAAE,IAAI;YACZ,QAAQ,EAAE,MAAM;YAChB,oBAAoB,EAAE,GAAG;YACzB,SAAS,EAAE,KAAK;SAEjB,EAAE;YACD,IAAI,EAAE,IAAI;YACV,EAAE,EAAE,CAAC;YACL,YAAY,EAAE,KAAK;YACnB,YAAY,EAAE,KAAK;YACnB,WAAW,EAAE,KAAK;YAClB,MAAM,EAAE,IAAI;YACZ,QAAQ,EAAE,KAAK;YACf,oBAAoB,EAAE,GAAG;YACzB,SAAS,EAAE,KAAK;SACjB,EAAE;YACD,IAAI,EAAE,KAAK;YACX,EAAE,EAAE,CAAC;YACL,YAAY,EAAE,KAAK;YACnB,YAAY,EAAE,KAAK;YACnB,MAAM,EAAE,GAAG;YACX,QAAQ,EAAE,MAAM;YAChB,oBAAoB,EAAE,GAAG;YACzB,SAAS,EAAE,KAAK;SACjB;KACF;CACF,CAAC;;;;;;;;;;;;;ACxHF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkB;AAE6B;AAC4B;AAE9B;AACiB;AACO;AAErE,IAAI,0EAAW,CAAC,aAAa,EAAE;IAC7B,gEAAa,EAAE,CAAC;CACjB;AAED,IAAI,0EAAW,CAAC,UAAU,EAAE;IAC1B,oEAAc,EAAE,CAAC;CAClB;AAED,gGAAsB,EAAE,CAAC,eAAe,CAAC,yDAAS,CAAC;KAChD,KAAK,CAAC,aAAG,IAAI,cAAO,CAAC,KAAK,CAAC,GAAG,CAAC,EAAlB,CAAkB,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;AClBpC,e","file":"main.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","import {Trail, TrailMeta} from '../../type/trail';\nimport {isDevMode} from '@angular/core';\nimport createGpx from 'gps-to-gpx';\nimport {Waypoint} from '../../type/waypoint';\n\n\n/* dev only class for creating clean GPX data (for use with mobile atlas creator to generate tile sets) */\nexport function createGPX(trailMeta: TrailMeta, flatTrailData: any): any {\n\n  const _gpxOptions: object = {\n    activityName: trailMeta.abbr + 'simplified',\n    creator: 'Frank Douwes',\n    startTime: null,\n    timeKey: 'time',\n  }\n\n  flatTrailData.forEach( function(waypoint: any) {\n    delete waypoint.distanceTotal;\n    delete waypoint.nearestToPois;\n    delete waypoint.distance;\n    waypoint['time'] = null;\n  })\n\n  // split in 3\n  // const _fileLength = Math.ceil(flatTrailData.length / 3);\n  // const _arrays = _splitArray(flatTrailData, _fileLength);\n  const _files: Array<any> = [];\n  //\n  // _arrays.forEach(function(fileData) {\n  //   _files.push(createGpx(fileData, _gpxOptions));\n  // });\n\n  _files.push(createGpx(flatTrailData, _gpxOptions));\n  \n  return _files;\n}\n\nfunction _splitArray(array: Array<any>, count: number) {\n  const _res: Array<any> = [];\n  while (array.length) {\n    _res.push(array.splice(0, count));\n  }\n  return _res;\n}\n","// UTILS for colors\n\n// get X (steps) colors inbetween 2 colors\nexport function interpolateColors(color1, color2, steps) {\n\n  const stepFactor = 1 / (steps - 1),\n    interpolatedColorArray = [];\n\n  color1 = color1.match(/\\d+/g).map(Number);\n  color2 = color2.match(/\\d+/g).map(Number);\n\n  for (let i = 0; i < steps; i++) {\n    interpolatedColorArray.push(_interpolateColor(color1, color2, stepFactor * i));\n  }\n\n  return interpolatedColorArray;\n}\n\n// based on https://codepen.io/njmcode/pen/axoyD?editors=0010\nfunction _interpolateColor(color1, color2, factor) {\n  if (arguments.length < 3) {\n    factor = 0.5;\n  }\n  const result = color1.slice();\n  for (let i = 0; i < 3; i++) {\n    result[i] = Math.round(result[i] + factor * (color2[i] - color1[i]));\n  }\n  return result;\n}\n\n// get a darker shade of a color\nexport function shadeColor(color: string, percent: number): string {\n\n  if (!color.startsWith('#')) {\n    console.log('color is not HEX', color);\n    color = '#F00';\n  }\n\n  // hex values\n  let R: number = parseInt(color.substring(1, 3), 16);\n  let G: number = parseInt(color.substring(3, 5), 16);\n  let B: number = parseInt(color.substring(5, 7), 16);\n\n  // decimal values\n  R = parseInt(String(R * (100 + percent) / 100), 10);\n  G = parseInt(String(G * (100 + percent) / 100), 10);\n  B = parseInt(String(B * (100 + percent) / 100), 10);\n\n  // take care of max values\n  R = (R < 255) ? R : 255;\n  G = (G < 255) ? G : 255;\n  B = (B < 255) ? B : 255;\n\n  // create a hex value, both values of the different channels are always the same value 77 CC FF etc,\n  // as the shade does not affect the color\n  const RR = ((R.toString(16).length === 1) ? '0' + R.toString(16) : R.toString(16));\n  const GG = ((G.toString(16).length === 1) ? '0' + G.toString(16) : G.toString(16));\n  const BB = ((B.toString(16).length === 1) ? '0' + B.toString(16) : B.toString(16));\n\n  return '#' + RR + GG + BB;\n}\n","/* just some helper functions to make sure everything is available,\n * useful for debugging in browser (when cordova isn't available) and simple guarding */\n\n/* cordova for native stuff (that tends to be buggy) */\nlet _cordova: any;\n\n/* cordova */\nexport function getCordova(): any {\n  return _cordova;\n}\n\nexport function setCordova(c): void {\n  _cordova = c;\n}\n\nexport function cordovaEnabled(): boolean {\n  return !!(_cordova);\n}\n\n\n\n/* device (general device info) */\nlet _device: any\nexport function setDevice(device: any): void {\n  _device = device\n}\n\nexport function getUUID(): string {\n  if (cordovaEnabled()) {\n    return _device.uuid;\n  } else {\n    return '1234567890';\n  }\n}\n\n\n\n/* screen is used to lock orientation using cordova-plugin-screen-orientation */\nlet _screen: any;\n\nexport function getScreen(): any {\n  return _screen;\n}\n\nexport function setScreen(s): void {\n  _screen = s;\n}\n\n\n\n/* used to test connection using cordova-plugin-network-information */\n/* TODO plugin not working as advertised, what else is new! */\nlet _connection: any;\n\nexport function getConnection(): any {\n  return _connection;\n}\n\nexport function setConnection(c): void {\n  _connection = c;\n}\n\nexport function hasConnection(): boolean {\n  return !!(_connection);\n}\n\n\n\n/* zip plugin cordova */\nlet _zip: any;\n\nexport function setZip(z): void {\n  _zip = z;\n}\n\nexport function getZip(): any {\n  return _zip;\n}\n\nexport function hasZip(): boolean {\n  return !!(_zip);\n}\n\n\n/* cordova dialogs plugin, to use native dialogs for warnings etc. */\nlet _dialogs: any;\n\nexport function setDialogs(d): void {\n  _dialogs = d;\n}\n\nexport function getDialogs(): any {\n  return _dialogs;\n}\n\nexport function hasDialogs(): boolean {\n  return !!(_dialogs);\n}\n\n\n","import {HttpClient, HttpEvent, HttpEventType, HttpHeaders, HttpRequest, HttpResponse} from '@angular/common/http';\nimport {BehaviorSubject, Observable, Subscription} from 'rxjs';\nimport {share} from 'rxjs/operators';\nimport {getExtensionFromString} from '../file';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {DownloaderStatus, DownloaderStatusManager} from './status-manager';\nimport {DownloadParser} from './parser';\nimport {FilesystemService} from '../../service/filesystem.service';\n\nclass FileReference {\n  url: string;\n  path: string;\n\n  constructor(url: string, path: string) {\n    this.url = url;\n    this.path = path;\n  }\n}\n\n\n/* file downloader\nsets type using file extension, currently supports json & blob (zip)\nsupports multiple files for a single downloader (zip parts, due to size limitations/freezing on mobile)\nhas save / unzip / delete file (for zips)\nhas resume download function (for multipart files)\nTODO: should probably be an uploader too... */\nexport class Downloader {\n\n  public meta:                        Observable<DownloaderStatus>;    // the downloader service observes this\n  public downloadedFile:              any;                   // only available if file is not being saved\n  public status:                      DownloaderStatusManager;\n  private _parser:                    DownloadParser;\n  private readonly _metaSubject:      BehaviorSubject<DownloaderStatus>;\n\n  private _downloadRequest:           Subscription;\n  private _fileType:                  string;\n\n  private _urls:                      Array<string>;     // allow sequential downloading\n  private _paths:                     Array<string>;\n  private _cache:                     boolean;\n  private _completedFiles             = 0;\n  private _hasParts:                  boolean;\n\n  constructor(\n    private _name:                    string,\n    private _filesystemService:       FilesystemService,\n    private _httpClient:              HttpClient,\n    private _localStorageService:     LocalStorageService,\n  ) {\n\n    // setup meta subscription\n    this._metaSubject = new BehaviorSubject<DownloaderStatus>(null);\n    this.meta = this._metaSubject.asObservable().pipe(share());\n\n    this.status = new DownloaderStatusManager(this._metaSubject);\n    this._parser = new DownloadParser(_filesystemService, this.status);\n  }\n\n  // allows multipart file downloading\n  private _sequencer(): void {\n\n    if (this._downloadRequest) {\n      this._downloadRequest.unsubscribe();\n      this._downloadRequest = null;\n    }\n\n    this._completedFiles += 1;\n\n    if (this._hasParts) {\n      this._localStorageService.store(this._name + '_filesDownloaded', this._completedFiles);\n    }\n\n    if (this._urls.length > this._completedFiles) {\n      this.downloadFile(this._urls, this._cache, this._paths);\n    } else {\n      if (this._hasParts) {\n        this._localStorageService.clear(this._name + '_filesDownloaded');\n      }\n      this.status.setStatus(new DownloaderStatus('downloader', 'complete', null), false);\n    }\n  }\n\n  // returns the first/next file reference to download based on completed downloads (for multipart)\n  // converts string to array if needed\n  private _setupPaths(urls, paths): FileReference {\n\n    const _storedCompletedCount: number = this._localStorageService.retrieve(this._name + '_filesDownloaded');\n    if (_storedCompletedCount && _storedCompletedCount > this._completedFiles) {\n      this._completedFiles = _storedCompletedCount;\n    }\n\n    if (!this._urls && !this._paths) {\n      if (typeof urls === 'string') {\n        this._hasParts = false;\n        this._paths = [paths];\n        this._urls = [urls];\n      } else {\n        this._hasParts = true;\n        this._paths = paths;\n        this._urls = urls;\n      }\n    }\n\n    return new FileReference(this._urls[this._completedFiles], this._paths[this._completedFiles]);\n  }\n\n  // savePath is the location to save the file, blank == no save, allows renaming (so 'download.zip' can be saved as 'DEMO/test-file.zip')\n  // zips will always be unzipped, .zip will be deleted afterwards.\n  // multipart files (tiles_0.zip, tiles_1.zip etc) will be unzipped in the same directory based on filename part (in this case 'tiles')\n  public downloadFile(urls: string | Array<string>, cache: boolean = true, path?: string | Array<string>): Observable<HttpEvent<any>> {\n\n    const _self = this;\n    const _path: FileReference = this._setupPaths(urls, path);\n\n    this._cache = cache;\n\n    this.status.setStatus(new DownloaderStatus('http', 'initialize', null), true);\n\n    const _extension = getExtensionFromString(_path.url);\n\n    this._fileType = (_extension === 'json') ? _extension : 'blob';\n\n    // TODO: research on cloud storage caching/headers\n    // https://cloud.google.com/storage/docs/gsutil/addlhelp/WorkingWithObjectMetadata\n\n    // let _headers = new HttpHeaders();\n    // if (_extension === 'json') {\n    //   _headers = _headers.append('Content-Type', 'application/json; charset=utf-8');\n    // } else {\n    //   _headers = _headers.append('Content-Type', 'application/zip;');\n    // }\n    //\n    // if (!cache) {\n    //   _headers = _headers.append('Cache-Control', 'no-cache');\n    //   _headers = _headers.append('Pragma', 'no-cache');\n    //   _paths.url += '?' + (Math.random() * Number.MAX_VALUE);\n    // }\n\n    // download file\n    const req = new HttpRequest('GET', _path.url, {\n      reportProgress: true,\n      // headers: _headers,\n      responseType: this._fileType\n    });\n\n    this.downloadedFile = null;\n\n    const _downloadObservable = this._httpClient.request(req);\n    this._downloadRequest = _downloadObservable.subscribe(event => {\n\n      if (event.type === HttpEventType.DownloadProgress) {\n\n        let _downloadPercentage = (event.loaded / event.total) * 100;\n\n        const _completedPerc = (this._completedFiles / this._urls.length) * 100;\n        _downloadPercentage = Number((_completedPerc + (_downloadPercentage / this._urls.length)).toFixed(2));\n\n        const _fileSize = Number(event.total);\n\n        this.status.setStatus(new DownloaderStatus('http', 'progress', {percentage: _downloadPercentage, fileSize: _fileSize}), true);\n\n      } else if (event instanceof HttpResponse) {\n\n        this.downloadedFile = event.body;\n        this.status.setStatus(new DownloaderStatus('http', 'complete', {file: this.downloadedFile}), (_path.path !== null));\n\n        if (!_path.path) {\n\n          // downloader complete\n          this._sequencer();\n          console.log('downloaded file available');\n\n        } else {\n          // save\n          this._parser.saveFile(event.body, _path.path, this._hasParts, this._fileType, function(result) {\n\n            // filesystem complete\n            _self.status.setStatus(new DownloaderStatus('filesystem', result, null), true);\n            _self._sequencer();\n          });\n        }\n      }\n    }, error => {\n      this.cancelDownload();\n      this.status.setStatus(new DownloaderStatus('downloader', 'error', error), false);\n    });\n\n    return _downloadObservable;\n  }\n\n  public cancelDownload(): void {\n\n    if (this._downloadRequest) {\n      this._downloadRequest.unsubscribe();\n      this._downloadRequest = null;\n    }\n\n    this.clearFile();\n\n    if (this._hasParts) {\n      this._localStorageService.clear(this._name + '_filesDownloaded');\n    }\n\n    // blank status\n    this.status.setStatus(new DownloaderStatus('downloader', '', null), false);\n  }\n\n  // clear all files related to this downloader (including unzipped multipart files)\n  public clearFile(): void {\n\n    if (this.downloadedFile) {\n      this.downloadedFile = null;\n    }\n\n    this._parser.clearFile(this._paths, this._completedFiles, this._hasParts);\n\n    this._completedFiles = 0;\n\n    this.status.setStatus(new DownloaderStatus('downloader', 'cleared', null), false);\n  }\n}\n","import {FilesystemService} from '../../service/filesystem.service';\nimport {DownloaderStatus, DownloaderStatusManager} from './status-manager';\nimport {getExtensionFromString} from '../file';\n\nexport class DownloadParser {\n\n  private _onComplete: Function;\n\n  constructor(\n    private _filesystemService: FilesystemService,\n    private _status: DownloaderStatusManager)\n  {}\n\n\n  // FILE SAVING\n\n  public saveFile(data: any, pathName: string, hasParts: boolean, fileType: string, onComplete: Function): void {\n\n    const _self = this;\n\n    this._onComplete = onComplete;\n\n    if (!this._filesystemService.root) {\n\n      alert('No file system available, unable to save files.');\n\n      onComplete('error');\n    }\n\n    this._status.setStatus(new DownloaderStatus('filesystem', 'initialize', null), true);\n\n    this._filesystemService.saveFile(data, null, pathName, function(result) {\n\n      if (fileType !== 'blob') {\n\n        onComplete('complete');\n\n      } else {\n\n        // continue unzipping\n        return _self._unzipFile(pathName, hasParts);\n      }\n    });\n  }\n\n\n\n\n  // UNZIPPING (happens after saving)\n\n  private _unzipFile(pathName: string, hasParts: boolean): void {\n\n    const _self = this;\n\n    const _observer = this._filesystemService.unzip(pathName, hasParts).subscribe(function(result: object) {\n\n      if (result['state'] === 'complete' || result['message'] === 'error') {\n        // success / error\n        _self._onComplete(result['message']);\n      } else if (result['state'] === 'progress') {\n        // progress\n        _self._status.setStatus(new DownloaderStatus('filesystem', 'progress', {percentage: (result['percentage'] * 0.33) + 66}), true);\n      }\n\n      _observer.unsubscribe();\n    });\n  }\n\n\n\n\n  // CLEAR FILE\n\n  public clearFile(paths: Array<string>, completedFiles: number, hasParts: boolean): void {\n\n    const _self = this;\n\n    if (paths && completedFiles > 0) {\n\n      // multiple parts are all extracted in the same directory, therefor this will only have to run once\n      const _extension = getExtensionFromString(paths[0]);\n\n      // if we're dealing with a zip, we'll have to remove the unzipped directory\n      if (_extension === 'zip') {\n\n        const _separator = (hasParts) ? '_' : '.';\n        const _directory = paths[0].split(_separator)[0] + '/';\n\n        _self._filesystemService.deleteDirectory(_directory, function (result): string {\n\n          // nothing here... dead end\n          return;\n        });\n      }\n    } else if (paths) {\n\n      _self._filesystemService.deleteFile(paths[0]);\n    }\n  }\n}\n","import {BehaviorSubject} from 'rxjs';\n\nexport class DownloaderStatus {\n  type:     string;       // http, filesystem or downloader (which are generic complete/error messages).\n  label:    string;\n  data:     any;\n\n  constructor(type: string, label: string, data: any) {\n    this.type = type;\n    this.label = label;\n    this.data = data;\n  }\n}\n\nexport class DownloaderStatusManager {\n\n  public isActiveSubject: BehaviorSubject<boolean>;\n\n  private _meta: BehaviorSubject<DownloaderStatus>\n\n  constructor(meta: BehaviorSubject<DownloaderStatus>) {\n    this.isActiveSubject = new BehaviorSubject<boolean>(false);\n    this._meta = meta;\n  }\n\n  public setStatus(downloaderStatus: DownloaderStatus, active?: boolean): void {\n\n    if (this.isActiveSubject.getValue() !== active) {\n      this.isActiveSubject.next(active);\n    }\n\n    if (downloaderStatus.label !== '') {\n      this._meta.next(downloaderStatus);\n    } else {\n      this._meta.next(null);\n    }\n  }\n}\n","// get the file extension as different filetypes are parsed differently\nexport function getExtensionFromString(filename: string): string {\n\n  const _urlSplit = filename.split('.');\n  if (_urlSplit.length === 1) {\n    alert('are you sure this is a full filename?');\n    return;\n  }\n\n  return _urlSplit[_urlSplit.length - 1];\n}\n\n/* Converts file:// urls to something a local server url, poorly documented nonsense!\nhttps://github.com/ionic-team/capacitor/issues/448\nhttps://stackoverflow.com/questions/52141085/file-uri-path-for-camera-not-working-on-ionic-4\nhttps://forum.ionicframework.com/t/normalizeurl-depricated-cannot-get-webview-convertfilesrc-to-work/136329\nthis is an IONIC webview specific implementation (iOS cordova plugin) */\nexport function convertToIonicUrl(fileUrl: string): string {\n  const _window: any = window;\n\n  //window.Ionic.normalizeURL... does not exist\n\n  if (!_window.Ionic || !_window.Ionic.WebView.convertFileSrc) {\n    alert('Unsupported filesystem.');\n    return;\n  } else {\n    return _window.Ionic.WebView.convertFileSrc(fileUrl);\n  }\n}\n","import * as L from 'leaflet';\n\n// sort an array of objects by a key (in each object)\nexport function sortByKey(array, key) {\n  return array.sort(function(a, b) {\n    const x = a[key];\n    const y = b[key];\n    return ((x < y) ? -1 : ((x > y) ? 1 : 0));\n  });\n}\n\n// returns a clone of the input (instead of a reference, when dealing with nested objects)\nexport function cloneData(input: object): object{\n  return JSON.parse(JSON.stringify(input));\n}\n\nexport function isObjectEmpty(obj:object): boolean {\n  for(const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n  return true;\n}\n","// Adjustments to geoLibs Distance class:\n// - key value for Distance is a string, converting that to a number\n// - added belongsTo, in case points belong to different sources\nimport * as geolib from \"geolib\";\nimport {Waypoint} from '../../type/waypoint';\nimport {environment} from '../../../environments/environment.prod';\n\nexport class Distance {\n\n  public latitude: number;\n  public longitude: number;\n  public distance: number;\n  public belongsTo ?: number;\n\n  private _key?: number;\n\n  get key(): any {\n    return this._key;\n  }\n\n  set key(key: any) {\n    if (typeof key === 'string') {\n      this._key = Number(key);\n    } else {\n      this._key = key;\n    }\n  }\n}\n\n// calculate the distance between 2 points\nexport function calculateDistance(point1: Waypoint, point2: Waypoint): number {\n\n  return geolib.getDistance(\n    {latitude: point1.latitude, longitude: point1.longitude},\n    {latitude: point2.latitude, longitude: point2.longitude}, 1, 4);\n}\n\n// calculate the scale factor of a section (array of waypoints), using the provided length (by author) and the calculated length\nexport function calculateSectionScale(section: Array<Waypoint>, length: number, useMile: boolean = true): number {\n\n  let _calcSectionLength = 0;\n  let _prevPoint: Waypoint;\n\n  const _length: number = section.length;\n  for (let i = 0; i < _length; i++) {\n\n    const _point: Waypoint = section[i];\n\n    if (_prevPoint) {\n      _calcSectionLength += calculateDistance(_prevPoint, _point);\n    }\n\n    _prevPoint = _point;\n  }\n\n  // convert to mile\n  if (useMile) {\n    _calcSectionLength = _calcSectionLength / environment.MILE;\n  }\n\n  const _scale = length / _calcSectionLength;\n\n  return _scale;\n}\n","import * as L from 'leaflet';\nimport {Waypoint} from '../../type/waypoint';\nimport {waypointToLatLng} from './converter';\nimport {Mile} from '../../type/mile';\nimport {Distance} from '../geolib/distance';\n\n/* calculate the nearest point on trail for a given location */\nexport function calculateTrailAnchorPoint(mile: Mile, nearestPoints: Array<Distance>): Waypoint {\n\n  const _nearestPoint = mile.waypoints[Number(nearestPoints[0].key)];\n  const _2ndNearestPoint = mile.waypoints[Number(nearestPoints[1].key)];\n\n  let _location: Waypoint = calculatePointBasedOnDistance(nearestPoints, [_nearestPoint, _2ndNearestPoint]);\n\n  /* found a loop/bend, which causes the _nearestPoint keys to not be in a consecutive order.\n  1. figure out the trailDistance between the 2 nearest points\n  2. find a point within all points that's closest to that trailDistance\n  3. do the distance calculation again with 2 points based on that centerpoint.\n  *. this is 'good enough', a trade-off between performance and slightly less optimal overlay/popup locations. */\n  if (Number(nearestPoints[1].key) !== Number(nearestPoints[0].key) + 1\n    && Number(nearestPoints[1].key) !== Number(nearestPoints[0].key) - 1) {\n\n    let _selectionWaypoints;\n\n    if (nearestPoints[0].key < nearestPoints[1].key) {\n      _selectionWaypoints = mile.waypoints.slice(nearestPoints[0].key, nearestPoints[1].key + 1);\n    } else {\n      _selectionWaypoints = mile.waypoints.slice(nearestPoints[1].key, nearestPoints[0].key + 1);\n    }\n\n    // sorting the selection based on the distance of the locations distance\n    _selectionWaypoints.sort(function (a, b) {\n      return Math.abs(_location.distance - a.distance) - Math.abs(_location.distance - b.distance);\n    });\n\n    _location = calculatePointBasedOnDistance(nearestPoints, [_selectionWaypoints[0], _selectionWaypoints[1]]);\n  }\n\n  return _location;\n}\n\n/* calculate a new waypoint based on the distance from 2 waypoints (using a distance sorted array (from GeoLib)\n* calculates a point (x) inline (between p1 & p2), based on the distance of p1 and p2 from y (labeled d1 and d2)\n*\n*   p1 --------- x ---------- p2\n*    .                      .\n*       .                .\n*     (d1) .          .  (d2)\n*             .     .\n*                y\n*                                   */\nfunction calculatePointBasedOnDistance(distancePoints: Array<any>, waypoints: Array<Waypoint>, returnAsLatlng: boolean = false): Waypoint | L.latlng {\n\n  // get the waypoints from a mile\n  const _point1: Waypoint = waypoints[0];\n  const _point2: Waypoint = waypoints[1];\n\n  const _distancePerc = distancePoints[0].distance / (distancePoints[0].distance + distancePoints[1].distance);\n\n  // calculate new props based on distance percentage\n  const _props: Array<string> = ['latitude', 'longitude', 'elevation', 'distance', 'distanceTotal'];\n  const _length: number = _props.length;\n\n  const _waypoint = {};\n\n  for (let i = 0; i < _length; i++) {\n    const _prop = _props[i];\n    _waypoint[_prop] = _point1[_prop] + (((_point2[_prop] - _point1[_prop]) / 2) * _distancePerc);\n  }\n\n  if (returnAsLatlng) {\n    return waypointToLatLng(_waypoint as Waypoint) as L.latLng;\n  } else {\n    return _waypoint as Waypoint;\n  }\n}\n","import {Waypoint} from '../../type/waypoint';\nimport * as L from 'leaflet';\n\n// define the seperate converter functions for easier referencing\nconst _converters = {\n  flat_waypoint: flatToWaypoint,\n  latlng_waypoint: latLngToWaypoint,\n  waypoint_latlng: waypointToLatLng,\n  waypoint_flat: waypointToFlat,\n  waypoint_waypoint: waypointToWaypoint\n};\n\n// convert an array of Waypoints in a specified format to another format)\nexport function pointArrayTypeConversion(waypoints: Array<any>, from: 'waypoint' | 'latlng' | 'flat', to: 'waypoint' | 'latlng' | 'flat'): any {\n\n  const _length = waypoints.length;\n  const _returnArr: Array<L.latlng> = [];\n\n  const _converter = _converters[from + '_' + to];\n\n  if (!_converter) {\n    console.warn('No converter for ' + from + ' to ' + to);\n  }\n\n  for (let i = 0; i < _length; i++) {\n    _returnArr.push(_converter(waypoints[i]));\n  }\n\n  return _returnArr;\n}\n\n// convert a single Waypoint to a Latlng (that leaflet uses), optional elevation\nexport function waypointToLatLng(waypoint: Waypoint): L.latlng {\n  return L.latLng(waypoint.latitude, waypoint.longitude, waypoint.elevation);\n}\n\n\n// convert a latlng to a waypoint, optional elevation\nexport function latLngToWaypoint(latlng: L.latLng): Waypoint {\n\n  const _waypoint: Waypoint = {\n    latitude: latlng.lat,\n    longitude: latlng.lng\n  };\n\n  if (latlng.alt) {\n    _waypoint.elevation = latlng.alt;\n  }\n\n  return _waypoint;\n}\n\n// convert flat data to waypoint (assuming an array with structure [latitude:number, longitude: number, elevation?:number]\nexport function flatToWaypoint(flat: Array<number>): Waypoint {\n\n  const _waypoint: Waypoint = {\n    latitude: flat[0],\n    longitude: flat[1]\n  };\n\n  if (flat[2]) {\n    _waypoint.elevation = flat[2];\n  }\n\n  return _waypoint;\n}\n\n\n// convert flat data to waypoint (assuming an array with structure [latitude:number, longitude: number, elevation?:number]\nexport function waypointToFlat(waypoint: Waypoint): Array<number> {\n\n  const _flat: Array<number> = [waypoint.latitude, waypoint.longitude];\n\n  if (waypoint.elevation) {\n    _flat.push(waypoint.elevation);\n  }\n\n  return _flat;\n}\n\n\n// convert waypoint to waypoint, turns string to numbers\nexport function waypointToWaypoint(waypoint: Waypoint): Waypoint {\n\n  const _waypoint: any = {};\n\n  for (const key in waypoint) {\n    _waypoint[key] = Number(waypoint[key]);\n  }\n\n  return _waypoint as Waypoint;\n}\n","import * as L from 'leaflet';\nimport {toPoint as point} from 'node_modules/leaflet/src/geometry/Point';\n\n/* creates a leaflet icon out of an html element\nthe default divIcon class (that's being extended) uses innerHTML() which breaks svg href links in iOS/Safari*/\nconst _htmlIcon = L.DivIcon.extend({\n\n  createIcon: function (oldIcon) {\n    const _div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : this.options.html,\n      options = this.options;\n\n    if (options.bgPos) {\n      const bgPos = point(options.bgPos);\n      _div.style.backgroundPosition = (-bgPos.x) + 'px ' + (-bgPos.y) + 'px';\n    }\n    this._setIconStyles(_div, 'icon');\n\n    return _div;\n  }\n});\n\nexport function htmlIcon(options) {\n  return new _htmlIcon(options);\n}\n","import * as L from 'leaflet';\nimport {fallbackLayer} from './tiles';\nimport {getTrailMetaDataByAbbr} from '../trail-meta';\nimport {environment} from '../../../environments/environment.prod';\n\n// create the main map tile layer, based on the custom fallback tile.\n// if there's an internet connection use arcGis, else use locally stored tiles (or default error tile)\nexport function createMapTileLayer(url: string, detectRetina: boolean): any {\n\n  const _fallbackUrl = environment.onlineTileUrl;\n\n  const _fallbackLayer = fallbackLayer(url,\n    {\n      // regular min & max zoom prop causes flickering\n      minNativeZoom: 15,\n      maxNativeZoom: 15,\n      fallbackTileUrl: _fallbackUrl,\n      errorTileUrl: './assets/images/missing.png',\n      keepBuffer: 0,    // small buffer means faster scrolling\n      updateWhenIdle: false,\n      updateWhenZooming: false,\n      detectRetina: detectRetina\n    });\n\n  return _fallbackLayer;\n}\n\n\n\n/* grid (TODO: overlapping grid issues, investigate UTM grids)\nconsidering rewriting this: https://github.com/ggolikov/Leaflet.gmxIndexGrid for leafelt 1.x\ncreates a square mile grid layer array (currently they're sliced into UTM zones, would prefer a single layer) */\nexport function createGridLayer(trailAbbr: string): Array<any> {\n\n  const _gridLayers: Array<any> = [];\n\n  const _trailUtm: Array<number> = getTrailMetaDataByAbbr(trailAbbr).utm;\n\n  if (_trailUtm) {\n\n    _trailUtm.forEach(function (zone) {\n\n      const _utmGrid = L.utmGrid(zone, false, {\n        color: '#AAA',\n        showAxis100km: false,\n        weight: 1,\n        minInterval: environment.MILE,\n        maxInterval: environment.MILE,\n        opacity: 1,\n      });\n\n      _gridLayers.push(_utmGrid);\n    });\n  }\n\n  return _gridLayers;\n}\n","import * as L from 'leaflet';\n/* simple mixin to force a z-index for a marker\nthis overrides the default index sorting leaflet has.\nused for the User marker (always on top) */\n(function (global) {\n    var MarkerMixin = {\n        _updateZIndex: function (offset) {\n            this._icon.style.zIndex = this.options.forceZIndex ? (this.options.forceZIndex + (this.options.zIndexOffset || 0)) : (this._zIndex + offset);\n        },\n        setForceZIndex: function (forceZIndex) {\n            console.log('force');\n            this.options.forceZIndex = forceZIndex ? forceZIndex : null;\n        }\n    };\n    if (global)\n        global.include(MarkerMixin);\n})(L.Marker);\n/**\n * Copyright (C) 2013 Maxime Hadjinlian <maxime.hadjinlian@gmail.com>\n * All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * - Redistributions of source code must retain the above copyright notice,\n *   this list of conditions and the following disclaimer.\n *\n * - Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n */\n(function () {\n    // Retain the value of the original onAdd and onRemove functions\n    var originalOnAdd = L.Marker.prototype.onAdd;\n    var originalOnRemove = L.Marker.prototype.onRemove;\n    // Add bounceonAdd options\n    L.Marker.mergeOptions({\n        bounceOnAdd: false,\n        bounceOnAddOptions: {\n            duration: 1000,\n            height: -1,\n            loop: 1,\n        },\n        bounceOnAddCallback: function () { },\n    });\n    L.Marker.include({\n        _toPoint: function (latlng) {\n            return this._map.latLngToContainerPoint(latlng);\n        },\n        _toLatLng: function (point) {\n            return this._map.containerPointToLatLng(point);\n        },\n        _motionStep: function (opts) {\n            var self = this;\n            var timePassed = new Date().getTime() - opts.start;\n            var progress = timePassed / opts.duration;\n            if (progress > 1) {\n                progress = 1;\n            }\n            var delta = self._easeOutBounce(progress);\n            opts.step(delta);\n            if (progress === 1) {\n                opts.start = new Date().getTime();\n                progress = 0;\n                if (opts.loop > 0)\n                    opts.loop = opts.loop - 1;\n                if (opts.loop === 0) {\n                    opts.end();\n                    return;\n                }\n            }\n            self._animationId = L.Util.requestAnimFrame(function (timestamp) {\n                self._motionStep(opts);\n            });\n        },\n        _bounceMotion: function (opts, callback) {\n            var original = L.latLng(this._origLatlng);\n            var start_y = this._dropPoint.y;\n            var start_x = this._dropPoint.x;\n            var distance = this._point.y - start_y;\n            var self = this;\n            self._animationId = L.Util.requestAnimFrame(function () {\n                self._motionStep({\n                    duration: opts.duration || 1000,\n                    loop: opts.loop || 1,\n                    start: new Date(),\n                    step: function (delta) {\n                        self._dropPoint.y =\n                            start_y\n                                + (distance * delta)\n                                - (self._map.project(self._map.getCenter()).y - self._origMapCenter.y);\n                        self._dropPoint.x =\n                            start_x\n                                - (self._map.project(self._map.getCenter()).x - self._origMapCenter.x);\n                        self.setLatLng(self._toLatLng(self._dropPoint));\n                    },\n                    end: function () {\n                        self.setLatLng(original);\n                        if (typeof callback === 'function')\n                            callback();\n                    },\n                });\n            });\n        },\n        // Many thanks to Robert Penner for this function\n        _easeOutBounce: function (pos) {\n            if ((pos) < (1 / 2.75)) {\n                return (7.5625 * pos * pos);\n            }\n            else if (pos < (2 / 2.75)) {\n                return (7.5625 * (pos -= (1.5 / 2.75)) * pos + 0.75);\n            }\n            else if (pos < (2.5 / 2.75)) {\n                return (7.5625 * (pos -= (2.25 / 2.75)) * pos + 0.9375);\n            }\n            else {\n                return (7.5625 * (pos -= (2.625 / 2.75)) * pos + 0.984375);\n            }\n        },\n        // Bounce : if options.height in pixels is not specified, drop from top.\n        // If options.duration is not specified animation is 1s long.\n        bounce: function (options, endCallback) {\n            if (typeof options === 'function') {\n                endCallback = options;\n                options = null;\n            }\n            options = options || { duration: 1000, height: -1, loop: 1 };\n            // backward compatibility\n            if (typeof options === 'number') {\n                options['duration'] = arguments[0];\n                options['height'] = arguments[1];\n            }\n            // Keep original map center\n            this._origMapCenter = this._map.project(this._map.getCenter());\n            this._dropPoint = this._getDropPoint(options.height);\n            this._bounceMotion(options, endCallback);\n        },\n        stopBounce: function () {\n            // We may have modified the marker; so we need to place it where it\n            // belongs so next time its coordinates are not changed.\n            this.setLatLng(this._origLatlng);\n            L.Util.cancelAnimFrame(this._animationId);\n        },\n        // This will get you a drop point given a height.\n        // If no height is given, the top y will be used.\n        _getDropPoint: function (height) {\n            // Get current coordidates in pixel\n            this._point = this._toPoint(this._origLatlng);\n            var top_y;\n            if (height === undefined || height < 0) {\n                top_y = this._toPoint(this._map.getBounds()._northEast).y;\n            }\n            else {\n                top_y = this._point.y - height;\n            }\n            return new L.Point(this._point.x, top_y);\n        },\n        onAdd: function (map) {\n            this._map = map;\n            // Call leaflet original method to add the Marker to the map.\n            originalOnAdd.call(this, map);\n            // Keep original latitude and longitude\n            this._origLatlng = this.getLatLng();\n            if (this.options.bounceOnAdd === true) {\n                this.bounce(this.options.bounceOnAddOptions, this.options.bounceOnAddCallback);\n            }\n        },\n        onRemove: function (map) {\n            this.stopBounce();\n            originalOnRemove.call(this, map);\n        },\n    });\n})();\n//# sourceMappingURL=marker.js.map","// leaflet metric grid from https://github.com/bill-chadwick/Leaflet.MetricGrid (not an npm package)\n/**\n *  A general purpose metric grid overlay for Leaflet.\n *  Designed to show grids such as the British, Irish and UTM.\n *  Such grids are composed of fixed size squares and were\n *  traditionally used for estimating grid references on printed maps.\n *  The grid is restricted to 100m, 1km, 10km or 100km intervals (more intervals would be possible but unusual).\n *  Most grids repeat their numbering every 100km.\n *  Grid lines will tend to straight as a Web Mercator map is zoomed in.\n *  At low zooms, the minimum number of straight line segments are used to\n *  draw grid lines that project as curves on Web Mercator.\n *  Depends on proj4.js 2.5.0 or later\n *  Author: bill.chadwick2@gmail.com\n *  Inspired by lanwei@cloudybay.com.tw and Open Layers 3\n */\n\nvar proj4 = window['proj4'];\n\nL.MetricGrid = L.Layer.extend({\n\n  options: {\n\n    proj4ProjDef: \"must be provided\",                    // must be provided\n    bounds: [[0, 0] , [0, 0]],                           // must be provided. First coord is bottom left, second is top right in [x,y] format\n    clip: null,                                          // optional, clip polygon in grid coordinates\n    latLonClipBounds: null,                              // optional, Leaflet.LatLngBounds or equivalent array\n    drawClip: false,                                     // optional, when true, the clip bounds are drawn with the same pen as the grid\n    hundredKmSquareFunc: function(e, n) {return \"\";},    // optional, params are eastings and northings in metres\n\n    showAxisLabels: [100, 1000, 10000],                  // show axis for listed grid spacings - omit 100000\n    showAxis100km: false,\n    showSquareLabels: [],                                // show square labels for listed grid spacings\n    opacity: 0.7,\n    weight: 2,                                           // use 2 for best results, else label rub-out is less good (antialiased pixels)\n    color: \"#00f\",\n    font: \"bold 16px Verdana\",\n    minInterval: 100,                   // minimum grid interval in metres\n    maxInterval: 100000,                // maximum grid interval in metres, the bounds values should be multiples of this\n    minZoom: 4                          // minimum zoom at which grid is drawn\n  },\n\n\n  // Pseudo class constructor\n  initialize: function (options) {\n\n    L.setOptions(this, options); // merge with default options above\n\n    if (!this.options.fontColor) {\n      this.options.fontColor = this.options.color;\n    }\n  },\n\n\n  // Base class override\n  onAdd: function (map) {\n\n    this._map = map;\n\n    if (!this._container) {\n      this._initCanvas();\n    }\n\n    map._panes.overlayPane.appendChild(this._container);\n    map.on(\"viewreset\", this._reset, this);\n    map.on(\"move\", this._reset, this);\n    map.on(\"moveend\", this._reset, this);\n\n    this._reset();\n  },\n\n\n  // Base class override\n  onRemove: function (map) {\n\n    map.getPanes().overlayPane.removeChild(this._container);\n    map.off(\"viewreset\", this._reset, this);\n    map.off(\"move\", this._reset, this);\n    map.off(\"moveend\", this._reset, this);\n  },\n\n\n  // Base class override\n  addTo: function (map) {\n    map.addLayer(this);\n    return this;\n  },\n\n\n  // Base class override, unlikely to be needed\n  getAttribution: function () {\n    return this.options.attribution;\n  },\n\n\n  // MetricGrid method\n  setOpacity: function (opacity) {\n    this.options.opacity = opacity;\n    this._updateOpacity();\n    return this;\n  },\n\n\n  // MetricGrid method\n  bringToFront: function () {\n    if (this._canvas) {\n      this._map._panes.overlayPane.appendChild(this._canvas);\n    }\n    return this;\n  },\n\n\n  // MetricGrid method\n  bringToBack: function () {\n    var pane = this._map._panes.overlayPane;\n    if (this._canvas) {\n      pane.insertBefore(this._canvas, pane.firstChild);\n    }\n    return this;\n  },\n\n\n  // Private method to initialize a drawing canvas for the grid.\n  // No animation support (yet).\n  _initCanvas: function () {\n\n    this._container = L.DomUtil.create(\"div\", \"leaflet-image-layer\");\n    this._canvas = L.DomUtil.create(\"canvas\", \"\");\n    this._updateOpacity();\n    this._container.appendChild(this._canvas);\n\n    // No canvas interactions, but bind canvas onload to our _onCanvasLoad\n    L.extend(this._canvas, {\n      onselectstart: L.Util.falseFn,\n      onmousemove: L.Util.falseFn,\n      onload: L.bind(this._onCanvasLoad, this)\n    });\n  },\n\n\n  // Sets the clip region for a grid.\n  // Useful at low zooms to prevent multiple grids drawing on top of each other.\n  // See the demo for clipping of the British and Irish grids.\n  // The clip path is specified in the options as an array of grid coordinates.\n  // These should represent a simple closed polygon and start and end with the same point.\n  // Individual points are an array of two coordinates - east/x then north/y.\n  // The clip outline is drawn using the same pen (color and width) as the grid lines\n  // Clipping is only used if one or more of the corners of the grid covering the visible map\n  // lie outside of the clipping path.\n  _setClip: function (ctx) {\n\n    var map = this._map;\n    var proj = this.options.proj4ProjDef;\n    var i;\n\n    if (this.options.clip) {\n\n      // iterate the segments of the clip path\n      var x2;\n      var y2;\n      var x1;\n      var y1;\n      var dX;\n      var dY;\n      var pts;\n      var j;\n\n      for(i=0; i < (this.options.clip.length-1); i+=1) {\n\n        x2 = this.options.clip[i+1][0];\n        x1 = this.options.clip[i][0];\n        y2 = this.options.clip[i+1][1];\n        y1 = this.options.clip[i][1];\n        dX = x2-x1;\n        dY = y2-y1;\n\n        // interpolate a point along the line segment\n        function _interpolate (frac) {\n          return proj4(proj).inverse([x1 + (frac * dX), y1 + (frac * dY)]);\n        }\n\n        // get set of Web Mercator line segments fitted to this segment with a maximum error of 1 pixel\n        pts = this._getPoints(_interpolate, 1.0, map);\n\n        // draw the clip path segment\n        j = 0;\n        if (i == 0) {\n          ctx.beginPath();\n          ctx.moveTo(pts[0].x, pts[0].y);\n          j = 1;\n        }\n        for (j=j; j < pts.length; j+=1) {\n          ctx.lineTo(pts[j].x, pts[j].y);\n        }\n      }\n\n      // finish the path and set the clip region\n      if (this.options.drawClip) {\n        ctx.stroke();\n      }\n      ctx.clip();\n\n\n\n    }\n  },\n\n  // sets a rectangular lat/lon clip\n  // the latLonClipBounds should be [[bottom lat, left lon],[top lat, right lon]]\n  // return is clip bounds in canvas coords\n  _setLLClipBounds: function (ctx, map) {\n\n    var b = L.latLngBounds(this.options.latLonClipBounds);\n    var bl = map.latLngToContainerPoint(b.getSouthWest());\n    var tr = map.latLngToContainerPoint(b.getNorthEast());\n\n    ctx.beginPath();\n    ctx.moveTo(bl.x, bl.y);\n    ctx.lineTo(tr.x, bl.y);\n    ctx.lineTo(tr.x, tr.y);\n    ctx.lineTo(bl.x, tr.y);\n    ctx.lineTo(bl.x, bl.y);\n\n    // finish the path and set the clip region\n    if (this.options.drawClip) {\n      ctx.stroke();\n    }\n    ctx.clip();\n\n    // LL bounds in canvas coords, for use when labelling\n    return L.bounds(bl, tr);\n  },\n\n\n  // redraw the overlay after a map pan or zoom etc\n  _reset: function () {\n\n    var container = this._container;\n    var canvas = this._canvas;\n    var size = this._map.getSize();\n    var lt = this._map.containerPointToLayerPoint([0, 0]);\n\n    // position the canvas ontop of the map\n    L.DomUtil.setPosition(container, lt);\n\n    container.style.width = size.x + \"px\";\n    container.style.height = size.y + \"px\";\n\n    canvas.width  = size.x;\n    canvas.height = size.y;\n    canvas.style.width  = size.x + \"px\";\n    canvas.style.height = size.y + \"px\";\n\n    this._draw();\n  },\n\n\n  // fire a Layer loaded event\n  _onCanvasLoad: function () {\n    this.fire(\"load\");\n  },\n\n\n  // internal opacity control\n  _updateOpacity: function () {\n    L.DomUtil.setOpacity(this._canvas, this.options.opacity);\n  },\n\n\n  // Formats eastings or northings within a 100km square for axis / square labelling\n  // Most grids repeat their numbering every 100km\n  // If grid spacing < 1km, uses 3 digits,\n  // else if grid spacing < 10km uses 2 digits,\n  // else one digit\n  _formatEastOrNorth(n, spacing) {\n\n    var r;\n    var h = Math.floor(n / 100000);\n    n = n % 100000; // metres within 100km square\n\n    if (spacing < 1000) {\n      r = Math.floor(n / 100).toString();\n      r = (r.length == 1) ? \"0\" + r : r;\n      r = (r.length == 2) ? \"0\" + r : r;\n    }\n    else if (spacing < 10000) {\n      r = Math.floor(n / 1000).toString();\n      r = (r.length == 1) ? \"0\" + r : r;\n    }\n    else {\n      r = Math.floor(n / 10000).toString();\n    }\n\n    // prepend hundreds of km in subscript\n    if (this.options.showAxis100km) {\n      var hs = h.toString();\n      var i;\n      for(i = (hs.length-1); i >= 0; i--) {\n        r = String.fromCharCode(hs.charCodeAt(i) + 8272) + r;\n      }\n    }\n\n    return r;\n  },\n\n\n  // Formats eastings value for grid line labels\n  // This shows distance within each 100 km grid square - most grid stytems work like this\n  _format_eastings: function(eastings, spacing) {\n    return this._formatEastOrNorth(eastings, spacing);\n  },\n\n\n  // Formats northings value for grid line labels\n  // This shows distance within each 100 km grid square - most grid stytems work like this\n  _format_northings: function(northings, spacing) {\n    return this._formatEastOrNorth(northings, spacing);\n  },\n\n\n  // Calculates map scale at the center of map in metres per pixel\n  // On a Web Mercator map, scale changes with latitude (y axis)\n  _mPerPx: function()\n  {\n    // get map resolution by moving 1 pixel at the center\n    var ll1 = this._map.getCenter();\n    var p1 = this._map.project(ll1);\n    var p2 = p1.add(new L.Point(1,0));\n    var ll2 = this._map.unproject(p2);\n    return ll1.distanceTo(ll2);\n  },\n\n\n  // Determines graticule interval according to map scale\n  // Because the grid can only be a power of 10 and map zooms are powers of two\n  // some zooms will have small grid squares and some large.\n  // The only way around this would be to introduce grids at decimal multiples of say 2 and 5 meters.\n  // We don't do that as such a grid square can not be properly labeled.\n  _calcInterval: function() {\n\n    var mPerPx = this._mPerPx();\n\n    // select the grid interval according to the map resolution\n    // TODO make these limits into an option perhaps setting spacing by zoom\n    var spacing;\n    if (mPerPx <= 1) {\n      spacing = 100;\n    } else if (mPerPx <= 20) {\n      spacing = 1000;\n    } else if (mPerPx <= 175) {\n      spacing = 10000;\n    } else {\n      spacing = 100000;\n    }\n\n    //limit to min/max interval\n    if (spacing < this.options.minInterval) {\n      spacing = this.options.minInterval;\n    }\n    if (spacing > this.options.maxInterval) {\n      spacing = this.options.maxInterval;\n    }\n\n    return spacing;\n  },\n\n  // Finds the set of screen points corresponding to a grid line.\n  // Most metric grid lines are nearly straight on a Web Mercator map, especially when zoomed in.\n  // We use the minimum number of line segments that represent the actual grid line,\n  // by chopping the grid line into a set of straight line segments that fit the grid line curve with less\n  // than 1 screen pixel of error.\n  // This approach can be used to draw e.g. a great circle on a Web Mercator map.\n  // However if the WM curve of your line has a point of inflexion then you will need to\n  // proceed in two parts about the inflexion.\n  // There is an inflexion when a Great Circle crosses the equator on a WM map.\n  //\n  // The interpolate function should return the Lat/Lon of point a for a fraction of 0.0\n  // and the Lat/Lon of point b for a fraction of 1.0.\n  //\n  // This code is adapted from OpenLayers 3\n  //\n  _getPoints: function (interpolate, tolerance, map) {\n\n    var geoA = interpolate(0);\n    var geoB = interpolate(1);\n\n    var a = map.latLngToContainerPoint(L.latLng(geoA[1], geoA[0]));\n    var b = map.latLngToContainerPoint(L.latLng(geoB[1], geoB[0]));\n\n    var coords = [];\n    var geoStack = [geoB, geoA];\n    var stack = [b, a];\n    var fractionStack = [1, 0];\n    var fractions = {};\n    var maxIterations = 1000;\n    var geoM;\n    var m;\n    var fracA;\n    var fracB;\n    var fracM;\n    var key;\n\n    while (--maxIterations > 0 && fractionStack.length > 0) {\n      // Pop the a coordinate off the stack\n      fracA = fractionStack.pop();\n      geoA = geoStack.pop();\n      a = stack.pop();\n\n      // Add the a coordinate if it has not been added yet\n      key = fracA.toString();\n      if (!fractions[key]) {\n        coords.push(a);\n        fractions[key] = true;\n      }\n\n      // Pop the b coordinate off the stack\n      fracB = fractionStack.pop();\n      geoB = geoStack.pop();\n      b = stack.pop();\n\n      // Find the m point between the a and b coordinates\n      fracM = (fracA + fracB) / 2;\n      geoM = interpolate(fracM);\n      m = map.latLngToContainerPoint(L.latLng(geoM[1], geoM[0]));\n\n      if (L.LineUtil.pointToSegmentDistance(m, a, b) < tolerance){\n        // If the m point is sufficiently close to the straight line, then we\n        // discard it.  Just use the b coordinate and move on to the next line\n        // segment.\n        coords.push(b);\n        key = fracB.toString();\n        fractions[key] = true;\n      }\n      else {\n        // Otherwise, we need to subdivide the current line segment.  Split it\n        // into two and push the two line segments onto the stack.\n        fractionStack.push(fracB, fracM, fracM, fracA);\n        stack.push(b, m, m, a);\n        geoStack.push(geoB, geoM, geoM, geoA);\n      }\n    }\n    return coords;\n  },\n\n\n  // Determine if a point lies inside a polygon\n  // This is used to check if a point lies outside the clipping region.\n  // vs is an array of 2d points [[x,y],,,]\n  _inside: function (point, vs) {\n    // ray-casting algorithm based on\n    // http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n\n    var x = point[0];\n    var y = point[1];\n    var i;\n\n    var inside = false;\n    for (i = 0, j = vs.length - 1; i < vs.length; j = i++) {\n      var xi = vs[i][0], yi = vs[i][1];\n      var xj = vs[j][0], yj = vs[j][1];\n\n      var intersect = ((yi > y) != (yj > y))\n        && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n      if (intersect) inside = !inside;\n    }\n\n    return inside;\n  },\n\n\n  // Draw the grid.\n  // We compute, in the current grid interval, a bounding box that contains the map view.\n  // Then we draw vertical and horizontal grid lines for that box.\n  // Then we optionally label the left and right axis, taking care to avoid colliding labels.\n  // Then we optionally label each grid square in its bottom left corner.\n  _draw: function() {\n\n    var canvas = this._canvas;\n    var map = this._map;\n\n    if (L.Browser.canvas && map && ((map.getZoom() >= this.options.minZoom))) {\n\n      var spacing = this._calcInterval();\n      var proj = this.options.proj4ProjDef\n      var ctx = canvas.getContext(\"2d\");\n\n      //set up canvas for drawing and writing\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.setLineDash([3, 2]);\n      ctx.lineWidth = this.options.weight;\n      ctx.strokeStyle = this.options.color;\n      ctx.fillStyle = this.options.fontColor;\n\n      if (this.options.font) {\n        ctx.font = this.options.font;\n      }\n      var txtWidth = ctx.measureText(\"0\").width;\n      var txtHeight;\n      var _font_frags = ctx.font.split(\" \");\n      var i;\n      for (i=0; i < _font_frags.length; i+=1) {\n        txtHeight = parseInt(_font_frags[i], 10);\n        if (!isNaN(txtHeight)) {\n          break;\n        }\n      }\n\n      // get bounds of map corners in grid projection\n      var mapB = map.getBounds();\n      var mapSW = mapB.getSouthWest();\n      var mapNE = mapB.getNorthEast();\n      var mapNW = mapB.getNorthWest();\n      var mapSE = mapB.getSouthEast();\n      var mapSWg = proj4(proj).forward([mapSW.lng, mapSW.lat]);\n      var mapNEg = proj4(proj).forward([mapNE.lng, mapNE.lat]);\n      var mapNWg = proj4(proj).forward([mapNW.lng, mapNW.lat]);\n      var mapSEg = proj4(proj).forward([mapSE.lng, mapSE.lat]);\n\n      //also the middles of the sides of the map\n      var mapSMg = proj4(proj).forward([mapB.getCenter().lng, mapB.getSouth()]);\n      var mapNMg = proj4(proj).forward([mapB.getCenter().lng, mapB.getNorth()]);\n      var mapWMg = proj4(proj).forward([mapB.getWest(), mapB.getCenter().lat]);\n      var mapEMg = proj4(proj).forward([mapB.getEast(), mapB.getCenter().lat,]);\n\n      // extend grid bounds to enclose the map corners\n      var grdWx = Math.min(mapSWg[0], mapNWg[0]);\n      var grdEx = Math.max(mapSEg[0], mapNEg[0]);\n      var grdSy = Math.min(mapSWg[1], mapSEg[1]);\n      var grdNy = Math.max(mapNWg[1], mapNEg[1]);\n\n      // extend grid bounds to enclose the middles of the sides\n      grdWx = Math.min(mapWMg[0], grdWx);\n      grdEx = Math.max(mapEMg[0], grdEx);\n      grdSy = Math.min(mapSMg[1], grdSy);\n      grdNy = Math.max(mapNMg[1], grdNy);\n\n      // round up/down based on the spacing\n      grdWx = Math.floor(grdWx / spacing) * spacing;\n      grdSy = Math.floor(grdSy / spacing) * spacing;\n      grdEx = Math.ceil(grdEx / spacing) * spacing;\n      grdNy = Math.ceil(grdNy / spacing) * spacing;\n\n      var canvasClipBounds = null;\n      if (this.options.clip) {\n        // if any of the corners of our grid are outside the clip path then we need to clip\n        // must do this before restricting to grid bounds\n\n        var swInClip = this._inside([grdWx, grdSy], this.options.clip);\n        var seInClip = this._inside([grdEx, grdSy], this.options.clip);\n        var neInClip = this._inside([grdEx, grdNy], this.options.clip);\n        var nwInClip = this._inside([grdWx, grdNy], this.options.clip);\n\n        if ((!swInClip) || (!seInClip) || (!neInClip) || (!nwInClip)){\n          this._setClip(ctx);\n        }\n      }\n      else if (this.options.latLonClipBounds) {\n        canvasClipBounds = this._setLLClipBounds(ctx, map);\n      }\n\n      // Limit to grid bounds. We don't need to draw anything\n      // if the map is way outside the area of the grid.\n      if (grdWx < this.options.bounds[0][0]) {\n        grdWx = Math.floor(this.options.bounds[0][0] / spacing) * spacing;\n      }\n      if (grdWx > this.options.bounds[1][0]) {\n        return; // left of grid > east limit\n      }\n      if (grdEx > this.options.bounds[1][0]) {\n        grdEx = Math.ceil(this.options.bounds[1][0] / spacing) * spacing;\n      }\n      if (grdEx < this.options.bounds[0][0]) {\n        return; // right of grid < west limit\n      }\n      if (grdSy < this.options.bounds[0][1]) {\n        grdSy = Math.floor(this.options.bounds[0][1] / spacing) * spacing;\n      }\n      if (grdSy > this.options.bounds[1][1]) {\n        return; // south of grid > north limit\n      }\n      if (grdNy > this.options.bounds[1][1]) {\n        grdNy = Math.ceil(this.options.bounds[1][1] / spacing) * spacing;\n      }\n      if (grdNy < this.options.bounds[0][1]) {\n        return; // north of grid < south limit\n      }\n\n      var ww = canvas.width;\n      var hh = canvas.height;\n\n      // now draw lines\n      var d = spacing;\n      var d2 = d / 2;\n\n      // Verticals of constant Eastings\n      var h = grdNy - grdSy;\n      for (x = grdWx; x <= grdEx; x += d) {\n\n        // interpolate northings from top to bottom\n        function _interpolateY (frac) {\n          return proj4(proj).inverse([x, grdNy - (frac * h)]);\n        }\n\n        var pts = this._getPoints(_interpolateY, 1.0, map)\n\n        ctx.beginPath();\n        ctx.moveTo(pts[0].x, pts[0].y);\n        for (i = 1; i < pts.length; i++) {\n          ctx.lineTo(pts[i].x, pts[i].y);\n        }\n        ctx.stroke();\n      }\n\n      // Horizontals of constant Northings\n      var w = grdEx - grdWx;\n      for (y = grdSy; y <= grdNy; y += d) {\n\n        // interpolate eastings from right to left\n        function _interpolateX (frac) {\n          return proj4(proj).inverse([grdEx - (frac * w), y]);\n        }\n\n        var pts = this._getPoints(_interpolateX, 1.0, map)\n\n        ctx.beginPath();\n        ctx.moveTo(pts[0].x, pts[0].y);\n        for (i = 1; i < pts.length; i++) {\n          ctx.lineTo(pts[i].x, pts[i].y);\n        }\n        ctx.stroke();\n      }\n\n      // Now the axis labels\n      // We label the West and South axis at grid croosings that are on screen.\n      // We label in the middle of the vertical or horizontal edge of a grid square,\n      // like the OS do on their printed maps. This means the labels never collide.\n\n      ctx.fillStyle=this.options.color; // for rub out\n      var rubWidth = this.options.weight * 3;\n\n      // Eastings axis labels\n      if (this.options.showAxisLabels.indexOf(d) >= 0) {\n        for (x = grdWx; x <= grdEx; x += d) {\n          for (y = grdSy; y <= grdNy; y += d) {\n\n            var ll = proj4(proj).inverse([x, y+d2]); // middle of vertical square edge\n            var s = map.latLngToContainerPoint(L.latLng(ll[1], ll[0])); // screen point\n\n            // check on screen and within grid bounds\n            if ((s.x > 0) && (s.y < hh) && (x < this.options.bounds[1][0])) {\n\n              if (this.options.clip) {\n                if (!this._inside([x, y+d2], this.options.clip)) {\n                  continue;\n                }\n              }\n              else if (this.options.latLonClipBounds) {\n                if (!canvasClipBounds.contains([s.x, s.y])) {\n                  continue;\n                }\n              }\n\n              var eStr = this._format_eastings(x, d);\n              txtWidth = ctx.measureText(eStr).width;\n\n              // rub out the bit of the grid line the text will be over\n              ctx.globalCompositeOperation = \"destination-out\";\n              ctx.fillRect(s.x - (rubWidth/2), s.y-txtHeight, rubWidth, txtHeight * 1.2);\n              ctx.globalCompositeOperation = \"source-over\";\n\n              ctx.fillText(eStr, s.x - (txtWidth / 2), s.y);\n              break;\n            }\n          }\n        }\n      }\n\n      // Northings axis labels\n      if (this.options.showAxisLabels.indexOf(d) >= 0) {\n        for (y = grdSy; y <= grdNy; y += d) {\n          for (x = grdWx; x <= grdEx; x += d) {\n\n            var ll = proj4(proj).inverse([x+d2, y]); // middle of horizontal square edge\n            var s = map.latLngToContainerPoint(L.latLng(ll[1], ll[0])); // screen point\n\n            // check on screen and within grid bounds\n            if ((s.x > 0) && (s.y < hh) && (y < this.options.bounds[1][1])) {\n\n              if (this.options.clip) {\n                if (!this._inside([x+d2, y], this.options.clip)) {\n                  continue;\n                }\n              }\n              else if (this.options.latLonClipBounds) {\n                if (!canvasClipBounds.contains([s.x, s.y])) {\n                  continue;\n                }\n              }\n\n              var nStr = this._format_northings(y, d);\n              txtWidth = ctx.measureText(nStr).width;\n\n              // rub out the bit of the grid line the text will be over\n              ctx.globalCompositeOperation = \"destination-out\";\n              ctx.fillRect(s.x - txtWidth * 0.1, s.y - (rubWidth/2), txtWidth * 1.2, rubWidth);\n              ctx.globalCompositeOperation = \"source-over\";\n\n              ctx.fillText(nStr, s.x, s.y + (txtHeight / 2));\n              break;\n            }\n          }\n        }\n      }\n\n      // Grid Square labels in bottom left of each square, with a 2px padding\n      var str;\n      if (this.options.showSquareLabels.indexOf(d) >= 0) {\n        for (y = grdSy; y <= grdNy; y += d) {\n          for (x = grdWx; x <= grdEx; x += d) {\n\n            var ll = proj4(proj).inverse([x, y]); // bottom left corner of grid square\n            var s = map.latLngToContainerPoint(L.latLng(ll[1], ll[0]));\n\n            // check on screen and within grid bounds\n            if ((s.x > 0) && (s.y < hh) && (x < this.options.bounds[1][0]) && (y < this.options.bounds[1][1])) {\n              var nStr = this._format_northings(y, d);\n              var eStr = this._format_eastings(x, d);\n              var sq = this.options.hundredKmSquareFunc(x, y);\n              str = sq;\n              if (d < 100000) {\n                str += eStr + nStr;\n              }\n              ctx.fillText(str, s.x + 2, s.y - 2);\n            }\n          }\n        }\n      }\n    }\n  },\n\n});\n\n// instance factory\nL.metricGrid = function (options) {\n  return new L.MetricGrid(options);\n};\n\n/** Definitions for a British Grid - EPSG code 27700\n * Clip path avoids overlaying L.IrishGrid.\n */\nL.BritishGrid = L.MetricGrid.extend({\n\n  options: {\n    proj4ProjDef: \"+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +datum=OSGB36 +units=m +no_defs\",\n    bounds: [[0, 0] , [700000, 1300000]],\n    clip: [[0, 0], [700000, 0], [700000, 1300000], [0, 1300000], [0, 700000],\n      [100000, 650000], [150000, 600000],  [190000, 550000], [200000, 500000], [200000, 400000],[0,0]],\n    hundredKmSquareFunc: function(e, n) {\n      var osgbGridSquares =  // index by  Northing kM / 100, Easting kM / 100\n        [\n          [\"SV\",\"SW\",\"SX\",\"SY\",\"SZ\",\"TV\",\"TW\"],\n          [\"SQ\",\"SR\",\"SS\",\"ST\",\"SU\",\"TQ\",\"TR\"],\n          [\"SL\",\"SM\",\"SN\",\"SO\",\"SP\",\"TL\",\"TM\"],\n          [\"SF\",\"SG\",\"SH\",\"SJ\",\"SK\",\"TF\",\"TG\"],\n          [\"SA\",\"SB\",\"SC\",\"SD\",\"SE\",\"TA\",\"TB\"],\n          [\"SV\",\"NW\",\"NX\",\"NY\",\"NZ\",\"OV\",\"OW\"],\n          [\"NQ\",\"NR\",\"NS\",\"NT\",\"NU\",\"OQ\",\"OR\"],\n          [\"NL\",\"NM\",\"NN\",\"NO\",\"NP\",\"OL\",\"OM\"],\n          [\"NF\",\"NG\",\"NH\",\"NJ\",\"NK\",\"OF\",\"OG\"],\n          [\"NA\",\"NB\",\"NC\",\"ND\",\"NE\",\"OA\",\"OB\"],\n          [\"HV\",\"HW\",\"HX\",\"HY\",\"HZ\",\"JV\",\"JW\"],\n          [\"HQ\",\"HR\",\"HS\",\"HT\",\"HU\",\"JQ\",\"JR\"],\n          [\"HL\",\"HM\",\"HN\",\"HO\",\"HP\",\"JL\",\"JM\"]\n        ];\n      var eSq = Math.floor(e / 100000);\n      var nSq = Math.floor(n / 100000);\n      return ((eSq < 7) && (nSq < 13) && (eSq >= 0) && (nSq >= 0)) ? osgbGridSquares[nSq][eSq] : \"--\";\n    }\n  }\n});\n\n// instance factory\nL.britishGrid = function (options) {\n  return new L.BritishGrid(options);\n};\n\n/** Definitions for a Irish Grid - EPSG code 29903 (TM75)\n * Clip path avoids overlaying L.BritishGrid\n */\nL.IrishGrid = L.MetricGrid.extend({\n\n  options: {\n    proj4ProjDef: \"+proj=tmerc +lat_0=53.5 +lon_0=-8 +k=1.000035 +x_0=200000 +y_0=250000 +ellps=mod_airy +towgs84=482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15 +uni+units=m +no_defs\",\n    bounds: [[0, 0] , [500000, 500000]],\n    clip: [\n      [0, 0],\n      [290000, 0],\n      [370000, 300000],\n      [370000, 400000],\n      [310000, 460000],\n      [200000, 500000],\n      [0, 500000],\n      [0, 0]],\n    hundredKmSquareFunc: function(e, n) {\n      var    irishGridSquares = // index by Easting kM / 100, Northing kM / 100\n        [\n          [\"V\", \"Q\", \"L\", \"F\", \"A\"],\n          [\"W\", \"R\", \"M\", \"G\", \"B\"],\n          [\"X\", \"S\", \"N\", \"H\", \"C\"],\n          [\"Y\", \"T\", \"O\", \"J\", \"D\"],\n          [\"Z\", \"U\", \"P\", \"K\", \"E\"]\n        ];\n      var eSq = Math.floor(e / 100000);\n      var nSq = Math.floor(n / 100000);\n      return ((eSq < 5) && (nSq < 5) && (eSq >= 0) && (nSq >= 0)) ? irishGridSquares[eSq][nSq] : \"--\";\n    }\n  }\n});\n\n// instance factory\nL.irishGrid = function (options) {\n  return new L.IrishGrid(options);\n};\n\n/** Definitions for UTM grid\n */\n\nL.UtmGrid = L.MetricGrid.extend({\n\n  options: {\n    bounds: [[100000, 0] , [900000, 9400000]]\n  },\n\n  initialize: function(zone, bSouth, options) {\n\n    options.proj4ProjDef = \"+proj=utm +zone=\" + zone + \" +ellps=WGS84 +datum=WGS84 +units=m +no_defs\";\n    if (bSouth) {\n      options.proj4ProjDef += \" +south\";\n      options.bounds = [[100000, 600000] , [900000, 10000000]];\n    }\n\n    options.hundredKmSquareFunc = function(e, n) {\n\n      var r = \"\";\n\n      // 100kM square UTM Easting letters, standard treatment (NIMA 8358.1 Appx B3)\n\n      var UTMEast = [\n        \"ABCDEFGH\", // zones 1,4, ...,   -400, -300, -200, -100, 0, 100, 200, 300 kM\n        \"JKLMNPQR\", // zones 2,5, ...,\n        \"STUVWXYZ\"  // zones 3,6, ...,\n      ];\n\n      // 100kM square UTM Northing letters, standard treatment (NIMA 8358.1 Appx B3)\n      // repeat every 2000 kM\n      // start at A at 0 Lat and go forwards for northern hemisphere\n      // start at V at 0 Lat and go backwards for southern hemisphere\n\n      var UTMNorthGroup1 =\n        [\n          \"ABCDEFGHJKLMNPQRSTUV\", // odd numbered zones\n          \"FGHJKLMNPQRSTUVABCDE\"  // even numbered zones\n        ];\n\n      var x = Math.floor(e / 100000);\n      var y = Math.floor(n / 100000);\n      var z = zone - 1;\n\n      if (bSouth) {\n        y -= 100;\n      }\n\n      if ((x >= 1) && (x <= 8)) {\n        r  = UTMEast[z % 3].charAt(x - 1);\n      }\n      else {\n        r = '-';\n      }\n\n      if (y >= 0) {\n        r += UTMNorthGroup1[z % 2].charAt(y % 20);// Northern Hemisphere\n      }\n      else {\n        r += UTMNorthGroup1[z  % 2].charAt(19+((y+1) % 20));// Southern Hemisphere\n      }\n      return r;\n    }\n\n    L.setOptions(this, options);\n  }\n\n});\n\n// instance factory\n// constructor params are UTM zone 1..60 and boolean true for southern hemisphere\nL.utmGrid = function (zone, bSouth, options) {\n  return new L.UtmGrid(zone, bSouth, options);\n};\n","import * as L from 'leaflet';\nimport * as Util from 'leaflet/src/core/Util';\nimport * as Browser from 'leaflet/src/core/Browser';\n\n// tile image order:\n// 1. locally stored tile images (url)\n// 2. internet tiles (fallbackTileUrl)\n// 3. assets missing tile image (errorTileUrl)\n// TODO: prevent 404 on image URL (stackoverflow.com/questions/9893886/prevent-image-load-errors-going-to-the-javascript-console)\nconst _fallbackTileLayer = L.TileLayer.extend({\n\n  createTile: function (coords, done) {\n    const _tile = L.TileLayer.prototype.createTile.call(this, coords, done);\n\n    // html attributes are strings\n    _tile.setAttribute('cx', coords.x);\n    _tile.setAttribute('cy', coords.y);\n    _tile.setAttribute('cz', coords.z);\n\n    _tile.setAttribute('state', 'default');\n\n    return _tile;\n  },\n\n  // override\n  _tileOnError: function (done, tile, e) {\n\n    const _tileState = tile.getAttribute('state');\n\n    const _tileCoords = {\n        x: tile.getAttribute('cx'),\n        y: tile.getAttribute('cy'),\n        z: tile.getAttribute('cz')\n    };\n\n    if (_tileState === 'default') {\n      tile.setAttribute('state', 'fallback');\n      tile.src = this.updateTileUrl(_tileCoords, this.options.fallbackTileUrl);\n    } else if (_tileState === 'fallback') {\n      tile.setAttribute('state', 'error');\n      tile.src = this.options.errorTileUrl;\n    }\n\n    done(e, tile);\n  },\n\n  updateTileUrl: function (coords, url) {\n\n    const data = {\n      r: Browser.retina ? '@2x' : '',\n      s: this._getSubdomain(coords),\n      x: coords.x,\n      y: coords.y,\n      z: this._getZoomForUrl()\n    };\n    if (this._map && !this._map.options.crs.infinite) {\n      const invertedY = this._globalTileRange.max.y - coords.y;\n      if (this.options.tms) {\n        data['y'] = invertedY;\n      }\n      data['-y'] = invertedY;\n    }\n\n    return Util.template(url, Util.extend(data, this.options));\n  }\n});\n\nexport function fallbackLayer (url, options) {\n  return new _fallbackTileLayer(url, options);\n}\n","// is a number a prime number?\nimport {environment} from '../../environments/environment.prod';\nimport {Waypoint} from '../type/waypoint';\n\nexport function isPrime (number: number): boolean {\n  for(let i = 2; i < number; i++) {\n    if (number % i === 0)  {\n      return false;\n    }\n  }\n  return number !== 1 && number !== 0;\n}\n\n// convert meters to miles/feet\nexport function distanceInMilesFeet(distanceMeters: number, force: string = ''): object {\n\n  let _distance: number;\n  let _unit: string;\n\n  if (distanceMeters / environment.MILE >= 0.1 && force !== 'ft' || force === 'mi') {\n    // show in miles\n    _distance = Number((distanceMeters / environment.MILE).toFixed(2));\n    _unit = 'mi.';\n\n  } else {\n    // show in feet\n    _distance = Number((distanceMeters / environment.FOOT).toFixed(0));\n    _unit = 'ft.';\n  }\n\n  return {distance: _distance, unit: _unit};\n}\n\n\n\n\n/* find a point on a line segment nearest to a point */\n// based on: https://stackoverflow.com/questions/32281168/find-a-point-on-a-line-closest-to-a-third-point-javascript\nexport function getClosestPointOnLine(point: Waypoint, lineSegment: Array<Waypoint>): Waypoint {\n\n  let minDist;\n  let fTo;\n  let fFrom;\n  let latitude: number;\n  let longitude: number;\n  let i;\n  let dist;\n\n  if (lineSegment.length > 1) {\n\n    for (let n = 1 ; n < lineSegment.length ; n++) {\n\n      if (lineSegment[n].latitude !== lineSegment[n - 1].latitude) {\n        const a = (lineSegment[n].longitude - lineSegment[n - 1].longitude) / (lineSegment[n].latitude - lineSegment[n - 1].latitude);\n        const b = lineSegment[n].longitude - a * lineSegment[n].latitude;\n        dist = Math.abs(a * point.latitude + b - point.longitude) / Math.sqrt(a * a + 1);\n      } else {\n        dist = Math.abs(point.latitude - lineSegment[n].latitude)\n      }\n\n      const rl2 = Math.pow(lineSegment[n].longitude - lineSegment[n - 1].longitude, 2) + Math.pow(lineSegment[n].latitude - lineSegment[n - 1].latitude, 2);\n      const ln2 = Math.pow(lineSegment[n].longitude - point.longitude, 2) + Math.pow(lineSegment[n].latitude - point.latitude, 2);\n      const lnm12 = Math.pow(lineSegment[n - 1].longitude - point.longitude, 2) + Math.pow(lineSegment[n - 1].latitude - point.latitude, 2);\n      const dist2 = Math.pow(dist, 2);\n\n      // calculated length^2 of line segment\n      const calcrl2 = ln2 - dist2 + lnm12 - dist2;\n\n      // redefine minimum distance to line segment (not infinite line) if necessary\n      if (calcrl2 > rl2) {\n        dist = Math.sqrt(Math.min(ln2, lnm12));\n      }\n\n      if (minDist == null || minDist > dist) {\n        if (calcrl2 > rl2) {\n          if (lnm12 < ln2) {\n            fTo = 0; //nearer to previous point\n            fFrom = 1;\n          } else {\n            fFrom = 0; //nearer to current point\n            fTo = 1;\n          }\n        } else {\n\n          // perpendicular from point intersects line segment\n          fTo = ((Math.sqrt(lnm12 - dist2)) / Math.sqrt(rl2));\n          fFrom = ((Math.sqrt(ln2 - dist2)) / Math.sqrt(rl2));\n        }\n\n        minDist = dist;\n        i = n;\n      }\n    }\n\n    const dx = lineSegment[i - 1].latitude - lineSegment[i].latitude;\n    const dy = lineSegment[i - 1].longitude - lineSegment[i].longitude;\n\n    latitude = lineSegment[i - 1].latitude - (dx * fTo);\n    longitude = lineSegment[i - 1].longitude - (dy * fTo);\n\n  }\n\n  // console.log({'latitude': latitude, 'longitude': longitude, 'i': i, 'fTo': fTo, 'fFrom': fFrom});\n\n  return { latitude: latitude, longitude: longitude} as Waypoint;\n}\n","import {Settings} from '../settings';\nimport {PoiType} from '../type/poi';\n\n// since poiType is an array, we'll have to filter subobjects to select one by type\nexport function getPoiTypeByType(type:string) {\n\n  const _pois = Settings.POITYPES;\n\n  const result = _pois.filter(function(poi) {\n    return poi['type'] === type;\n  });\n\n  return result[0];     // only return first\n}\n\n// get all poi types that are considered major (and therefor visible on elevation profile)\nexport function getMajorPoiTypes(): Array<string> {\n\n  const _result: Array<string> = [];\n\n  Settings.POITYPES.forEach(function(poi: PoiType) {\n    if (poi.isMajor) {\n      _result.push(poi.type);\n    }\n  });\n\n  return _result;\n}\n","import { saveAs } from 'file-saver';\n\n// save file as, only works for desktop, used for generating data files (admin only)\nexport function saveFileAs(data:any, filename:string, ): void {\n\n  if (typeof data !== 'string') {\n    data = JSON.stringify(data)\n  }\n\n  const blob = new Blob([data], {type: 'text/plain;charset=utf-8'});\n  saveAs(blob, filename);\n}\n","// TODO: currently unused, would add another calculation\n\n// The smoothing ratio\nconst smoothing = 0.025;\n\n// Properties of a line\nconst line = (pointA, pointB) => {\n  const lengthX = pointB[0] - pointA[0];\n  const lengthY = pointB[1] - pointA[1];\n  return {\n    length: Math.sqrt(Math.pow(lengthX, 2) + Math.pow(lengthY, 2)),\n    angle: Math.atan2(lengthY, lengthX)\n  }\n};\n\n// Position of a control point\nconst controlPoint = (current, previous, next, reverse: boolean = false) => {\n\n  // When 'current' is the first or last point of the array\n  // 'previous' or 'next' don't exist.\n  // Replace with 'current'\n  const p = previous || current;\n  const n = next || current;\n\n  // Properties of the opposed-line\n  const o = line(p, n);\n\n  // If is end-control-point, add PI to the angle to go backward\n  const angle = o.angle + (reverse ? Math.PI : 0);\n  const length = o.length * smoothing;\n\n  // The control point position is relative to the current point\n  const x = current[0] + Math.cos(angle) * length;\n  const y = current[1] + Math.sin(angle) * length;\n  return [x, y]\n};\n\n// Create the bezier curve command\nconst bezierCommand = (point, i, a) => {\n\n  // start control point\n  const cps = controlPoint(a[i - 1], a[i - 2], point);\n\n  // end control point\n  const cpe = controlPoint(point, a[i - 1], a[i + 1], true);\n  return `C ${cps[0]},${cps[1]} ${cpe[0]},${cpe[1]} ${point[0]},${point[1]}`\n};\n\n// Render the svg <path> element\nexport function svgPath(points){\n  // build the d attributes by looping over the points\n  const d = points.reduce((acc, point, i, a) => i === 0\n    ? `M ${point[0]},${point[1]}`\n    : `${acc} ${bezierCommand(point, i, a)}`\n    , '');\n\n  return d;\n}\n","import {Snow, Snowpoint} from '../type/snow';\n\nclass SnowPivot {\n  label:      string;\n  location:   SnowLocation;\n}\n\n// from source file\nclass SnowLocation {\n  x:          number;\n  y:          number;\n  elev:       number;\n}\n\nexport function parseSnow(snow: Array<SnowLocation>, trailId: number, abbr: string, version: string): Snow {\n\n  if (!snow || snow.length === 0) {\n    return;\n  }\n\n  const _returnObj = new Snow();\n\n  _returnObj.trailId = trailId;\n  _returnObj.version = version;\n  _returnObj.abbr = abbr;\n\n  const _snowPivots: Array<SnowPivot> = [];\n\n  // starting at 1 for a comparison with the previous point\n  for (let i = 1; i < snow.length; i++) {\n\n    // get pivots (no snow/snow & snow/no-snow)\n    if (i === 0 && snow[i].y > 0) {\n      // snow at start of trail\n      _snowPivots.push({label: 'start', location: snow[i]});\n    } else if (snow[i].y > 0 && snow[i - 1].y === 0) {\n      // start of snowlevel\n      _snowPivots.push({label: 'start', location: snow[i - 1]});\n    } else if (snow[i - 1].y > 0 && snow[i].y === 0) {\n      // end of snow level\n      _snowPivots.push({label: 'end', location: snow[i]});\n    } else if (i === snow.length - 1 && snow[i].y > 0) {\n      // snow at end of trail\n      _snowPivots.push({label: 'end', location: snow[i]});\n    }\n  }\n\n  const _snowMiles: Array<Array<Snowpoint>> = [];\n\n  // calculate snowlevel elevation line\n  for (let s = 0; s < _snowPivots.length; s += 2) {\n\n    const _mileNr: number = Math.floor(_snowPivots[s].location.x);\n\n    // the total distance of this snow patch\n    const _distance = _snowPivots[s + 1].location.x - _snowPivots[s].location.x;\n\n    // the elevation change between the start and end of snowpatch\n    const _levelChange = Math.abs(_snowPivots[s].location.elev - _snowPivots[s + 1].location.elev);\n\n    // distance to next full mile (if snow starts at mi 37.7, = 0.3)\n    let _nextFullMileDist = Math.ceil(_snowPivots[s].location.x) - _snowPivots[s].location.x;\n    _nextFullMileDist = +_nextFullMileDist.toFixed(2);    // rounding\n\n    // set start point and end point for start mile\n    if (!_snowMiles[_mileNr]) {\n      _snowMiles[_mileNr] = [];\n    }\n\n    _snowMiles[_mileNr].push(\n      {distance: _nextFullMileDist, elevation: _snowPivots[s].location.elev},\n      {distance: 1, elevation: _snowPivots[s].location.elev + ((_nextFullMileDist / _distance) * _levelChange)}\n    );\n\n    let _miles = _nextFullMileDist;\n\n    // set start / end points for miles in distance\n    while (Number(_miles.toFixed(2)) < _distance - _nextFullMileDist - 1) {\n\n      _miles ++;\n\n      // start point for next mile\n      _snowMiles[_mileNr + _miles - _nextFullMileDist] = [\n        {distance: 0, elevation: _snowPivots[s].location.elev + (((_miles - 1) / _distance) * _levelChange)},\n        {distance: 1, elevation: _snowPivots[s].location.elev + (((_miles) / _distance) * _levelChange)}\n      ];\n    }\n\n    // set start / end point for end mile\n    _snowMiles[ Math.floor(_snowPivots[s + 1].location.x) ] = [\n      new Snowpoint(0, _snowPivots[s].location.elev + (((_miles) / _distance) * _levelChange)),\n      new Snowpoint(Number((_distance - _miles).toFixed(2)), _snowPivots[s + 1].location.elev)\n    ];\n  }\n\n  _returnObj.snowMiles = _snowMiles;\n\n  return _returnObj;\n}\n\nexport function reverseSnow(snow: Snow, trailLength: number): Snow {\n  // sobo reverse snow\n  // snow.snowMiles.reverse();\n  const _newSnowArray: Array<any> = [];\n\n  snow.snowMiles.forEach(function (snowMile: Array<Snowpoint>, index: number) {\n\n    if (snowMile) {\n      snowMile.reverse();\n\n      snowMile.forEach(function (point: Snowpoint) {\n        if (point) {\n          point.distance = Math.abs(point.distance - 1);\n        }\n      });\n    }\n    _newSnowArray[trailLength - index] = snowMile;\n  });\n\n  snow.snowMiles = _newSnowArray;\n\n  return snow;\n}\n","// simple class to add a pause option to setTimeout.\nimport Timeout = NodeJS.Timeout;\n\nexport class TimerObj {\n\n  public id:                Timeout;        // timeout/js says it returns a number, node says it's a Timeout...\n  public runTime:           number;         // the time in ms the timer should run for (in total)\n  public action:            Function;       // a callback function to execute once time runs out\n\n  public startTime?:        number;         // the start time (cleared on pause)\n  public timeRemaining?:    number;         // this is the time in ms that's remaining after a timer has been 'paused' (deleted)\n\n  constructor(id: Timeout, runTime: number, action: Function, startTime?: number, timeRemaining?: number) {\n    this.id = id;\n    this.runTime = runTime;\n    this.action = action;\n    this.startTime = (startTime) ? startTime : new Date().getTime();\n    this.timeRemaining = timeRemaining;\n  }\n}\n\n// timeout in miliseconds, returns id, start-time\nexport function setTimeOut(runTime: number, action: Function): TimerObj {\n  const _id: Timeout = setTimeout(function() {\n    action();\n  }, runTime);\n\n  return new TimerObj(_id, runTime, action);\n}\n\n// clearing the current timeout but setting the remaining time\nexport function pauseTimeOut(timerObj: TimerObj): TimerObj {\n\n  const _currentTime = new Date().getTime();\n  clearTimeout(timerObj.id);\n  timerObj.timeRemaining = timerObj.runTime - (_currentTime - timerObj.startTime);\n  timerObj.startTime = null;\n\n  return timerObj;\n}\n\n// resumes the timeOut (creating a new timeout for the remaining time)\nexport function resumeTimeOut(timerObj: TimerObj): TimerObj {\n  return setTimeOut(timerObj.timeRemaining, timerObj.action);\n}\n\n// clear timer\nexport function clearTimeOut(timerObj: TimerObj): void {\n\n  if (timerObj) {\n\n    if (timerObj.id) {\n      clearTimeout(timerObj.id);\n    }\n\n    timerObj.action();\n  }\n\n  timerObj = null;\n}\n","import {TrailMeta} from '../type/trail';\n\nlet trails: Array<TrailMeta>;\n\n// set\nexport function setTrailMetaData(data: Array<TrailMeta>) {\n  trails = data;\n}\n\n// get all\nexport function getTrailsMetaData(): Array<TrailMeta> {\n  return trails;\n}\n\n// get a trailmeta object based on the trail id (does not have to equal the array index)\nexport function getTrailMetaDataById(id: number): TrailMeta {\n\n  if (!trails) {\n    throw new Error('no trails available!');\n  }\n\n  for (const key in trails) {\n    if (trails[key].id === id) {\n      return trails[key] as TrailMeta;\n    }\n  }\n\n  throw new Error('Trail not found!');\n}\n\n// trail meta does not contain a name, it does contain abbr.\nexport function getTrailMetaDataByAbbr(abbr: string): TrailMeta {\n  if (!trails) {\n    throw new Error('no trails available!');\n  }\n\n  return trails[abbr] as TrailMeta;\n}\n","// TODO: find all usages of this routine (or similar) there are a bunch\n// normalizes elevation within a range (converts a value in feet to a y position in pixels)\nimport {environment} from '../../environments/environment.prod';\nimport {Waypoint} from '../type/waypoint';\n\n// normalize the elevation based on the hieght of the container (so that the max elevation matches the container height)\nexport function normalizeElevation(containerHeight: number, elevation: number, min: number, range: number, padding: number): number {\n\n  const _halfMile: number = environment.MILE / 2;\n\n  if (range < _halfMile / 2) {\n    const _difference = _halfMile / 2 - range;\n    range = _halfMile;\n    elevation += _difference / 3;\n  }\n\n  elevation = (elevation - (min - padding)) / (range + (padding * 2));\n\n  // invert as svg draws from top left\n  elevation = Math.abs(elevation - 1);\n\n  return Math.round(elevation * containerHeight);\n}\n\n\n// calculate elevation range\nexport function calculateOHLC(data: any, range: object, identifier: string = 'elevation', nested: boolean = true) {\n\n  // select sub data set to use for calculations\n  const _subArr = data.slice(range['start'], range['end']);\n\n  return _ohlc(_subArr);\n}\n\n\n// calculate ohlc of single data point?\nfunction _ohlc(waypoints: Array<Waypoint>){\n\n  // calculate OHLC\n  const   _open:    number    = Number(waypoints[0].elevation);\n  let     _high:    number    = Number(_open);\n  let     _low:     number    = Number(_open);\n  const   _close:   number    = Number(waypoints[waypoints.length - 1].elevation);\n\n  const _length = waypoints.length;   // speed\n  for (let i = 0; i < _length; i++) {\n\n    const _waypoint = waypoints[i];\n    const _elevation = Number(_waypoint.elevation);\n\n    if (_elevation > _high) {\n\n      _high = _elevation;\n\n    } else if (_elevation < _low) {\n\n      _low = _elevation;\n    }\n  }\n\n  return {open: _open, high: _high, low: _low, close: _close};\n}\n","import { NgModule } from '@angular/core';\nimport {Routes, RouterModule, NavigationError, Router, NavigationStart, NavigationEnd} from '@angular/router';\n\n// component\nimport { MileDetailComponent } from './component/mile-detail/mile-detail.component';\nimport { ElevationProfileComponent } from './component/elevation-profile/elevation-profile.component';\n\n// resolvers\nimport {SequentialResolverService} from './service/sequential-resolver.service';\nimport {AdminComponent} from './component/admin/admin.component';\n\n\n// // TODO: temp, iOS navigation error...\n// export function handleErrors(error: NavigationError):void {\n//   console.log('app routing error');\n// }\n\nconst routes: Routes = [\n  {\n    path: 'elevation-profile',\n    component: ElevationProfileComponent,\n    resolve: {\n      data: SequentialResolverService\n    }\n  },\n  {\n    path: 'detail/:id',\n    component: MileDetailComponent,\n    resolve: {\n      data: SequentialResolverService\n    }\n  },\n  {\n    path: '',\n    redirectTo: 'elevation-profile',\n    pathMatch: 'full'\n  },\n  // {\n  //   path: '*',\n  //   redirectTo: 'elevation-profile',\n  // },\n  {\n    path: 'admin',\n    component: AdminComponent,\n    resolve: {\n      data: SequentialResolverService\n    }\n  }\n];\n\n\n// , errorHandler: handleErrors\n@NgModule({\n  imports: [RouterModule.forRoot(routes, {onSameUrlNavigation: 'ignore', useHash: false, enableTracing: false})\n  ],\n  exports: [RouterModule]\n})\n\nexport class AppRoutingModule {\n\n  // STARTUP\n\n  constructor(private _router: Router) {\n\n    // iOS router error testing\n    _router.events.subscribe( (event: any) => {\n\n      if (event instanceof NavigationStart) {\n        // Show loading indicator\n      }\n\n      if (event instanceof NavigationEnd) {\n        // Hide loading indicator\n      }\n\n      if (event instanceof NavigationError) {\n        // Hide loading indicator\n\n        // Present error to user\n        console.log(event.error);\n      }\n    });\n  }\n}\n","module.exports = \"<fa-sampler></fa-sampler>\\n<router-outlet>\\n  <loader-overlay [showLoader]=\\\"showLoader\\\" #loader></loader-overlay>\\n  <navigation-component [ngClass]=\\\"(navIsVisible) ? 'showNav' : 'hideNav'\\\" (navEvent)=\\\"onNavEvent($event)\\\" [appInitialized]=\\\"initialized\\\"></navigation-component>\\n</router-outlet>\\n\"","module.exports = \":host .showNav {\\n  margin-top: 0;\\n  visibility: visible;\\n  -webkit-transform: scale(1);\\n          transform: scale(1);\\n  transition: visibility 200ms linear, margin-top 100ms ease-out; }\\n\\n:host .hideNav {\\n  margin-top: -400px;\\n  visibility: hidden;\\n  transition: visibility 200ms linear, margin-top 100ms ease-in; }\\n\\n:host .hidden {\\n  display: none;\\n  visibility: hidden; }\\n\\n:host::ng-deep .note:not(.multiple) {\\n  color: rgba(95, 83, 73, 0.85); }\\n\\n:host::ng-deep .fa-marker {\\n  color: white; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2FwcC5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUVHLGFBQWE7RUFDYixtQkFBbUI7RUFDbkIsMkJBQW1CO1VBQW5CLG1CQUFtQjtFQUNuQiw4REFBOEQsRUFBQTs7QUFMakU7RUFRRyxrQkFBa0I7RUFDbEIsa0JBQWtCO0VBQ2xCLDZEQUE2RCxFQUFBOztBQVZoRTtFQWFHLGFBQWE7RUFDYixrQkFBa0IsRUFBQTs7QUFFckI7RUFHRyw2QkFBNkIsRUFBQTs7QUFIaEM7RUFNRyxZQUFZLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9hcHAuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuICAuc2hvd05hdiB7XG4gICAgbWFyZ2luLXRvcDogMDtcbiAgICB2aXNpYmlsaXR5OiB2aXNpYmxlO1xuICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7XG4gICAgdHJhbnNpdGlvbjogdmlzaWJpbGl0eSAyMDBtcyBsaW5lYXIsIG1hcmdpbi10b3AgMTAwbXMgZWFzZS1vdXQ7IH1cblxuICAuaGlkZU5hdiB7XG4gICAgbWFyZ2luLXRvcDogLTQwMHB4O1xuICAgIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgICB0cmFuc2l0aW9uOiB2aXNpYmlsaXR5IDIwMG1zIGxpbmVhciwgbWFyZ2luLXRvcCAxMDBtcyBlYXNlLWluOyB9XG5cbiAgLmhpZGRlbiB7XG4gICAgZGlzcGxheTogbm9uZTtcbiAgICB2aXNpYmlsaXR5OiBoaWRkZW47IH0gfVxuXG4gOmhvc3Q6Om5nLWRlZXAge1xuXG4gIC5ub3RlOm5vdCgubXVsdGlwbGUpIHtcbiAgICBjb2xvcjogcmdiYSg5NSwgODMsIDczLCAwLjg1KTsgfVxuXG4gIC5mYS1tYXJrZXIge1xuICAgIGNvbG9yOiB3aGl0ZTsgfSB9XG4iXX0= */\"","import {Component, ElementRef, Injector, OnDestroy, OnInit, ViewChild, ViewContainerRef} from '@angular/core';\nimport {LoaderService} from './service/loader.service';\nimport {MatDialog} from '@angular/material';\nimport {SettingsDialogComponent} from './component/dialog/settings-dialog/settings-dialog.component';\nimport {MarkerDialogComponent} from './component/dialog/marker-dialog/marker-dialog.component';\nimport {LocationService} from './service/location.service';\nimport {OfftrailDialogComponent} from './component/dialog/offtrail-dialog/offtrail-dialog.component';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {FilesystemService} from './service/filesystem.service';\nimport {ActivatedRoute} from '@angular/router';\nimport {ConnectionService} from './service/connection.service';\nimport {BaseComponent} from './base/base/base.component';\nimport {RateService} from './service/rate.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.sass']\n})\nexport class AppComponent extends BaseComponent implements OnInit, OnDestroy {\n\n  @ViewChild('loader', { read: ViewContainerRef }) loader: ViewContainerRef;\n\n  public initialized: boolean;\n  public showLoader      = true;    // show loader/spinner by default\n  public navIsVisible    = true;    // nav visibility\n\n  private _offtrailDialog: any;\n  private _markerDialog: any;\n  \n  constructor(\n    private _route: ActivatedRoute,\n    private _fileSystemService: FilesystemService,\n    private _dialog: MatDialog,\n    private _loaderService: LoaderService,\n    private _element: ElementRef,\n    private _injector: Injector,\n    private _localStorage: LocalStorageService,\n    private _connectionService: ConnectionService) {\n\n    super();\n\n    // makes constructor props accessible through LocationService, needed for inheritance\n    LocationService.injector = this._injector;\n  }\n\n  ngOnInit(): void {\n\n    const _self = this;\n\n    if (navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/)) {\n\n      console.log('running on mobile device:', navigator.userAgent);\n\n      this.addEventListener(document, 'deviceready', function() {\n        _self._onReady();\n        _self.removeEventListener(document, 'deviceready');\n      });\n\n    } else {\n\n      console.log('debugging in browser');\n      this._onReady();\n    }\n\n    // loader (spinner)\n    this.addSubscription('loaderService', this._loaderService.observe.subscribe((obj: object) => {\n      this.showLoader = (obj['type'] === 'self') ? (obj['action'] === 'show') : this.showLoader;\n      if (obj['action'] === 'hide') {\n        this.initialized = true;\n      }\n    }));\n\n    // show settings on first load\n    const _firstRun = this._localStorage.retrieve('firstRun');\n    if (_firstRun) {\n      this._localStorage.store('firstRun', false);\n      const timeOut = setTimeout(() => {\n        _self._openSettingsDialog();\n      }, 250);\n    }\n\n    this._connectionService.startTracking();\n    this.addEventListener(this._element.nativeElement, ['markerClick', 'offtrail'] , this._onDialogEvent.bind(this), false);\n  }\n\n  ngOnDestroy(): void {\n    super.ngOnDestroy();\n    this._connectionService.stopTracking();\n  }\n\n  // STARTUP\n\n  private _onReady(): void {\n    // reload on storage timestamp change (user settings changed that require a reload)\n    this.addSubscription('reload', this._localStorage.observe('timestamp').subscribe((value) => {\n      window.location.reload();\n    }));\n  }\n\n\n\n  // EVENT HANDLERS\n\n  // angular event handler for navEvents (public for aot)\n  public onNavEvent(event: string): void {\n\n    if (event === 'settings') {\n      this._openSettingsDialog();\n    }\n  }\n\n  // on marker click (using standard events as angular events don't bubble)\n  private _onDialogEvent(event: Event): void {\n\n    // destination reached\n    event.stopImmediatePropagation();\n    event.stopPropagation();\n\n    this._forceHideNavigation();\n\n    if (event.type === 'offtrail') {\n      this._openOfftrailDialog(event);\n    } else {\n      this._openMarkerDialog(event);\n    }\n  }\n\n\n\n  // DIALOGS\n  \n  // marker dialog\n  private _openMarkerDialog(event): void {\n\n    if (this._markerDialog) {\n      this._markerDialog.close();\n    }\n\n    this._markerDialog = this._dialog.open(MarkerDialogComponent, {\n      autoFocus: false, width: '85%', height: '75%', data: event.detail\n    });\n\n    this._onDialogClose(this._markerDialog, 'markerClosed_' + event.detail.id);\n  }\n\n  // settings dialog\n  private _openSettingsDialog(): void {\n\n    this._forceHideNavigation();\n\n    const _settingsDialog = this._dialog.open(SettingsDialogComponent, {\n      autoFocus: false, width: '85%', height: '75%', data: {icon: 'cog'}\n    });\n\n    this._onDialogClose(_settingsDialog, 'settingsClosed', result => {\n      if (result) {\n        this._loaderService.showOverlay();\n        this._localStorage.store('timestamp', new Date().getTime());\n      }\n    });\n  }\n\n  // off trail dialog (mile simulator)\n  private _openOfftrailDialog(event): void {\n\n    if (this._offtrailDialog) {\n      this._markerDialog.close();\n    }\n\n    this._offtrailDialog = this._dialog.open(OfftrailDialogComponent, {\n      panelClass: 'offtrail-dialog', autoFocus: false, width: '50%', height: '75%', data: event.detail\n    });\n\n    this._onDialogClose(this._offtrailDialog, 'offtrailClosed', result => {\n\n      this._offtrailDialog = null;\n\n      if (result) {\n        this._localStorage.store('simulatedMile', Number(result.simulatedMile));\n      }\n\n      const _simulate = !!(result);\n      this._injector.get(LocationService).toggleTracking(_simulate);\n    });\n  }\n\n  private _onDialogClose(dialog: any, name: string, callback?: Function): void {\n\n    this.addSubscription(name, dialog.afterClosed().subscribe(result => {\n\n      this._toggleNavigationVisibility(true);\n\n      this.removeSubscription(name);\n      dialog = null;\n\n      if (callback) {\n        callback(result);\n      }\n\n\n    }));\n  }\n\n  private _forceHideNavigation(): void {\n    if (this.navIsVisible) {\n      this._toggleNavigationVisibility(false);\n    }\n  }\n\n  private _toggleNavigationVisibility(visible: boolean): void {\n    this.navIsVisible = visible;\n  }\n}\n\n","import {BrowserModule} from '@angular/platform-browser';\nimport {HttpClientModule} from '@angular/common/http';\nimport {FormsModule} from '@angular/forms';\nimport {Injector, isDevMode, NgModule} from '@angular/core';\nimport {AppRoutingModule} from './app-routing.module';\nimport {AppComponent} from './app.component';\n\n// font awesome\nimport {FontAwesomeModule} from '@fortawesome/angular-fontawesome';\nimport {library} from '@fortawesome/fontawesome-svg-core';\nimport {faLongArrowAltUp, faLongArrowAltDown, faCampground, faCog, faLocationArrow, faStreetView, faPenAlt, faHouseDamage,\n  faArrowLeft, faRoad, faMapMarkerAlt, faTint, faTree, faExclamationTriangle, faMapMarkedAlt, faLock, faParking,\n  faHiking, faAngleRight, faPlus, faCar, faTrain, faDoorOpen, faTimes, faDownload, faMapPin, faHotel, faShoePrints,\n  faBolt, faStore, faBoxOpen, faUtensils, faInfo, faMapSigns, faFlag, faStar, faQuestionCircle, faGem, faCity,\n  faSnowflake, faAtlas, faMountain, faSpinner, faTrash, faSkull, faCircle, faChevronDown, faChevronUp, faStarHalfAlt\n} from '@fortawesome/free-solid-svg-icons';\nimport {faCompass, faDotCircle, faArrowAltCircleDown} from '@fortawesome/free-regular-svg-icons';\nimport {faStar as fasStar} from '@fortawesome/free-regular-svg-icons';\n\n// material\nimport {MatProgressSpinnerModule} from '@angular/material/progress-spinner';\nimport {BrowserAnimationsModule} from '@angular/platform-browser/animations';\nimport {ScrollingModule} from '@angular/cdk/scrolling';\nimport {MatDialogModule} from '@angular/material/dialog';\nimport {MatListModule} from '@angular/material/list';\nimport {MatSelectModule} from '@angular/material/select';\nimport {MatRadioModule} from '@angular/material/radio';\nimport {MatCheckboxModule} from '@angular/material/checkbox';\nimport {MatCardModule} from '@angular/material/card';\nimport {MatButtonModule} from '@angular/material/button';\nimport {MatRippleModule} from '@angular/material/core';\nimport {MatFormFieldModule} from '@angular/material/form-field';\nimport {MatInputModule} from '@angular/material/input';\nimport {MatCarouselModule} from '@ngmodule/material-carousel';\nimport {MatIconModule} from '@angular/material/icon';\nimport {MatSnackBarModule} from '@angular/material/snack-bar';\nimport {MatProgressBarModule} from '@angular/material/progress-bar';\nimport {NgxWebstorageModule} from 'ngx-webstorage';\n\n// component\nimport { LocationBasedComponent } from './base/location-based/location-based.component';\nimport { ListItemComponent } from './component/elevation-profile/virtual-list/list-item/list-item.component';\nimport { ElevationProfileComponent } from './component/elevation-profile/elevation-profile.component';\nimport { MileDetailComponent } from './component/mile-detail/mile-detail.component';\nimport { NavigationComponent } from './component/navigation/navigation.component';\nimport { VirtualListComponent } from './component/elevation-profile/virtual-list/virtual-list.component';\nimport { ScrollbarComponent } from './component/elevation-profile/scrollbar/scrollbar.component';\nimport { LabelsComponent } from './component/elevation-profile/virtual-list/labels/labels.component';\nimport { GuidesComponent } from './component/elevation-profile/virtual-list/guides/guides.component';\nimport { LocatorComponent} from './component/navigation/locator/locator.component';\nimport { PoiListComponent } from './component/poi-list/poi-list.component';\nimport { PoiListItemComponent } from './component/poi-list/poi-list-item/poi-list-item.component';\nimport { PoiUserItemComponent } from './component/poi-list/poi-user-item/poi-user-item.component';\nimport { LeafletMapComponent } from './component/leaflet-map/leaflet-map.component';\nimport { DynamicItemComponent } from './component/poi-list/dynamic-item/dynamic-item.component';\nimport { OfftrailDialogComponent } from './component/dialog/offtrail-dialog/offtrail-dialog.component';\nimport { PurchaseSettingsComponent } from './component/dialog/settings-dialog/panels/purchase-settings/purchase-settings.component';\nimport { GeneralSettingsComponent } from './component/dialog/settings-dialog/panels/general-settings/general-settings.component';\nimport { AboutComponent } from './component/dialog/settings-dialog/panels/about/about.component';\nimport { InstructionsComponent } from './component/dialog/settings-dialog/panels/instructions/instructions.component';\nimport { SettingsPanelComponent } from './base/settings-panel/settings-panel.component';\nimport { DownloaderComponent } from './component/dialog/settings-dialog/panels/trail-settings/downloader/downloader.component';\nimport { LoaderOverlayComponent } from './component/loader-overlay/loader-overlay.component';\nimport { FaSamplerComponent } from './component/fa-sampler/fa-sampler.component';\nimport { FaIconComponent } from './component/fa-sampler/fa-icon/fa-icon.component';\nimport { IconComponent } from './base/icon/icon.component';\nimport { ButtonComponent } from './base/button/button.component';\nimport { SettingsComponent } from './component/navigation/settings/settings.component';\nimport { TrailSettingsComponent } from './component/dialog/settings-dialog/panels/trail-settings/trail-settings.component';\nimport { AdminComponent } from './component/admin/admin.component';\nimport { UserIndicatorComponent } from './component/poi-list/user-indicator/user-indicator.component';\n\n// dialog\nimport {MarkerDialogComponent} from './component/dialog/marker-dialog/marker-dialog.component';\nimport {SettingsDialogComponent} from './component/dialog/settings-dialog/settings-dialog.component';\n\n// pipes\nimport {PoiSortingPipe} from './pipe/poi-sorting.pipe';\nimport {DistancePipe} from './pipe/distance.pipe';\nimport {FilesizePipe} from './pipe/filesize.pipe';\nimport {RatingComponent} from './component/dialog/marker-dialog/rating/rating.component';\nimport {PopupComponent} from './component/leaflet-map/elements/popup/popup.component';\nimport {createCustomElement} from '@angular/elements';\nimport {NoteDialogComponent} from './component/dialog/note-dialog/note-dialog.component';\nimport {BaseComponent} from './base/base/base.component';\nimport {UserSettingsComponent} from './component/dialog/settings-dialog/panels/user-settings/user-settings.component';\nimport {CurrentScoreComponent} from './component/dialog/marker-dialog/rating/elements/current-score/current-score.component';\nimport {AddScoreComponent} from './component/dialog/marker-dialog/rating/elements/add-score/add-score.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    LocationBasedComponent,\n    ButtonComponent,\n    FaIconComponent,\n    IconComponent,\n    LoaderOverlayComponent,\n    FaSamplerComponent,\n    NavigationComponent,\n    LocatorComponent,\n    ElevationProfileComponent,\n    MileDetailComponent,\n    ListItemComponent,\n    VirtualListComponent,\n    ScrollbarComponent,\n    LabelsComponent,\n    GuidesComponent,\n    SettingsDialogComponent,\n    MarkerDialogComponent,\n    OfftrailDialogComponent,\n    PoiListComponent,\n    LeafletMapComponent,\n    PoiSortingPipe,\n    DistancePipe,\n    FilesizePipe,\n    PoiUserItemComponent,\n    PoiListItemComponent,\n    DynamicItemComponent,\n    PurchaseSettingsComponent,\n    GeneralSettingsComponent,\n    AboutComponent,\n    InstructionsComponent,\n    SettingsPanelComponent,\n    DownloaderComponent,\n    SettingsComponent,\n    TrailSettingsComponent,\n    AdminComponent,\n    UserIndicatorComponent,\n    RatingComponent,\n    PopupComponent,\n    NoteDialogComponent,\n    BaseComponent,\n    UserSettingsComponent,\n    CurrentScoreComponent,\n    AddScoreComponent\n  ],\n  entryComponents: [\n    SettingsDialogComponent,\n    MarkerDialogComponent,\n    OfftrailDialogComponent,\n    PoiUserItemComponent,\n    PoiListItemComponent,\n    PopupComponent,\n    NoteDialogComponent\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    NgxWebstorageModule.forRoot(),\n    HttpClientModule,\n    ScrollingModule,\n    BrowserAnimationsModule,\n    AppRoutingModule,\n    FontAwesomeModule,\n    MatProgressSpinnerModule,\n    MatDialogModule,\n    MatSelectModule,\n    MatRadioModule,\n    MatCheckboxModule,\n    MatCardModule,\n    MatButtonModule,\n    MatListModule,\n    MatRippleModule,\n    MatIconModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatCarouselModule,\n    MatSnackBarModule,\n    MatProgressBarModule\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {\n\n  constructor(private _injector: Injector) {\n\n    // Register custom element(s)\n    const _popupElement = createCustomElement(PopupComponent, {injector: _injector});\n    customElements.define('leaflet-element-popup', _popupElement);\n\n    if (isDevMode()) {\n      console.log('\\n');\n      console.log('***** ***** ***** ***** ***** ***** ***** *****');\n      console.log('RUNNING IN DEV MODE, CHECK ENVIRONMENT SETTINGS');\n      console.log('***** ***** ***** ***** ***** ***** ***** *****');\n      console.log('\\n');\n    }\n\n    // font awesome library\n    library.add(faLongArrowAltUp, faLongArrowAltDown, faCampground, faCog, faLocationArrow, faHotel, faStreetView, faPenAlt,\n      faArrowLeft, faRoad, faMapMarkerAlt, faTint, faTree, faCompass, faCar, faTrain, faDoorOpen, faMapMarkedAlt, faHouseDamage,\n      faBolt, faStore, faBoxOpen, faUtensils, faInfo, faMapSigns, faQuestionCircle, faFlag, faStar, faDownload, faCity, faStarHalfAlt,\n      faDotCircle, faExclamationTriangle, faHiking, faArrowAltCircleDown, faAngleRight, faPlus, faSnowflake, faGem, faMapPin, fasStar,\n      faAtlas, faMountain, faSpinner, faTrash, faSkull, faCircle, faChevronDown, faChevronUp, faTimes, faParking, faShoePrints, faLock);\n  }\n}\n","module.exports = \"\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2Jhc2UvYmFzZS9iYXNlLmNvbXBvbmVudC5zYXNzIn0= */\"","import {Component, OnDestroy} from '@angular/core';\nimport {Subscription} from 'rxjs';\n\nclass EventListenerObj {\n\n  public target:      any;\n  public type:        string;\n  public listener:    EventListenerOrEventListenerObject;\n  public options:     boolean | object;\n\n  constructor(target: any, type: string, listener: EventListenerOrEventListenerObject, options: boolean | object = false) {\n\n    this.target = target;\n    this.type = type;\n    this.listener = listener;\n    this.options = options;\n  }\n}\n\nclass SubscriptionObj {\n\n  public name:          string;\n  public subscription:  Subscription;\n\n  constructor(name: string, subscription: Subscription) {\n\n    this.name = name;\n    this.subscription = subscription;\n  }\n}\n\n@Component({\n  selector: 'app-base',\n  templateUrl: './base.component.html',\n  styleUrls: ['./base.component.sass']\n})\n\n/* base component:\n- manages subscriptions\n- manages event listeners */\nexport class BaseComponent implements OnDestroy {\n\n  private _eventListeners: object;\n  private _subscriptions: object;\n\n  constructor() {\n    this._eventListeners = {};\n    this._subscriptions = {};\n  }\n\n  ngOnDestroy(): void {\n    this._removeAllEventListeners();\n    this._removeAllSubscriptions();\n  }\n\n  // SUBSCRIPTIONS MANAGER\n\n  public addSubscription(name: string, subscription: Subscription): void {\n\n    if (this._subscriptions.hasOwnProperty(name)) {\n      throw new Error('Subscription with name ' + name + ' already exists!');\n    }\n\n    this._subscriptions[name] = new SubscriptionObj(name, subscription);\n  }\n\n  // remove subscription by name\n  public removeSubscription(name: string): void {\n\n    if (this._subscriptions.hasOwnProperty(name)) {\n\n      let _subscription: SubscriptionObj = this._subscriptions[name];\n\n      _subscription.subscription.unsubscribe();\n      _subscription.subscription = null;\n\n      delete this._subscriptions[name];\n      _subscription = null;\n    }\n  }\n\n  private _removeAllSubscriptions(): void {\n\n    for (const key in this._subscriptions) {\n\n      let _subscriptionObj: SubscriptionObj = this._subscriptions[key];\n      this.removeSubscription(_subscriptionObj.name);\n      _subscriptionObj = null;\n    }\n\n    this._subscriptions = null;\n  }\n\n\n\n  // EVENTS MANAGER\n\n  // add an event listener (allows for multiple types per target)\n  public addEventListener(target: any, type: string | Array<string>, listener: EventListenerOrEventListenerObject, options: boolean | object = false): void {\n\n    // check if target is DOM element\n    if (!this._isDOMElement(target)) {\n      throw new Error('Can not add event, target is not a DOM element');\n    }\n\n    if (typeof type === 'string') {\n      type = [type];\n    }\n\n    for (let i = 0; i < type.length; i++) {\n\n      const _uniqueName = target.tagName + '_' + type[i];\n\n      // check if eventlistener already exists\n      if (this._eventListeners.hasOwnProperty(_uniqueName)) {\n        throw new Error('Event listener for ' + type[i] + ' already exists on ' + target.tagName);\n      }\n\n      this._eventListeners[_uniqueName] = new EventListenerObj(target, type[i], listener, options);\n      target.addEventListener(type[i], listener, options);\n    }\n  }\n\n  // remove event listers (allows multiple types per target)\n  public removeEventListener(target: any, type: string | Array<string>): void {\n\n    const _uniqueName = target.tagName + '_' + type;\n\n    if (this._eventListeners.hasOwnProperty(_uniqueName)) {\n\n      let _eventListenerObj: EventListenerObj = this._eventListeners[_uniqueName];\n      _eventListenerObj.target.removeEventListener(_eventListenerObj.type, _eventListenerObj.listener, _eventListenerObj.options);\n\n      delete this._eventListeners[_uniqueName];\n      _eventListenerObj = null;\n    }\n  }\n\n  private _removeAllEventListeners(): void {\n\n    for (const key in this._eventListeners) {\n\n      let _eventListenerObj: EventListenerObj = this._eventListeners[key];\n      this.removeEventListener(_eventListenerObj.target, _eventListenerObj.type);\n      _eventListenerObj = null;\n    }\n\n    this._eventListeners = null;\n  }\n\n  private _isDOMElement(element: any): boolean {\n    if (element === window) {\n      return true;\n    } else {\n      return element instanceof Element || element instanceof HTMLDocument;\n    }\n  }\n}\n","module.exports = \"<button>\\n  <display-icon *ngIf=\\\"this.poiTypes\\\" [data]=\\\"this.poiTypes\\\"></display-icon>\\n  <fa-layers [fixedWidth]=\\\"true\\\">\\n    <fa-icon *ngIf=\\\"this.icon\\\" [icon]=\\\"icon\\\" size=\\\"2x\\\" [classes]=\\\"['icon']\\\"></fa-icon>\\n    <fa-icon *ngIf=\\\"this.badge && this.badge !== 'spinner'\\\" [icon]=\\\"badge\\\" size=\\\"2x\\\" [classes]=\\\"['badge']\\\"></fa-icon>\\n    <fa-icon *ngIf=\\\"this.badge && this.badge === 'spinner'\\\" icon=\\\"spinner\\\" size=\\\"2x\\\" [classes]=\\\"['spinner']\\\" [pulse]=\\\"true\\\"></fa-icon>\\n  </fa-layers>\\n</button>\\n\"","module.exports = \"button {\\n  background-image: unset;\\n  user-focus: none;\\n  padding: 0 !important;\\n  /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#ffffff+0,ffffff+100&0.78+0,0.55+100 */\\n  background: linear-gradient(135deg, rgba(255, 255, 255, 0.78) 0%, rgba(255, 255, 255, 0.55) 100%);\\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c7ffffff', endColorstr='#8cffffff',GradientType=1 );\\n  border-radius: 50%;\\n  font-size: 1.5vw;\\n  width: 7vw;\\n  height: 7vw;\\n  margin: 10px 10px 0 0;\\n  border: 2px solid white;\\n  box-shadow: 0px 5px 10px -5px rgba(0, 0, 0, 0.35);\\n  -webkit-backdrop-filter: blur(6px);\\n          backdrop-filter: blur(6px);\\n  outline: none !important;\\n  -webkit-transition: opacity 3s ease-in-out;\\n    -webkit-transition--moz-transition: opacity 3s ease-in-out;\\n    -webkit-transition--ms-transition: opacity 3s ease-in-out;\\n    -webkit-transition--o-transition: opacity 3s ease-in-out; }\\n  button display-icon {\\n    -webkit-filter: drop-shadow(-1px -2px 1px rgba(0, 0, 0, 0.1)) drop-shadow(2px 3px 2px white);\\n            filter: drop-shadow(-1px -2px 1px rgba(0, 0, 0, 0.1)) drop-shadow(2px 3px 2px white);\\n    text-rendering: optimizeLegibility;\\n    display: block;\\n    width: 100%;\\n    height: 100%;\\n    padding-top: 22.5%;\\n    color: #555; }\\n  button fa-icon {\\n    -webkit-filter: drop-shadow(-1px -2px 1px rgba(0, 0, 0, 0.1)) drop-shadow(2px 3px 2px white);\\n            filter: drop-shadow(-1px -2px 1px rgba(0, 0, 0, 0.1)) drop-shadow(2px 3px 2px white);\\n    position: absolute;\\n    top: 50%;\\n    left: -35%;\\n    text-rendering: optimizeLegibility;\\n    color: #555; }\\n  button:focus, button:active {\\n  outline: none !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2Jhc2UvYnV0dG9uL2J1dHRvbi5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHVCQUF1QjtFQUN2QixnQkFBZ0I7RUFFaEIscUJBQXFCO0VBRXJCLGdJQUFBO0VBR0EsaUdBQTBGO0VBQzFGLHVIQUF1SDtFQUV2SCxrQkFBa0I7RUFDbEIsZ0JBQWdCO0VBQ2hCLFVBQVU7RUFDVixXQUFXO0VBQ1gscUJBQXFCO0VBQ3JCLHVCQUF1QjtFQUd2QixpREFBOEM7RUFDOUMsa0NBQTBCO1VBQTFCLDBCQUEwQjtFQUUxQix3QkFBd0I7RUFFeEIsMENBQTBDO0lBQ3hDLDBEQUF1QztJQUN2Qyx5REFBc0M7SUFDdEMsd0RBQXFDLEVBQUE7RUE1QnpDO0lBZ0NJLDRGQUFpRjtZQUFqRixvRkFBaUY7SUFDakYsa0NBQWtDO0lBQ2xDLGNBQWM7SUFDZCxXQUFXO0lBQ1gsWUFBWTtJQUNaLGtCQUFrQjtJQUNsQixXQUFXLEVBQUE7RUF0Q2Y7SUF5Q0ksNEZBQWlGO1lBQWpGLG9GQUFpRjtJQUNqRixrQkFBa0I7SUFDbEIsUUFBUTtJQUNSLFVBQVU7SUFDVixrQ0FBa0M7SUFDbEMsV0FBVyxFQUFBO0VBR2Y7RUFDRSx3QkFBd0IsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2Jhc2UvYnV0dG9uL2J1dHRvbi5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbImJ1dHRvbiB7XG4gIGJhY2tncm91bmQtaW1hZ2U6IHVuc2V0OyAgICAgICAvLyBtYXRlcmlhbCBmaXhcbiAgdXNlci1mb2N1czogbm9uZTtcblxuICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7XG5cbiAgLyogUGVybWFsaW5rIC0gdXNlIHRvIGVkaXQgYW5kIHNoYXJlIHRoaXMgZ3JhZGllbnQ6IGh0dHA6Ly9jb2xvcnppbGxhLmNvbS9ncmFkaWVudC1lZGl0b3IvI2ZmZmZmZiswLGZmZmZmZisxMDAmMC43OCswLDAuNTUrMTAwICovXG4gIGJhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KC00NWRlZywgcmdiYSgyNTUsMjU1LDI1NSwwLjc4KSAwJSwgcmdiYSgyNTUsMjU1LDI1NSwwLjU1KSAxMDAlKSAvKiBGRjMuNi0xNSAqLztcbiAgYmFja2dyb3VuZDogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQoLTQ1ZGVnLCByZ2JhKDI1NSwyNTUsMjU1LDAuNzgpIDAlLHJnYmEoMjU1LDI1NSwyNTUsMC41NSkgMTAwJSkgLyogQ2hyb21lMTAtMjUsU2FmYXJpNS4xLTYgKi87XG4gIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHJnYmEoMjU1LDI1NSwyNTUsMC43OCkgMCUscmdiYSgyNTUsMjU1LDI1NSwwLjU1KSAxMDAlKSAvKiBXM0MsIElFMTArLCBGRjE2KywgQ2hyb21lMjYrLCBPcGVyYTEyKywgU2FmYXJpNysgKi87XG4gIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KCBzdGFydENvbG9yc3RyPScjYzdmZmZmZmYnLCBlbmRDb2xvcnN0cj0nIzhjZmZmZmZmJyxHcmFkaWVudFR5cGU9MSApIC8qIElFNi05IGZhbGxiYWNrIG9uIGhvcml6b250YWwgZ3JhZGllbnQgKi87XG5cbiAgYm9yZGVyLXJhZGl1czogNTAlO1xuICBmb250LXNpemU6IDEuNXZ3O1xuICB3aWR0aDogN3Z3O1xuICBoZWlnaHQ6IDd2dztcbiAgbWFyZ2luOiAxMHB4IDEwcHggMCAwO1xuICBib3JkZXI6IDJweCBzb2xpZCB3aGl0ZTtcbiAgLXdlYmtpdC1ib3gtc2hhZG93OiAwcHggNXB4IDEwcHggLTVweCByZ2JhKDAsMCwwLDAuMzUpO1xuICAtbW96LWJveC1zaGFkb3c6IDBweCA1cHggMTBweCAtNXB4IHJnYmEoMCwwLDAsMC4zNSk7XG4gIGJveC1zaGFkb3c6IDBweCA1cHggMTBweCAtNXB4IHJnYmEoMCwwLDAsMC4zNSk7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig2cHgpOyAgICAvLyBzYWZhcmkvaU9TIG9ubHksIGNhdXNlcyBnbGl0Y2hpbmcuLi5cblxuICBvdXRsaW5lOiBub25lICFpbXBvcnRhbnQ7XG5cbiAgLXdlYmtpdC10cmFuc2l0aW9uOiBvcGFjaXR5IDNzIGVhc2UtaW4tb3V0IHtcbiAgICAtbW96LXRyYW5zaXRpb246IG9wYWNpdHkgM3MgZWFzZS1pbi1vdXQ7XG4gICAgLW1zLXRyYW5zaXRpb246IG9wYWNpdHkgM3MgZWFzZS1pbi1vdXQ7XG4gICAgLW8tdHJhbnNpdGlvbjogb3BhY2l0eSAzcyBlYXNlLWluLW91dDsgfVxuXG5cbiAgZGlzcGxheS1pY29uIHtcbiAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KC0xcHggLTJweCAxcHggcmdiYSgwLDAsMCwwLjEpKSBkcm9wLXNoYWRvdygycHggM3B4IDJweCB3aGl0ZSk7XG4gICAgdGV4dC1yZW5kZXJpbmc6IG9wdGltaXplTGVnaWJpbGl0eTtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgcGFkZGluZy10b3A6IDIyLjUlO1xuICAgIGNvbG9yOiAjNTU1OyB9XG5cbiAgZmEtaWNvbiB7XG4gICAgZmlsdGVyOiBkcm9wLXNoYWRvdygtMXB4IC0ycHggMXB4IHJnYmEoMCwwLDAsMC4xKSkgZHJvcC1zaGFkb3coMnB4IDNweCAycHggd2hpdGUpO1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiAtMzUlO1xuICAgIHRleHQtcmVuZGVyaW5nOiBvcHRpbWl6ZUxlZ2liaWxpdHk7XG4gICAgY29sb3I6ICM1NTU7IH0gfVxuXG5cbmJ1dHRvbjpmb2N1cywgYnV0dG9uOmFjdGl2ZSB7XG4gIG91dGxpbmU6IG5vbmUgIWltcG9ydGFudDsgfVxuXG5cbiJdfQ== */\"","import {Component, Input} from '@angular/core';\nimport {PoiType} from '../../type/poi';\n\n@Component({\n  selector: 'display-button',\n  templateUrl: './button.component.html',\n  styleUrls: ['./button.component.sass']\n})\n\nexport class ButtonComponent {\n\n  @Input() icon?:    string;\n  @Input() badge?:    string;\n  @Input() poiTypes?: Array<PoiType>;\n\n  // simple button with label & font awesome icon\n  constructor() { }\n}\n","module.exports = \"<div class=\\\"icon noselect fa-2x\\\">\\n  <fa-layers id=\\\"icons\\\" [fixedWidth]=\\\"true\\\">\\n    <fa-icon *ngFor=\\\"let poiType of data\\\" [icon]=\\\"[poiType.iconType, poiType.icon]\\\"></fa-icon>\\n  </fa-layers>\\n\\n  <!-- star rating -->\\n  <!--<fa-layers *ngIf=\\\"rateable\\\" id=\\\"rating\\\" [fixedWidth]=\\\"true\\\">-->\\n    <!--<fa-icon icon=\\\"star\\\" class=\\\"fa-icon-star\\\" size=\\\"sm\\\"></fa-icon>-->\\n    <!--<fa-layers-text content=\\\"1\\\" transform=\\\"shrink-8\\\" class=\\\"fa-icon-star-label\\\"></fa-layers-text>-->\\n  <!--</fa-layers>-->\\n\\n</div>\\n\"","module.exports = \".icon {\\n  color: #555; }\\n  .icon fa-layers {\\n    display: block;\\n    margin: 0 auto;\\n    pointer-events: none; }\\n  .icon fa-icon {\\n    pointer-events: none; }\\n  .icon #icons fa-icon:first-child:nth-last-child(2), .icon #icons fa-icon:first-child:nth-last-child(2) ~ fa-icon {\\n    position: absolute;\\n    font-size: 2.2vw; }\\n  .icon #icons fa-icon:first-child:nth-last-child(2) {\\n    text-align: left;\\n    top: 35%;\\n    left: 20%; }\\n  .icon #icons fa-icon:first-child:nth-last-child(2) ~ fa-icon {\\n    text-align: right;\\n    left: 40%;\\n    bottom: 35%; }\\n  .icon #rating {\\n    position: absolute;\\n    left: 0;\\n    bottom: 15%; }\\n  .icon #rating .fa-icon-star {\\n      color: #e8aa1b !important; }\\n  .icon #rating .fa-icon-star-label {\\n      color: white !important;\\n      font-size: 5vh !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2Jhc2UvaWNvbi9pY29uLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBVyxFQUFBO0VBRGI7SUFJSSxjQUFjO0lBQ2QsY0FBYztJQUNkLG9CQUFvQixFQUFBO0VBTnhCO0lBVUksb0JBQW9CLEVBQUE7RUFWeEI7SUFnQk0sa0JBQWtCO0lBQ2xCLGdCQUFnQixFQUFBO0VBakJ0QjtJQW9CTSxnQkFBZ0I7SUFDaEIsUUFBUTtJQUNSLFNBQVMsRUFBQTtFQXRCZjtJQXlCTSxpQkFBaUI7SUFDakIsU0FBUztJQUNULFdBQVcsRUFBQTtFQTNCakI7SUE4Qkksa0JBQWtCO0lBQ2xCLE9BQU87SUFDUCxXQUFXLEVBQUE7RUFoQ2Y7TUFtQ00seUJBQXlCLEVBQUE7RUFuQy9CO01Bc0NNLHVCQUF1QjtNQUN2Qix5QkFBeUIsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2Jhc2UvaWNvbi9pY29uLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiLmljb24ge1xuICBjb2xvcjogIzU1NTtcblxuICBmYS1sYXllcnMge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIG1hcmdpbjogMCBhdXRvO1xuICAgIHBvaW50ZXItZXZlbnRzOiBub25lOyB9XG5cbiAgZmEtaWNvbiB7XG4gICAgLy9maWx0ZXI6IGRyb3Atc2hhZG93KC0xcHggLTJweCAxcHggcmdiYSgwLDAsMCwwLjEpKSBkcm9wLXNoYWRvdygycHggM3B4IDJweCB3aGl0ZSk7XG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7IH1cblxuICAjaWNvbnMge1xuXG4gICAgLy8gaWYgMiBpY29uc1xuICAgIGZhLWljb246Zmlyc3QtY2hpbGQ6bnRoLWxhc3QtY2hpbGQoMiksIGZhLWljb246Zmlyc3QtY2hpbGQ6bnRoLWxhc3QtY2hpbGQoMikgfiBmYS1pY29uIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGZvbnQtc2l6ZTogMi4ydnc7IH1cblxuICAgIGZhLWljb246Zmlyc3QtY2hpbGQ6bnRoLWxhc3QtY2hpbGQoMikge1xuICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgIHRvcDogMzUlO1xuICAgICAgbGVmdDogMjAlOyB9XG5cbiAgICBmYS1pY29uOmZpcnN0LWNoaWxkOm50aC1sYXN0LWNoaWxkKDIpIH4gZmEtaWNvbiB7XG4gICAgICB0ZXh0LWFsaWduOiByaWdodDtcbiAgICAgIGxlZnQ6IDQwJTtcbiAgICAgIGJvdHRvbTogMzUlOyB9IH1cblxuICAjcmF0aW5nIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgbGVmdDogMDtcbiAgICBib3R0b206IDE1JTtcblxuICAgIC5mYS1pY29uLXN0YXIge1xuICAgICAgY29sb3I6ICNlOGFhMWIgIWltcG9ydGFudDsgfVxuXG4gICAgLmZhLWljb24tc3Rhci1sYWJlbCB7XG4gICAgICBjb2xvcjogd2hpdGUgIWltcG9ydGFudDtcbiAgICAgIGZvbnQtc2l6ZTogNXZoICFpbXBvcnRhbnQ7IH0gfSB9XG5cbi8vXG4vLyAgI2ljb25zXG4vL1xuLy8gICAgLy8gaWYgMiBpY29uc1xuLy8gICAgZmEtaWNvbjpmaXJzdC1jaGlsZDpudGgtbGFzdC1jaGlsZCgyKSwgZmEtaWNvbjpmaXJzdC1jaGlsZDpudGgtbGFzdC1jaGlsZCgyKSB+IGZhLWljb25cbi8vICAgICAgLy9wb3NpdGlvbjogYWJzb2x1dGVcbi8vICAgICAgYmFzZTogYmxvY2tcbi8vICAgICAgZm9udC1zaXplOiAwLjY1ZW1cbi8vXG4vLyAgICBmYS1pY29uOmZpcnN0LWNoaWxkOm50aC1sYXN0LWNoaWxkKDIpXG4vLyAgICAgIHRleHQtYWxpZ246IGxlZnRcbi8vICAgICAgdG9wOiAyNSVcbi8vICAgICAgbGVmdDogMFxuLy9cbi8vICAgIGZhLWljb246Zmlyc3QtY2hpbGQ6bnRoLWxhc3QtY2hpbGQoMikgfiBmYS1pY29uXG4vLyAgICAgIHRleHQtYWxpZ246IHJpZ2h0XG4vLyAgICAgIGJvdHRvbTogMjUlXG4vLyAgICAgIHJpZ2h0OiA2NSVcbi8vXG4vL1xuLy8gIC8vI3JhdGluZywgI3VwZGF0ZVxuLy8gIC8vICBwb3NpdGlvbjogcmVsYXRpdmVcbi8vICAvLyAgbWFyZ2luLXRvcDogLTgwJVxuLy8gIC8vXG4vLyAgLy8gIC5mYS1pY29uLXN0YXIsIC5mYS1pY29uLWNvdW50ZXIsIC5mYS1pY29uLXN0YXItbGFiZWxcbi8vICAvL1xuLy8gIC8vICAuZmEtaWNvbi1zdGFyXG4vLyAgLy8gICAgcG9zaXRpb246IGFic29sdXRlXG4vLyAgLy8gICAgY29sb3I6IG9yYW5nZVxuLy8gIC8vICAgIHJpZ2h0OiA1MCVcbi8vICAvLyAgICB0b3A6IDExNSVcbi8vICAvL1xuLy8gIC8vICAuZmEtaWNvbi1zdGFyLWxhYmVsXG4vLyAgLy8gICAgcG9zaXRpb246IGFic29sdXRlXG4vLyAgLy8gICAgcmlnaHQ6IDEwJVxuLy8gIC8vICAgIHRvcDogMTIwJVxuLy8gIC8vXG4vLyAgLy8gIC5mYS1pY29uLWNvdW50ZXJcbi8vICAvLyAgICBwb3NpdGlvbjogYWJzb2x1dGVcbi8vICAvLyAgICB6b29tOiAyMDAlXG4vLyAgLy8gICAgcmlnaHQ6IC0xMCVcbi8vICAvLyAgICB0b3A6IDExMCVcbiJdfQ== */\"","import {Component, Input, OnChanges, OnInit, SimpleChanges} from '@angular/core';\nimport {PoiType} from '../../type/poi';\n\n@Component({\n  selector: 'display-icon',\n  templateUrl: './icon.component.html',\n  styleUrls: ['./icon.component.sass']\n})\nexport class IconComponent implements OnChanges {\n\n  @Input() data: Array<PoiType>;\n  @Input() name ?: string;\n\n  public rateable: boolean;\n\n  constructor() {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.data) {\n      this._setupIcons();\n    }\n  }\n\n  private _setupIcons(): void {\n\n    let _newRateable: boolean;\n\n    const _length = this.data.length;\n\n    for (let i = 0; i < _length; i++) {\n      const _poiType:PoiType = this.data[i];\n      if (_poiType.rateable === true) {\n        _newRateable = true;\n      }\n    }\n\n    // only update if needed\n    if (_newRateable !== this.rateable) {\n      this.rateable = _newRateable;\n    }\n  }\n}\n","module.exports = \"<!-- needed for event dispatching -->\\n<div class=\\\"hidden\\\" #container></div>\\n\"","module.exports = \".hidden {\\n  visibility: hidden;\\n  display: none; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2Jhc2UvbG9jYXRpb24tYmFzZWQvbG9jYXRpb24tYmFzZWQuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQkFBa0I7RUFDbEIsYUFBYSxFQUFBIiwiZmlsZSI6InNyYy9hcHAvYmFzZS9sb2NhdGlvbi1iYXNlZC9sb2NhdGlvbi1iYXNlZC5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIi5oaWRkZW4ge1xuICB2aXNpYmlsaXR5OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7IH1cbiJdfQ== */\"","import {Component, OnDestroy, OnInit, ViewChild} from '@angular/core';\nimport {LocationService} from '../../service/location.service';\nimport {User} from '../../type/user';\nimport {Waypoint} from '../../type/waypoint';\nimport {Mile} from '../../type/mile';\nimport {environment} from '../../../environments/environment.prod';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {TrailGeneratorService} from '../../service/trail-generator.service';\nimport {FilesystemService} from '../../service/filesystem.service';\nimport {cloneData} from '../../_util/generic';\nimport {Distance} from '../../_util/geolib/distance';\nimport {BaseComponent} from '../base/base.component';\n\n@Component({\n  selector: 'app-location-based',\n  templateUrl: './location-based.component.html',\n  styleUrls: ['./location-based.component.sass']\n})\n\nexport class LocationBasedComponent extends BaseComponent implements OnInit {\n\n  @ViewChild('container') container;\n\n  public locationService:                   LocationService;\n  public localStorage:                      LocalStorageService;\n  public trailGenerator:                    TrailGeneratorService;\n  public fileSystem:                        FilesystemService;\n\n  public status:                            string;\n  public user:                              User;\n  public timestamp:                         number;\n  private _user:                            User;\n\n  constructor() {\n\n    super();\n\n    // since we're extending this class, we shouldn't inject through the constructor props\n    if (LocationService.injector) {\n      this.locationService = LocationService.injector.get(LocationService);\n      this.localStorage = LocationService.injector.get(LocalStorageService);\n      this.trailGenerator = LocationService.injector.get(TrailGeneratorService);\n      this.fileSystem = LocationService.injector.get(FilesystemService);\n    }\n\n    this.timestamp = new Date().getTime();\n\n    // create default user\n    this._user = this.createBlankUser();\n  }\n\n\n\n  // TEST FUNCTIONS\n\n  // private _hikeMile(mileId: number): void {\n  //\n  //   const _self = this;\n  //   const _steps = this.trailGenerator.getTrailData().miles[mileId].waypoints;\n  //   let _stepCount = 0;\n  //\n  //   const _interval = setInterval(function() {\n  //\n  //     if (_stepCount < _steps.length) {\n  //\n  //       const _location = {\n  //         coords: {\n  //           accuracy: 0,\n  //           altitude:  _steps[_stepCount].elevation,\n  //           altitudeAccuracy: 0,\n  //           heading: 0,\n  //           speed: 0,\n  //           latitude: _steps[_stepCount].latitude,\n  //           longitude: _steps[_stepCount].longitude\n  //         },\n  //         timestamp: new Date().getTime()\n  //       };\n  //\n  //       _stepCount ++;\n  //\n  //       _self._onLocationChange(_location as Position);\n  //\n  //     } else {\n  //       clearInterval(_interval);\n  //     }\n  //   }, 4000);\n  //\n  // }\n\n\n\n  // LIFECYCLE\n\n  ngOnInit() {\n\n    // why attempt location based stuff if there's no location service?\n    if (!this.locationService) {\n      // throw new Error('location service error!');\n      return;\n    }\n\n    // set up subscriptions\n    this.addSubscription('location', this.locationService.location.subscribe(\n      location => {\n        if (location) {\n          // this._hikeMile(2);\n          this._onLocationChange(location as Position);\n        }\n      }));\n\n    this.addSubscription('locationStatus', this.locationService.locationStatus.subscribe(\n      status => {\n        this.status = status;\n        this.onStatusChange(status);\n      }));\n\n    this.addSubscription('centerUser', this.locationService.centerUser.subscribe(trigger => {\n      if (trigger !== 0) {\n        this.centerOnUser();\n      }\n    }));\n\n  }\n\n\n\n  // EVENTS\n\n  private _onLocationChange(location: object): void {\n\n    if (location && this.status !== 'idle') {\n\n      // SET USER\n\n      // waypoint\n      this._user.waypoint = {\n        latitude: location['coords']['latitude'],\n        longitude: location['coords']['longitude'],\n        elevation: location['coords']['altitude']} as Waypoint;\n\n      // mile\n      const _waypoint: Distance = this.trailGenerator.findNearestPointInMileTree(this._user.waypoint, 1)[0];\n      const _mile: Mile = this.trailGenerator.getTrailData().miles[_waypoint['belongsTo']];\n\n      this._user.nearestMileId = _mile.id;\n\n      // anchorPoint\n      const _nearestAnchorPoint = _waypoint;\n      this._user.anchorPoint = _mile.waypoints[_nearestAnchorPoint.key];\n\n      // distance\n      this._user.waypoint.distance = _nearestAnchorPoint.distance;\n\n      //toggle warning / mile simulator\n      if (this._user.waypoint.distance > this.localStorage.retrieve('maxPoiDistance')\n        && this.localStorage.retrieve('simulatedMile') === -1 && !this.localStorage.retrieve('disableSimulation')) {\n\n        const _event: CustomEvent = new CustomEvent(\n          'offtrail',\n          {\n            bubbles: true,\n            cancelable: true,\n            detail: {\n              distance: this._user.waypoint.distance,\n              anchorPointDistance: (this._user.anchorPoint.distanceTotal / environment.MILE).toFixed(2),\n              trailLength: this.trailGenerator.getTrailData().miles.length\n            }\n          });\n\n        if (this.container) {\n          if (this.container.nativeElement) {\n            this.container.nativeElement.dispatchEvent(_event);\n          }\n        }\n\n      } else {\n\n        this.user = cloneData(this._user) as User;\n        this.timestamp = location['timestamp'];\n        this.onUserLocationChange(this.user);\n      }\n    }\n  }\n\n  public onStatusChange(status: string): void {\n    // OVERRIDE\n  }\n\n  public onUserLocationChange(user: User): void {\n    // OVERRIDE\n  }\n\n  public centerOnUser(): void {\n    // OVERRIDE\n  }\n\n\n  // OTHER\n\n  public createBlankUser(): User {\n    return {\n      type: 'user',\n      waypoint: undefined,\n      anchorPoint: undefined,\n      distance: 0,\n      nearestMileId: 0,\n      id: -1\n    } as User;\n  }\n\n}\n","module.exports = \"\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2Jhc2Uvc2V0dGluZ3MtcGFuZWwvc2V0dGluZ3MtcGFuZWwuY29tcG9uZW50LnNhc3MifQ== */\"","import {Component, EventEmitter, OnDestroy, OnInit, Output} from '@angular/core';\n\n@Component({\n  selector: 'settings-panel',\n  templateUrl: './settings-panel.component.html',\n  styleUrls: ['./settings-panel.component.sass']\n})\n\n// a panel with an invalidate function which triggers a reload of the application\n// used for forms that require an app reload on change\nexport class SettingsPanelComponent implements OnInit, OnDestroy {\n\n  @Output() onSettingsChanged: EventEmitter<boolean> = new EventEmitter();\n\n  public settingsChanged = false;\n\n  constructor() { }\n\n  ngOnInit() {}\n\n  ngOnDestroy(): void {\n    this.validate();\n    this.onSettingsChanged = null;\n  }\n\n  protected invalidate(): void {\n    this.settingsChanged = true;\n    this.validate();\n  }\n\n  protected validate(): void {\n    if (this.settingsChanged) {\n      this.onSettingsChanged.emit(true);\n    }\n  }\n}\n","import * as X2JS from 'x2js';\nimport {Waypoint} from '../../type/waypoint';\nimport {Poi} from '../../type/poi';\nimport {Snowpoint} from '../../type/snow';\nimport {TrailMeta} from '../../type/trail';\nimport {calculateDistance} from '../../_util/geolib/distance';\nimport {Town} from '../../type/town';\n\nexport interface FindReplace {\n  find:       string;\n  replace:    string;\n}\n\nexport class TrailParser {\n\n  public trail: TrailMeta;\n  public trailData: Array<string> | string;\n  public poiData: Array<string> | string;\n  public snow: object;\n  public direction: number;\n  public totalDistance = 0;\n  public findReplaceArray: Array<FindReplace>;\n  public x2js = new X2JS({\n    attributePrefix : ''    // no attribute prefix\n  });\n\n  private _prevPoint: Waypoint;\n\n  constructor() {}\n\n  // the main entry point\n  public parse(trail: TrailMeta, trailData: Array<string> | string, poiData: Array<string> | string, snow: object, towns: Array<Town>, direction: any): void {\n\n    // set\n    this.trail = trail;\n    this.trailData = this.directionReverse(trailData);\n\n    this.poiData = this.directionReverse(poiData);\n    this.snow = snow;\n    this.direction = direction;\n\n    // defaults\n    this.findReplaceArray = [];\n    this.totalDistance = 0;\n    this._prevPoint = null;\n\n    // auto reverse input data\n    if (direction === 1 && Array.isArray(trailData)) {\n      trailData.reverse();\n    }\n  }\n\n  public parseTrail(trailData: Array<string> | string): Array<Waypoint> {\n    // override\n\n    return;\n  }\n\n  public parsePois(pois: Array<object>): Array<Poi> {\n    // override\n\n    return;\n  }\n\n  public parseSnow(): Array<Snowpoint> {\n    // override\n\n    return;\n  }\n\n\n\n  // CONVERTERS\n\n  // converts urls in strings to html hrefs\n  public convertStringUrls(input: string) {\n\n    const _regex = /(([a-z]+:\\/\\/)?(([a-z0-9\\-]+\\.)+([a-z]{2}|aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel|local|internal))(:[0-9]{1,5})?(\\/[a-z0-9_\\-\\.~]+)*(\\/([a-z0-9_\\-\\.]*)(\\?[a-z0-9+_\\-\\.%=&amp;]*)?)?(#[a-zA-Z0-9!$&'()*+.=-_~:@/?]*)?)(\\s+|$)/gi;\n\n    return input.replace(_regex, function (match) {\n\n      match = match.split(' ').join('');      // remove spaces\n      return '<a href=\"http://' + match.toLowerCase() + '\" target=\"_blank\">' + match.toLowerCase() + '</a> ';\n    });\n  }\n\n\n  public convertStringTel(input: string): string {\n\n    const _regex = /(?:(?:\\+?1\\s*(?:[.-]\\s*)?)?(?:\\(\\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\\s*\\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\\s*(?:[.-]\\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\\s*(?:[.-]\\s*)?([0-9]{4})(?:\\s*(?:#|x\\.?|ext\\.?|extension)\\s*(\\d+))?/img;\n\n    return input.replace(_regex, function (match) {\n      const _digits = match.split('-').join('');\n      return '<a href=\"tel:+1' + _digits + '\">+1-' + match + '</a>';\n    });\n  }\n\n  // go from gpx to waypoint before converting to JSON (string manipulation is faster?)\n  public convertToWaypointString(input: string): string {\n\n    const _length = this.findReplaceArray.length;\n\n    for (let i = 0; i < _length; i++) {\n      input = input.split(this.findReplaceArray[i].find).join(this.findReplaceArray[i].replace);\n    }\n    return input;\n  }\n\n\n\n  // OTHER\n\n  // set the total distance (the distance on trail) for each waypoint, based on the section scale\n  public addDistanceToWaypoints(waypoints: Array<Waypoint>, scale: number): Array<Waypoint> {\n\n    let _sectionLength = 0;\n    const _length = waypoints.length;\n\n    for (let i = 0; i < _length; i++) {\n\n      const _waypoint: Waypoint = waypoints[i];\n\n      let _distance = 0;\n\n      if(this._prevPoint) {\n        _distance = (calculateDistance(_waypoint, this._prevPoint) * scale);\n        _sectionLength += _distance;\n        this.totalDistance += _distance;\n      }\n\n      _waypoint.distanceTotal = this.totalDistance;\n\n      this._prevPoint = _waypoint;\n    }\n\n    return waypoints;\n  }\n\n  // reverse data if needed, for sobo\n  public directionReverse(input: any): Array<any> {\n\n    if (this.direction === 1 && Array.isArray(input)) {\n      return input.reverse();\n    } else {\n      return input;\n    }\n  }\n\n  // letting the browser parse it, returning the contents\n  public stripHtmlTags(input: string): string {\n    const _div = document.createElement('');\n    _div.innerHTML = input;\n    return _div.textContent || _div.innerText || '';\n  }\n\n  // helper class to generate a list of possible identifiers\n  // private _generateIdentifierList(input): void {\n  //   if (_identifierList.indexOf(input) === -1) {\n  //     _identifierList.push(input);\n  //   }\n  // }\n}\n","module.exports = \"<div id=\\\"container\\\">\\n\\n  <h2>Generate data</h2>\\n\\n  <span>\\n    <select [(ngModel)]=\\\"selectedTrail\\\">\\n      <option *ngFor=\\\"let trail of trailMeta\\\" [value]=\\\"trail.id\\\">\\n        {{trail.abbr}}\\n      </option>\\n    </select>\\n\\n    <span> : </span>\\n\\n    <select  [(ngModel)]=\\\"selectedDirection\\\">\\n       <option *ngFor=\\\"let dir of directions\\\" [value]=\\\"dir.id\\\">\\n        {{dir.name}}\\n      </option>\\n    </select>\\n\\n    <span> : </span>\\n\\n    <button class=\\\"{{trailDataStateClassName}}\\\" (click)=\\\"generateTrailData()\\\">Generate Trail Data</button>\\n\\n  </span>\\n  <hr/>\\n\\n  <div *ngIf=\\\"trailDataStateClassName !== ''\\\">\\n\\n    <h2>Download files</h2>\\n\\n    <button (click)=\\\"downloadData('trail')\\\">Download Trail Data</button>\\n    <button (click)=\\\"downloadData('snow')\\\">Download Snow Data</button>\\n    <button (click)=\\\"genGpxData()\\\">Download (clean) GPX file</button>\\n    <hr/>\\n\\n  </div>\\n\\n  <h2>App data helpers</h2>\\n\\n  <button (click)=\\\"safeClearUserData()\\\">clean user (excl. tiles)</button>\\n  <button (click)=\\\"defaultUserData()\\\">default user data</button>\\n  <button (click)=\\\"clearStorage()\\\">clear storage</button>\\n  <button (click)=\\\"reset()\\\">RESET ALL</button>\\n\\n  <h2>Communication (requires an internet connection)</h2>\\n  <button (click)=\\\"sendAllNotes()\\\">Send all notes</button>\\n  <button (click)=\\\"sendAllPins()\\\">Send all pins</button>\\n\\n  <h2>Other</h2>\\n  <button (click)=\\\"disableSimulation()\\\">disable mile simulation</button>\\n\\n</div>\\n\"","module.exports = \":host #container > * {\\n  margin: 10px; }\\n\\n:host #container {\\n  text-align: center;\\n  overflow-y: scroll;\\n  min-height: 100%;\\n  height: 100%; }\\n\\n:host #container h1, :host #container h2 {\\n    text-align: center; }\\n\\n:host #container button {\\n    margin: 4px; }\\n\\n:host #container button:focus {\\n    outline: 0; }\\n\\n:host #container .generated {\\n    background-color: lightgreen; }\\n\\n:host #container .error {\\n    background-color: lightcoral; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9hZG1pbi9hZG1pbi5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLFlBQVksRUFBQTs7QUFIZjtFQU1HLGtCQUFrQjtFQUNsQixrQkFBa0I7RUFDbEIsZ0JBQWdCO0VBQ2hCLFlBQVksRUFBQTs7QUFUZjtJQVlLLGtCQUFrQixFQUFBOztBQVp2QjtJQWVLLFdBQVcsRUFBQTs7QUFmaEI7SUFrQkssVUFBVSxFQUFBOztBQWxCZjtJQXFCSyw0QkFBNEIsRUFBQTs7QUFyQmpDO0lBd0JLLDRCQUE0QixFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2FkbWluL2FkbWluLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IHtcblxuICAjY29udGFpbmVyID4gKiB7XG4gICAgbWFyZ2luOiAxMHB4OyB9XG5cbiAgI2NvbnRhaW5lciB7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIG92ZXJmbG93LXk6IHNjcm9sbDtcbiAgICBtaW4taGVpZ2h0OiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcblxuICAgIGgxLCBoMiB7XG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH1cblxuICAgIGJ1dHRvbiB7XG4gICAgICBtYXJnaW46IDRweDsgfVxuXG4gICAgYnV0dG9uOmZvY3VzIHtcbiAgICAgIG91dGxpbmU6IDA7IH1cblxuICAgIC5nZW5lcmF0ZWQge1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRncmVlbjsgfVxuXG4gICAgLmVycm9yIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Y29yYWw7IH0gfSB9XG4iXX0= */\"","import {Component, OnInit} from '@angular/core';\nimport {LoaderService} from '../../service/loader.service';\nimport {TrailMeta} from '../../type/trail';\nimport {getTrailMetaDataById, getTrailsMetaData} from '../../_util/trail-meta';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {switchMap, take} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {TrailService} from '../../service/trail.service';\nimport {saveFileAs} from '../../_util/save';\nimport {FilesystemService} from '../../service/filesystem.service';\nimport {createGPX} from '../../_util/admin/gpx-tools';\nimport {TrailGeneratorService} from '../../service/trail-generator.service';\nimport {OrientationService} from '../../service/orientation.service';\nimport {SequentialResolverService} from '../../service/sequential-resolver.service';\nimport {cloneData} from '../../_util/generic';\nimport {Waypoint} from '../../type/waypoint';\nimport {BaseComponent} from '../../base/base/base.component';\n\n@Component({\n  selector: 'app-admin',\n  templateUrl: './admin.component.html',\n  styleUrls: ['./admin.component.sass']\n})\nexport class AdminComponent extends BaseComponent implements OnInit {\n\n  // public compass: number;\n\n  public trailMeta: Array<TrailMeta>;\n  public selectedTrail = 0;\n  public selectedDirection = 0;\n  public trailDataStateClassName: string = '';\n\n  private _generatedData: any;\n\n  public directions: Array<any> = [\n    {id: 0, name:'nobo'},\n    {id: 1, name:'sobo'}\n  ];\n\n  constructor(\n    private _fileSystemService: FilesystemService,\n    private _trailService: TrailService,\n    private _trailGeneratorService: TrailGeneratorService,\n    private _localStorageService: LocalStorageService,\n    private _loaderService: LoaderService,\n    // private _orientationService: OrientationService,\n    private _sequentialResolver: SequentialResolverService\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n\n    const _trailMetaObj = getTrailsMetaData();\n\n    this.trailMeta = Object.keys(_trailMetaObj).map(function(key) {\n      return _trailMetaObj[key];\n    });\n    //\n    // this._orientationService.orientationObserver.subscribe(function(direction) {\n    //   _self.compass = direction;\n    // });\n    //\n    // this._orientationService.startTracking();\n  }\n\n  public genGpxData(): void {\n\n    const _trailMeta: TrailMeta = getTrailMetaDataById(Number(this.selectedTrail));\n\n    // simplify the track for app: Mobile Atlas Creator\n    const _clone: Array<any> = cloneData(this._trailGeneratorService.flatTrailData) as Array<Waypoint>;\n\n    // 55 gives roughly 3 points per mile (PCT)\n    // _clone = this._trailGeneratorService.simplify(_clone, 0.1, true);\n\n    alert(this._trailGeneratorService.flatTrailData.length + ' to ' + _clone.length + ' waypoints');\n\n    const _gpx: Array<any> = createGPX(_trailMeta, _clone);\n\n    _gpx.forEach(function(file, index) {\n      saveFileAs(file, _trailMeta.abbr + '_' + index + '.gpx');\n    })\n\n  }\n\n  public generateTrailData(): void {\n\n    this.trailDataStateClassName = '';\n\n    this.addSubscription('rawTrailData', this._getRawData().subscribe( data => {\n\n      const _trailMeta: TrailMeta = data[0];\n      const _dataOffset: number = (_trailMeta.parts) ? _trailMeta.parts - 1 : 0;\n\n      let _waypointData: Array<string> | string;\n      if (_trailMeta.multipart) {\n\n        _waypointData = [];\n\n        for (let i = 0; i <= _dataOffset; i++) {\n          _waypointData.push(data[i + 1]);\n        }\n      } else {\n        _waypointData = data[1];\n      }\n\n      const _parsedData = this._trailService.parseTrailData(data[0], _waypointData, data[2 + _dataOffset], data[3 + _dataOffset], data[4 + _dataOffset], Number(this.selectedDirection));\n\n      this._generatedData = _parsedData;\n      this.trailDataStateClassName = 'generated';\n    }));\n  }\n\n  private _getRawData(): Observable<any> {\n\n    this._loaderService.showOverlay();\n\n    return this._trailService.getRawTrailData(Number(this.selectedTrail)).pipe(\n\n      take(1),\n      switchMap(data => {\n\n        this._loaderService.hideOverlay();\n\n        if (data) {\n\n          // return parsed trail\n          return of(data);\n\n        } else {\n\n          alert('Error!');\n\n          this.trailDataStateClassName = 'error';\n\n          return;\n        }\n      })\n    );\n  }\n\n  public downloadData(type: string): void {\n\n    const _trailAbbr: string = getTrailMetaDataById(Number(this.selectedTrail)).abbr;\n    const _direction: string = this.directions[Number(this.selectedDirection)].name;\n\n    let _fileName:string = _trailAbbr + '-' + type;\n\n    if (type === 'trail') {\n      _fileName +=  '-' + _direction;\n    }\n\n    saveFileAs(this._generatedData[type], _fileName + '.json');\n  }\n\n  public clearStorage(): void {\n\n    const _self = this;\n\n    this.trailMeta.forEach(function(meta:TrailMeta) {\n      _self._fileSystemService.deleteDirectory(meta.abbr, function() {\n        console.log(meta.abbr + ' directory deleted');\n      });\n    });\n  }\n\n  // clears all user data with the exception of tile downloaded flags ([abbr]Version)\n  public defaultUserData(): void {\n\n    // clear all\n    this._localStorageService.clear();\n\n    // set defaults\n    this._sequentialResolver.firstRun();\n  }\n\n  public safeClearUserData(): void {\n\n    const _self = this;\n    \n    // get tile settings (don't want to delete those flags as it would require a re-download of all tiles)\n    const _tileSettings = {};\n    this.trailMeta.forEach(function(meta: TrailMeta) {\n      _tileSettings[meta.abbr + 'Version'] = _self._localStorageService.retrieve(meta.abbr + 'Version');\n    });\n\n    console.log(_tileSettings);\n\n    // clear all\n    this._localStorageService.clear();\n\n    // set defaults\n    this._sequentialResolver.firstRun();\n\n    this.trailMeta.forEach(function(meta: TrailMeta) {\n      console.log(_tileSettings[meta.abbr + 'Version']);\n      if (_tileSettings[meta.abbr + 'Version'] !== null) {\n        _self._localStorageService.store(meta.abbr + 'Version', _tileSettings[meta.abbr + 'Version']);\n      }\n    });\n  }\n\n  public reset(): void {\n    this.clearStorage();\n    this.defaultUserData();\n  }\n\n  public disableSimulation(): void {\n\n    const _current = this._localStorageService.retrieve('disableSimulation');\n    this._localStorageService.store('disableSimulation', !(_current))\n  }\n\n  // TODO: does not work on all devices...\n  public sendAllNotes(): void {\n    const _notes = this._localStorageService.retrieve(this._trailGeneratorService.getTrailData().abbr + '_notes');\n    window.open('mailto:frankdouwes@gmail.com?subject=Hello there&body=' + _notes);\n  }\n\n  public sendAllPins(): void {\n    alert('not implemented');\n  }\n}\n","module.exports = \"<div id=\\\"center-icon\\\" >\\n  <display-button class=\\\"button\\\" label=\\\"\\\" [poiTypes]=\\\"poiTypes\\\" routerLink=\\\"\\\"></display-button>\\n</div>\\n\\n<!-- left -->\\n<div id=\\\"left-panel\\\">\\n  <button *ngIf=\\\"data.type.includes('note')\\\" (click)=\\\"deletePoi()\\\">delete</button>\\n\\n  <!-- information -->\\n  <div id=\\\"information-container\\\">\\n\\n    <h1 mat-dialog-title [innerHTML]=\\\"data.label\\\"></h1>\\n    <h2 id=\\\"mileage\\\" *ngIf=\\\"data.anchorPoint && data.waypoint\\\">{{data.anchorPoint.distanceTotal | distance:'meters':'miles'}} ({{data.waypoint.distance | distance:'meters':'miles':true}})</h2>\\n    <small *ngIf=\\\"data.identifier\\\">{{data.identifier}}</small>\\n\\n    <div id=\\\"description\\\" *ngIf=\\\"data.description\\\">\\n      <p [innerHTML]=\\\"data.description\\\"></p>\\n    </div>\\n\\n    <div id=\\\"comment\\\" *ngIf=\\\"data.comment\\\">\\n      <p [innerHTML]=\\\"data.comment\\\"></p>\\n    </div>\\n\\n  </div>\\n\\n  <!-- rating -->\\n  <rating *ngIf=\\\"rateable\\\" [waypoint]=\\\"data.waypoint\\\" [poiTypes]=\\\"poiTypes\\\"></rating>\\n\\n</div>\\n\\n<!-- right -->\\n<div id=\\\"right-panel\\\" [ngStyle]=\\\"{'background-color': poiTypes[0].color} \\\">\\n  <div id=\\\"scroll-container\\\">\\n    <div class=\\\"related-poi-list\\\" *ngFor=\\\"let poiGroup of poiCollection\\\">\\n      <h3>Next {{relatedLabel(poiGroup.label)}}</h3>\\n      <poi-list\\n        class=\\\"poi-list\\\"\\n        [showUser]=\\\"false\\\"\\n        [masterPoi]=\\\"data\\\"\\n        [poisData]=\\\"poiGroup.data\\\">\\n      </poi-list>\\n    </div>\\n  </div>\\n</div>\\n\"","module.exports = \":host #center-icon {\\n  position: absolute;\\n  left: 50%;\\n  margin: -3.5vw 0 0 -3.5vw;\\n  z-index: 1000; }\\n  :host #center-icon button {\\n    user-focus: none; }\\n  :host #left-panel, :host #right-panel {\\n  box-sizing: border-box;\\n  display: inline-block;\\n  width: 50%;\\n  height: 100%; }\\n  :host #left-panel {\\n  height: 98%;\\n  vertical-align: bottom;\\n  overflow-y: scroll; }\\n  :host #left-panel #information-container {\\n    margin-top: 12px; }\\n  :host #left-panel #information-container #mileage, :host #left-panel #information-container h1, :host #left-panel #information-container h2, :host #left-panel #information-container small {\\n      padding: 0 12px; }\\n  :host #left-panel #information-container #description, :host #left-panel #information-container #comment {\\n      padding: 6px 12px; }\\n  :host #left-panel #information-container h1, :host #left-panel #information-container h2 {\\n      display: block;\\n      text-align: left;\\n      width: 90%;\\n      overflow: hidden; }\\n  :host #left-panel #information-container h1 {\\n      font-size: 4.2vh;\\n      line-height: 5.5vh;\\n      margin-bottom: 0 !important; }\\n  :host #left-panel #information-container h2 {\\n      font-size: 3.8vh;\\n      line-height: 4.4vh; }\\n  :host #right-panel {\\n  background-color: #AAAAAA;\\n  vertical-align: top;\\n  padding: 0 12px 12px 12px; }\\n  :host #right-panel #scroll-container {\\n    height: 100%;\\n    overflow-y: scroll; }\\n  :host #right-panel #scroll-container h3 {\\n      text-align: center; }\\n  :host #right-panel #scroll-container .related-poi-list {\\n      height: calc((100vh / 7) * 3.75); }\\n  :host /deep/ .mat-list-item-content {\\n  padding: 0 12px !important;\\n  margin: 0 !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvbWFya2VyLWRpYWxvZy9tYXJrZXItZGlhbG9nLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFDO0VBR0csa0JBQWtCO0VBQ2xCLFNBQVM7RUFDVCx5QkFBeUI7RUFDekIsYUFBYSxFQUFBO0VBTmhCO0lBU0ssZ0JBQWdCLEVBQUE7RUFUckI7RUFZRyxzQkFBc0I7RUFDdEIscUJBQXFCO0VBQ3JCLFVBQVU7RUFDVixZQUFZLEVBQUE7RUFmZjtFQWtCRyxXQUFXO0VBQ1gsc0JBQXNCO0VBQ3RCLGtCQUFrQixFQUFBO0VBcEJyQjtJQXVCSyxnQkFBZ0IsRUFBQTtFQXZCckI7TUEwQk8sZUFBZSxFQUFBO0VBMUJ0QjtNQTZCTyxpQkFBaUIsRUFBQTtFQTdCeEI7TUFnQ08sY0FBYztNQUNkLGdCQUFnQjtNQUNoQixVQUFVO01BQ1YsZ0JBQWdCLEVBQUE7RUFuQ3ZCO01Bc0NPLGdCQUFnQjtNQUNoQixrQkFBa0I7TUFDbEIsMkJBQTJCLEVBQUE7RUF4Q2xDO01BMkNPLGdCQUFnQjtNQUNoQixrQkFBa0IsRUFBQTtFQTVDekI7RUErQ0cseUJBQXlCO0VBQ3pCLG1CQUFtQjtFQUNuQix5QkFBeUIsRUFBQTtFQWpENUI7SUFvREssWUFBWTtJQUNaLGtCQUFrQixFQUFBO0VBckR2QjtNQXdETyxrQkFBa0IsRUFBQTtFQXhEekI7TUEyRE8sZ0NBQWdDLEVBQUE7RUFJdkM7RUFHRywwQkFBMEI7RUFDMUIsb0JBQW9CLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGlhbG9nL21hcmtlci1kaWFsb2cvbWFya2VyLWRpYWxvZy5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG5cbiAgI2NlbnRlci1pY29uIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgbGVmdDogNTAlO1xuICAgIG1hcmdpbjogLTMuNXZ3IDAgMCAtMy41dnc7XG4gICAgei1pbmRleDogMTAwMDtcblxuICAgIGJ1dHRvbiB7XG4gICAgICB1c2VyLWZvY3VzOiBub25lOyB9IH1cblxuICAjbGVmdC1wYW5lbCwgI3JpZ2h0LXBhbmVsIHtcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICB3aWR0aDogNTAlO1xuICAgIGhlaWdodDogMTAwJTsgfVxuXG4gICNsZWZ0LXBhbmVsIHtcbiAgICBoZWlnaHQ6IDk4JTtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICAgIG92ZXJmbG93LXk6IHNjcm9sbDtcblxuICAgICNpbmZvcm1hdGlvbi1jb250YWluZXIge1xuICAgICAgbWFyZ2luLXRvcDogMTJweDtcblxuICAgICAgI21pbGVhZ2UsIGgxLCBoMiwgc21hbGwge1xuICAgICAgICBwYWRkaW5nOiAwIDEycHg7IH1cblxuICAgICAgI2Rlc2NyaXB0aW9uLCAjY29tbWVudCB7XG4gICAgICAgIHBhZGRpbmc6IDZweCAxMnB4OyB9XG5cbiAgICAgIGgxLCBoMiB7XG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgICAgICB3aWR0aDogOTAlO1xuICAgICAgICBvdmVyZmxvdzogaGlkZGVuOyB9XG5cbiAgICAgIGgxIHtcbiAgICAgICAgZm9udC1zaXplOiA0LjJ2aDtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDUuNXZoO1xuICAgICAgICBtYXJnaW4tYm90dG9tOiAwICFpbXBvcnRhbnQ7IH1cblxuICAgICAgaDIge1xuICAgICAgICBmb250LXNpemU6IDMuOHZoO1xuICAgICAgICBsaW5lLWhlaWdodDogNC40dmg7IH0gfSB9XG5cbiAgI3JpZ2h0LXBhbmVsIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjQUFBQUFBO1xuICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gICAgcGFkZGluZzogMCAxMnB4IDEycHggMTJweDtcblxuICAgICNzY3JvbGwtY29udGFpbmVyIHtcbiAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIG92ZXJmbG93LXk6IHNjcm9sbDtcblxuICAgICAgaDMge1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH1cblxuICAgICAgLnJlbGF0ZWQtcG9pLWxpc3Qge1xuICAgICAgICBoZWlnaHQ6IGNhbGMoKDEwMHZoIC8gNykgKiAzLjc1KTsgfSB9IH0gfVxuXG5cblxuIDpob3N0IC9kZWVwLyB7XG5cbiAgLm1hdC1saXN0LWl0ZW0tY29udGVudCB7XG4gICAgcGFkZGluZzogMCAxMnB4ICFpbXBvcnRhbnQ7XG4gICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7IH0gfVxuXG4iXX0= */\"","import {ChangeDetectionStrategy, Component, Inject, OnDestroy, OnInit} from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material';\nimport { Poi, PoiType } from '../../../type/poi';\nimport { getPoiTypeByType } from '../../../_util/poi';\nimport {TrailGeneratorService} from '../../../service/trail-generator.service';\nimport {NoteService} from '../../../service/note.service';\n\n@Component({\n  selector: 'marker-dialog',\n  templateUrl: './marker-dialog.component.html',\n  styleUrls: ['./marker-dialog.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class MarkerDialogComponent implements OnInit, OnDestroy {\n\n  public poiTypes:  Array<PoiType> = [];\n  public poiCollection: Array<object> = [];\n  public showRelated: boolean;\n  public rateable: boolean;\n\n  constructor(\n    private _trailGeneratorService: TrailGeneratorService,\n    private _noteService: NoteService,\n    public dialogRef: MatDialogRef<MarkerDialogComponent>,\n    @Inject(MAT_DIALOG_DATA)\n    public data: Poi\n  ) {}\n\n  ngOnInit() {\n\n    const _self = this;\n\n    // generate poiTypes (icons)\n    const _poiStrArr: Array<string> = this.data.type.split(', ');\n\n    _poiStrArr.forEach(function(poi, index) {\n\n      const _poiData = getPoiTypeByType(poi);\n\n      if (!_poiData) {\n        // TODO: a bug in cottonwood creek below lake morena (PCT), seems to be a blank poi in data...\n        return;\n      }\n\n      if(_poiData.rateable && !_self.rateable) {\n        _self.rateable = true;\n      }\n\n      if (_poiData !== undefined) {\n\n        if (_poiStrArr.length > 2 && index === 1) {\n          _self.poiTypes.push(getPoiTypeByType('unknown'));\n        }\n        _self.poiTypes.push(_poiData);\n      } else {\n        _self.poiTypes.push(getPoiTypeByType('unknown'));\n      }\n    });\n\n    // if no types\n    if (this.poiTypes.length === 0) {\n      this.poiTypes.push(getPoiTypeByType('unknown'));\n    }\n\n    if (this.data.type.includes('water')) {\n      this.showRelated = true;\n      this._getRelatedPois('water');\n    }\n\n    if (this.data.type.includes('camp')) {\n      this.showRelated = true;\n      this._getRelatedPois('camp');\n    }\n  }\n\n  ngOnDestroy(): void {\n\n  }\n\n\n  public deletePoi(): void {\n    this._noteService.deleteNote(this.data.id, this.data.belongsToType, this.data.belongsTo);\n    this.dialogRef.close();\n  }\n\n  // only show individual rating labels if there is more than 1 poitype that allows rating\n  public showRatingLabel(): boolean {\n\n    if (this.poiTypes.length < 2) {\n\n      return false;\n\n    } else {\n\n      // check if there are multiple rateable types)\n      let _rateableCount = 0;\n      for (let i = 0; i < this.poiTypes.length; i++) {\n        if (this.poiTypes[i].rateable) {\n          _rateableCount++;\n        }\n      }\n\n      return (_rateableCount > 1);\n    }\n  }\n\n  public relatedLabel(type: string): string {\n    return getPoiTypeByType(type).label;\n  }\n\n\n  // get related pois (by type) to display\n  private _getRelatedPois(poiType: string): void {\n\n    const _relatedPois: Array<number> = this._trailGeneratorService.getTrailData().sortedPoiIds[poiType];\n    const _poiIndex: number = _relatedPois.indexOf(this.data.id);\n    const _poiIds: Array<number> = _relatedPois.slice(_poiIndex + 1, _poiIndex + 4);\n\n    this.poiCollection.push({label: poiType, data: _poiIds});\n  }\n\n\n\n\n  // EVENTS\n}\n","module.exports = \"<div id=\\\"wrapper\\\" (click)=\\\"setScore($event)\\\">\\n\\n  <span id=\\\"label\\\" (click)=\\\"cycleScore($event)\\\">{{label}}:</span>\\n\\n  <span id=\\\"star-container\\\">\\n    <fa-icon\\n      *ngFor=\\\"let score of scoreArray; let i = index\\\"\\n      [id]=\\\"i\\\"\\n      [icon]=\\\"(score === '/') ? 'star-half-alt' : ((score === 'o') ? ['far', 'star'] : 'star')\\\"\\n      [ngClass]=\\\"(score !== 'o') ? 'active' : 'inactive'\\\" class=\\\"fa-icon-star\\\"\\n      [fixedWidth]=\\\"true\\\">\\n    </fa-icon>\\n  </span>\\n\\n</div>\\n\\n\"","module.exports = \":host #wrapper #label {\\n  text-transform: capitalize; }\\n\\n:host #star-container {\\n  float: right;\\n  color: #e8aa1b !important; }\\n\\n:host /deep/ fa-icon {\\n  display: inline-block;\\n  pointer-events: all !important; }\\n\\n:host /deep/ fa-icon svg {\\n    pointer-events: none; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvbWFya2VyLWRpYWxvZy9yYXRpbmcvZWxlbWVudHMvYWRkLXNjb3JlL2FkZC1zY29yZS5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUtLLDBCQUEwQixFQUFBOztBQUwvQjtFQVFHLFlBQVk7RUFDWix5QkFBeUIsRUFBQTs7QUFFNUI7RUFHRyxxQkFBcUI7RUFDckIsOEJBQThCLEVBQUE7O0FBSmpDO0lBT0ssb0JBQW9CLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGlhbG9nL21hcmtlci1kaWFsb2cvcmF0aW5nL2VsZW1lbnRzL2FkZC1zY29yZS9hZGQtc2NvcmUuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuXG4gICN3cmFwcGVyIHtcblxuICAgICNsYWJlbCB7XG4gICAgICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTsgfSB9XG5cbiAgI3N0YXItY29udGFpbmVyIHtcbiAgICBmbG9hdDogcmlnaHQ7XG4gICAgY29sb3I6ICNlOGFhMWIgIWltcG9ydGFudDsgfSB9XG5cbiA6aG9zdCAvZGVlcC8ge1xuXG4gIGZhLWljb24ge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsgICAgICAgLy8gbmVlZGVkIGZvciBTYWZhcmkvaU9TIGNsaWNrIGV2ZW50c1xuICAgIHBvaW50ZXItZXZlbnRzOiBhbGwgIWltcG9ydGFudDtcblxuICAgIHN2ZyB7XG4gICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsgfSB9IH1cbiJdfQ== */\"","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Input, OnInit, ViewChild} from '@angular/core';\nimport {Rating, Score, TotalScore} from '../../../../../../type/rating';\n\n@Component({\n  selector: 'rating-add-score',\n  templateUrl: './add-score.component.html',\n  styleUrls: ['./add-score.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class AddScoreComponent implements OnInit {\n\n  @Input() type: string;\n  @Input() round: boolean;\n  @Input() label: string;\n  @Input() rating: Rating;\n\n  public score: TotalScore;\n  public scoreArray: Array<string>;\n\n  constructor(private _changeDetector: ChangeDetectorRef) {}\n\n  ngOnInit(): void {\n    this.score = this.rating.getAspect(this.label);\n    this.setScoreArray();\n  }\n\n  public setScore(event): void {\n\n    let _newScore: number = (event.target.id !== 'wrapper') ? Number(event.target.id) + 1 : 0;\n    const _currentScore: number = this.score.getUserScore();\n\n    // toggle\n    if (_newScore === _currentScore) {\n      _newScore --;\n    }\n\n    // change score\n    this.rating.setAspectRating(this.label, _newScore);\n\n    this.setScoreArray();\n    this._changeDetector.markForCheck();\n  }\n\n  // +1 the score\n  public cycleScore(event): void {\n\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n\n    let _floorScore = Math.floor(this.score.getUserScore());\n\n    if (_floorScore < 5) {\n\n      _floorScore ++;\n      this.rating.setAspectRating(this.label, _floorScore);\n\n    } else {\n      this.rating.setAspectRating(this.label, 0);\n    }\n\n    this.setScoreArray();\n    this._changeDetector.detectChanges();\n  }\n\n  // turns 3.7 into ['x', 'x', 'x', '/', 'o'], can round to the nearest number\n  public setScoreArray(): void {\n\n    const _scoreArray: Array<string> = [];\n\n    let _score = this.score.getUserScore();\n    _score = (this.round) ? Math.round(_score) : _score;\n\n    for (let i = 0; i < 5; i++) {\n\n      if (_score > i) {\n        if (_score - i >= 1) {\n          _scoreArray.push('x');\n        } else {\n          _scoreArray.push('/');\n        }\n      } else {\n        _scoreArray.push('o');\n      }\n    }\n\n    this.scoreArray = _scoreArray;\n  }\n}\n","module.exports = \"<span id=\\\"label\\\">{{label}}:</span>\\n\\n<span id=\\\"star-container\\\">\\n    <fa-icon\\n      *ngFor=\\\"let score of scoreArray(score.getScore(), false); let i = index\\\"\\n      [id]=\\\"i\\\"\\n      [icon]=\\\"(score === '/') ? 'star-half-alt' : 'star'\\\"\\n      [ngClass]=\\\"(score !== 'o') ? 'active' : 'inactive'\\\"\\n      class=\\\"fa-icon-star\\\"\\n      [fixedWidth]=\\\"true\\\">\\n    </fa-icon>\\n    <!--<span>({{score.getScore()}})</span>-->\\n</span>\\n\"","module.exports = \":host #label {\\n  text-transform: capitalize; }\\n\\n:host #star-container {\\n  float: right;\\n  color: #d1d1d1 !important; }\\n\\n:host #star-container .active {\\n    color: #e8aa1b !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvbWFya2VyLWRpYWxvZy9yYXRpbmcvZWxlbWVudHMvY3VycmVudC1zY29yZS9jdXJyZW50LXNjb3JlLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFDO0VBR0csMEJBQTBCLEVBQUE7O0FBSDdCO0VBTUcsWUFBWTtFQUNaLHlCQUFvQyxFQUFBOztBQVB2QztJQVVLLHlCQUF5QixFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2RpYWxvZy9tYXJrZXItZGlhbG9nL3JhdGluZy9lbGVtZW50cy9jdXJyZW50LXNjb3JlL2N1cnJlbnQtc2NvcmUuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuXG4gICNsYWJlbCB7XG4gICAgdGV4dC10cmFuc2Zvcm06IGNhcGl0YWxpemU7IH1cblxuICAjc3Rhci1jb250YWluZXIge1xuICAgIGZsb2F0OiByaWdodDtcbiAgICBjb2xvcjogcmdiKDIwOSwgMjA5LCAyMDkpICFpbXBvcnRhbnQ7XG5cbiAgICAuYWN0aXZlIHtcbiAgICAgIGNvbG9yOiAjZThhYTFiICFpbXBvcnRhbnQ7IH0gfSB9XG4iXX0= */\"","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, Input, OnChanges, OnInit, SimpleChanges} from '@angular/core';\nimport {Score, TotalScore} from '../../../../../../type/rating';\n\n@Component({\n  selector: 'rating-current-score',\n  templateUrl: './current-score.component.html',\n  styleUrls: ['./current-score.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class CurrentScoreComponent implements OnInit, OnChanges {\n\n  @Input() label: string;\n  @Input() score: TotalScore;\n  @Input() update: number;\n\n  constructor(private _changeDetector: ChangeDetectorRef) {}\n\n  ngOnInit() {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.update) {\n      this._changeDetector.detectChanges();\n    }\n  }\n\n  // turns 3.7 into ['x', 'x', 'x', '/', 'o'], can round to the nearest number\n  public scoreArray(score: number, round: boolean): Array<string> {\n\n    const _scoreArray: Array<string> = [];\n\n    score = (round) ? Math.round(score) : score;\n\n    for (let i = 0; i < 5; i++) {\n\n      if (score > i) {\n        if (score - i >= 1) {\n          _scoreArray.push('x');\n        } else {\n          _scoreArray.push('/');\n        }\n      } else {\n        _scoreArray.push('o');\n      }\n    }\n\n    return _scoreArray;\n  }\n}\n","module.exports = \"<div id=\\\"rate-container\\\">\\n\\n  <div id=\\\"rate-toggle\\\">\\n    <h2 (click)=\\\"onToggleClick('current')\\\" [ngClass]=\\\"{'active': state === 'current'}\\\">Rating ({{totalRating}})</h2>\\n    <span id=\\\"divider\\\"> | </span>\\n    <h2 (click)=\\\"onToggleClick('add')\\\" [ngClass]=\\\"{'active': state === 'add'}\\\">Your Rating</h2>\\n  </div>\\n\\n  <div id=\\\"rating-panel\\\" *ngFor=\\\"let type of rateablePoiTypes\\\">\\n\\n    <h4 *ngIf=\\\"(rateablePoiTypes.length > 1)\\\">{{type.label}}</h4>\\n\\n    <!-- toggle between current / add (form)-->\\n\\n    <div id=\\\"rating\\\" *ngFor=\\\"let name of type.rateBy\\\" #ratingPanel>\\n\\n      <rating-current-score *ngIf=\\\"state === 'current'\\\" [label]=\\\"name\\\" [score]=\\\"getAspect(type.type, name)\\\" [update]=\\\"timestamp\\\"></rating-current-score>\\n      <rating-add-score *ngIf=\\\"state === 'add'\\\" [label]=\\\"name\\\" [type]=\\\"type.type\\\" [rating]=\\\"getRating(type.type)\\\"></rating-add-score>\\n    </div>\\n\\n  </div>\\n\\n</div>\\n\"","module.exports = \":host #rate-container {\\n  border-top: 1px solid #CCC;\\n  background-color: #EEE;\\n  padding: 12px; }\\n  :host #rate-container #rate-toggle {\\n    text-align: center;\\n    padding-bottom: 12px; }\\n  :host #rate-container #rate-toggle h2 {\\n      display: inline;\\n      font-size: 3.4vh;\\n      font-family: Roboto, \\\"Helvetica Neue\\\", sans-serif;\\n      font-weight: 500; }\\n  :host #rate-container #rate-toggle h2:not(.active) {\\n      color: grey; }\\n  :host #rate-container #rate-toggle #divider {\\n      color: #CCC; }\\n  :host #rate-container #rating-panel {\\n    position: relative; }\\n  :host #rate-container #rating-panel h4 {\\n      margin: 0 auto !important;\\n      font-size: 3vh; }\\n  :host #rate-container #rating-panel #rating {\\n      padding: 6px 0; }\\n  :host #rate-container #rating-panel > .warn::after {\\n    content: \\\"\\\";\\n    background-color: rgba(238, 238, 238, 0.9);\\n    font-size: 12px;\\n    position: absolute;\\n    text-align: center;\\n    top: 0;\\n    left: 0;\\n    width: 100%;\\n    height: 100%;\\n    box-sizing: border-box;\\n    padding: auto 25%;\\n    -webkit-backdrop-filter: blur(3px);\\n    backdrop-filter: blur(3px);\\n    vertical-align: -50%; }\\n  :host #rate-container #rating-panel > .warn-gps::after {\\n    content: \\\"Please enable GPS in order to rate this location.\\\"; }\\n  :host #rate-container #rating-panel > .warn-distance::after {\\n    content: \\\"You're currently > 4.5 miles from this location.\\\"; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvbWFya2VyLWRpYWxvZy9yYXRpbmcvcmF0aW5nLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFDO0VBR0csMEJBQTBCO0VBQzFCLHNCQUFzQjtFQUN0QixhQUFhLEVBQUE7RUFMaEI7SUFRSyxrQkFBa0I7SUFDbEIsb0JBQW9CLEVBQUE7RUFUekI7TUFZTyxlQUFlO01BQ2YsZ0JBQWdCO01BQ2hCLGlEQUFpRDtNQUNqRCxnQkFBZ0IsRUFBQTtFQWZ2QjtNQWtCTyxXQUFXLEVBQUE7RUFsQmxCO01BcUJPLFdBQVcsRUFBQTtFQXJCbEI7SUF5Qkssa0JBQWtCLEVBQUE7RUF6QnZCO01BNEJPLHlCQUF5QjtNQUN6QixjQUFjLEVBQUE7RUE3QnJCO01BZ0NPLGNBQWMsRUFBQTtFQWhDckI7SUFtQ0ssV0FBVztJQUNYLDBDQUEwQztJQUMxQyxlQUFlO0lBQ2Ysa0JBQWtCO0lBQ2xCLGtCQUFrQjtJQUNsQixNQUFNO0lBQ04sT0FBTztJQUNQLFdBQVc7SUFDWCxZQUFZO0lBQ1osc0JBQXNCO0lBQ3RCLGlCQUFpQjtJQUNqQixrQ0FBa0M7SUFDbEMsMEJBQTBCO0lBQzFCLG9CQUFvQixFQUFBO0VBaER6QjtJQW1ESyw0REFBNEQsRUFBQTtFQW5EakU7SUFzREssMkRBQTJELEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGlhbG9nL21hcmtlci1kaWFsb2cvcmF0aW5nL3JhdGluZy5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG5cbiAgI3JhdGUtY29udGFpbmVyIHtcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgI0NDQztcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRUVFO1xuICAgIHBhZGRpbmc6IDEycHg7XG5cbiAgICAjcmF0ZS10b2dnbGUge1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgcGFkZGluZy1ib3R0b206IDEycHg7XG5cbiAgICAgIGgyIHtcbiAgICAgICAgZGlzcGxheTogaW5saW5lO1xuICAgICAgICBmb250LXNpemU6IDMuNHZoO1xuICAgICAgICBmb250LWZhbWlseTogUm9ib3RvLCBcIkhlbHZldGljYSBOZXVlXCIsIHNhbnMtc2VyaWY7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7IH1cblxuICAgICAgaDI6bm90KC5hY3RpdmUpIHtcbiAgICAgICAgY29sb3I6IGdyZXk7IH1cblxuICAgICAgI2RpdmlkZXIge1xuICAgICAgICBjb2xvcjogI0NDQzsgfSB9XG5cbiAgICAjcmF0aW5nLXBhbmVsIHtcblxuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuXG4gICAgICBoNCB7XG4gICAgICAgIG1hcmdpbjogMCBhdXRvICFpbXBvcnRhbnQ7XG4gICAgICAgIGZvbnQtc2l6ZTogM3ZoOyB9XG5cbiAgICAgICNyYXRpbmcge1xuICAgICAgICBwYWRkaW5nOiA2cHggMDsgfSB9XG5cbiAgICAjcmF0aW5nLXBhbmVsPi53YXJuOjphZnRlciB7XG4gICAgICBjb250ZW50OiBcIlwiO1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzgsIDIzOCwgMjM4LCAwLjkpO1xuICAgICAgZm9udC1zaXplOiAxMnB4O1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgdG9wOiAwO1xuICAgICAgbGVmdDogMDtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICAgIHBhZGRpbmc6IGF1dG8gMjUlO1xuICAgICAgLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6IGJsdXIoM3B4KTtcbiAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigzcHgpO1xuICAgICAgdmVydGljYWwtYWxpZ246IC01MCU7IH1cblxuICAgICNyYXRpbmctcGFuZWw+Lndhcm4tZ3BzOjphZnRlciB7XG4gICAgICBjb250ZW50OiBcIlBsZWFzZSBlbmFibGUgR1BTIGluIG9yZGVyIHRvIHJhdGUgdGhpcyBsb2NhdGlvbi5cIjsgfVxuXG4gICAgI3JhdGluZy1wYW5lbD4ud2Fybi1kaXN0YW5jZTo6YWZ0ZXIge1xuICAgICAgY29udGVudDogXCJZb3UncmUgY3VycmVudGx5ID4gNC41IG1pbGVzIGZyb20gdGhpcyBsb2NhdGlvbi5cIjsgfSB9IH1cbiJdfQ== */\"","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Input, OnDestroy, OnInit, ViewChild} from '@angular/core';\nimport {PoiType} from '../../../../type/poi';\nimport {RateService} from '../../../../service/rate.service';\nimport {Waypoint} from '../../../../type/waypoint';\nimport {Rating, Score, TotalScore} from '../../../../type/rating';\nimport {Subscription} from 'rxjs';\nimport {LocationBasedComponent} from '../../../../base/location-based/location-based.component';\nimport {waypointToLatLng} from '../../../../_util/leaflet/converter';\nimport {environment} from '../../../../../environments/environment.prod';\n\n@Component({\n  selector: 'rating',\n  templateUrl: './rating.component.html',\n  styleUrls: ['./rating.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class RatingComponent extends LocationBasedComponent implements OnInit, OnDestroy {\n\n  @ViewChild('ratingPanel') ratingPanel: ElementRef;\n  @Input() poiTypes: Array<PoiType>;\n  @Input() waypoint: Waypoint;\n\n  public totalRating = 0;\n  public state: 'current' | 'add' = 'current';\n  public timestamp: number;\n  public rateablePoiTypes: Array<PoiType> = [];\n\n  private _ratings: object = {};\n  private _ratingSubscriptions: Array<Subscription> = [];\n\n  constructor(\n    private _rateService: RateService,\n    private _changeDetector: ChangeDetectorRef\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n\n    super.ngOnInit();\n\n    const _self = this;\n\n    this.poiTypes.forEach(function(type: PoiType) {\n\n      if (type.rateable) {\n\n        _self.rateablePoiTypes.push(type);\n\n        const _rating: Rating = _self._rateService.getRatingById(type.type, _self.waypoint);\n\n        _self._ratings[type.type] = _rating;\n        _self._ratingSubscriptions.push(_rating.ratingChangedObserver.subscribe(function(update: number){\n          if (update !== -1) {\n            _self.calculateTotalRating();\n          }\n        }));\n      }\n    });\n\n    this.calculateTotalRating();\n  }\n\n  ngOnDestroy(): void {\n\n    super.ngOnDestroy();\n\n    this._saveRating();\n\n    // clear subscriptions\n    this._ratingSubscriptions.forEach(function(subscription: Subscription) {\n      subscription.unsubscribe();\n      subscription = null;\n    });\n\n    this._ratingSubscriptions = null;\n\n    // destroy ratings (as everything is stored in Score\n    for (const key in this._ratings) {\n      this._ratings[key].destroy();\n    }\n\n    this._ratings = null;\n  }\n\n  public onToggleClick(state: 'current' | 'add'): void {\n\n    // you're only allowed to rate if you're nearby (4.5 miles)\n    // if (state === 'add') {\n    //   if (this.status !== 'tracking' && !this.user) {\n    //     this.ratingPanel.nativeElement.classList.add('warn');\n    //     this.ratingPanel.nativeElement.classList.add('warn-gps');\n    //   } else {\n    //     const _distance = geolib.getDistance(waypointToLatLng(this.waypoint), waypointToLatLng(this.user.waypoint));\n    //     if (_distance > (environment.MILE * 4.5)) {\n    //       this.ratingPanel.nativeElement.classList.add('warn');\n    //       this.ratingPanel.nativeElement.classList.add('warn-distance');\n    //     }\n    //   }\n    // } else {\n    //   this.ratingPanel.nativeElement.classList.remove('warn');\n    //   this.ratingPanel.nativeElement.classList.remove('warn-gps');\n    //   this.ratingPanel.nativeElement.classList.remove('warn-distance');\n    // }\n    this.state = state;\n  }\n\n  public calculateTotalRating(): void {\n\n    let _ratingCount: number = 0;\n    let _cummulativeScore: number = 0;\n\n    for (const key in this._ratings) {\n      _ratingCount ++;\n      const _rating: Rating = this._ratings[key];\n      _cummulativeScore += _rating.getRating();\n    }\n\n    this.totalRating = Number((_cummulativeScore / _ratingCount).toFixed(2));\n  }\n\n  public getAspect(type: string, aspect: string): TotalScore {\n    return this.getRating(type).getAspect(aspect);\n  }\n\n  public getRating(type: string): Rating {\n    return this._ratings[type];\n  }\n\n  // when a user switches from 'your rating' to 'ratings', save the users rating\n  private _saveRating(): void {\n\n    const _scoreArray: Array<Score> = [];\n\n    for (const key in this._ratings) {\n\n      const _rating: Rating = this._ratings[key];\n\n      const _aspects: Array<TotalScore> = _rating.getAspects();\n      for (let j = 0; j < _aspects.length; j++) {\n        const _totalScore: TotalScore = _aspects[j];\n        if (_totalScore.userScore && _totalScore.userScore.unsynced) {\n          _scoreArray.push(_totalScore.userScore);\n        }\n      }\n    }\n\n    this._rateService.saveRatings(_scoreArray);\n  }\n}\n","module.exports = \"<mat-card-content>\\n\\n  <h2>Add location</h2>\\n\\n  <form #noteForm=\\\"ngForm\\\" class=\\\"example-form\\\" (ngSubmit)=\\\"submitNote(noteForm.value)\\\">\\n\\n    <mat-form-field class=\\\"example-full-width\\\">\\n      <input matInput placeholder=\\\"title\\\" name=\\\"title\\\" id=\\\"title\\\" ngModel #titleField>\\n    </mat-form-field>\\n\\n    <mat-form-field class=\\\"example-full-width\\\">\\n      <textarea matInput placeholder=\\\"note\\\" name=\\\"note\\\" id=\\\"note\\\" rows=\\\"5\\\" ngModel maxlength=\\\"140\\\"></textarea>\\n    </mat-form-field>\\n\\n    <mat-form-field class=\\\"select-form-field\\\">\\n      <mat-select placeholder=\\\"type\\\" [(ngModel)]=\\\"defaultType\\\" name=\\\"type\\\" ngModel>\\n        <mat-option *ngFor=\\\"let poiType of getTypes()\\\" [value]=\\\"poiType.type\\\">\\n          {{poiType.label}}\\n        </mat-option>\\n      </mat-select>\\n    </mat-form-field>\\n\\n    <mat-checkbox name=\\\"share\\\" [ngModel]=\\\"true\\\">Share (with developer!)</mat-checkbox>\\n\\n    <div class=\\\"btn-group\\\">\\n      <button mat-stroked-button (click)=\\\"onButtonClick('cancel')\\\" type=\\\"button\\\">Cancel</button>\\n      <button mat-stroked-button color=\\\"primary\\\" type=\\\"submit\\\">Save</button>\\n    </div>\\n  </form>\\n\\n</mat-card-content>\\n\"","module.exports = \":host ::ng-deep mat-card-content {\\n  display: block;\\n  padding: 0 12px; }\\n  :host ::ng-deep mat-card-content h2 {\\n    text-align: center;\\n    margin-bottom: 0 !important; }\\n  :host ::ng-deep mat-card-content mat-form-field {\\n    width: 100% !important; }\\n  :host ::ng-deep mat-card-content mat-form-field .mat-form-field-infix {\\n      border-top: 0 !important; }\\n  :host ::ng-deep mat-card-content mat-form-field .mat-select, :host ::ng-deep mat-card-content mat-form-field input, :host ::ng-deep mat-card-content mat-form-field textarea {\\n      box-sizing: border-box !important;\\n      padding: 0 12px !important;\\n      background-color: #EEE !important;\\n      border-radius: 6px !important;\\n      border: none !important; }\\n  :host ::ng-deep mat-card-content mat-form-field textarea {\\n      padding: 12px !important; }\\n  :host ::ng-deep mat-card-content mat-form-field .mat-select, :host ::ng-deep mat-card-content mat-form-field input {\\n      height: 48px !important; }\\n  :host ::ng-deep mat-card-content mat-form-field .mat-select .mat-select-trigger, :host ::ng-deep mat-card-content mat-form-field input .mat-select-trigger {\\n        height: 48px; }\\n  :host ::ng-deep mat-card-content .btn-group {\\n    text-align: center;\\n    margin-bottom: 12px; }\\n  :host ::ng-deep mat-card-content .btn-group button {\\n      margin: 0 6px; }\\n  :host ::ng-deep mat-card-content .mat-form-field-underline {\\n    display: none; }\\n  :host ::ng-deep mat-card-content .mat-form-field-underline .mat-list-item-content {\\n      padding: 0 12px !important;\\n      margin: 0 !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvbm90ZS1kaWFsb2cvbm90ZS1kaWFsb2cuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUM7RUFHRyxjQUFjO0VBQ2QsZUFBZSxFQUFBO0VBSmxCO0lBT0ssa0JBQWtCO0lBQ2xCLDJCQUEyQixFQUFBO0VBUmhDO0lBV0ssc0JBQXNCLEVBQUE7RUFYM0I7TUFjTyx3QkFBd0IsRUFBQTtFQWQvQjtNQWlCTyxpQ0FBaUM7TUFDakMsMEJBQTBCO01BQzFCLGlDQUFpQztNQUNqQyw2QkFBNkI7TUFDN0IsdUJBQXVCLEVBQUE7RUFyQjlCO01Bd0JPLHdCQUF3QixFQUFBO0VBeEIvQjtNQTJCTyx1QkFBdUIsRUFBQTtFQTNCOUI7UUE4QlMsWUFBWSxFQUFBO0VBOUJyQjtJQWlDSyxrQkFBa0I7SUFDbEIsbUJBQW1CLEVBQUE7RUFsQ3hCO01BcUNPLGFBQWEsRUFBQTtFQXJDcEI7SUF3Q0ssYUFBYSxFQUFBO0VBeENsQjtNQTJDTywwQkFBMEI7TUFDMUIsb0JBQW9CLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGlhbG9nL25vdGUtZGlhbG9nL25vdGUtZGlhbG9nLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IDo6bmctZGVlcCB7XG5cbiAgbWF0LWNhcmQtY29udGVudCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgcGFkZGluZzogMCAxMnB4O1xuXG4gICAgaDIge1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgbWFyZ2luLWJvdHRvbTogMCAhaW1wb3J0YW50OyB9XG5cbiAgICBtYXQtZm9ybS1maWVsZCB7XG4gICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50O1xuXG4gICAgICAubWF0LWZvcm0tZmllbGQtaW5maXgge1xuICAgICAgICBib3JkZXItdG9wOiAwICFpbXBvcnRhbnQ7IH1cblxuICAgICAgLm1hdC1zZWxlY3QsIGlucHV0LCB0ZXh0YXJlYSB7XG4gICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3ggIWltcG9ydGFudDtcbiAgICAgICAgcGFkZGluZzogMCAxMnB4ICFpbXBvcnRhbnQ7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNFRUUgIWltcG9ydGFudDtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4ICFpbXBvcnRhbnQ7XG4gICAgICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50OyB9XG5cbiAgICAgIHRleHRhcmVhIHtcbiAgICAgICAgcGFkZGluZzogMTJweCAhaW1wb3J0YW50OyB9XG5cbiAgICAgIC5tYXQtc2VsZWN0LCBpbnB1dCB7XG4gICAgICAgIGhlaWdodDogNDhweCAhaW1wb3J0YW50O1xuXG4gICAgICAgIC5tYXQtc2VsZWN0LXRyaWdnZXIge1xuICAgICAgICAgIGhlaWdodDogNDhweDsgfSB9IH1cblxuICAgIC5idG4tZ3JvdXAge1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgbWFyZ2luLWJvdHRvbTogMTJweDtcblxuICAgICAgYnV0dG9uIHtcbiAgICAgICAgbWFyZ2luOiAwIDZweDsgfSB9XG5cbiAgICAubWF0LWZvcm0tZmllbGQtdW5kZXJsaW5lIHtcbiAgICAgIGRpc3BsYXk6IG5vbmU7XG5cbiAgICAgIC5tYXQtbGlzdC1pdGVtLWNvbnRlbnQge1xuICAgICAgICBwYWRkaW5nOiAwIDEycHggIWltcG9ydGFudDtcbiAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7IH0gfSB9IH1cblxuIl19 */\"","import {Component, ElementRef, Inject, OnInit, ViewChild} from '@angular/core';\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material';\nimport {Waypoint} from '../../../type/waypoint';\nimport {PoiType} from '../../../type/poi';\nimport {NoteService} from '../../../service/note.service';\nimport {Settings} from '../../../settings';\nimport {Note} from '../../../type/note';\n\nexport class NoteProperties {\n  type: string;\n  label: string;\n  anchorPoint: Waypoint;\n  belongsTo: number;\n  belongsToType: string;\n  waypoint?: Waypoint;\n}\n\n@Component({\n  selector: 'app-note-dialog',\n  templateUrl: './note-dialog.component.html',\n  styleUrls: ['./note-dialog.component.sass']\n})\nexport class NoteDialogComponent implements OnInit {\n\n  @ViewChild('titleField') titleField: ElementRef;\n\n  public defaultType: string;\n  private _notes: Array<Note>;\n\n  constructor(\n    private _dialogRef: MatDialogRef<NoteDialogComponent>,\n    private _noteService: NoteService,\n    @Inject(MAT_DIALOG_DATA)\n    public data: NoteProperties\n  ) {}\n\n  ngOnInit() {\n\n    this.defaultType = this.data.type;\n    this.titleField.nativeElement.focus();\n  }\n\n  public submitNote(formData: object): void {\n\n    // add missing properties to data object so we can convert it to a Note\n    this.data['id'] = new Date().getTime();\n\n    // only add to type if it differs\n    if (formData['type'] !== this.data['type']) {\n      this.data['type'] += ', ' + formData['type'];\n    }\n\n    this.data['label'] = formData['title'];\n    this.data['description'] = formData['note'];\n    this.data['share'] = formData['share'];\n\n    const _noteObj: Note = this.data as Note;\n\n    this._noteService.saveNote(_noteObj);\n    this._dialogRef.close('success');\n  }\n\n  public onButtonClick(action: string): void {\n    this['_' + action]();\n  }\n\n  private _cancel(): void {\n    this._dialogRef.close('cancel');\n  }\n\n  public getTypes(): Array<PoiType> {\n\n    const _types = [];\n    Settings.POITYPES.forEach(function(type) {\n      if (type.userEnabled) {\n        _types.push(type);\n      }\n    });\n\n    return _types;\n  }\n\n}\n","module.exports = \"<div id=\\\"center-icon\\\" >\\n</div>\\n\\n<div id=\\\"panel\\\">\\n  <div id=\\\"top\\\">\\n    <display-button class=\\\"button\\\" label=\\\"\\\" icon=\\\"map-marked-alt\\\" routerLink=\\\"\\\"></display-button>\\n    <div id=\\\"meta\\\">\\n      <h2>You are currently</h2>\\n      <h3>{{ data['distance'] | distance:'meters':'miles':true}}.</h3>\\n    </div>\\n  </div>\\n  <div id=\\\"bottom\\\">\\n    <mat-card-content class=\\\"form-container\\\">\\n      <mat-form-field>\\n        <input matInput placeholder=\\\"simulate mile\\\" value=\\\"{{simulatedMile || 0}}\\\" type=\\\"tel\\\" min=0 max={{trailLength}} (keyup)=\\\"onKey($event)\\\" #simulate>\\n      </mat-form-field>\\n      <div id=\\\"button-group\\\">\\n        <span>\\n          <button mat-stroked-button (click)=\\\"onCancel()\\\">Cancel</button>\\n          <button mat-stroked-button color=\\\"primary\\\" (click)=\\\"onOk()\\\">OK</button>\\n        </span>\\n      </div>\\n    </mat-card-content>\\n  </div>\\n</div>\\n\"","module.exports = \":host #panel {\\n  background: url('overlay.png') repeat-x; }\\n\\n:host #top {\\n  display: grid;\\n  height: 50%;\\n  padding: 5vh;\\n  grid-template-columns: 20% auto;\\n  grid-template-areas: 'button meta'; }\\n\\n:host #top .button {\\n    user-focus: none;\\n    grid-area: button; }\\n\\n:host #top #meta {\\n    grid-area: meta;\\n    padding-top: 1.5vh; }\\n\\n:host #top #meta h2, :host #top #meta h3 {\\n      vertical-align: center;\\n      -webkit-margin-before: 0 !important;\\n              margin-block-start: 0 !important;\\n      -webkit-margin-after: 0 !important;\\n              margin-block-end: 0 !important;\\n      margin: 0; }\\n\\n:host #top #meta h2 {\\n      font-size: 4vw; }\\n\\n:host #top #meta h3 {\\n      font-size: 2vw; }\\n\\n:host #bottom {\\n  display: block;\\n  height: 50%;\\n  padding: 12px 48px !important;\\n  vert-align: bottom;\\n  bottom: 0; }\\n\\n:host #bottom .form-container {\\n    display: flex;\\n    flex-direction: column; }\\n\\n:host #bottom .form-container > * {\\n    width: 100%; }\\n\\n:host #button-group {\\n  width: 100%;\\n  text-align: center; }\\n\\n:host #button-group span button {\\n    margin: 0 6px; }\\n\\n:host /deep/ .mat-form-field-infix .mat-input-element {\\n  background: rgba(255, 255, 255, 0.5);\\n  padding: 12px 0;\\n  border: 2px solid white;\\n  border-radius: 12px;\\n  text-align: center;\\n  font-size: 4.5vw;\\n  color: #555; }\\n\\n:host /deep/ .mat-form-field-infix .mat-input-element::-moz-selection {\\n  background: #88b2c7; }\\n\\n:host /deep/ .mat-form-field-infix .mat-input-element::selection {\\n  background: #88b2c7; }\\n\\n:host /deep/ .mat-form-field-underline {\\n  display: none;\\n  visibility: hidden; }\\n\\n:host /deep/ .mat-form-field-label {\\n  text-align: center; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvb2ZmdHJhaWwtZGlhbG9nL29mZnRyYWlsLWRpYWxvZy5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLHVDQUFpRSxFQUFBOztBQUhwRTtFQU9HLGFBQWE7RUFDYixXQUFXO0VBQ1gsWUFBWTtFQUVaLCtCQUErQjtFQUMvQixrQ0FBa0MsRUFBQTs7QUFackM7SUFpQkssZ0JBQWdCO0lBQ2hCLGlCQUFpQixFQUFBOztBQWxCdEI7SUFzQkssZUFBZTtJQUNmLGtCQUFrQixFQUFBOztBQXZCdkI7TUE0Qk8sc0JBQXNCO01BQ3RCLG1DQUFnQztjQUFoQyxnQ0FBZ0M7TUFDaEMsa0NBQThCO2NBQTlCLDhCQUE4QjtNQUM5QixTQUFTLEVBQUE7O0FBL0JoQjtNQWtDTyxjQUFjLEVBQUE7O0FBbENyQjtNQW9DTyxjQUFjLEVBQUE7O0FBcENyQjtFQXVDRyxjQUFjO0VBQ2QsV0FBVztFQUNYLDZCQUE2QjtFQUM3QixrQkFBa0I7RUFDbEIsU0FBUyxFQUFBOztBQTNDWjtJQThDSyxhQUFhO0lBQ2Isc0JBQXNCLEVBQUE7O0FBL0MzQjtJQWtESyxXQUFXLEVBQUE7O0FBbERoQjtFQXFERyxXQUFXO0VBQ1gsa0JBQWtCLEVBQUE7O0FBdERyQjtJQTBETyxhQUFhLEVBQUE7O0FBSXBCO0VBS0ssb0NBQWlDO0VBQ2pDLGVBQWU7RUFDZix1QkFBdUI7RUFDdkIsbUJBQW1CO0VBQ25CLGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsV0FBVyxFQUFBOztBQVhoQjtFQWNLLG1CQUFtQixFQUFBOztBQWR4QjtFQWNLLG1CQUFtQixFQUFBOztBQWR4QjtFQWlCRyxhQUFhO0VBQ2Isa0JBQWtCLEVBQUE7O0FBbEJyQjtFQXFCRyxrQkFBa0IsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvb2ZmdHJhaWwtZGlhbG9nL29mZnRyYWlsLWRpYWxvZy5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG5cbiAgI3BhbmVsIHtcbiAgICBiYWNrZ3JvdW5kOiB1cmwoJy4uLy4uLy4uLy4uL2Fzc2V0cy9pbWFnZXMvb3ZlcmxheS5wbmcnKSByZXBlYXQteDsgfVxuXG4gICN0b3Age1xuXG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBoZWlnaHQ6IDUwJTtcbiAgICBwYWRkaW5nOiA1dmg7XG5cbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDIwJSBhdXRvO1xuICAgIGdyaWQtdGVtcGxhdGUtYXJlYXM6ICdidXR0b24gbWV0YSc7XG5cbiAgICAvL3BhZGRpbmc6IDQ4cHggMjAlIDAgMjAlICFpbXBvcnRhbnRcblxuICAgIC5idXR0b24ge1xuICAgICAgdXNlci1mb2N1czogbm9uZTtcbiAgICAgIGdyaWQtYXJlYTogYnV0dG9uOyB9XG5cbiAgICAjbWV0YSB7XG5cbiAgICAgIGdyaWQtYXJlYTogbWV0YTtcbiAgICAgIHBhZGRpbmctdG9wOiAxLjV2aDtcblxuICAgICAgaDIsIGgzIHtcbiAgICAgICAgZ3JpZC1jb2x1bW46IHt9XG4gICAgICAgIC8vdGV4dC1hbGlnbjogY2VudGVyXG4gICAgICAgIHZlcnRpY2FsLWFsaWduOiBjZW50ZXI7XG4gICAgICAgIG1hcmdpbi1ibG9jay1zdGFydDogMCAhaW1wb3J0YW50O1xuICAgICAgICBtYXJnaW4tYmxvY2stZW5kOiAwICFpbXBvcnRhbnQ7XG4gICAgICAgIG1hcmdpbjogMDsgfVxuXG4gICAgICBoMiB7XG4gICAgICAgIGZvbnQtc2l6ZTogNHZ3OyB9XG4gICAgICBoMyB7XG4gICAgICAgIGZvbnQtc2l6ZTogMnZ3OyB9IH0gfVxuXG4gICNib3R0b20ge1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGhlaWdodDogNTAlO1xuICAgIHBhZGRpbmc6IDEycHggNDhweCAhaW1wb3J0YW50O1xuICAgIHZlcnQtYWxpZ246IGJvdHRvbTtcbiAgICBib3R0b206IDA7XG5cbiAgICAuZm9ybS1jb250YWluZXIge1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IH1cblxuICAgIC5mb3JtLWNvbnRhaW5lciA+ICoge1xuICAgICAgd2lkdGg6IDEwMCU7IH0gfVxuXG4gICNidXR0b24tZ3JvdXAge1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcblxuICAgIHNwYW4ge1xuICAgICAgYnV0dG9uIHtcbiAgICAgICAgbWFyZ2luOiAwIDZweDtcbiAgICAgICAgLy9wYWRkaW5nOiA0cHggMTJweFxuIH0gfSB9IH0gICAgICAgIC8vZm9udC1zaXplOiAydndcblxuIDpob3N0IC9kZWVwLyB7XG5cbiAgLm1hdC1mb3JtLWZpZWxkLWluZml4IHtcblxuICAgIC5tYXQtaW5wdXQtZWxlbWVudCB7XG4gICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwyNTUsMjU1LDAuNSk7XG4gICAgICBwYWRkaW5nOiAxMnB4IDA7XG4gICAgICBib3JkZXI6IDJweCBzb2xpZCB3aGl0ZTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7XG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICBmb250LXNpemU6IDQuNXZ3O1xuICAgICAgY29sb3I6ICM1NTU7IH1cblxuICAgIC5tYXQtaW5wdXQtZWxlbWVudDo6c2VsZWN0aW9uIHtcbiAgICAgIGJhY2tncm91bmQ6ICM4OGIyYzc7IH0gfVxuXG4gIC5tYXQtZm9ybS1maWVsZC11bmRlcmxpbmUge1xuICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgdmlzaWJpbGl0eTogaGlkZGVuOyB9XG5cbiAgLm1hdC1mb3JtLWZpZWxkLWxhYmVsIHtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7IH0gfVxuIl19 */\"","import { Component, Inject, OnInit, ViewChild } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material';\nimport { LocalStorageService } from 'ngx-webstorage';\n\n@Component({\n  selector: 'offtrail-dialog',\n  templateUrl: './offtrail-dialog.component.html',\n  styleUrls: ['./offtrail-dialog.component.sass']\n})\nexport class OfftrailDialogComponent implements OnInit {\n\n  @ViewChild('simulate') simulateInput;\n\n  public simulatedMile: number;\n  public trailLength: number;\n\n  constructor(\n    private _dialogRef: MatDialogRef<OfftrailDialogComponent>,\n    private _localStorage: LocalStorageService,\n    @Inject(MAT_DIALOG_DATA)\n    public data: object\n  ) {}\n\n  ngOnInit(): void {\n    this.simulatedMile = Math.floor(Number(this.data['anchorPointDistance']));\n    this.trailLength = this.data['trailLength'];\n  }\n\n  public onOk(): void {\n    // const _value: number = (Math.floor(Number(this.simulateInput.nativeElement.value)) > this.trailLength) ? this.trailLength : Math.floor(Number(this.simulateInput.nativeElement.value));\n\n    let _value: number = this.simulateInput.nativeElement.value.replace(',', '.');      // in case of comma\n    _value = (Number(_value) < this.trailLength) ? Number(_value) : this.trailLength - 1;\n\n    const _self = this;\n    setTimeout(function() {\n      _self._dialogRef.close({simulatedMile: _value});\n    }, 100);\n  }\n\n  public onKey(event): void {\n\n    // if enter pressed\n    if (event.key === 'Enter') {\n      this.onOk();\n    }\n  }\n\n  public onCancel(): void {\n    this._dialogRef.close();\n  }\n}\n","module.exports = \"<mat-card>\\n  <mat-card-header>\\n    <mat-card-title>About</mat-card-title>\\n  </mat-card-header>\\n\\n  <mat-card-content>\\n    <p>This app was developed by Frank Douwes, after successfully finishing the triple crown in 2019.</p>\\n    <p>While hiking I valued a good elevation profile over maps, this app is an attempt to give future hikers exactly that.</p>\\n  </mat-card-content>\\n\\n  <!--<mat-card-header>-->\\n    <!--<mat-card-title>Report Bug / Contact</mat-card-title>-->\\n  <!--</mat-card-header>-->\\n\\n  <!--<mat-card-content>-->\\n    <!--<p>Found something that needs fixing, or just have a suggestion for improvements? feel free to contact me using the form below:</p>-->\\n  <!--</mat-card-content>-->\\n\\n  <!--<mat-card-content class=\\\"form-container\\\">-->\\n    <!--<mat-form-field>-->\\n      <!--<input matInput placeholder=\\\"Name\\\" type=\\\"text\\\" required>-->\\n    <!--</mat-form-field>-->\\n\\n    <!--<mat-form-field>-->\\n      <!--<mat-select placeholder=\\\"Type\\\" required>-->\\n        <!--<mat-option value=\\\"bug\\\">Bug Report</mat-option>-->\\n        <!--<mat-option value=\\\"message\\\">Message</mat-option>-->\\n      <!--</mat-select>-->\\n    <!--</mat-form-field>-->\\n\\n    <!--<mat-form-field>-->\\n      <!--<textarea matInput placeholder=\\\"Message\\\" rows=\\\"5\\\" required></textarea>-->\\n    <!--</mat-form-field>-->\\n    <!--<button>Send</button>-->\\n  <!--</mat-card-content>-->\\n\\n  <!--<br/><br/>-->\\n\\n  <mat-card-header>\\n    <mat-card-title>Sources</mat-card-title>\\n  </mat-card-header>\\n\\n  <mat-card-content>\\n    <ul>\\n      <li>Halfmile's PCT maps - <a href=\\\"https://www.pctmap.net\\\">pctmap.net</a></li>\\n      <!--<li>Jonathan Ley's CDT maps - <a href=\\\"http://phlumf.com\\\">phlumf.com</a></li>-->\\n      <!--<li>AT? - <a href=\\\"\\\">AT</a></li>-->\\n      <li>National Park typeface - <a href=\\\"http://nationalparktypeface.com\\\">nationalparktypeface.com</a></li>\\n    </ul>\\n  </mat-card-content>\\n\\n  <button mat-raised-button (click)=\\\"toggleAdmin()\\\" color=\\\"warn\\\">💀 IDDQD 💀</button>\\n\\n</mat-card>\\n\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy9hYm91dC9hYm91dC5jb21wb25lbnQuc2FzcyJ9 */\"","import { Component, OnInit } from '@angular/core';\nimport {LocalStorageService} from 'ngx-webstorage';\n\n@Component({\n  selector: 'about',\n  templateUrl: './about.component.html',\n  styleUrls: ['./about.component.sass']\n})\nexport class AboutComponent implements OnInit {\n\n  constructor(\n    private _localStorage: LocalStorageService\n  ) { }\n\n  ngOnInit() {\n  }\n\n  public toggleAdmin(): void {\n    const _isAdmin = this._localStorage.retrieve('isAdmin');\n    if (!_isAdmin) {\n      this._localStorage.store('isAdmin', true);\n      alert('God mode enabled!');\n    } else {\n      this._localStorage.clear('isAdmin');\n      alert('Just a regular mortal.');\n    }\n  }\n\n}\n","module.exports = \"<mat-card #panel>\\n\\n  <h2>Settings</h2>\\n\\n  <mat-card-content>\\n\\n    <h3>Display Mode</h3>\\n\\n    <section>\\n      <mat-radio-group [(ngModel)]=\\\"screenMode\\\">\\n        <mat-radio-button *ngFor=\\\"let mode of screenModes\\\" [value]=\\\"mode.value\\\" (click)=\\\"onRadioClick(mode.value)\\\">\\n          {{mode.label}}\\n        </mat-radio-button>\\n      </mat-radio-group>\\n\\n      <br/>\\n    </section>\\n\\n    <h3>Elements</h3>\\n\\n    <mat-checkbox name=\\\"showSnow\\\" [(ngModel)]=\\\"showSnow\\\" (change)=\\\"onCheckboxChange($event)\\\">show snowpack</mat-checkbox>\\n\\n    <section>\\n\\n      <!--<mat-form-field>-->\\n        <!--<input type=\\\"number\\\" value=\\\"250\\\" input=\\\"\\\" placeholder=\\\"Poi offtrail distance (ft.)\\\">-->\\n      <!--</mat-form-field>-->\\n\\n      <!--<mat-form-field>-->\\n        <!--<input type=\\\"number\\\" value=\\\"250\\\" input=\\\"\\\" placeholder=\\\"User offtrail distance (ft.)\\\">-->\\n      <!--</mat-form-field>-->\\n\\n      <!--<hr/>-->\\n\\n      <!--<mat-form-field>-->\\n        <!--<input type=\\\"number\\\" value=\\\"1000\\\" input=\\\"\\\" placeholder=\\\"Poi render radius (ft.)\\\">-->\\n      <!--</mat-form-field>-->\\n    </section>\\n\\n    <h3>Elevation Profile</h3>\\n\\n    <section>\\n      <div *ngFor=\\\"let poiType of majorPoiTypes\\\">\\n        <mat-checkbox [name]=\\\"createCamelCaseName(poiType, 'show')\\\" [(ngModel)]=\\\"this[createCamelCaseName(poiType, 'show')]\\\" (change)=\\\"onCheckboxChange($event)\\\">Show {{poiType}}</mat-checkbox>\\n      </div>\\n      <hr/>\\n      <mat-checkbox name=\\\"showMiniMap\\\" [(ngModel)]=\\\"showMiniMap\\\" (change)=\\\"onCheckboxChange($event)\\\">Show mini-map</mat-checkbox>\\n      <mat-checkbox name=\\\"parallaxEnabled\\\" [(ngModel)]=\\\"parallaxEnabled\\\" (change)=\\\"onCheckboxChange($event)\\\">Enable parallax</mat-checkbox>\\n    </section>\\n\\n    <h3>Scroll Map</h3>\\n\\n    <section>\\n      <mat-checkbox name=\\\"animateMap\\\" [(ngModel)]=\\\"animateMap\\\" (change)=\\\"onCheckboxChange($event)\\\">Animate Map (buggy)</mat-checkbox>\\n      <mat-checkbox name=\\\"showMileGrid\\\" [(ngModel)]=\\\"showMileGrid\\\" (change)=\\\"onCheckboxChange($event)\\\">Show Mile Grid (buggy)</mat-checkbox>\\n      <mat-checkbox name=\\\"detectRetina\\\" [(ngModel)]=\\\"detectRetina\\\" (change)=\\\"onCheckboxChange($event)\\\">Use Retina Tiles (battery intensive)</mat-checkbox>\\n    </section>\\n\\n  </mat-card-content>\\n</mat-card>\\n\"","module.exports = \"mat-radio-button {\\n  display: block; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy9nZW5lcmFsLXNldHRpbmdzL2dlbmVyYWwtc2V0dGluZ3MuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFjLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGlhbG9nL3NldHRpbmdzLWRpYWxvZy9wYW5lbHMvZ2VuZXJhbC1zZXR0aW5ncy9nZW5lcmFsLXNldHRpbmdzLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsibWF0LXJhZGlvLWJ1dHRvbiB7XG4gIGRpc3BsYXk6IGJsb2NrOyB9XG5cbiJdfQ== */\"","import {Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {SettingsPanelComponent} from '../../../../../base/settings-panel/settings-panel.component';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {MatCheckboxChange, MatSelectChange} from '@angular/material';\nimport {VersionResolverService} from '../../../../../service/version-resolver.service';\nimport {getMajorPoiTypes} from '../../../../../_util/poi';\n\n@Component({\n  selector: 'general-settings',\n  templateUrl: './general-settings.component.html',\n  styleUrls: ['./general-settings.component.sass']\n})\nexport class GeneralSettingsComponent extends SettingsPanelComponent implements OnInit {\n\n  @ViewChild('panel') panel: ElementRef;\n\n  public showSnow: boolean;\n  public parallaxEnabled: boolean;\n  public highContrast: boolean;\n  public showMiniMap: boolean;\n  public detectRetina: boolean;\n  public majorPoiTypes: Array<string>;\n  public showMileGrid: boolean;\n  public animateMap: boolean;\n  public screenModes: Array<any> = [\n    {value: 'default', label: 'Default'},\n    {value: 'highContrast', label: 'High Contrast'},\n    {value: 'nightHike', label: 'Night Hiking'}\n  ];\n  public screenMode;\n\n  constructor(\n    private _localStorage: LocalStorageService,\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n\n    const _self = this;\n\n    this.showSnow = this._localStorage.retrieve('showSnow');\n    this.parallaxEnabled = this._localStorage.retrieve('parallaxEnabled');\n    this.screenMode = this._localStorage.retrieve('screenMode');\n    this.showMiniMap = this._localStorage.retrieve('showMiniMap');\n    this.showMileGrid = this._localStorage.retrieve('showMileGrid');\n    this.animateMap = this._localStorage.retrieve('animateMap');\n    this.detectRetina = this._localStorage.retrieve('detectRetina');\n\n    // dynamic poi type properties\n    this.majorPoiTypes = getMajorPoiTypes();\n\n    this.majorPoiTypes.forEach(function(name) {\n      const _camelName = _self.createCamelCaseName(name, 'show');\n      _self[_camelName] = _self._localStorage.retrieve(_camelName);\n    });\n  }\n\n  // EVENTS\n\n  // checkboxes are named after their data property\n  public onCheckboxChange(event: MatCheckboxChange): void {\n    this._localStorage.store(event.source.name, event.checked);\n  }\n\n  public onRadioClick(radioValue): void {\n    this._localStorage.store('screenMode', radioValue);\n  }\n\n  public createCamelCaseName(name: string, prepend?: string, append?: string): string {\n\n    prepend = (prepend) ? prepend : '';\n    append = (append) ? prepend : '';\n\n    return prepend + name.charAt(0).toUpperCase() + name.slice(1) + append;\n  };\n\n}\n","module.exports = \"<!--<mat-tab label=\\\"•\\\"> on/offline indicator </mat-tab>-->\\n<!--<mat-tab label=\\\"•\\\"> icons </mat-tab>-->\\n<!--<mat-tab label=\\\"•\\\"> syncing/updating </mat-tab>-->\\n\\n<mat-carousel>\\n  <mat-carousel-slide\\n    #matCarouselSlide\\n    *ngFor=\\\"let slide of slides; let i = index\\\"\\n    [image]=\\\"slide.image\\\"\\n    maxWidth=\\\"auto\\\"\\n    loop=\\\"true\\\"\\n    slides=\\\"3\\\"\\n    hideIndicators=false\\n    color=\\\"unset\\\"\\n  ></mat-carousel-slide>\\n</mat-carousel>\\n\"","module.exports = \"::ng-deep .carousel, ::ng-deep .carousel-list {\\n  display: block;\\n  height: 100% !important; }\\n\\n::ng-deep .carousel-slide {\\n  background-size: contain !important;\\n  height: 100% !important;\\n  padding-bottom: 0 !important; }\\n\\n::ng-deep .carousel-slide-overlay {\\n  background-color: unset !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy9pbnN0cnVjdGlvbnMvaW5zdHJ1Y3Rpb25zLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBR0ksY0FBYztFQUNkLHVCQUF1QixFQUFBOztBQUozQjtFQU9JLG1DQUFtQztFQUNuQyx1QkFBdUI7RUFDdkIsNEJBQTRCLEVBQUE7O0FBVGhDO0VBYUksa0NBQWtDLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZGlhbG9nL3NldHRpbmdzLWRpYWxvZy9wYW5lbHMvaW5zdHJ1Y3Rpb25zL2luc3RydWN0aW9ucy5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIjo6bmctZGVlcCB7XG5cbiAgLmNhcm91c2VsLCAuY2Fyb3VzZWwtbGlzdCB7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7IH1cblxuICAuY2Fyb3VzZWwtc2xpZGUge1xuICAgIGJhY2tncm91bmQtc2l6ZTogY29udGFpbiAhaW1wb3J0YW50O1xuICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50O1xuICAgIHBhZGRpbmctYm90dG9tOiAwICFpbXBvcnRhbnQ7IH1cblxuICAuY2Fyb3VzZWwtc2xpZGUtb3ZlcmxheSB7XG5cbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB1bnNldCAhaW1wb3J0YW50OyB9IH1cbiJdfQ== */\"","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'instructions',\n  templateUrl: './instructions.component.html',\n  styleUrls: ['./instructions.component.sass']\n})\nexport class InstructionsComponent implements OnInit {\n\n  public slides = [\n    {image: 'assets/images/slides/instructions-1.jpg'},\n    {image: 'assets/images/slides/instructions-2.jpg'},\n    {image: 'assets/images/slides/instructions-3.jpg'}\n  ]\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","module.exports = \"<mat-card id=\\\"purchase-trails\\\">\\n\\n  <!--<h2>Purchase Trail Data</h2>-->\\n\\n  <mat-card-content>\\n    <section class=\\\"purchase\\\">\\n      <div *ngFor=\\\"let trail of availableTrailList\\\" class=\\\"purchase-container sign-{{trail.abbr}}\\\" >\\n        <div class=\\\"sign\\\">\\n          <img class=\\\"cap\\\" src=\\\"../assets/images/sign-post/post-cap.png\\\"/>\\n          <div class=\\\"post\\\">\\n            <button mat-raised-button\\n                    [value]=\\\"trail.id\\\"\\n                    (click)=\\\"onTrailPurchased(trail.id)\\\"\\n                    [disabled]=\\\"!trail.availableForPurchase\\\">\\n              <img class=\\\"marker\\\" src=\\\"../assets/images/logos/{{trail.abbr}}.png\\\" width=\\\"48\\\" height=\\\"48\\\"/>\\n              <!--<div class=\\\"unavailable\\\" *ngIf=\\\"!trail.availableForPurchase\\\">Unavailable</div>-->\\n              <!--<div class=\\\"free\\\" *ngIf=\\\"trail.isFree\\\">Free</div>-->\\n              <p>{{trail.name}}\\n                <!--<small>({{trail.length}} mi.)</small>-->\\n              </p>\\n              <div>•</div>\\n            </button>\\n          </div>\\n        </div>\\n      </div>\\n    </section>\\n  </mat-card-content>\\n</mat-card>\\n\"","module.exports = \"@charset \\\"UTF-8\\\";\\n:host {\\n  display: block;\\n  width: 100%;\\n  min-height: 100%;\\n  height: auto;\\n  padding-bottom: 12px; }\\n:host #purchase-trails {\\n    background: unset;\\n    border: unset;\\n    box-shadow: unset;\\n    padding-bottom: 0;\\n    border-radius: unset; }\\n:host #purchase-trails .sign-PCT {\\n      background-image: url('pct.jpg'); }\\n:host #purchase-trails .sign-CDT {\\n      background-image: url('cdt.jpg'); }\\n:host #purchase-trails .sign-SHR {\\n      background-image: url('shr.jpg'); }\\n:host #purchase-trails .purchase-container {\\n      -webkit-perspective: 1000px;\\n              perspective: 1000px;\\n      background-size: cover;\\n      height: 200px;\\n      overflow-y: hidden;\\n      border-radius: 12px;\\n      margin-bottom: 6px;\\n      border: 1px solid #CCC; }\\n:host #purchase-trails .purchase-container .sign {\\n        max-width: 75%;\\n        height: 100%;\\n        margin: 0 5% 0 auto;\\n        padding-top: 12px;\\n        -webkit-transform: rotate(1deg) skewY(3deg) skewX(-3deg) rotateX(-10deg);\\n        transform: rotate(1deg) skewY(3deg) skewX(-3deg) rotateX(-10deg); }\\n:host #purchase-trails .purchase-container .sign .cap {\\n          display: block;\\n          width: 48px;\\n          margin: 0 auto -3px auto; }\\n:host #purchase-trails .purchase-container .sign .post {\\n          background-image: url('post-backgound.jpg');\\n          background-position: center top;\\n          background-repeat: repeat-y;\\n          padding: 24px 0 48px 0;\\n          width: 100%;\\n          text-align: center; }\\n:host #purchase-trails .purchase-container .sign .post button {\\n            width: auto;\\n            box-sizing: border-box;\\n            padding: 20px 12px 0px 12px;\\n            text-align: center;\\n            text-wrap: normal;\\n            white-space: normal;\\n            line-height: 24px;\\n            font-size: 18px;\\n            text-shadow: 1px 1px 1px rgba(255, 255, 255, 0.25);\\n            border-radius: 6px;\\n            -webkit-transform: rotate(-1deg) skewY(1deg);\\n            transform: rotate(-1deg) skewY(1deg); }\\n:host #purchase-trails .purchase-container .sign .post button .unavailable {\\n              color: red; }\\n:host #purchase-trails .purchase-container .sign .post button .free {\\n              color: green; }\\n:host #purchase-trails .purchase-container .sign .post button p {\\n              margin: 0;\\n              padding: 0; }\\n:host #purchase-trails .purchase-container .sign .post button p small {\\n                text-wrap: none;\\n                white-space: nowrap; }\\n:host #purchase-trails .purchase-container .sign .post button .marker {\\n              width: 48px;\\n              height: 48px;\\n              margin-bottom: 6px;\\n              opacity: 0.8; }\\n:host #purchase-trails .purchase-container .sign .post button::after {\\n            content: \\\"•\\\";\\n            background-image: url('sign-background.jpg');\\n            opacity: 1;\\n            width: 100%;\\n            height: 100%;\\n            left: 0;\\n            bottom: 0;\\n            position: absolute;\\n            z-index: -1;\\n            border-radius: 6px;\\n            vertical-align: bottom;\\n            border-top: 3px solid #8c7457; }\\n:host #purchase-trails .purchase-container .sign .post button:disabled {\\n            color: rgba(0, 0, 0, 0.87); }\\n:host #purchase-trails .purchase-container .sign .post button:disabled::after {\\n            opacity: 1; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29tcG9uZW50L2RpYWxvZy9zZXR0aW5ncy1kaWFsb2cvcGFuZWxzL3B1cmNoYXNlLXNldHRpbmdzL3B1cmNoYXNlLXNldHRpbmdzLmNvbXBvbmVudC5zYXNzIiwiL1VzZXJzL2ZyYW5rZG91d2VzL3dvcmsvanVzdC1oaWtlL3NyYy9hcHAvY29tcG9uZW50L2RpYWxvZy9zZXR0aW5ncy1kaWFsb2cvcGFuZWxzL3B1cmNoYXNlLXNldHRpbmdzL3B1cmNoYXNlLXNldHRpbmdzLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGdCQUFnQjtBQ0FmO0VBQ0MsY0FBYztFQUNkLFdBQVc7RUFDWCxnQkFBZ0I7RUFDaEIsWUFBWTtFQUNaLG9CQUFvQixFQUFBO0FBTHJCO0lBUUcsaUJBQWlCO0lBQ2pCLGFBQWE7SUFDYixpQkFBaUI7SUFDakIsaUJBQWlCO0lBQ2pCLG9CQUFvQixFQUFBO0FBWnZCO01BZUssZ0NBQWtGLEVBQUE7QUFmdkY7TUFrQkssZ0NBQWtGLEVBQUE7QUFsQnZGO01BcUJLLGdDQUFrRixFQUFBO0FBckJ2RjtNQXdCSywyQkFBbUI7Y0FBbkIsbUJBQW1CO01BQ25CLHNCQUFzQjtNQUN0QixhQUFhO01BQ2Isa0JBQWtCO01BQ2xCLG1CQUFtQjtNQUNuQixrQkFBa0I7TUFDbEIsc0JBQXNCLEVBQUE7QUE5QjNCO1FBb0NPLGNBQWM7UUFDZCxZQUFZO1FBQ1osbUJBQW1CO1FBQ25CLGlCQUFpQjtRQUdqQix3RUFBd0U7UUFDeEUsZ0VBQWdFLEVBQUE7QUEzQ3ZFO1VBOENTLGNBQWM7VUFDZCxXQUFXO1VBQ1gsd0JBQXdCLEVBQUE7QUFoRGpDO1VBbURTLDJDQUFxRjtVQUNyRiwrQkFBK0I7VUFDL0IsMkJBQTJCO1VBQzNCLHNCQUFzQjtVQUN0QixXQUFXO1VBQ1gsa0JBQWtCLEVBQUE7QUF4RDNCO1lBMkRXLFdBQVc7WUFDWCxzQkFBc0I7WUFDdEIsMkJBQTJCO1lBQzNCLGtCQUFrQjtZQUNsQixpQkFBaUI7WUFDakIsbUJBQW1CO1lBQ25CLGlCQUFpQjtZQUNqQixlQUFlO1lBQ2Ysa0RBQStDO1lBQy9DLGtCQUFrQjtZQUdsQiw0Q0FBNEM7WUFDNUMsb0NBQW9DLEVBQUE7QUF4RS9DO2NBMkVhLFVBQVUsRUFBQTtBQTNFdkI7Y0E4RWEsWUFBWSxFQUFBO0FBOUV6QjtjQWlGYSxTQUFTO2NBQ1QsVUFBVSxFQUFBO0FBbEZ2QjtnQkFxRmUsZUFBZTtnQkFDZixtQkFBbUIsRUFBQTtBQXRGbEM7Y0F5RmEsV0FBVztjQUNYLFlBQVk7Y0FDWixrQkFBa0I7Y0FDbEIsWUFBWSxFQUFBO0FBNUZ6QjtZQStGVyxZQUFTO1lBQ1QsNENBQXNGO1lBQ3RGLFVBQVU7WUFDVixXQUFXO1lBQ1gsWUFBWTtZQUNaLE9BQU87WUFDUCxTQUFTO1lBQ1Qsa0JBQWtCO1lBQ2xCLFdBQVc7WUFDWCxrQkFBa0I7WUFDbEIsc0JBQXNCO1lBQ3RCLDZCQUE2QixFQUFBO0FBMUd4QztZQTZHVywwQkFBc0IsRUFBQTtBQTdHakM7WUFnSFcsVUFBVSxFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2RpYWxvZy9zZXR0aW5ncy1kaWFsb2cvcGFuZWxzL3B1cmNoYXNlLXNldHRpbmdzL3B1cmNoYXNlLXNldHRpbmdzLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiQGNoYXJzZXQgXCJVVEYtOFwiO1xuOmhvc3Qge1xuICBkaXNwbGF5OiBibG9jaztcbiAgd2lkdGg6IDEwMCU7XG4gIG1pbi1oZWlnaHQ6IDEwMCU7XG4gIGhlaWdodDogYXV0bztcbiAgcGFkZGluZy1ib3R0b206IDEycHg7IH1cbiAgOmhvc3QgI3B1cmNoYXNlLXRyYWlscyB7XG4gICAgYmFja2dyb3VuZDogdW5zZXQ7XG4gICAgYm9yZGVyOiB1bnNldDtcbiAgICBib3gtc2hhZG93OiB1bnNldDtcbiAgICBwYWRkaW5nLWJvdHRvbTogMDtcbiAgICBib3JkZXItcmFkaXVzOiB1bnNldDsgfVxuICAgIDpob3N0ICNwdXJjaGFzZS10cmFpbHMgLnNpZ24tUENUIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcIi4uLy4uLy4uLy4uLy4uLy4uL2Fzc2V0cy9pbWFnZXMvcGFuZWwtYmFja2dyb3VuZHMvcGN0LmpwZ1wiKTsgfVxuICAgIDpob3N0ICNwdXJjaGFzZS10cmFpbHMgLnNpZ24tQ0RUIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcIi4uLy4uLy4uLy4uLy4uLy4uL2Fzc2V0cy9pbWFnZXMvcGFuZWwtYmFja2dyb3VuZHMvY2R0LmpwZ1wiKTsgfVxuICAgIDpob3N0ICNwdXJjaGFzZS10cmFpbHMgLnNpZ24tU0hSIHtcbiAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcIi4uLy4uLy4uLy4uLy4uLy4uL2Fzc2V0cy9pbWFnZXMvcGFuZWwtYmFja2dyb3VuZHMvc2hyLmpwZ1wiKTsgfVxuICAgIDpob3N0ICNwdXJjaGFzZS10cmFpbHMgLnB1cmNoYXNlLWNvbnRhaW5lciB7XG4gICAgICBwZXJzcGVjdGl2ZTogMTAwMHB4O1xuICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjtcbiAgICAgIGhlaWdodDogMjAwcHg7XG4gICAgICBvdmVyZmxvdy15OiBoaWRkZW47XG4gICAgICBib3JkZXItcmFkaXVzOiAxMnB4O1xuICAgICAgbWFyZ2luLWJvdHRvbTogNnB4O1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgI0NDQzsgfVxuICAgICAgOmhvc3QgI3B1cmNoYXNlLXRyYWlscyAucHVyY2hhc2UtY29udGFpbmVyIC5zaWduIHtcbiAgICAgICAgbWF4LXdpZHRoOiA3NSU7XG4gICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgbWFyZ2luOiAwIDUlIDAgYXV0bztcbiAgICAgICAgcGFkZGluZy10b3A6IDEycHg7XG4gICAgICAgIC1tcy10cmFuc2Zvcm06IHJvdGF0ZSgxZGVnKSBza2V3WSgzZGVnKSBza2V3WCgtM2RlZykgcm90YXRlWCgtMTBkZWcpO1xuICAgICAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDFkZWcpIHNrZXdZKDNkZWcpIHNrZXdYKC0zZGVnKSByb3RhdGVYKC0xMGRlZyk7XG4gICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDFkZWcpIHNrZXdZKDNkZWcpIHNrZXdYKC0zZGVnKSByb3RhdGVYKC0xMGRlZyk7IH1cbiAgICAgICAgOmhvc3QgI3B1cmNoYXNlLXRyYWlscyAucHVyY2hhc2UtY29udGFpbmVyIC5zaWduIC5jYXAge1xuICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAgIHdpZHRoOiA0OHB4O1xuICAgICAgICAgIG1hcmdpbjogMCBhdXRvIC0zcHggYXV0bzsgfVxuICAgICAgICA6aG9zdCAjcHVyY2hhc2UtdHJhaWxzIC5wdXJjaGFzZS1jb250YWluZXIgLnNpZ24gLnBvc3Qge1xuICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChcIi4uLy4uLy4uLy4uLy4uLy4uL2Fzc2V0cy9pbWFnZXMvc2lnbi1wb3N0L3Bvc3QtYmFja2dvdW5kLmpwZ1wiKTtcbiAgICAgICAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgdG9wO1xuICAgICAgICAgIGJhY2tncm91bmQtcmVwZWF0OiByZXBlYXQteTtcbiAgICAgICAgICBwYWRkaW5nOiAyNHB4IDAgNDhweCAwO1xuICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsgfVxuICAgICAgICAgIDpob3N0ICNwdXJjaGFzZS10cmFpbHMgLnB1cmNoYXNlLWNvbnRhaW5lciAuc2lnbiAucG9zdCBidXR0b24ge1xuICAgICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICAgICAgcGFkZGluZzogMjBweCAxMnB4IDBweCAxMnB4O1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgdGV4dC13cmFwOiBub3JtYWw7XG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm9ybWFsO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDI0cHg7XG4gICAgICAgICAgICBmb250LXNpemU6IDE4cHg7XG4gICAgICAgICAgICB0ZXh0LXNoYWRvdzogMXB4IDFweCAxcHggcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgICAgICAgIC1tcy10cmFuc2Zvcm06IHJvdGF0ZSgtMWRlZykgc2tld1koMWRlZyk7XG4gICAgICAgICAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKC0xZGVnKSBza2V3WSgxZGVnKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKC0xZGVnKSBza2V3WSgxZGVnKTsgfVxuICAgICAgICAgICAgOmhvc3QgI3B1cmNoYXNlLXRyYWlscyAucHVyY2hhc2UtY29udGFpbmVyIC5zaWduIC5wb3N0IGJ1dHRvbiAudW5hdmFpbGFibGUge1xuICAgICAgICAgICAgICBjb2xvcjogcmVkOyB9XG4gICAgICAgICAgICA6aG9zdCAjcHVyY2hhc2UtdHJhaWxzIC5wdXJjaGFzZS1jb250YWluZXIgLnNpZ24gLnBvc3QgYnV0dG9uIC5mcmVlIHtcbiAgICAgICAgICAgICAgY29sb3I6IGdyZWVuOyB9XG4gICAgICAgICAgICA6aG9zdCAjcHVyY2hhc2UtdHJhaWxzIC5wdXJjaGFzZS1jb250YWluZXIgLnNpZ24gLnBvc3QgYnV0dG9uIHAge1xuICAgICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICAgIHBhZGRpbmc6IDA7IH1cbiAgICAgICAgICAgICAgOmhvc3QgI3B1cmNoYXNlLXRyYWlscyAucHVyY2hhc2UtY29udGFpbmVyIC5zaWduIC5wb3N0IGJ1dHRvbiBwIHNtYWxsIHtcbiAgICAgICAgICAgICAgICB0ZXh0LXdyYXA6IG5vbmU7XG4gICAgICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsgfVxuICAgICAgICAgICAgOmhvc3QgI3B1cmNoYXNlLXRyYWlscyAucHVyY2hhc2UtY29udGFpbmVyIC5zaWduIC5wb3N0IGJ1dHRvbiAubWFya2VyIHtcbiAgICAgICAgICAgICAgd2lkdGg6IDQ4cHg7XG4gICAgICAgICAgICAgIGhlaWdodDogNDhweDtcbiAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNnB4O1xuICAgICAgICAgICAgICBvcGFjaXR5OiAwLjg7IH1cbiAgICAgICAgICA6aG9zdCAjcHVyY2hhc2UtdHJhaWxzIC5wdXJjaGFzZS1jb250YWluZXIgLnNpZ24gLnBvc3QgYnV0dG9uOjphZnRlciB7XG4gICAgICAgICAgICBjb250ZW50OiBcIuKAolwiO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiLi4vLi4vLi4vLi4vLi4vLi4vYXNzZXRzL2ltYWdlcy9zaWduLXBvc3Qvc2lnbi1iYWNrZ3JvdW5kLmpwZ1wiKTtcbiAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIGxlZnQ6IDA7XG4gICAgICAgICAgICBib3R0b206IDA7XG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICB6LWluZGV4OiAtMTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG4gICAgICAgICAgICBib3JkZXItdG9wOiAzcHggc29saWQgIzhjNzQ1NzsgfVxuICAgICAgICAgIDpob3N0ICNwdXJjaGFzZS10cmFpbHMgLnB1cmNoYXNlLWNvbnRhaW5lciAuc2lnbiAucG9zdCBidXR0b246ZGlzYWJsZWQge1xuICAgICAgICAgICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44Nyk7IH1cbiAgICAgICAgICA6aG9zdCAjcHVyY2hhc2UtdHJhaWxzIC5wdXJjaGFzZS1jb250YWluZXIgLnNpZ24gLnBvc3QgYnV0dG9uOmRpc2FibGVkOjphZnRlciB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxOyB9XG4iLCIgOmhvc3Qge1xuICBkaXNwbGF5OiBibG9jaztcbiAgd2lkdGg6IDEwMCU7XG4gIG1pbi1oZWlnaHQ6IDEwMCU7XG4gIGhlaWdodDogYXV0bztcbiAgcGFkZGluZy1ib3R0b206IDEycHg7XG5cbiAgI3B1cmNoYXNlLXRyYWlscyB7XG4gICAgYmFja2dyb3VuZDogdW5zZXQ7XG4gICAgYm9yZGVyOiB1bnNldDtcbiAgICBib3gtc2hhZG93OiB1bnNldDtcbiAgICBwYWRkaW5nLWJvdHRvbTogMDtcbiAgICBib3JkZXItcmFkaXVzOiB1bnNldDtcblxuICAgIC5zaWduLVBDVCB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuLi8uLi8uLi8uLi8uLi8uLi9hc3NldHMvaW1hZ2VzL3BhbmVsLWJhY2tncm91bmRzL3BjdC5qcGdcIik7IH1cblxuICAgIC5zaWduLUNEVCB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuLi8uLi8uLi8uLi8uLi8uLi9hc3NldHMvaW1hZ2VzL3BhbmVsLWJhY2tncm91bmRzL2NkdC5qcGdcIik7IH1cblxuICAgIC5zaWduLVNIUiB7XG4gICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuLi8uLi8uLi8uLi8uLi8uLi9hc3NldHMvaW1hZ2VzL3BhbmVsLWJhY2tncm91bmRzL3Noci5qcGdcIik7IH1cblxuICAgIC5wdXJjaGFzZS1jb250YWluZXIge1xuICAgICAgcGVyc3BlY3RpdmU6IDEwMDBweDtcbiAgICAgIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XG4gICAgICBoZWlnaHQ6IDIwMHB4O1xuICAgICAgb3ZlcmZsb3cteTogaGlkZGVuO1xuICAgICAgYm9yZGVyLXJhZGl1czogMTJweDtcbiAgICAgIG1hcmdpbi1ib3R0b206IDZweDtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNDQ0M7XG4gICAgICAvL2Rpc3BsYXk6IGZsZXhcbiAgICAgIC8vZmxleC13cmFwOiB3cmFwXG4gICAgICAvL2FsaWduLWl0ZW1zOiBmbGV4LWVuZFxuXG4gICAgICAuc2lnbiB7XG4gICAgICAgIG1heC13aWR0aDogNzUlO1xuICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgIG1hcmdpbjogMCA1JSAwIGF1dG87XG4gICAgICAgIHBhZGRpbmctdG9wOiAxMnB4O1xuXG4gICAgICAgIC1tcy10cmFuc2Zvcm06IHJvdGF0ZSgxZGVnKSBza2V3WSgzZGVnKSBza2V3WCgtM2RlZykgcm90YXRlWCgtMTBkZWcpIC8qIElFIDkgKi87XG4gICAgICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMWRlZykgc2tld1koM2RlZykgc2tld1goLTNkZWcpIHJvdGF0ZVgoLTEwZGVnKSAvKiBTYWZhcmkgMy04ICovO1xuICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgxZGVnKSBza2V3WSgzZGVnKSBza2V3WCgtM2RlZykgcm90YXRlWCgtMTBkZWcpO1xuXG4gICAgICAgIC5jYXAge1xuICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAgIHdpZHRoOiA0OHB4O1xuICAgICAgICAgIG1hcmdpbjogMCBhdXRvIC0zcHggYXV0bzsgfVxuXG4gICAgICAgIC5wb3N0IHtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuLi8uLi8uLi8uLi8uLi8uLi9hc3NldHMvaW1hZ2VzL3NpZ24tcG9zdC9wb3N0LWJhY2tnb3VuZC5qcGdcIik7XG4gICAgICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyIHRvcDtcbiAgICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXk7XG4gICAgICAgICAgcGFkZGluZzogMjRweCAwIDQ4cHggMDtcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG5cbiAgICAgICAgICBidXR0b24ge1xuICAgICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICAgICAgcGFkZGluZzogMjBweCAxMnB4IDBweCAxMnB4O1xuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgdGV4dC13cmFwOiBub3JtYWw7XG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm9ybWFsO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDI0cHg7XG4gICAgICAgICAgICBmb250LXNpemU6IDE4cHg7XG4gICAgICAgICAgICB0ZXh0LXNoYWRvdzogMXB4IDFweCAxcHggcmdiYSgyNTUsMjU1LDI1NSwwLjI1KTtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcblxuICAgICAgICAgICAgLW1zLXRyYW5zZm9ybTogcm90YXRlKC0xZGVnKSBza2V3WSgxZGVnKSAvKiBJRSA5ICovO1xuICAgICAgICAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgtMWRlZykgc2tld1koMWRlZykgLyogU2FmYXJpIDMtOCAqLztcbiAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKC0xZGVnKSBza2V3WSgxZGVnKTtcblxuICAgICAgICAgICAgLnVuYXZhaWxhYmxlIHtcbiAgICAgICAgICAgICAgY29sb3I6IHJlZDsgfVxuXG4gICAgICAgICAgICAuZnJlZSB7XG4gICAgICAgICAgICAgIGNvbG9yOiBncmVlbjsgfVxuXG4gICAgICAgICAgICBwIHtcbiAgICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgICBwYWRkaW5nOiAwO1xuXG4gICAgICAgICAgICAgIHNtYWxsIHtcbiAgICAgICAgICAgICAgICB0ZXh0LXdyYXA6IG5vbmU7XG4gICAgICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsgfSB9XG5cbiAgICAgICAgICAgIC5tYXJrZXIge1xuICAgICAgICAgICAgICB3aWR0aDogNDhweDtcbiAgICAgICAgICAgICAgaGVpZ2h0OiA0OHB4O1xuICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA2cHg7XG4gICAgICAgICAgICAgIG9wYWNpdHk6IDAuODsgfSB9XG5cbiAgICAgICAgICBidXR0b246OmFmdGVyIHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi4oCiXCI7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIuLi8uLi8uLi8uLi8uLi8uLi9hc3NldHMvaW1hZ2VzL3NpZ24tcG9zdC9zaWduLWJhY2tncm91bmQuanBnXCIpO1xuICAgICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgbGVmdDogMDtcbiAgICAgICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIHotaW5kZXg6IC0xO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgICAgICAgICAgIGJvcmRlci10b3A6IDNweCBzb2xpZCAjOGM3NDU3OyB9XG5cbiAgICAgICAgICBidXR0b246ZGlzYWJsZWQge1xuICAgICAgICAgICAgY29sb3I6IHJnYmEoMCwwLDAsLjg3KTsgfVxuXG4gICAgICAgICAgYnV0dG9uOmRpc2FibGVkOjphZnRlciB7XG4gICAgICAgICAgICBvcGFjaXR5OiAxOyB9IH0gfSB9XG5cblxuXG4gICAgLy8ucHVyY2hhc2UtY29udGFpbmVyIC5zaWduOm5vdCg6Zmlyc3QtY2hpbGQpXG4gICAgLy8gIG1hcmdpbi1sZWZ0OiA1JVxuICAgIC8vXG4gICAgLy8vKiBvbmUgaXRlbSAqL1xuICAgIC8vLnB1cmNoYXNlLWNvbnRhaW5lciAuc2lnbjpmaXJzdC1jaGlsZDpudGgtbGFzdC1jaGlsZCgxKVxuICAgIC8vICB3aWR0aDogMTAwJVxuICAgIC8vXG4gICAgLy8vKiB0d28gaXRlbXMgKi9cbiAgICAvLy5wdXJjaGFzZS1jb250YWluZXIgLnNpZ246Zmlyc3QtY2hpbGQ6bnRoLWxhc3QtY2hpbGQoMiksXG4gICAgLy8ucHVyY2hhc2UtY29udGFpbmVyIC5zaWduOmZpcnN0LWNoaWxkOm50aC1sYXN0LWNoaWxkKDIpIH4gLnNpZ25cbiB9IH0gICAgLy8gIHdpZHRoOiA0Ny41JVxuIl19 */\"","import { Component, OnInit } from '@angular/core';\nimport { TrailMeta } from '../../../../../type/trail';\nimport { LocalStorageService } from 'ngx-webstorage';\nimport { SettingsPanelComponent } from '../../../../../base/settings-panel/settings-panel.component';\nimport {getTrailsMetaData} from '../../../../../_util/trail-meta';\n\n@Component({\n  selector: 'purchase-settings',\n  templateUrl: './purchase-settings.component.html',\n  styleUrls: ['./purchase-settings.component.sass'],\n})\nexport class PurchaseSettingsComponent extends SettingsPanelComponent implements OnInit {\n\n  public availableTrailList: Array<TrailMeta> = [];\n  private _purchasedTrails: Array<number>;\n\n  constructor(\n    private _localStorage: LocalStorageService,\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n\n    this._purchasedTrails = this._localStorage.retrieve('purchasedTrails');\n    this._generateTrailLists();\n  }\n\n  private _generateTrailLists(): void {\n\n    const _self = this;\n\n    this.availableTrailList = [];\n\n    const _trailData = getTrailsMetaData();\n\n    for (const key in _trailData) {\n      if (_self._purchasedTrails && _self._purchasedTrails.indexOf(_trailData[key].id) === -1 && _trailData[key].abbr !== 'DEMO') {\n        if (_trailData[key].availableForPurchase === true) {\n          _self.availableTrailList.push(_trailData[key]);\n        }\n      }\n    }\n  }\n\n\n  // EVENTS\n\n  public onTrailPurchased(trailId): void {\n\n    // TODO app store routines\n\n    if (this._purchasedTrails.indexOf(trailId) === -1) {\n\n      this._purchasedTrails.push(trailId);\n      this._purchasedTrails.sort();\n      this._localStorage.store('purchasedTrails', this._purchasedTrails);\n\n      this._generateTrailLists();\n    }\n  }\n}\n","module.exports = \"<div id=\\\"main\\\">\\n\\n  <!--idle-->\\n  <button *ngIf=\\\"hasUpdate && !isActive\\\" mat-fab class=\\\"download\\\" (click)=\\\"onButtonClick('download')\\\">\\n    <fa-icon icon=\\\"download\\\" size=\\\"lg\\\"></fa-icon>\\n  </button>\\n\\n  <!--downloading-->\\n  <button *ngIf=\\\"isActive && !hasFile\\\" mat-fab class=\\\"cancel\\\" (click)=\\\"onButtonClick('cancel')\\\">\\n      <fa-icon icon=\\\"times\\\" size=\\\"lg\\\"></fa-icon>\\n    </button>\\n\\n  <!-- download complete / has file-->\\n  <button *ngIf=\\\"!hasUpdate && !isActive\\\" mat-fab class=\\\"delete\\\" (click)=\\\"onButtonClick('clear')\\\">\\n    <fa-icon icon=\\\"trash\\\" size=\\\"lg\\\"></fa-icon>\\n  </button>\\n</div>\\n<div id=\\\"meta\\\">\\n  <h3>{{type + ' data '}}<small>{{'v' + version}}</small></h3>\\n  <div>\\n    <p *ngIf=\\\"!isActive && hasUpdate\\\">{{trailMeta[type + 'FileSize'] | filesize}}</p>\\n    <p *ngIf=\\\"!isActive && !hasUpdate\\\">Downloaded</p>\\n    <!--<p *ngIf=\\\"isActive\\\">{{progressLabel}}</p>-->\\n    <mat-progress-bar *ngIf=\\\"isActive\\\" mode=\\\"determinate\\\" [value]=\\\"progress\\\" class=\\\"progress\\\"></mat-progress-bar>\\n  </div>\\n</div>\\n\"","module.exports = \":host {\\n  display: inline-block;\\n  box-sizing: border-box;\\n  position: relative;\\n  width: 33%;\\n  height: 100%;\\n  vertical-align: center; }\\n  :host #main {\\n    text-align: center; }\\n  :host #main button {\\n      box-shadow: none; }\\n  :host #meta {\\n    height: 100%;\\n    vertical-align: middle;\\n    margin: 8px 12px;\\n    text-align: center; }\\n  :host #meta h3 {\\n      margin: 0 12px 3px 0 !important;\\n      width: 100%;\\n      text-transform: capitalize; }\\n  :host #meta h3 small {\\n        text-transform: lowercase; }\\n  :host #meta p {\\n      margin: 0; }\\n  :host .delete {\\n    background-color: #b4b4b4; }\\n  :host .download {\\n    background-color: #60be69; }\\n  :host .cancel {\\n    background-color: rgba(232, 92, 0, 0.62); }\\n  :host::ng-deep .mat-progress-bar-fill::after {\\n  background-color: #b4b4b4; }\\n  :host::ng-deep .mat-progress-bar-buffer {\\n  background: #e9edf0; }\\n  :host::ng-deep .mat-progress-bar {\\n  margin-top: 8px;\\n  border-radius: 4px;\\n  height: 8px;\\n  width: 100%;\\n  border: 0.5px solid #cdcdcd; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy90cmFpbC1zZXR0aW5ncy9kb3dubG9hZGVyL2Rvd25sb2FkZXIuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUM7RUFDQyxxQkFBcUI7RUFDckIsc0JBQXNCO0VBQ3RCLGtCQUFrQjtFQUNsQixVQUFVO0VBQ1YsWUFBWTtFQUNaLHNCQUFzQixFQUFBO0VBTnZCO0lBU0csa0JBQWtCLEVBQUE7RUFUckI7TUFZSyxnQkFBZ0IsRUFBQTtFQVpyQjtJQWVHLFlBQVk7SUFDWixzQkFBc0I7SUFDdEIsZ0JBQWdCO0lBQ2hCLGtCQUFrQixFQUFBO0VBbEJyQjtNQXFCSywrQkFBK0I7TUFDL0IsV0FBVztNQUNYLDBCQUEwQixFQUFBO0VBdkIvQjtRQTBCTyx5QkFBeUIsRUFBQTtFQTFCaEM7TUE2QkssU0FBUyxFQUFBO0VBN0JkO0lBZ0NHLHlCQUFvQyxFQUFBO0VBaEN2QztJQW1DRyx5QkFBbUMsRUFBQTtFQW5DdEM7SUFzQ0csd0NBQXdDLEVBQUE7RUFFM0M7RUFHRyx5QkFBb0MsRUFBQTtFQUh2QztFQU1HLG1CQUFtQixFQUFBO0VBTnRCO0VBU0csZUFBZTtFQUNmLGtCQUFrQjtFQUNsQixXQUFXO0VBQ1gsV0FBVztFQUNYLDJCQUEyQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2RpYWxvZy9zZXR0aW5ncy1kaWFsb2cvcGFuZWxzL3RyYWlsLXNldHRpbmdzL2Rvd25sb2FkZXIvZG93bmxvYWRlci5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICB3aWR0aDogMzMlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHZlcnRpY2FsLWFsaWduOiBjZW50ZXI7XG5cbiAgI21haW4ge1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcblxuICAgIGJ1dHRvbiB7XG4gICAgICBib3gtc2hhZG93OiBub25lOyB9IH1cblxuICAjbWV0YSB7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG4gICAgbWFyZ2luOiA4cHggMTJweDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG5cbiAgICBoMyB7XG4gICAgICBtYXJnaW46IDAgMTJweCAzcHggMCAhaW1wb3J0YW50O1xuICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICB0ZXh0LXRyYW5zZm9ybTogY2FwaXRhbGl6ZTtcblxuICAgICAgc21hbGwge1xuICAgICAgICB0ZXh0LXRyYW5zZm9ybTogbG93ZXJjYXNlOyB9IH1cblxuICAgIHAge1xuICAgICAgbWFyZ2luOiAwOyB9IH1cblxuICAuZGVsZXRlIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMTgwLCAxODAsIDE4MCk7IH1cblxuICAuZG93bmxvYWQge1xuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYig5NiwgMTkwLCAxMDUpOyB9XG5cbiAgLmNhbmNlbCB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzIsIDkyLCAwLCAwLjYyKTsgfSB9XG5cbiA6aG9zdDo6bmctZGVlcCB7XG5cbiAgLm1hdC1wcm9ncmVzcy1iYXItZmlsbDo6YWZ0ZXIge1xuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigxODAsIDE4MCwgMTgwKTsgfVxuXG4gIC5tYXQtcHJvZ3Jlc3MtYmFyLWJ1ZmZlciB7XG4gICAgYmFja2dyb3VuZDogI2U5ZWRmMDsgfVxuXG4gIC5tYXQtcHJvZ3Jlc3MtYmFyIHtcbiAgICBtYXJnaW4tdG9wOiA4cHg7XG4gICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgIGhlaWdodDogOHB4O1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGJvcmRlcjogMC41cHggc29saWQgI2NkY2RjZDsgfVxuXG4gIC8vI21haW46OmFmdGVyXG4gIC8vICBwb3NpdGlvbjogYWJzb2x1dGVcbiAgLy8gIGJveC1zaXppbmc6IGJvcmRlci1ib3hcbiAgLy8gIGNvbnRlbnQ6IFwiXCJcbiAgLy8gIHBhZGRpbmc6IDAgYXV0b1xuICAvLyAgdG9wOiAwXG4gIC8vICBsZWZ0OiAwXG4gIC8vICB0ZXh0LWFsaWduOiBjZW50ZXJcbiAgLy8gIHZlcnRpY2FsLWFsaWduOiBib3R0b21cbiAgLy8gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjUzLDIyNywyMjcsMC43NSlcbiAgLy8gIHdpZHRoOiAxMDAlXG4gIC8vICBoZWlnaHQ6IDEwMCVcbiB9ICAvLyAgYm9yZGVyLXJhZGl1czogMjhweCA2cHggNnB4IDI4cHhcbiJdfQ== */\"","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, Input, isDevMode,\n  OnChanges, OnDestroy, OnInit, SimpleChanges} from '@angular/core';\nimport {DownloadService} from '../../../../../../service/download.service';\nimport {Subscription} from 'rxjs';\nimport {Downloader} from '../../../../../../_util/downloader/downloader';\nimport {FilesystemService} from '../../../../../../service/filesystem.service';\nimport {getTrailMetaDataById} from '../../../../../../_util/trail-meta';\nimport {TrailMeta} from '../../../../../../type/trail';\nimport {environment} from '../../../../../../../environments/environment.prod';\nimport {DownloaderStatus} from '../../../../../../_util/downloader/status-manager';\nimport {ConnectionService} from '../../../../../../service/connection.service';\n\n@Component({\n  selector: 'downloader',\n  templateUrl: './downloader.component.html',\n  styleUrls: ['./downloader.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class DownloaderComponent implements OnInit, OnChanges, OnDestroy {\n\n  @Input() trailId:                 number;\n  @Input() type:                    string;\n  @Input() label ?:                 string;     // if not provided, label will be generated\n  @Input() onComplete?:             Function;\n  @Input() onClear?:                Function;\n  @Input() hasFile?:                boolean;    // is there a file available locally (in local storage/assets/filesystem)\n  @Input() hasUpdate?:              boolean;    // is there an update available for this files\n  @Input() version:                 string;\n  @Input() isVersionSpecific?:      boolean;    // is the download based on version (trail data / tiles data)\n\n  @Input() file:                    string;     // the filename (without extension)\n  @Input() extension:               string;     // just the extension, no .)\n  @Input() parts?:                  number;     // support for multi part (sequential downloading, as there is a max filesize)\n\n  public trailMeta:                 TrailMeta;\n  public isActive:                  boolean;\n  public storageAvailable:          boolean;\n  public progress:                  number;\n  public progressState              = 'determinate';\n\n  private _buttonState:             string;\n  private _downloadSubscription:    Subscription;\n  private _downloader:              Downloader;\n  private _url:                     string | Array<string>;\n\n  constructor(\n    private _changeDetector:        ChangeDetectorRef,\n    private _downloadService:       DownloadService,\n    private _fileSystemService:     FilesystemService,\n    private _connectionService:     ConnectionService\n  ) {\n  }\n\n  ngOnInit(): void {\n    this.trailMeta = getTrailMetaDataById(this.trailId);\n    this._createDownloader();\n    this._setup();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (changes.trailId) {\n      this.trailMeta = getTrailMetaDataById(this.trailId);\n      this._createDownloader();\n      this._setup();\n    }\n  }\n\n\n  ngOnDestroy(): void {\n    this._downloadSubscription.unsubscribe();\n  }\n\n\n\n\n  // SETUP\n  private _createDownloader(): void {\n\n    // name based downloader, managed by downloader service\n    this._downloader = this._downloadService.createDownloader(this.trailMeta.abbr +  '_' + this.type);\n  }\n\n  private _setup(): void {\n\n    const _self = this;\n\n    this.isActive = this._downloader.status.isActiveSubject.getValue();\n\n    let _base: string = this.trailMeta.abbr + '/';\n    if (this.isVersionSpecific) {\n      _base += this.trailMeta[this.type + 'Version'] + '/';\n    }\n\n    if (this.parts > 1) {\n\n      // multipart download\n      this._url = [];\n\n      for (let i = 0; i < this.parts; i++) {\n\n        this._url.push(_base + this.file + '_' + i + '.' + this.extension);\n      }\n\n    } else {\n\n      // single file\n      this._url = _base + this.file + '.' + this.extension;\n    }\n\n    // check if storage is accessible\n    this.storageAvailable = this._fileSystemService.isStorageAvailable;\n\n    // observe download status\n    if (this._downloadSubscription) {\n      this._downloadSubscription.unsubscribe();\n    }\n\n    this._downloadSubscription = this._downloader.meta.subscribe(\n      function (status: DownloaderStatus) {\n\n        _self.isActive = _self._downloader.status.isActiveSubject.getValue();\n\n        if (status && status.label) {\n\n          if (status.type === 'http' && status.label === 'complete') {\n\n            if (_self.extension !== 'zip' && _self.extension !== 'json') {\n\n              _self._clear();\n              _self.hasFile = false;\n              _self.isActive = false;\n              throw new Error('downloaded an unsupported file');\n            }\n\n          } else if (status.label === 'progress') {\n\n            // TODO: currently not showing saving/unzipping as part of the progress bar\n\n            if (status.type === 'http') {\n\n              // only updates on full % difference, to save redraws\n              const _newProgress = Math.floor(status.data.percentage);\n              if (_newProgress !== _self.progress) {\n                _self.progressState = 'determinate';\n                _self.progress = status.data.percentage;\n                _self._changeDetector.detectChanges();\n              }\n            } else {\n              _self.progressState = 'buffer';\n              _self._changeDetector.detectChanges();\n            }\n          } else if (status.label === 'error') {\n\n            alert('Downloader error');\n            _self.hasFile = false;\n            _self.onClear(_self.type);\n            _self.progress = 0;\n\n          } else if (status.type === 'downloader' && status.label === 'complete') {\n            _self.progress = 100;\n            _self.hasFile = true;\n\n            console.log('downloader complete?');\n            _self.onComplete(_self.type);\n\n          } else if (status.type === 'downloader' && status.label === 'cleared') {\n            _self.progress = 0;\n          }\n        }\n      }, function (error) {\n\n        alert('Download error');\n        _self.isActive = _self._downloader.status.isActiveSubject.getValue();\n        _self.onClear(_self.type);\n        _self.hasFile = false;\n        _self.progress = 0;\n      });\n\n    // since object changes won't trigger a redraw\n    this._changeDetector.detectChanges();\n  }\n\n  // EVENT HANDLERS\n\n  public onButtonClick(newState: string) {\n\n    // prevent repetitive actions\n    if (this._buttonState !== newState) {\n      this['_' + newState]();     // dynamic function call\n    }\n  }\n\n\n\n  // BUTTON ACTIONS (dynanically called from button click)\n\n  private _download(): void {\n\n    if (this._connectionService.state !== 'online') {\n      alert('You\\'re currently offline!');\n      return;\n    }\n\n    let _url;\n\n    if (typeof this._url === 'string') {\n      _url = environment.appDomain + environment.fileBaseUrl + this._url;\n    } else {\n\n      _url = [];\n\n      this._url.forEach(function(file) {\n        _url.push(environment.appDomain + environment.fileBaseUrl + file);\n      });\n    }\n\n    this._downloader.downloadFile(_url, !isDevMode(), this._url);\n  }\n\n  // clear all data\n  private _clear(): void {\n    this._downloader.cancelDownload();\n    this._downloader.clearFile();\n    this.hasFile = false;\n    this.onClear(this.type);\n  }\n\n  // cancel current download/unzip process\n  private _cancel(): void {\n    this._downloader.cancelDownload();\n    this.onClear(this.type);\n  }\n}\n","module.exports = \"<mat-card id=\\\"trail-selector\\\">\\n\\n  <h2>Trail Downloads</h2>\\n\\n  <mat-card-content>\\n    <section>\\n      <mat-form-field class=\\\"select-form-field\\\">\\n        <mat-select [value]=\\\"activeTrail.id\\\" (selectionChange)=\\\"onTrailSelect($event)\\\" #trailSelector>\\n          <mat-option *ngFor=\\\"let trail of purchasedTrailList\\\" [value]=\\\"trail.id\\\">\\n            {{trail.name}}\\n          </mat-option>\\n        </mat-select>\\n      </mat-form-field>\\n    </section>\\n\\n    <section id=\\\"download\\\">\\n\\n      <div class=\\\"warning\\\" *ngIf=\\\"hasInternet\\\">{{(!hasWifi) ? 'Cellular network detected, consider locating wifi before downloading large files!' : ''}}</div>\\n\\n      <downloader\\n        *ngFor=\\\"let downloader of downloaders\\\"\\n\\n        [hasFile]=\\\"hasFile(downloader)\\\"\\n        [version]=\\\"displayVersion(downloader)\\\"\\n        [hasUpdate]=\\\"updateAvailable(downloader)\\\"\\n        [type]=\\\"downloader\\\"\\n        [trailId]=\\\"activeTrail.id\\\"\\n        [file]=\\\"downloader\\\"\\n        [isVersionSpecific]=\\\"(downloader !== 'snow') ? true : false\\\"\\n        [extension]=\\\"(downloader === 'snow') ? 'json' : 'zip'\\\"\\n        [parts]=\\\"(downloader === 'tiles') ? activeTrail.tilesFileCount : 1\\\"\\n        [onComplete]=\\\"onDownloadComplete.bind(this)\\\"\\n        [onClear]=\\\"onDownloadCleared.bind(this)\\\"\\n      >\\n      </downloader>\\n\\n    </section>\\n\\n  </mat-card-content>\\n\\n</mat-card>\\n\"","module.exports = \"::ng-deep .mat-form-field-wrapper {\\n  padding-bottom: 0px !important; }\\n\\n#download {\\n  border-radius: 0 0 6px 6px;\\n  background-color: #F9F9F9;\\n  padding: 36px 0 12px 0;\\n  margin-top: -12px !important; }\\n\\n.warning {\\n  text-align: center; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy90cmFpbC1zZXR0aW5ncy90cmFpbC1zZXR0aW5ncy5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUdJLDhCQUE4QixFQUFBOztBQU1sQztFQUNFLDBCQUEwQjtFQUMxQix5QkFBeUI7RUFDekIsc0JBQXNCO0VBQ3RCLDRCQUE0QixFQUFBOztBQUU5QjtFQUNFLGtCQUFrQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2RpYWxvZy9zZXR0aW5ncy1kaWFsb2cvcGFuZWxzL3RyYWlsLXNldHRpbmdzL3RyYWlsLXNldHRpbmdzLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiOjpuZy1kZWVwIHtcblxuICAubWF0LWZvcm0tZmllbGQtd3JhcHBlciB7XG4gICAgcGFkZGluZy1ib3R0b206IDBweCAhaW1wb3J0YW50OyB9XG5cbiAgLnNlbGVjdC1mb3JtLWZpZWxkIHtcbiAgICAubWF0LXNlbGVjdCB7XG4gfSB9IH0gICAgICAvL2JhY2tncm91bmQtY29sb3I6IHNhbG1vbiAhaW1wb3J0YW50XG5cbiNkb3dubG9hZCB7XG4gIGJvcmRlci1yYWRpdXM6IDAgMCA2cHggNnB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjlGOUY5O1xuICBwYWRkaW5nOiAzNnB4IDAgMTJweCAwO1xuICBtYXJnaW4tdG9wOiAtMTJweCAhaW1wb3J0YW50OyB9XG5cbi53YXJuaW5nIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyOyB9XG4iXX0= */\"","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, OnDestroy, OnInit, ViewChild} from '@angular/core';\nimport {TrailMeta} from '../../../../../type/trail';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {MatSelectChange} from '@angular/material';\nimport {SettingsPanelComponent} from '../../../../../base/settings-panel/settings-panel.component';\nimport {DownloadService} from '../../../../../service/download.service';\nimport {getTrailMetaDataById, getTrailsMetaData} from '../../../../../_util/trail-meta';\nimport {ConnectionService} from '../../../../../service/connection.service';\nimport {getConnection, getDialogs, hasDialogs} from '../../../../../_util/cordova';\nimport {Subscription} from 'rxjs';\nimport {VersionResolverService} from '../../../../../service/version-resolver.service';\n\n@Component({\n  selector: 'trail-settings',\n  templateUrl: './trail-settings.component.html',\n  styleUrls: ['./trail-settings.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class TrailSettingsComponent extends SettingsPanelComponent implements OnInit, OnDestroy {\n\n  @ViewChild('trailSelector') trailSelector: ElementRef;\n\n  private _dataTypes = ['trail', 'snow', 'tiles'];\n  public downloaders = [];\n\n  public purchasedTrailList:        Array<TrailMeta> = [];\n  public activeTrail:               TrailMeta;      // meta of the current trail\n\n  // connection type checking\n  public hasInternet: boolean;\n  public hasWifi: boolean;\n  public updates: object = {};                      // update available (accessible by name)\n\n  private _purchasedTrails:         Array<number>;  // ids of all purchased trails\n  private _storedTrailId:           number;         // the current trail ID\n  private _downloadersActive:       boolean;        // are there active downloaders\n\n  public currentVersions: object = {};                   // version data (accessible by name)\n  private _versionSubscriptions: object = {};       // local storage subscriptions\n  private _updateSubscriptions: object = {};       // local storage subscriptions\n\n  constructor(\n    private _versionResolverService:  VersionResolverService,\n    private _changeDetector:        ChangeDetectorRef,\n    private _localStorage:          LocalStorageService,\n    private _downloadService:       DownloadService,\n    private _connectionService:     ConnectionService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n\n    super.ngOnInit();\n\n    const _self = this;\n\n    this._purchasedTrails = this._localStorage.retrieve('purchasedTrails');\n    this.activeTrail = getTrailMetaDataById(this._localStorage.retrieve('activeTrailId') || 0);\n\n    this._downloadService.isDownloadingObservable.subscribe(function(result) {\n      _self._downloadersActive = result;\n    });\n\n    this._generateTrailLists();\n\n    this.hasInternet = (this._connectionService.getStatus() === 'online');\n\n    const _internetType = this._connectionService.getConnectionInfo()['state'];\n    const _connection = getConnection();\n\n    if (_connection) {\n      if (_internetType === _connection.WIFI) {\n        this.hasWifi = true;\n      }\n    }\n\n    this._setupUpdateSubscriptions();\n  }\n\n  ngOnDestroy(): void {\n    super.ngOnDestroy();\n\n    this._removeVersionSubscriptions();\n    this._removeUpdateSubscriptions();\n  }\n\n\n  // SETUP\n\n  private _generateTrailLists(): void {\n\n    const _self = this;\n\n    this.purchasedTrailList = [];\n\n    const _trailData = getTrailsMetaData();\n\n    for (const key in _trailData) {\n      if (_self._purchasedTrails && _self._purchasedTrails.indexOf(_trailData[key].id) !== -1 || _trailData[key].abbr === 'DEMO') {\n        _self.purchasedTrailList.push(_trailData[key]);\n      }\n    }\n  }\n\n\n  private _setupUpdateSubscriptions(): void {\n\n    const _self = this;\n\n    this._removeVersionSubscriptions();\n    this._removeUpdateSubscriptions();\n\n    _self.downloaders = [];\n\n    this._dataTypes.forEach(function(type) {\n      console.log(_self.activeTrail[type + 'Version']);\n      if (_self.activeTrail[type + 'Version']) {\n        _self.downloaders.push(type);\n      }\n    })\n\n    this.downloaders.forEach(function(name) {\n\n      _self._setupVersionSubscription(name);\n      _self._updateSubscriptions[name] = _self._versionResolverService.observables[_self.activeTrail.abbr + '_' + name + 'Available'].subscribe(function(result) {\n        // console.log('VERSION CHANGED UPDATE', name, result);\n        _self.updates[name] = result;\n        _self._changeDetector.detectChanges();\n      });\n    });\n  }\n\n  private _setupVersionSubscription(name: string):void {\n\n    this._versionSubscriptions[name] = this._localStorage.observe(this.activeTrail.abbr + '_' + name + 'Version').subscribe(result => {\n      console.log('VERSION CHANGED', name, result);\n      this.currentVersions[name + 'Version'] = result;\n      this._changeDetector.detectChanges();\n    });\n\n    // set initial value\n    this.currentVersions[name + 'Version'] = this._localStorage.retrieve(this.activeTrail.abbr + '_' + name + 'Version');\n  }\n\n  private _removeVersionSubscriptions(): void {\n    for (const key in this._versionSubscriptions) {\n      let _subscription: Subscription = this._versionSubscriptions[key];\n      if (_subscription) {\n        _subscription.unsubscribe();\n        _subscription = null;\n      }\n    }\n  }\n\n  private _removeUpdateSubscriptions(): void {\n    for (const key in this._updateSubscriptions) {\n      let _subscription: Subscription = this._updateSubscriptions[key];\n      if (_subscription) {\n        _subscription.unsubscribe();\n        _subscription = null;\n      }\n    }\n  }\n\n  // triggered from template\n  public displayVersion(name: string): string {\n    // console.log('base version', name);\n\n    if (this.updates[name]) {\n      // console.log('- from updates', this.activeTrail[name + 'Version']);\n      return this.activeTrail[name + 'Version'];    // the online version\n    } else {\n      // console.log('- from current', this.currentVersions[name + 'Version']);\n      return this.currentVersions[name + 'Version'];      // the installed version\n    }\n  }\n\n  // triggered from template\n  public updateAvailable(name: string): boolean {\n\n    // console.log('updates available', name, this.updates[name]);\n\n    return this.updates[name];\n  }\n\n  // triggered from template\n  public hasFile(name: string): boolean {\n    // console.log('has file', this.currentVersions[name + 'Version']);\n    return (this.currentVersions[name + 'Version'] === this.updates[name + 'Version']);\n  }\n\n\n  // EVENTS\n\n  /* when a new trail is selected\n  * - check for mismatch to current trail\n  * - show a warning if user is still downloading data for the old selected trail\n  * - set new trail and invalidate for reload (in app.component) */\n  public onTrailSelect(event: MatSelectChange): void {\n\n    const _id: number = Number(event.value);\n\n    if (_id !== this._storedTrailId) {\n\n      if (hasDialogs() && this._downloadersActive) {\n\n        const _dialog = getDialogs();\n        _dialog.confirm(\n          'Switching trails cancels all active downloads',\n          this._setActiveTrail.bind(this),\n          'Warning',\n          ['Cancel', 'Continue']\n        );\n\n      } else {\n\n        if (this._downloadersActive) {\n          alert('canceling downloads');\n        }\n        this._setActiveTrail();\n        this._changeDetector.markForCheck();\n      }\n    }\n  }\n\n  // in conjunction with onTrailSelect();\n  private _setActiveTrail(buttonId?: number): void {\n\n    buttonId = buttonId || 2;\n\n    const _currentValue: number = this._storedTrailId;\n    const _newValue: number = this.trailSelector['value'];\n\n    if (buttonId === 2 && _currentValue !== _newValue) {\n      if (this._downloadersActive) {\n\n        // cancels active downloaders and clears data\n        this._downloadService.clearDownloaders(this.activeTrail.abbr, true);\n      }\n      this._storedTrailId = this._localStorage.store('activeTrailId', _newValue);\n      this.activeTrail = getTrailMetaDataById(_newValue);\n\n\n\n      this._setupUpdateSubscriptions();\n\n      super.invalidate();\n    } else {\n      this.trailSelector['value'] = _currentValue;      // reset to old value\n    }\n\n  }\n\n  public onDownloadComplete(type: string): void {\n    console.log(type + 'data downloaded');\n    this._localStorage.store(this.activeTrail.abbr + '_' + type + 'Version', this.activeTrail[type + 'Version']);\n  }\n\n  public onDownloadCleared(type: string): void {\n    console.log('CLEAR');\n    this._localStorage.store(this.activeTrail.abbr + '_' + type + 'Version', 0.1);\n  }\n}\n","module.exports = \"<mat-card id=\\\"user-settings\\\">\\n\\n  <h2>User Settings</h2>\\n\\n  <mat-card-content>\\n\\n    <section>\\n\\n      <mat-form-field id=\\\"user-name\\\">\\n        <input type=\\\"text\\\" matInput placeholder=\\\"name\\\" value=\\\"{{userName}}\\\" (input)=\\\"onUserNameChange($event.target.value)\\\">\\n      </mat-form-field>\\n\\n      <small>ID: {{UUID}}</small>\\n\\n      <mat-form-field class=\\\"direction\\\">\\n        <mat-select placeholder=\\\"direction\\\" [value]=\\\"direction\\\" (selectionChange)=\\\"onDirectionSelect($event)\\\">\\n          <mat-option *ngFor=\\\"let direction of directionList\\\" [value]=\\\"direction.id\\\">\\n            {{direction.label}}\\n          </mat-option>\\n        </mat-select>\\n      </mat-form-field>\\n\\n    </section>\\n\\n  </mat-card-content>\\n\\n</mat-card>\\n\"","module.exports = \":host ::ng-deep #user-name .mat-form-field-wrapper {\\n  padding-bottom: 0 !important; }\\n\\n:host small {\\n  float: right;\\n  margin-bottom: 17.5px;\\n  color: grey; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy91c2VyLXNldHRpbmdzL3VzZXItc2V0dGluZ3MuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUM7RUFHRyw0QkFBNEIsRUFBQTs7QUFHL0I7RUFHRyxZQUFZO0VBQ1oscUJBQXFCO0VBQ3JCLFdBQVcsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3BhbmVscy91c2VyLXNldHRpbmdzL3VzZXItc2V0dGluZ3MuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3QgOjpuZy1kZWVwIHtcblxuICAjdXNlci1uYW1lIC5tYXQtZm9ybS1maWVsZC13cmFwcGVyIHtcbiAgICBwYWRkaW5nLWJvdHRvbTogMCAhaW1wb3J0YW50OyB9IH1cblxuXG4gOmhvc3Qge1xuXG4gIHNtYWxsIHtcbiAgICBmbG9hdDogcmlnaHQ7XG4gICAgbWFyZ2luLWJvdHRvbTogMTcuNXB4O1xuICAgIGNvbG9yOiBncmV5OyB9IH1cbiJdfQ== */\"","import { Component, OnInit } from '@angular/core';\nimport {MatSelectChange} from '@angular/material';\nimport {SettingsPanelComponent} from '../../../../../base/settings-panel/settings-panel.component';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {getUUID} from '../../../../../_util/cordova';\n\n@Component({\n  selector: 'user-settings',\n  templateUrl: './user-settings.component.html',\n  styleUrls: ['./user-settings.component.sass']\n})\nexport class UserSettingsComponent extends SettingsPanelComponent implements OnInit {\n\n  public direction: number;       // 0: NOBO, 1: SOBO\n  public userName: string;\n  public directionList: Array<object> = [{id: 0, label: 'Northbound (NOBO)'}, {id: 1, label: 'Southbound (SOBO)'}];\n  public UUID: string;\n\n  constructor(\n    private _localStorage: LocalStorageService\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    this.direction = this._localStorage.retrieve('direction');\n\n    this.UUID = getUUID();\n\n    const _savedName: string = this._localStorage.retrieve('userName');\n    if (_savedName) {\n      this.userName = _savedName;\n    }\n  }\n\n  public onDirectionSelect(event: MatSelectChange): void {\n\n    this._localStorage.store('direction', event.value);\n\n    if (event.value !== this.direction) {\n      this.invalidate();\n    }\n  }\n\n  public onUserNameChange(username): void {\n    this._localStorage.store('userName', username);\n  }\n\n\n}\n","module.exports = \"  <div id=\\\"center-icon\\\" >\\n    <display-button class=\\\"button\\\" label=\\\"\\\" icon=\\\"{{data['icon']}}\\\" routerLink=\\\"\\\"></display-button>\\n  </div>\\n\\n  <!-- left -->\\n  <div id=\\\"left-panel\\\">\\n\\n    <div id=\\\"setings-meta\\\">\\n      <h1>Settings</h1>\\n      <div mat-dialog-content>\\n        <p>Select a topic below</p>\\n      </div>\\n    </div>\\n\\n    <mat-action-list id=\\\"settings-menu\\\">\\n      <button [disableRipple]=\\\"true\\\" *ngFor=\\\"let item of listItems\\\" mat-list-item (click)=\\\"onClick(item)\\\"> <h2>{{item.title}}</h2><span><fa-icon icon=\\\"angle-right\\\" size=\\\"lg\\\"></fa-icon></span></button>\\n    </mat-action-list>\\n  </div>\\n\\n  <!-- right -->\\n  <div id=\\\"right-panel\\\" #contentPanel>\\n\\n    <!-- purchase / download panel -->\\n    <instructions *ngIf=\\\"!activePanel\\\"></instructions>\\n\\n    <!-- purchase trails -->\\n    <purchase-settings *ngIf=\\\"activePanel === 'purchase'\\\" (onSettingsChanged)=\\\"onSettingsChanged($event)\\\"></purchase-settings>\\n\\n    <!-- trail data -->\\n    <trail-settings *ngIf=\\\"activePanel === 'trail'\\\" (onSettingsChanged)=\\\"onSettingsChanged($event)\\\"></trail-settings>\\n\\n    <!-- user settings -->\\n    <user-settings *ngIf=\\\"activePanel === 'user'\\\" (onSettingsChanged)=\\\"onSettingsChanged($event)\\\"></user-settings>\\n\\n    <!-- general settings panel -->\\n    <general-settings *ngIf=\\\"activePanel === 'general'\\\" (onSettingsChanged)=\\\"onSettingsChanged($event)\\\"></general-settings>\\n\\n    <!-- about panel-->\\n    <about *ngIf=\\\"activePanel === 'about'\\\"></about>\\n\\n  </div>\\n\"","module.exports = \":host ::ng-deep hr {\\n  border: unset;\\n  border-top: 1px solid #CCC; }\\n\\n:host ::ng-deep mat-card h2 {\\n  text-align: center;\\n  margin-bottom: 0 !important; }\\n\\n:host ::ng-deep .input {\\n  display: flex;\\n  flex-direction: column; }\\n\\n:host ::ng-deep .input > * {\\n  width: 100% !important; }\\n\\n:host ::ng-deep mat-form-field, :host ::ng-deep input {\\n  width: 100% !important; }\\n\\n:host ::ng-deep .mat-select, :host ::ng-deep input {\\n  box-sizing: border-box !important;\\n  padding: 0 12px !important;\\n  background-color: #EEE !important;\\n  border-radius: 6px !important;\\n  height: 48px !important;\\n  border: none !important; }\\n\\n:host ::ng-deep .mat-select .mat-select-trigger, :host ::ng-deep input .mat-select-trigger {\\n    height: 48px; }\\n\\n:host ::ng-deep .mat-select .mat-select-trigger .mat-select-value, :host ::ng-deep input .mat-select-trigger .mat-select-value {\\n      vertical-align: middle; }\\n\\n:host ::ng-deep input {\\n  background-color: transparent !important;\\n  border: 2px solid #EEE !important; }\\n\\n:host ::ng-deep .mat-form-field-underline {\\n  display: none; }\\n\\n:host ::ng-deep .mat-form-field-underline .mat-list-item-content {\\n    padding: 0 12px !important;\\n    margin: 0 !important; }\\n\\n:host ::ng-deep mat-radio-button, :host ::ng-deep mat-checkbox {\\n  display: block;\\n  padding: 3px 0 !important;\\n  height: 28px !important; }\\n\\n:host ::ng-deep .mat-radio-container, :host ::ng-deep .mat-radio-outer-circle, :host ::ng-deep .mat-radio-inner-circle, :host ::ng-deep .mat-checkbox-inner-container {\\n  width: 28px !important;\\n  height: 28px !important; }\\n\\n:host ::ng-deep .mat-checkbox-frame, :host ::ng-deep .mat-checkbox-background {\\n  width: 24px !important;\\n  height: 24px !important;\\n  border-radius: 4px !important; }\\n\\n:host #center-icon {\\n  position: absolute;\\n  left: 38.2%;\\n  margin: -3.5vw 0 0 -3.5vw;\\n  z-index: 1000; }\\n\\n:host #center-icon button {\\n    user-focus: none; }\\n\\n:host #left-panel, :host #right-panel {\\n  display: inline-block;\\n  height: 100%; }\\n\\n:host #left-panel {\\n  height: 98%;\\n  width: 38.2%;\\n  vertical-align: bottom;\\n  overflow-y: hidden; }\\n\\n:host #left-panel h1, :host #left-panel h2 {\\n    display: block;\\n    text-align: left;\\n    width: 90%;\\n    white-space: nowrap;\\n    text-overflow: ellipsis;\\n    overflow: hidden; }\\n\\n:host #left-panel h1 {\\n    font-size: 4.2vh;\\n    padding: 0 12px; }\\n\\n:host #left-panel h2 {\\n    font-size: 3.4vh;\\n    font-weight: 300; }\\n\\n:host #left-panel #setings-meta {\\n    background-color: white;\\n    box-sizing: border-box;\\n    height: 25%;\\n    border-bottom: 1px solid #DDD;\\n    overflow: hidden;\\n    text-overflow: ellipsis;\\n    font-size: 3vh; }\\n\\n:host #left-panel #setings-meta .mat-dialog-title {\\n      margin-bottom: 0;\\n      padding-bottom: 0; }\\n\\n:host #left-panel #setings-meta .mat-dialog-content {\\n      display: block; }\\n\\n:host #left-panel #setings-meta .mat-dialog-content p {\\n        display: block;\\n        margin: 0 12px 12px 12px; }\\n\\n:host #left-panel #settings-menu {\\n    height: 75%;\\n    overflow-y: scroll;\\n    padding: 0;\\n    /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#f7f7f7+0,f9f9f9+7 */\\n    background: #f7f7f7;\\n    background: linear-gradient(to bottom, #f7f7f7 0%, #f9f9f9 7%);\\n    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f7f7f7', endColorstr='#f9f9f9',GradientType=0 ); }\\n\\n:host #left-panel #settings-menu button {\\n      border-bottom: 1px solid #EEE;\\n      height: 22.22%; }\\n\\n:host #left-panel #settings-menu span {\\n      display: block;\\n      position: absolute;\\n      right: 0;\\n      padding: 0 12px 0 12px;\\n      vertical-align: center;\\n      color: #CCC; }\\n\\n:host #right-panel {\\n  box-sizing: border-box;\\n  width: 61.8%;\\n  background-color: #EEE;\\n  vertical-align: top;\\n  overflow-y: scroll; }\\n\\n:host #right-panel mat-card {\\n    box-sizing: border-box;\\n    background-color: #97a895;\\n    min-height: 100%;\\n    border: unset;\\n    border-radius: unset; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3NldHRpbmdzLWRpYWxvZy5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLGFBQWE7RUFDYiwwQkFBMEIsRUFBQTs7QUFKN0I7RUFTSyxrQkFBa0I7RUFDbEIsMkJBQTJCLEVBQUE7O0FBVmhDO0VBYUcsYUFBYTtFQUNiLHNCQUFzQixFQUFBOztBQWR6QjtFQWlCRyxzQkFBc0IsRUFBQTs7QUFqQnpCO0VBcUJHLHNCQUFzQixFQUFBOztBQXJCekI7RUF3QkcsaUNBQWlDO0VBQ2pDLDBCQUEwQjtFQUMxQixpQ0FBaUM7RUFDakMsNkJBQTZCO0VBQzdCLHVCQUF1QjtFQUN2Qix1QkFBdUIsRUFBQTs7QUE3QjFCO0lBZ0NLLFlBQVksRUFBQTs7QUFoQ2pCO01BbUNPLHNCQUFzQixFQUFBOztBQW5DN0I7RUFzQ0csd0NBQXdDO0VBQ3hDLGlDQUFpQyxFQUFBOztBQXZDcEM7RUEyQ0csYUFBYSxFQUFBOztBQTNDaEI7SUE4Q0ssMEJBQTBCO0lBQzFCLG9CQUFvQixFQUFBOztBQS9DekI7RUFtREcsY0FBYztFQUNkLHlCQUF5QjtFQUN6Qix1QkFBdUIsRUFBQTs7QUFyRDFCO0VBd0RHLHNCQUFzQjtFQUN0Qix1QkFBdUIsRUFBQTs7QUF6RDFCO0VBNERHLHNCQUFzQjtFQUN0Qix1QkFBdUI7RUFDdkIsNkJBQTZCLEVBQUE7O0FBRWhDO0VBR0csa0JBQWtCO0VBQ2xCLFdBQVc7RUFDWCx5QkFBeUI7RUFDekIsYUFBYSxFQUFBOztBQU5oQjtJQVNLLGdCQUFnQixFQUFBOztBQVRyQjtFQVlHLHFCQUFxQjtFQUNyQixZQUFZLEVBQUE7O0FBYmY7RUFnQkcsV0FBVztFQUNYLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsa0JBQWtCLEVBQUE7O0FBbkJyQjtJQXNCSyxjQUFjO0lBQ2QsZ0JBQWdCO0lBQ2hCLFVBQVU7SUFDVixtQkFBbUI7SUFDbkIsdUJBQXVCO0lBQ3ZCLGdCQUFnQixFQUFBOztBQTNCckI7SUE4QkssZ0JBQWdCO0lBQ2hCLGVBQWUsRUFBQTs7QUEvQnBCO0lBa0NLLGdCQUFnQjtJQUNoQixnQkFBZ0IsRUFBQTs7QUFuQ3JCO0lBc0NLLHVCQUF1QjtJQUN2QixzQkFBc0I7SUFDdEIsV0FBVztJQUNYLDZCQUE2QjtJQUM3QixnQkFBZ0I7SUFDaEIsdUJBQXVCO0lBQ3ZCLGNBQWMsRUFBQTs7QUE1Q25CO01BK0NPLGdCQUFnQjtNQUNoQixpQkFBaUIsRUFBQTs7QUFoRHhCO01BbURPLGNBQWMsRUFBQTs7QUFuRHJCO1FBc0RTLGNBQWM7UUFDZCx3QkFBd0IsRUFBQTs7QUF2RGpDO0lBMERLLFdBQVc7SUFDWCxrQkFBa0I7SUFDbEIsVUFBVTtJQUVWLDhHQUFBO0lBQ0EsbUJBQTRCO0lBRzVCLDhEQUFxRjtJQUNyRixtSEFBbUgsRUFBQTs7QUFuRXhIO01Bc0VPLDZCQUE2QjtNQUM3QixjQUFjLEVBQUE7O0FBdkVyQjtNQTBFTyxjQUFjO01BQ2Qsa0JBQWtCO01BQ2xCLFFBQVE7TUFDUixzQkFBc0I7TUFDdEIsc0JBQXNCO01BQ3RCLFdBQVcsRUFBQTs7QUEvRWxCO0VBa0ZHLHNCQUFzQjtFQUN0QixZQUFZO0VBQ1osc0JBQXNCO0VBQ3RCLG1CQUFtQjtFQUNuQixrQkFBa0IsRUFBQTs7QUF0RnJCO0lBeUZLLHNCQUFzQjtJQUN0Qix5QkFBeUI7SUFDekIsZ0JBQWdCO0lBQ2hCLGFBQWE7SUFDYixvQkFBb0IsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9kaWFsb2cvc2V0dGluZ3MtZGlhbG9nL3NldHRpbmdzLWRpYWxvZy5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCA6Om5nLWRlZXAge1xuXG4gIGhyIHtcbiAgICBib3JkZXI6IHVuc2V0O1xuICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjQ0NDOyB9XG5cbiAgbWF0LWNhcmQge1xuXG4gICAgaDIge1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgbWFyZ2luLWJvdHRvbTogMCAhaW1wb3J0YW50OyB9IH1cblxuICAuaW5wdXQge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgfVxuXG4gIC5pbnB1dCA+ICoge1xuICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7IH1cblxuXG4gIG1hdC1mb3JtLWZpZWxkLCBpbnB1dCB7XG4gICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsgfVxuXG4gIC5tYXQtc2VsZWN0LCBpbnB1dCB7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveCAhaW1wb3J0YW50O1xuICAgIHBhZGRpbmc6IDAgMTJweCAhaW1wb3J0YW50O1xuICAgIGJhY2tncm91bmQtY29sb3I6ICNFRUUgIWltcG9ydGFudDtcbiAgICBib3JkZXItcmFkaXVzOiA2cHggIWltcG9ydGFudDtcbiAgICBoZWlnaHQ6IDQ4cHggIWltcG9ydGFudDtcbiAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDtcblxuICAgIC5tYXQtc2VsZWN0LXRyaWdnZXIge1xuICAgICAgaGVpZ2h0OiA0OHB4O1xuXG4gICAgICAubWF0LXNlbGVjdC12YWx1ZSB7XG4gICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IH0gfSB9IC8vIHVzZXMgdGFibGUtY2VsbFxuXG4gIGlucHV0IHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50O1xuICAgIGJvcmRlcjogMnB4IHNvbGlkICNFRUUgIWltcG9ydGFudDsgfVxuXG5cbiAgLm1hdC1mb3JtLWZpZWxkLXVuZGVybGluZSB7XG4gICAgZGlzcGxheTogbm9uZTtcblxuICAgIC5tYXQtbGlzdC1pdGVtLWNvbnRlbnQge1xuICAgICAgcGFkZGluZzogMCAxMnB4ICFpbXBvcnRhbnQ7XG4gICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsgfSB9XG5cbiAgLy8gcmFkaW8gYnV0dG9uICYgY2hlY2tib3hcbiAgbWF0LXJhZGlvLWJ1dHRvbiwgbWF0LWNoZWNrYm94IHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBwYWRkaW5nOiAzcHggMCAhaW1wb3J0YW50O1xuICAgIGhlaWdodDogMjhweCAhaW1wb3J0YW50OyB9XG5cbiAgLm1hdC1yYWRpby1jb250YWluZXIsIC5tYXQtcmFkaW8tb3V0ZXItY2lyY2xlLCAubWF0LXJhZGlvLWlubmVyLWNpcmNsZSwgLm1hdC1jaGVja2JveC1pbm5lci1jb250YWluZXIge1xuICAgIHdpZHRoOiAyOHB4ICFpbXBvcnRhbnQ7XG4gICAgaGVpZ2h0OiAyOHB4ICFpbXBvcnRhbnQ7IH1cblxuICAubWF0LWNoZWNrYm94LWZyYW1lLCAubWF0LWNoZWNrYm94LWJhY2tncm91bmQge1xuICAgIHdpZHRoOiAyNHB4ICFpbXBvcnRhbnQ7XG4gICAgaGVpZ2h0OiAyNHB4ICFpbXBvcnRhbnQ7XG4gICAgYm9yZGVyLXJhZGl1czogNHB4ICFpbXBvcnRhbnQ7IH0gfVxuXG4gOmhvc3Qge1xuXG4gICNjZW50ZXItaWNvbiB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIGxlZnQ6IDM4LjIlO1xuICAgIG1hcmdpbjogLTMuNXZ3IDAgMCAtMy41dnc7XG4gICAgei1pbmRleDogMTAwMDtcblxuICAgIGJ1dHRvbiB7XG4gICAgICB1c2VyLWZvY3VzOiBub25lOyB9IH1cblxuICAjbGVmdC1wYW5lbCwgI3JpZ2h0LXBhbmVsIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgaGVpZ2h0OiAxMDAlOyB9XG5cbiAgI2xlZnQtcGFuZWwge1xuICAgIGhlaWdodDogOTglO1xuICAgIHdpZHRoOiAzOC4yJTtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xuICAgIG92ZXJmbG93LXk6IGhpZGRlbjtcblxuICAgIGgxLCBoMiB7XG4gICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgICB3aWR0aDogOTAlO1xuICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsgfVxuXG4gICAgaDEge1xuICAgICAgZm9udC1zaXplOiA0LjJ2aDtcbiAgICAgIHBhZGRpbmc6IDAgMTJweDsgfVxuXG4gICAgaDIge1xuICAgICAgZm9udC1zaXplOiAzLjR2aDtcbiAgICAgIGZvbnQtd2VpZ2h0OiAzMDA7IH1cblxuICAgICNzZXRpbmdzLW1ldGEge1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgaGVpZ2h0OiAyNSU7XG4gICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0RERDtcbiAgICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgICAgIGZvbnQtc2l6ZTogM3ZoO1xuXG4gICAgICAubWF0LWRpYWxvZy10aXRsZSB7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDA7XG4gICAgICAgIHBhZGRpbmctYm90dG9tOiAwOyB9XG5cbiAgICAgIC5tYXQtZGlhbG9nLWNvbnRlbnQge1xuICAgICAgICBkaXNwbGF5OiBibG9jaztcblxuICAgICAgICBwIHtcbiAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICBtYXJnaW46IDAgMTJweCAxMnB4IDEycHg7IH0gfSB9XG5cbiAgICAjc2V0dGluZ3MtbWVudSB7XG4gICAgICBoZWlnaHQ6IDc1JTtcbiAgICAgIG92ZXJmbG93LXk6IHNjcm9sbDtcbiAgICAgIHBhZGRpbmc6IDA7XG5cbiAgICAgIC8qIFBlcm1hbGluayAtIHVzZSB0byBlZGl0IGFuZCBzaGFyZSB0aGlzIGdyYWRpZW50OiBodHRwOi8vY29sb3J6aWxsYS5jb20vZ3JhZGllbnQtZWRpdG9yLyNmN2Y3ZjcrMCxmOWY5ZjkrNyAqL1xuICAgICAgYmFja2dyb3VuZDogcmdiKDI0NywyNDcsMjQ3KSAvKiBPbGQgYnJvd3NlcnMgKi87XG4gICAgICBiYWNrZ3JvdW5kOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsIHJnYmEoMjQ3LDI0NywyNDcsMSkgMCUsIHJnYmEoMjQ5LDI0OSwyNDksMSkgNyUpIC8qIEZGMy42LTE1ICovO1xuICAgICAgYmFja2dyb3VuZDogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCByZ2JhKDI0NywyNDcsMjQ3LDEpIDAlLHJnYmEoMjQ5LDI0OSwyNDksMSkgNyUpIC8qIENocm9tZTEwLTI1LFNhZmFyaTUuMS02ICovO1xuICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgcmdiYSgyNDcsMjQ3LDI0NywxKSAwJSxyZ2JhKDI0OSwyNDksMjQ5LDEpIDclKSAvKiBXM0MsIElFMTArLCBGRjE2KywgQ2hyb21lMjYrLCBPcGVyYTEyKywgU2FmYXJpNysgKi87XG4gICAgICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudCggc3RhcnRDb2xvcnN0cj0nI2Y3ZjdmNycsIGVuZENvbG9yc3RyPScjZjlmOWY5JyxHcmFkaWVudFR5cGU9MCApIC8qIElFNi05ICovO1xuXG4gICAgICBidXR0b24ge1xuICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0VFRTtcbiAgICAgICAgaGVpZ2h0OiAyMi4yMiU7IH1cblxuICAgICAgc3BhbiB7XG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHJpZ2h0OiAwO1xuICAgICAgICBwYWRkaW5nOiAwIDEycHggMCAxMnB4O1xuICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogY2VudGVyO1xuICAgICAgICBjb2xvcjogI0NDQzsgfSB9IH1cblxuICAjcmlnaHQtcGFuZWwge1xuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgd2lkdGg6IDYxLjglO1xuICAgIGJhY2tncm91bmQtY29sb3I6ICNFRUU7XG4gICAgdmVydGljYWwtYWxpZ246IHRvcDtcbiAgICBvdmVyZmxvdy15OiBzY3JvbGw7XG5cbiAgICBtYXQtY2FyZCB7XG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzk3YTg5NTtcbiAgICAgIG1pbi1oZWlnaHQ6IDEwMCU7XG4gICAgICBib3JkZXI6IHVuc2V0O1xuICAgICAgYm9yZGVyLXJhZGl1czogdW5zZXQ7IH0gfSB9XG4iXX0= */\"","import {Component, ElementRef, Inject, OnInit, ViewChild} from '@angular/core';\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material';\n\n@Component({\n  selector: 'settings-dialog',\n  templateUrl: './settings-dialog.component.html',\n  styleUrls: ['./settings-dialog.component.sass']\n})\nexport class SettingsDialogComponent implements OnInit {\n\n  @ViewChild('contentPanel') contentPanel: ElementRef;\n\n  public listItems: Array<object> = [\n    {title: 'Purchase', panel: 'purchase'},\n    {title: 'Download', panel: 'trail'},\n    {title: 'User', panel: 'user'},\n    {title: 'Application', panel: 'general'},\n    {title: 'About', panel: 'about'}\n  ];\n\n  public activePanel: string;\n  private _settingsChanged: boolean = false;\n\n  constructor(\n    private _dialogRef: MatDialogRef<SettingsDialogComponent>,\n    @Inject(MAT_DIALOG_DATA) public data: object\n  ) {\n\n    _dialogRef.disableClose = true; // disable default close operation\n\n    if (_dialogRef.backdropClick) {\n        _dialogRef.backdropClick().subscribe(result => {\n        _dialogRef.close(this._settingsChanged);\n      });\n    }\n  }\n\n  ngOnInit(): void {}\n\n  public onClick(item): void {\n    this.activePanel = item.panel;\n    this.contentPanel.nativeElement.scrollTo(0, 0);\n  }\n\n  // only triggered if true\n  public onSettingsChanged(event): void {\n    this._settingsChanged = event;\n  }\n}\n","module.exports = \"<virtual-list-component id=\\\"elevation-profile-list\\\" [trailData]=\\\"trailData\\\" (scrollEvent)=\\\"onScroll($event)\\\" (resizeEvent)=\\\"onResize($event)\\\" [scrollTo]=\\\"scrollTo\\\"></virtual-list-component>\\n<scrollbar-component [trailData]=\\\"trailData\\\" [visibleRange]=\\\"visibleRange\\\" [resize]=\\\"resize\\\" (scrollToEvent)=\\\"onScrollTo($event)\\\"></scrollbar-component>\\n\"","module.exports = \":host .cdk-virtual-scroll-orientation-horizontal, :host .cdk-virtual-scroll-content-wrapper, :host .cdk-virtual-scroll-viewport {\\n  display: block; }\\n\\n:host .cdk-virtual-scroll-orientation-horizontal {\\n  padding-bottom: 25px;\\n  height: 90vh; }\\n\\n:host /deep/ .fa-marker {\\n  color: white; }\\n\\n:host /deep/ .tree-marker {\\n  color: rgba(224, 223, 213, 0.65); }\\n\\n:host /deep/ #wrap {\\n  /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#c7e2ed+0,eeeeee+50,eeeeee+77,e9e1d2+78,b8cbb5+100&1+0,1+77,0.65+78,1+100 */\\n  background: linear-gradient(to bottom, #c7e2ed 0%, #eeeeee 50%, #eeeeee 77%, rgba(233, 225, 210, 0.65) 78%, #b8cbb5 100%);\\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c7e2ed', endColorstr='#b8cbb5',GradientType=0 ); }\\n\\n:host /deep/ .marker-container {\\n  overflow: visible !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS9lbGV2YXRpb24tcHJvZmlsZS5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUVHLGNBQWMsRUFBQTs7QUFGakI7RUFLRyxvQkFBb0I7RUFDcEIsWUFBWSxFQUFBOztBQUdmO0VBR0csWUFBWSxFQUFBOztBQUhmO0VBTUcsZ0NBQTZCLEVBQUE7O0FBTmhDO0VBU0cscUtBQUE7RUFHQSx5SEFBa0s7RUFDbEssbUhBQW1ILEVBQUE7O0FBYnRIO0VBZ0JHLDRCQUE0QixFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2VsZXZhdGlvbi1wcm9maWxlL2VsZXZhdGlvbi1wcm9maWxlLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IHtcbiAgLmNkay12aXJ0dWFsLXNjcm9sbC1vcmllbnRhdGlvbi1ob3Jpem9udGFsLCAuY2RrLXZpcnR1YWwtc2Nyb2xsLWNvbnRlbnQtd3JhcHBlciwgLmNkay12aXJ0dWFsLXNjcm9sbC12aWV3cG9ydCB7XG4gICAgZGlzcGxheTogYmxvY2s7IH1cblxuICAuY2RrLXZpcnR1YWwtc2Nyb2xsLW9yaWVudGF0aW9uLWhvcml6b250YWwge1xuICAgIHBhZGRpbmctYm90dG9tOiAyNXB4O1xuICAgIGhlaWdodDogOTB2aDsgfSB9XG5cbi8vIFRPRE8gbW92ZSB0aGlzP1xuIDpob3N0IC9kZWVwLyB7XG5cbiAgLmZhLW1hcmtlciB7XG4gICAgY29sb3I6IHdoaXRlOyB9XG5cbiAgLnRyZWUtbWFya2VyIHtcbiAgICBjb2xvcjogcmdiYSgyMjQsMjIzLDIxMywwLjY1KTsgfVxuXG4gICN3cmFwIHtcbiAgICAvKiBQZXJtYWxpbmsgLSB1c2UgdG8gZWRpdCBhbmQgc2hhcmUgdGhpcyBncmFkaWVudDogaHR0cDovL2NvbG9yemlsbGEuY29tL2dyYWRpZW50LWVkaXRvci8jYzdlMmVkKzAsZWVlZWVlKzUwLGVlZWVlZSs3NyxlOWUxZDIrNzgsYjhjYmI1KzEwMCYxKzAsMSs3NywwLjY1Kzc4LDErMTAwICovXG4gICAgYmFja2dyb3VuZDogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCByZ2JhKDE5OSwyMjYsMjM3LDEpIDAlLCByZ2JhKDIzOCwyMzgsMjM4LDEpIDUwJSwgcmdiYSgyMzgsMjM4LDIzOCwxKSA3NyUsIHJnYmEoMjMzLDIyNSwyMTAsMC42NSkgNzglLCByZ2JhKDE4NCwyMDMsMTgxLDEpIDEwMCUpIC8qIEZGMy42LTE1ICovO1xuICAgIGJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgcmdiYSgxOTksMjI2LDIzNywxKSAwJSxyZ2JhKDIzOCwyMzgsMjM4LDEpIDUwJSxyZ2JhKDIzOCwyMzgsMjM4LDEpIDc3JSxyZ2JhKDIzMywyMjUsMjEwLDAuNjUpIDc4JSxyZ2JhKDE4NCwyMDMsMTgxLDEpIDEwMCUpIC8qIENocm9tZTEwLTI1LFNhZmFyaTUuMS02ICovO1xuICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sIHJnYmEoMTk5LDIyNiwyMzcsMSkgMCUscmdiYSgyMzgsMjM4LDIzOCwxKSA1MCUscmdiYSgyMzgsMjM4LDIzOCwxKSA3NyUscmdiYSgyMzMsMjI1LDIxMCwwLjY1KSA3OCUscmdiYSgxODQsMjAzLDE4MSwxKSAxMDAlKSAvKiBXM0MsIElFMTArLCBGRjE2KywgQ2hyb21lMjYrLCBPcGVyYTEyKywgU2FmYXJpNysgKi87XG4gICAgZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoIHN0YXJ0Q29sb3JzdHI9JyNjN2UyZWQnLCBlbmRDb2xvcnN0cj0nI2I4Y2JiNScsR3JhZGllbnRUeXBlPTAgKSAvKiBJRTYtOSAqLzsgfVxuXG4gIC5tYXJrZXItY29udGFpbmVyIHtcbiAgICBvdmVyZmxvdzogdmlzaWJsZSAhaW1wb3J0YW50OyB9IH1cbiJdfQ== */\"","import {Component, OnDestroy, OnInit} from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { Trail } from '../../type/trail';\nimport {Snow} from '../../type/snow';\nimport {LoaderService} from '../../service/loader.service';\nimport {BaseComponent} from '../../base/base/base.component';\nimport {ConnectionService} from '../../service/connection.service';\nimport {RateService} from '../../service/rate.service';\n\n@Component({\n  selector: 'app-elevation-profile',\n  templateUrl: './elevation-profile.component.html',\n  styleUrls: ['./elevation-profile.component.sass']\n})\nexport class ElevationProfileComponent extends BaseComponent implements OnInit {\n\n  public visibleRange:  object;\n  public resize:        object;\n  public scrollTo:      number;\n\n  public trailData: Trail;\n  public snowData: Snow;\n\n  constructor(\n    private _route: ActivatedRoute,\n    private _loaderOverlay: LoaderService) {\n    super();\n  }\n\n  ngOnInit(): void {\n    this.addSubscription('routeData', this._route.data.subscribe(result => {\n        this.trailData = result.data['trail'];\n        this.snowData = result.data['snow'];\n        this._loaderOverlay.hideOverlay();\n      }\n    ));\n  }\n\n  // EVENT HANDLERS\n\n  public onScroll(response: object): void {\n    this.visibleRange = response;\n  }\n\n  public onResize(response: object): void {\n    this.resize = response;\n  }\n\n  public onScrollTo(response: number): void {\n    this.scrollTo = response;\n  }\n}\n\n\n","module.exports = \"<!--<button id=\\\"left\\\" (click)=\\\"onPan('backward')\\\">back</button>-->\\n\\n<div id=\\\"main\\\" #main>\\n\\n  <div id=\\\"scroll-map\\\" (click)=\\\"onClick($event)\\\" [ngStyle]=\\\"{'left': -mapOffset + 'px'}\\\"></div>\\n\\n  <div class=\\\"viewport-wrapper\\\" [ngStyle]=\\\"{'padding-left': viewportOffset + 'px'}\\\">\\n    <div class=\\\"viewport\\\" [ngStyle]=\\\"{'width': viewportSize + 'px'}\\\" #viewport></div>\\n  </div>\\n\\n</div>\\n\\n<!--<button id=\\\"right\\\" (click)=\\\"onPan('forward')\\\">forw</button>-->\\n\"","module.exports = \":host {\\n  display: block;\\n  position: absolute;\\n  box-sizing: border-box;\\n  bottom: 0;\\n  left: 0;\\n  width: 100vw;\\n  height: 10vh;\\n  border-top: 1px solid #999;\\n  /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#b2b2b2+0,dddddd+5 */\\n  background: #b2b2b2;\\n  /* Old browsers */\\n  /* FF3.6-15 */\\n  /* Chrome10-25,Safari5.1-6 */\\n  background: linear-gradient(to bottom, #b2b2b2 0%, #dddddd 5%);\\n  /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b2b2b2', endColorstr='#dddddd',GradientType=0 );\\n  /* IE6-9 */\\n  display: inline-grid;\\n  grid-template-columns: 0 100% 0;\\n  grid-template-areas: 'leftbutton main rightbutton';\\n  overflow: hidden; }\\n\\n#main {\\n  grid-area: main;\\n  height: 10vh; }\\n\\n#main #scroll-map {\\n    position: absolute;\\n    left: 0;\\n    -webkit-filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.25));\\n            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.25));\\n    height: 100%; }\\n\\n#main .viewport-wrapper {\\n    grid-area: main;\\n    pointer-events: none;\\n    display: block;\\n    box-sizing: border-box;\\n    position: absolute;\\n    height: 10vh;\\n    overflow-x: visible;\\n    width: 100vw;\\n    z-index: 100;\\n    left: 0;\\n    top: 0;\\n    transition: padding-left 0.05s;\\n    overflow-x: visible; }\\n\\n#main .viewport-wrapper .viewport {\\n      pointer-events: none;\\n      position: absolute;\\n      box-sizing: border-box;\\n      width: 100%;\\n      background-color: rgba(172, 204, 229, 0.25);\\n      height: 100%;\\n      border: solid #AAA;\\n      border-width: 0 1px 0 1px;\\n      transition: width 0.25s; }\\n\\n#left {\\n  grid-area: leftbutton; }\\n\\n#right {\\n  grid-area: rightbutton; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS9zY3JvbGxiYXIvc2Nyb2xsYmFyLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFDO0VBQ0MsY0FBYztFQUNkLGtCQUFrQjtFQUNsQixzQkFBc0I7RUFDdEIsU0FBUztFQUNULE9BQU87RUFDUCxZQUFZO0VBQ1osWUFBWTtFQUVaLDBCQUEwQjtFQUMxQiw4R0FBQTtFQUNBLG1CQUFtQjtFQUFFLGlCQUFBO0VBQzBDLGFBQUE7RUFDRSw0QkFBQTtFQUNqRSw4REFBNkQ7RUFBRSxxREFBQTtFQUMvRCxtSEFBbUg7RUFBRSxVQUFBO0VBQ3JILG9CQUFvQjtFQUNwQiwrQkFBK0I7RUFDL0Isa0RBQWtEO0VBQ2xELGdCQUFnQixFQUFBOztBQUVsQjtFQUNFLGVBQWU7RUFDZixZQUFZLEVBQUE7O0FBRmQ7SUFLSSxrQkFBa0I7SUFDbEIsT0FBTztJQUNQLCtEQUFvRDtZQUFwRCx1REFBb0Q7SUFDcEQsWUFBWSxFQUFBOztBQVJoQjtJQVdJLGVBQWU7SUFDZixvQkFBb0I7SUFDcEIsY0FBYztJQUNkLHNCQUFzQjtJQUN0QixrQkFBa0I7SUFDbEIsWUFBWTtJQUNaLG1CQUFtQjtJQUNuQixZQUFZO0lBQ1osWUFBWTtJQUNaLE9BQU87SUFDUCxNQUFNO0lBRU4sOEJBQThCO0lBQzlCLG1CQUFtQixFQUFBOztBQXhCdkI7TUE0Qk0sb0JBQW9CO01BQ3BCLGtCQUFrQjtNQUNsQixzQkFBc0I7TUFDdEIsV0FBVztNQUNYLDJDQUF3QztNQUN4QyxZQUFZO01BRVosa0JBQWtCO01BQ2xCLHlCQUF5QjtNQUV6Qix1QkFBdUIsRUFBQTs7QUFFN0I7RUFDRSxxQkFBcUIsRUFBQTs7QUFFdkI7RUFDRSxzQkFBc0IsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS9zY3JvbGxiYXIvc2Nyb2xsYmFyLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgYm90dG9tOiAwO1xuICBsZWZ0OiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTB2aDtcbiAgLy9wYWRkaW5nLXRvcDogMTBweFxuICBib3JkZXItdG9wOiAxcHggc29saWQgIzk5OTtcbiAgLyogUGVybWFsaW5rIC0gdXNlIHRvIGVkaXQgYW5kIHNoYXJlIHRoaXMgZ3JhZGllbnQ6IGh0dHA6Ly9jb2xvcnppbGxhLmNvbS9ncmFkaWVudC1lZGl0b3IvI2IyYjJiMiswLGRkZGRkZCs1ICovXG4gIGJhY2tncm91bmQ6ICNiMmIyYjI7IC8qIE9sZCBicm93c2VycyAqLztcbiAgYmFja2dyb3VuZDogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAjYjJiMmIyIDAlLCAjZGRkZGRkIDUlKTsgLyogRkYzLjYtMTUgKi87XG4gIGJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgI2IyYjJiMiAwJSwjZGRkZGRkIDUlKTsgLyogQ2hyb21lMTAtMjUsU2FmYXJpNS4xLTYgKi87XG4gIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICNiMmIyYjIgMCUsI2RkZGRkZCA1JSk7IC8qIFczQywgSUUxMCssIEZGMTYrLCBDaHJvbWUyNissIE9wZXJhMTIrLCBTYWZhcmk3KyAqLztcbiAgZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoIHN0YXJ0Q29sb3JzdHI9JyNiMmIyYjInLCBlbmRDb2xvcnN0cj0nI2RkZGRkZCcsR3JhZGllbnRUeXBlPTAgKTsgLyogSUU2LTkgKi87XG4gIGRpc3BsYXk6IGlubGluZS1ncmlkO1xuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDAgMTAwJSAwO1xuICBncmlkLXRlbXBsYXRlLWFyZWFzOiAnbGVmdGJ1dHRvbiBtYWluIHJpZ2h0YnV0dG9uJztcbiAgb3ZlcmZsb3c6IGhpZGRlbjsgfVxuXG4jbWFpbiB7XG4gIGdyaWQtYXJlYTogbWFpbjtcbiAgaGVpZ2h0OiAxMHZoO1xuXG4gICNzY3JvbGwtbWFwIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgbGVmdDogMDtcbiAgICBmaWx0ZXI6IGRyb3Atc2hhZG93KDAgMCAxMHB4IHJnYmEoMjU1LDI1NSwyNTUsMC4yNSkpO1xuICAgIGhlaWdodDogMTAwJTsgfVxuXG4gIC52aWV3cG9ydC13cmFwcGVyIHtcbiAgICBncmlkLWFyZWE6IG1haW47XG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgaGVpZ2h0OiAxMHZoO1xuICAgIG92ZXJmbG93LXg6IHZpc2libGU7XG4gICAgd2lkdGg6IDEwMHZ3O1xuICAgIHotaW5kZXg6IDEwMDtcbiAgICBsZWZ0OiAwO1xuICAgIHRvcDogMDtcbiAgICAtd2Via2l0LXRyYW5zaXRpb246IHBhZGRpbmctbGVmdCAwLjA1cyAvKiBTYWZhcmkgKi87XG4gICAgdHJhbnNpdGlvbjogcGFkZGluZy1sZWZ0IDAuMDVzO1xuICAgIG92ZXJmbG93LXg6IHZpc2libGU7XG4gICAgLy9iYWNrZ3JvdW5kLWNvbG9yOiByZWRcblxuICAgIC52aWV3cG9ydCB7XG4gICAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgICB3aWR0aDogMTAwJTtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMTcyLDIwNCwyMjksMC4yNSk7XG4gICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAvL2JvcmRlci1yYWRpdXM6IDNweFxuICAgICAgYm9yZGVyOiBzb2xpZCAjQUFBO1xuICAgICAgYm9yZGVyLXdpZHRoOiAwIDFweCAwIDFweDtcbiAgICAgIC13ZWJraXQtdHJhbnNpdGlvbjogd2lkdGggMC4yNXMgLyogU2FmYXJpICovO1xuICAgICAgdHJhbnNpdGlvbjogd2lkdGggMC4yNXM7IH0gfSB9XG5cbiNsZWZ0IHtcbiAgZ3JpZC1hcmVhOiBsZWZ0YnV0dG9uOyB9XG5cbiNyaWdodCB7XG4gIGdyaWQtYXJlYTogcmlnaHRidXR0b247IH1cbiJdfQ== */\"","import {Component, Input, OnInit, OnChanges, ElementRef, SimpleChanges, Output,\n  EventEmitter, ViewChild, AfterViewInit} from '@angular/core';\nimport {Waypoint} from '../../../type/waypoint';\nimport {environment} from '../../../../environments/environment.prod';\nimport * as Hammer from 'hammerjs/hammer.min';\nimport {Mile} from '../../../type/mile';\nimport {Trail} from '../../../type/trail';\nimport {normalizeElevation} from '../../../_util/trail';\ndeclare const SVG: any;    // fixed SVG installation bug\n\n@Component({\n  selector: 'scrollbar-component',\n  templateUrl: './scrollbar.component.html',\n  styleUrls: ['./scrollbar.component.sass'],\n  // changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ScrollbarComponent implements OnInit, AfterViewInit, OnChanges {\n\n  @ViewChild('main') main: ElementRef;\n  @ViewChild('viewport') viewport: ElementRef;\n\n  @Input() trailData:       Trail;\n  @Input() visibleRange:    object;\n  @Input() resize:          object;\n\n  @Output() scrollToEvent: EventEmitter<number> = new EventEmitter<number>();\n\n  public viewportSize = 0;\n  public viewportOffset = 0;\n  public mapOffset: number;\n\n  private _verticalPadding = 8;\n  private _svgCanvas;\n  private _svgWidth:        number;\n  private _svgHeight:       number;\n  private _segments:        number;\n  private _sectionLength:   number;\n\n  private _flatWaypoints:   Array<Waypoint>;\n\n\n  constructor() {}\n\n\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n    const sliderManager = new Hammer.Manager(this.main.nativeElement);\n    sliderManager.add(new Hammer.Pan({threshold: 0, pointers: 0, direction: Hammer.DIRECTION_HORIZONTAL}));\n    sliderManager.on('pan', this._onSlide.bind(this));\n  }\n\n  ngAfterViewInit(): void {\n\n    const _self = this;\n\n    if (!this.trailData) {\n      return;\n    }\n\n    // convert mile data to flat waypoints\n    this._flatWaypoints = [];\n    const _milesCount: number = this.trailData.miles.length;\n    this.trailData.miles.forEach(function(mile: Mile, index) {\n\n      // remove overlapping first and last point\n      if (index !== 0 || index !== _milesCount - 1) {\n        const _waypointsSection = mile.waypoints.slice(1, mile.waypoints.length - 1);\n        _self._flatWaypoints = _self._flatWaypoints.concat(_waypointsSection);\n      } else {\n        _self._flatWaypoints = _self._flatWaypoints.concat(mile.waypoints);\n      }\n    });\n\n    // show 100 miles\n    this._sectionLength = this.trailData.scrollbarSegmentSize;\n\n    this._segments = (Math.ceil(this.trailData.length) / this._sectionLength < 1) ? 1 : Math.ceil(this.trailData.length) / this._sectionLength;\n\n    this._svgWidth =  this._segments * this.main.nativeElement.clientWidth;\n    this._svgHeight =  this.main.nativeElement.clientHeight;\n\n    this._svgCanvas = SVG('scroll-map')\n      .size(this._svgWidth, this._svgHeight)\n      .viewbox(0, 0, this._svgWidth, this._svgHeight);\n\n    this._drawMap();\n    this._drawGuides();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (changes.visibleRange && changes.visibleRange.currentValue) {\n\n      this.visibleRange = changes.visibleRange;\n      const _start: number = this.visibleRange['currentValue']['visibleRange'].start;\n      const _end: number = this.visibleRange['currentValue']['visibleRange'].end;\n      const _range: number = _end - _start;\n      const _scrollX: number = this.visibleRange['currentValue']['scrollX'];\n\n      // map\n      const _maxOffset = this._svgWidth - this.main.nativeElement.clientWidth;\n      const _mileWidth = this.main.nativeElement.clientWidth / 4.5;\n      const _scrollXPerc = (_scrollX / _mileWidth) / this.trailData.miles.length;\n      this.mapOffset = (_scrollXPerc * _maxOffset);\n\n      // viewport\n      const _viewPortWidthPerc = _range / this._sectionLength;\n      const _viewPortWidth = _viewPortWidthPerc * this.main.nativeElement.clientWidth;\n\n      // todo: not sure why this is...\n      let _maxViewPortOffset = this.main.nativeElement.clientWidth;\n      if (this.trailData.abbr !== 'DEMO') {\n        _maxViewPortOffset = this.main.nativeElement.clientWidth - _viewPortWidth;\n      }\n\n      this.viewportOffset = (_scrollXPerc * (_maxViewPortOffset + 5));\n      this.viewportSize = _viewPortWidth;\n    }\n\n    if (changes.resize) {\n\n      this._svgWidth = this._segments * this.main.nativeElement.clientWidth;\n      this._svgHeight = this.main.nativeElement.clientHeight;\n\n      // update svg size\n      if (this._svgCanvas) {\n        const svg = window.document.getElementById(this._svgCanvas.node.id);\n        if (svg) {\n          svg.setAttribute('viewBox', '0 0 ' + this._svgWidth + ' ' + this._svgHeight + '');\n          svg.setAttribute('width', this._svgWidth + '');\n          svg.setAttribute('height', this._svgHeight + '');\n        }\n      }\n\n      if (this.visibleRange) {\n        this._drawMap();\n        this._drawGuides();\n      }\n    }\n  }\n\n\n\n\n  // DRAW\n\n  private _drawMap(): void {\n\n    const min: number = Number(this.trailData.elevationRange.low) / environment.FOOT;\n    const max: number = Number(this.trailData.elevationRange.high) / environment.FOOT;\n    let elevation: number;\n\n    const drawPoints: Array<any> = [];\n\n    let counter = 0;\n\n    const range = (max - min);\n\n    const l = (this._svgWidth / this._flatWaypoints.length);\n\n    // start points\n    drawPoints.push([0, max]);\n    elevation = this._invertValue(normalizeElevation(this._svgHeight - (this._verticalPadding * 2)\n      , this._flatWaypoints[0]['elevation'], min, range, this._verticalPadding));\n\n    drawPoints.push([0, elevation]);\n\n    let prevPoint: object;\n    let totalDistancePerc = 0;\n\n    for (let i = 0; i < this._flatWaypoints.length; i += Math.round(this.trailData.scrollbarSegmentSize / 10)) {\n\n      const waypoint: Waypoint = this._flatWaypoints[i];\n\n      // calculate distance, starting at 2nd point\n      if (counter > 0) {\n        totalDistancePerc = (waypoint.distanceTotal / environment.MILE) / this.trailData.length;\n      }\n\n      elevation = this._invertValue(normalizeElevation(this._svgHeight - (this._verticalPadding * 2)\n        , waypoint.elevation, min, range, this._verticalPadding));\n\n      drawPoints.push([this._svgWidth * totalDistancePerc, elevation]);\n      counter += l;\n      prevPoint = waypoint;\n    }\n\n    // fill til end, back down to 0\n    drawPoints.push([this._svgWidth, elevation]);\n    drawPoints.push([this._svgWidth, max]);\n\n    if (this._svgCanvas) {\n      this._svgCanvas.clear();\n    }\n\n    const polyline = this._svgCanvas.polyline(drawPoints).fill('#C3C3C3');\n  }\n\n  private _drawGuides(): void {\n\n    for (let i = 1; i < Math.ceil(this._segments) * 5; i++) {\n      const line = this._svgCanvas.line((this.main.nativeElement.clientWidth / 5) * i, 0, (this.main.nativeElement.clientWidth / 5) * i, this._svgHeight).stroke({ width: 1, color: '#AAA', opacity: '0.85', dasharray: '2, 2'});\n    }\n\n  }\n\n  // svg draws from lop to bottom\n  private _invertValue(input): number {\n    return Math.abs(input - 1) + this._verticalPadding;\n  }\n\n\n\n  // EVENT HANDLERS\n\n  public onClick(event: MouseEvent): void {\n\n    const percent = (event.clientX + this.mapOffset) / this._svgWidth;\n    this.scrollToEvent.emit(percent);\n  }\n\n  // fast scrolling\n  private _onSlide(event): void {\n\n    // support touch events and mouse events\n    const _xPos: number = event.srcEvent.x || event.srcEvent.pageX || 0;\n    const percent = _xPos / this.main.nativeElement.clientWidth;\n    this.scrollToEvent.emit(percent);\n  }\n\n}\n","module.exports = \"<div *ngFor=\\\"let guide of processedGuides\\\" [ngStyle]=\\\"{'margin-top': guide.offset + 'px', 'border-color': guide.color}\\\" class=\\\"guide\\\"></div>\\n\"","module.exports = \":host {\\n  display: block;\\n  position: fixed;\\n  top: 10vh;\\n  left: 0;\\n  height: 60vh;\\n  width: 100%;\\n  margin: 0;\\n  padding: 0;\\n  overflow-y: visible;\\n  pointer-events: none;\\n  z-index: 100; }\\n  :host .guide {\\n    position: absolute;\\n    white-space: nowrap;\\n    left: 0;\\n    margin: 0;\\n    padding: 0;\\n    box-sizing: border-box;\\n    border-top: 1px solid;\\n    width: 100%;\\n    transition: margin-top 0.1s linear; }\\n  :host .guide .max {\\n      top: -19px; }\\n  :host .guide:first-child {\\n    border-top: 2px dashed; }\\n  :host .guide:last-child {\\n    border-top: 2px dashed; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS92aXJ0dWFsLWxpc3QvZ3VpZGVzL2d1aWRlcy5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUNDLGNBQWM7RUFDZCxlQUFlO0VBQ2YsU0FBUztFQUNULE9BQU87RUFDUCxZQUFZO0VBQ1osV0FBVztFQUNYLFNBQVM7RUFDVCxVQUFVO0VBQ1YsbUJBQW1CO0VBQ25CLG9CQUFvQjtFQUNwQixZQUFZLEVBQUE7RUFYYjtJQWNHLGtCQUFrQjtJQUNsQixtQkFBbUI7SUFDbkIsT0FBTztJQUNQLFNBQVM7SUFDVCxVQUFVO0lBQ1Ysc0JBQXNCO0lBQ3RCLHFCQUFxQjtJQUNyQixXQUFXO0lBQ1gsa0NBQWtDLEVBQUE7RUF0QnJDO01BeUJLLFVBQVUsRUFBQTtFQXpCZjtJQTRCRyxzQkFBc0IsRUFBQTtFQTVCekI7SUErQkcsc0JBQXNCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZWxldmF0aW9uLXByb2ZpbGUvdmlydHVhbC1saXN0L2d1aWRlcy9ndWlkZXMuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuICBkaXNwbGF5OiBibG9jaztcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDEwdmg7XG4gIGxlZnQ6IDA7XG4gIGhlaWdodDogNjB2aDtcbiAgd2lkdGg6IDEwMCU7XG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcbiAgb3ZlcmZsb3cteTogdmlzaWJsZTtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHotaW5kZXg6IDEwMDtcblxuICAuZ3VpZGUge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgIGxlZnQ6IDA7XG4gICAgbWFyZ2luOiAwO1xuICAgIHBhZGRpbmc6IDA7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQ7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgdHJhbnNpdGlvbjogbWFyZ2luLXRvcCAwLjFzIGxpbmVhcjtcblxuICAgIC5tYXgge1xuICAgICAgdG9wOiAtMTlweDsgfSB9XG5cbiAgLmd1aWRlOmZpcnN0LWNoaWxkIHtcbiAgICBib3JkZXItdG9wOiAycHggZGFzaGVkOyB9XG5cbiAgLmd1aWRlOmxhc3QtY2hpbGQge1xuICAgIGJvcmRlci10b3A6IDJweCBkYXNoZWQ7IH0gfVxuIl19 */\"","import {Component, Input, OnInit, OnChanges, SimpleChanges, ElementRef, ChangeDetectionStrategy} from '@angular/core';\nimport {interpolateColors} from '../../../../_util/color';\nimport {environment} from '../../../../../environments/environment.prod';\nimport {OHLC} from '../../../../type/ohlc';\nimport {normalizeElevation} from '../../../../_util/trail';\n\n@Component({\n  selector: 'guides',\n  templateUrl: './guides.component.html',\n  styleUrls: ['./guides.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class GuidesComponent implements OnInit, OnChanges {\n\n  @Input() visibleOHLC: OHLC;\n  @Input() guides: Array<object>;\n\n  public processedGuides: Array<object> = [];\n\n  private _container: ElementRef;\n\n  constructor(_element: ElementRef) {\n    this._container = _element;\n  }\n\n  ngOnInit(): void {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (this.visibleOHLC) {\n\n      // remove unused guides\n      if (this.guides.length < this.processedGuides.length) {\n       this.processedGuides.splice(this.processedGuides.length - this.guides.length, this.processedGuides.length - this.guides.length);\n      }\n\n      const min: number = this.visibleOHLC.low;   // high point\n      const max: number = this.visibleOHLC.high;  // low point\n      const range = (max - min);\n\n      const _colors: Array<string> = interpolateColors('rgb(187, 97, 0)', 'rgb(62, 125, 158)', this.guides.length);\n\n      const _self = this;\n\n      const _guidesLength = this.guides.length;\n\n      // loop, optimal\n      for (let i = 0; i < _guidesLength; i++) {\n\n        const _guide = this.guides[i];\n\n        const elevation: number = normalizeElevation(_self._container.nativeElement.clientHeight\n          , _guide['elevation'], min, range, environment.LINEHEIGHT);\n\n        // if item already exists, update\n        if (_self.processedGuides[i]) {\n\n          _self.processedGuides[i]['offset'] = elevation;\n          _self.processedGuides[i]['range'] = _guide['range'];\n          _self.processedGuides[i]['color'] = 'rgba(' + String(_colors[i]) + ',0.5)';\n        } else {\n\n          _self.processedGuides.push(\n            {\n              offset: elevation,\n              range: _guide['range'],\n              color: 'rgba(' + String(_colors[i]) + ',0.5)'\n\n            });\n        }\n      }\n    }\n  }\n}\n","module.exports = \"<div *ngFor=\\\"let guide of processedGuides\\\" [ngStyle]=\\\"{'margin-top': guide.offset + 'px'}\\\" class=\\\"guide\\\">\\n  <span class=\\\"guide-label {{guide.range}}\\\">{{guide.label}} ft.</span>\\n</div>\\n\"","module.exports = \":host {\\n  display: block;\\n  position: fixed;\\n  top: 10vh;\\n  left: 0;\\n  height: 60vh;\\n  width: 100px;\\n  margin: 0;\\n  padding: 0;\\n  overflow-y: visible;\\n  pointer-events: none;\\n  z-index: 300; }\\n  :host .guide {\\n    position: absolute;\\n    white-space: nowrap;\\n    left: 0;\\n    margin: 0;\\n    padding: 0;\\n    box-sizing: border-box;\\n    width: 20vw;\\n    transition: margin-top 0.1s linear; }\\n  :host .guide .guide-label {\\n      position: absolute;\\n      text-align: left;\\n      background-color: rgba(243, 243, 243, 0.75);\\n      top: -1px;\\n      left: 10px;\\n      padding: 4px 6px 2px 6px;\\n      line-height: 15px;\\n      border-radius: 0 0 4px 0;\\n      border: 0.5px solid rgba(136, 178, 199, 0.25);\\n      font-size: 12px;\\n      -webkit-backdrop-filter: blur(3px);\\n              backdrop-filter: blur(3px); }\\n  :host .guide .max {\\n      top: -23px;\\n      border-radius: 0 4px 0 0; }\\n  :host .guide .min {\\n      top: 0px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS92aXJ0dWFsLWxpc3QvbGFiZWxzL2xhYmVscy5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUNDLGNBQWM7RUFDZCxlQUFlO0VBQ2YsU0FBUztFQUNULE9BQU87RUFDUCxZQUFZO0VBQ1osWUFBWTtFQUNaLFNBQVM7RUFDVCxVQUFVO0VBQ1YsbUJBQW1CO0VBQ25CLG9CQUFvQjtFQUNwQixZQUFZLEVBQUE7RUFYYjtJQWNHLGtCQUFrQjtJQUNsQixtQkFBbUI7SUFDbkIsT0FBTztJQUNQLFNBQVM7SUFDVCxVQUFVO0lBQ1Ysc0JBQXNCO0lBQ3RCLFdBQVc7SUFDWCxrQ0FBa0MsRUFBQTtFQXJCckM7TUF3Qkssa0JBQWtCO01BQ2xCLGdCQUFnQjtNQUNoQiwyQ0FBd0M7TUFDeEMsU0FBUztNQUNULFVBQVU7TUFDVix3QkFBd0I7TUFDeEIsaUJBQWlCO01BQ2pCLHdCQUF3QjtNQUN4Qiw2Q0FBNkM7TUFDN0MsZUFBZTtNQUNmLGtDQUEwQjtjQUExQiwwQkFBMEIsRUFBQTtFQWxDL0I7TUFxQ0ssVUFBVTtNQUNWLHdCQUF3QixFQUFBO0VBdEM3QjtNQXlDSyxRQUFRLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZWxldmF0aW9uLXByb2ZpbGUvdmlydHVhbC1saXN0L2xhYmVscy9sYWJlbHMuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuICBkaXNwbGF5OiBibG9jaztcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IDEwdmg7XG4gIGxlZnQ6IDA7XG4gIGhlaWdodDogNjB2aDtcbiAgd2lkdGg6IDEwMHB4O1xuICBtYXJnaW46IDA7XG4gIHBhZGRpbmc6IDA7XG4gIG92ZXJmbG93LXk6IHZpc2libGU7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICB6LWluZGV4OiAzMDA7XG5cbiAgLmd1aWRlIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgICBsZWZ0OiAwO1xuICAgIG1hcmdpbjogMDtcbiAgICBwYWRkaW5nOiAwO1xuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gICAgd2lkdGg6IDIwdnc7XG4gICAgdHJhbnNpdGlvbjogbWFyZ2luLXRvcCAwLjFzIGxpbmVhcjtcblxuICAgIC5ndWlkZS1sYWJlbCB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDMsMjQzLDI0MywwLjc1KTtcbiAgICAgIHRvcDogLTFweDtcbiAgICAgIGxlZnQ6IDEwcHg7XG4gICAgICBwYWRkaW5nOiA0cHggNnB4IDJweCA2cHg7XG4gICAgICBsaW5lLWhlaWdodDogMTVweDtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDAgMCA0cHggMDtcbiAgICAgIGJvcmRlcjogMC41cHggc29saWQgcmdiYSgxMzYsIDE3OCwgMTk5LCAwLjI1KTtcbiAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigzcHgpOyB9ICAgIC8vIHNhZmFyaS9pT1Mgb25seSwgY2F1c2VzIGdsaXRjaGluZy4uLlxuXG4gICAgLm1heCB7XG4gICAgICB0b3A6IC0yM3B4O1xuICAgICAgYm9yZGVyLXJhZGl1czogMCA0cHggMCAwOyB9XG5cbiAgICAubWluIHtcbiAgICAgIHRvcDogMHB4OyB9IH0gfVxuIl19 */\"","import {Component, Input, OnInit, OnChanges, SimpleChanges, ElementRef, ChangeDetectionStrategy} from '@angular/core';\nimport {environment} from '../../../../../environments/environment.prod';\nimport {OHLC} from '../../../../type/ohlc';\nimport {normalizeElevation} from '../../../../_util/trail';\n\n@Component({\n  selector: 'labels',\n  templateUrl: './labels.component.html',\n  styleUrls: ['./labels.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class LabelsComponent implements OnInit, OnChanges {\n\n  @Input() visibleOHLC: OHLC;\n  @Input() guides: Array<object>;\n\n  public processedGuides: Array<object> = [];\n\n  private _container: ElementRef;\n\n  constructor(_element: ElementRef) {\n    this._container = _element;\n  };\n\n  ngOnInit(): void {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (this.visibleOHLC) {\n\n      // draw labels\n\n      // remove unused guides\n      if (this.guides.length < this.processedGuides.length) {\n        this.processedGuides.splice(this.processedGuides.length - this.guides.length, this.processedGuides.length - this.guides.length);\n      }\n\n      let min: number = this.visibleOHLC.low;   // high point\n      let max: number = this.visibleOHLC.high;  // low point\n      let range = (max - min);\n\n      var _self = this;\n\n      const _guidesLength = this.guides.length;\n\n      // loop, optimal\n      for (let i = 0; i < _guidesLength; i++) {\n\n        const _guide = this.guides[i];\n\n        const elevation: number = normalizeElevation(_self._container.nativeElement.clientHeight\n          , _guide['elevation'], min, range, environment.LINEHEIGHT);\n\n        // if item already exists, update\n        if (_self.processedGuides[i]) {\n\n          _self.processedGuides[i]['label'] = _guide['label'];\n          _self.processedGuides[i]['offset'] = elevation + 1;\n          _self.processedGuides[i]['range'] = _guide['range'];\n        }\n\n        // else add\n        else {\n\n          _self.processedGuides.push(\n            {\n              label: _guide['label'],\n              offset: elevation + 1,      // +1 for guide line height\n              range: _guide['range']\n            });\n        }\n\n      }\n    }\n  }\n}\n","module.exports = \"<div class=\\\"map\\\" id=\\\"map_{{data.id}}\\\" #map></div>\\n<div class=\\\"markers\\\" id=\\\"markers_{{data.id}}\\\" #markers></div>\\n<div class=\\\"meta\\\">\\n  <div class=\\\"elevation-container\\\">\\n    <div class=\\\"elevation-change\\\">\\n      <div class=\\\"gain\\\"><fa-icon [icon]=\\\"['fas', 'long-arrow-alt-up']\\\" transform=\\\"rotate-45\\\"></fa-icon> {{data.elevationGain}} ft.</div>\\n      <div class=\\\"loss\\\"><fa-icon [icon]=\\\"['fas', 'long-arrow-alt-down']\\\" transform=\\\"rotate--45\\\"></fa-icon> {{data.elevationLoss}} ft.</div>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"icons\\\">\\n    <span class=\\\"icon-wrap\\\" *ngIf=\\\"hasInvisiblePoi\\\"><fa-icon [icon]=\\\"['fas', 'map-marker-alt']\\\" [ngClass]=\\\"['fa-fw']\\\" size=\\\"sm\\\"></fa-icon></span>\\n    <span class=\\\"icon-wrap\\\" *ngIf=\\\"hasNotes\\\"><fa-icon [icon]=\\\"['fas', 'pen-alt']\\\" [ngClass]=\\\"['fa-fw']\\\" size=\\\"sm\\\"></fa-icon></span>\\n  </div>\\n\\n  <div class=\\\"label\\\" *ngIf=\\\"!isLast\\\">{{data.id}}</div>\\n\\n</div>\\n\"","module.exports = \":host {\\n  position: relative;\\n  display: inline-block;\\n  width: 22.22vw;\\n  height: 90vh;\\n  border-right: 1px dashed #BBB;\\n  align-items: center;\\n  overflow: visible; }\\n  :host .map, :host .markers {\\n    display: block;\\n    margin-top: 10vh;\\n    width: 22.22vw;\\n    height: 60vh;\\n    font-size: 1.33em; }\\n  :host .markers {\\n    overflow: visible;\\n    padding-top: 0;\\n    top: 0;\\n    position: absolute;\\n    z-index: 200; }\\n  :host .markers svg {\\n      shape-rendering: optimizeSpeed; }\\n  .meta {\\n  position: absolute;\\n  bottom: 0;\\n  width: 22.22vw;\\n  height: 20vh; }\\n  .meta .elevation-container {\\n    padding-top: 1.5vh;\\n    display: flex;\\n    width: 100%;\\n    justify-content: center; }\\n  .meta .elevation-container .elevation-change {\\n      text-align: left;\\n      font-size: 3.5vh;\\n      color: #333; }\\n  .meta .label {\\n    display: block;\\n    position: absolute;\\n    box-sizing: border-box;\\n    float: right;\\n    width: 44px;\\n    padding: 2px 3px 2px 3px;\\n    bottom: 2vh;\\n    right: -22px;\\n    z-index: 0;\\n    background-color: rgba(243, 243, 243, 0.75);\\n    border: 0.5px solid rgba(151, 168, 149, 0.75);\\n    border-radius: 3px;\\n    font-size: 12px;\\n    text-align: center;\\n    -webkit-backdrop-filter: blur(6px);\\n            backdrop-filter: blur(6px); }\\n  .icons {\\n  display: block;\\n  text-align: center;\\n  padding-top: 1vh; }\\n  .icons .icon-wrap {\\n    display: inline-block;\\n    padding: 4px 0;\\n    margin: 2px;\\n    width: 28px;\\n    text-align: center;\\n    border: 1px solid #97a895;\\n    border-radius: 50%;\\n    font-size: 16px;\\n    color: #666; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS92aXJ0dWFsLWxpc3QvbGlzdC1pdGVtL2xpc3QtaXRlbS5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUNDLGtCQUFrQjtFQUNsQixxQkFBcUI7RUFDckIsY0FBYztFQUNkLFlBQVk7RUFDWiw2QkFBNkI7RUFDN0IsbUJBQW1CO0VBQ25CLGlCQUFpQixFQUFBO0VBUGxCO0lBVUcsY0FBYztJQUNkLGdCQUFnQjtJQUNoQixjQUFjO0lBQ2QsWUFBWTtJQUNaLGlCQUFpQixFQUFBO0VBZHBCO0lBaUJHLGlCQUFpQjtJQUNqQixjQUFjO0lBQ2QsTUFBTTtJQUNOLGtCQUFrQjtJQUNsQixZQUFZLEVBQUE7RUFyQmY7TUF3QkssOEJBQThCLEVBQUE7RUFFcEM7RUFDRSxrQkFBa0I7RUFDbEIsU0FBUztFQUNULGNBQWM7RUFDZCxZQUFZLEVBQUE7RUFKZDtJQU9JLGtCQUFrQjtJQUNsQixhQUFhO0lBQ2IsV0FBVztJQUNYLHVCQUF1QixFQUFBO0VBVjNCO01BYU0sZ0JBQWdCO01BQ2hCLGdCQUFnQjtNQUNoQixXQUFXLEVBQUE7RUFmakI7SUFrQkksY0FBYztJQUVkLGtCQUFrQjtJQUNsQixzQkFBc0I7SUFDdEIsWUFBWTtJQUVaLFdBQVc7SUFDWCx3QkFBd0I7SUFFeEIsV0FBVztJQUNYLFlBQVk7SUFDWixVQUFVO0lBRVYsMkNBQXdDO0lBQ3hDLDZDQUE2QztJQUU3QyxrQkFBa0I7SUFFbEIsZUFBZTtJQUNmLGtCQUFrQjtJQUNsQixrQ0FBMEI7WUFBMUIsMEJBQTBCLEVBQUE7RUFFOUI7RUFDRSxjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLGdCQUFnQixFQUFBO0VBSGxCO0lBTUkscUJBQXFCO0lBQ3JCLGNBQWM7SUFDZCxXQUFXO0lBQ1gsV0FBVztJQUNYLGtCQUFrQjtJQUNsQix5QkFBeUI7SUFDekIsa0JBQWtCO0lBQ2xCLGVBQWU7SUFDZixXQUFXLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvZWxldmF0aW9uLXByb2ZpbGUvdmlydHVhbC1saXN0L2xpc3QtaXRlbS9saXN0LWl0ZW0uY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgd2lkdGg6IDIyLjIydnc7XG4gIGhlaWdodDogOTB2aDtcbiAgYm9yZGVyLXJpZ2h0OiAxcHggZGFzaGVkICNCQkI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIG92ZXJmbG93OiB2aXNpYmxlO1xuXG4gIC5tYXAsIC5tYXJrZXJzIHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBtYXJnaW4tdG9wOiAxMHZoO1xuICAgIHdpZHRoOiAyMi4yMnZ3O1xuICAgIGhlaWdodDogNjB2aDtcbiAgICBmb250LXNpemU6IDEuMzNlbTsgfVxuXG4gIC5tYXJrZXJzIHtcbiAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICBwYWRkaW5nLXRvcDogMDtcbiAgICB0b3A6IDA7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHotaW5kZXg6IDIwMDtcblxuICAgIHN2ZyB7XG4gICAgICBzaGFwZS1yZW5kZXJpbmc6IG9wdGltaXplU3BlZWQ7IH0gfSB9XG5cbi5tZXRhIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBib3R0b206IDA7XG4gIHdpZHRoOiAyMi4yMnZ3O1xuICBoZWlnaHQ6IDIwdmg7XG5cbiAgLmVsZXZhdGlvbi1jb250YWluZXIge1xuICAgIHBhZGRpbmctdG9wOiAxLjV2aDtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXG4gICAgLmVsZXZhdGlvbi1jaGFuZ2Uge1xuICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgIGZvbnQtc2l6ZTogMy41dmg7XG4gICAgICBjb2xvcjogIzMzMzsgfSB9XG5cbiAgLmxhYmVsIHtcbiAgICBkaXNwbGF5OiBibG9jaztcblxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgIGZsb2F0OiByaWdodDtcblxuICAgIHdpZHRoOiA0NHB4O1xuICAgIHBhZGRpbmc6IDJweCAzcHggMnB4IDNweDtcblxuICAgIGJvdHRvbTogMnZoO1xuICAgIHJpZ2h0OiAtMjJweDtcbiAgICB6LWluZGV4OiAwO1xuXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDMsMjQzLDI0MywwLjc1KTtcbiAgICBib3JkZXI6IDAuNXB4IHNvbGlkIHJnYmEoMTUxLCAxNjgsIDE0OSwgMC43NSk7XG5cbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XG5cbiAgICBmb250LXNpemU6IDEycHg7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cig2cHgpOyB9IH0gICAgLy8gc2FmYXJpL2lPUyBvbmx5LCBjYXVzZXMgZ2xpdGNoaW5nLi4uXG5cbi5pY29ucyB7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIHBhZGRpbmctdG9wOiAxdmg7XG5cbiAgLmljb24td3JhcCB7XG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgIHBhZGRpbmc6IDRweCAwO1xuICAgIG1hcmdpbjogMnB4O1xuICAgIHdpZHRoOiAyOHB4O1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjOTdhODk1O1xuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICBmb250LXNpemU6IDE2cHg7XG4gICAgY29sb3I6ICM2NjY7IH0gfVxuIl19 */\"","import {AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter,\n  Input, OnChanges, OnInit, Output, SimpleChanges, ViewChild} from '@angular/core';\nimport {BaseComponent} from '../../../../base/base/base.component';\nimport 'seedrandom/seedrandom';\nimport {svgPath} from '../../../../_util/smooth-line';\nimport {isPrime} from '../../../../_util/math';\nimport {getMajorPoiTypes} from '../../../../_util/poi';\nimport {environment} from '../../../../../environments/environment.prod';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {TrailGeneratorService} from '../../../../service/trail-generator.service';\nimport {SnowGeneratorService} from '../../../../service/snow-generator.service';\nimport {MarkerService} from '../../../../factory/marker.service';\nimport {Mile} from '../../../../type/mile';\nimport {User} from '../../../../type/user';\nimport {Poi} from '../../../../type/poi';\nimport {Snowpoint} from '../../../../type/snow';\nimport {Waypoint} from '../../../../type/waypoint';\nimport {NoteService} from '../../../../service/note.service';\nimport {OHLC} from '../../../../type/ohlc';\nimport {normalizeElevation} from '../../../../_util/trail';\n\ndeclare const SVG: any;    // fixes SVGjs bug\n\n@Component({\n  selector: 'display-list-item',\n  templateUrl: './list-item.component.html',\n  styleUrls: ['./list-item.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\n// uses basic for loops for performance\n// TODO: iOS scroll performance issues (jumps backwards during scroll event)\nexport class ListItemComponent extends BaseComponent implements OnInit, AfterViewInit, OnChanges {\n\n  @ViewChild('map') map: ElementRef;\n\n  @Output() markerEvent: EventEmitter<number> = new EventEmitter<number>();\n\n  @Input() data:                Mile;\n  @Input() visibleOHLC:         OHLC;\n  @Input() guides:              Array<object>;\n  @Input() isLast:              boolean;\n  @Input() resize:              number;\n  @Input() update:              number;           // triggers a redraw\n\n  // user inputs only set if this mile is closest to user (else null)\n  @Input() user?:               User;\n  @Input() triggerUserUpdate?:  number;           // timestamp, set when user location is updated.\n  @Input() userStatus?:         string;           // idle/fetching/tracking\n\n  private _majorPoiTypes:         Array<string>;\n\n  public hasInvisiblePoi:     boolean;\n  public hasNotes:            boolean;\n\n  private _snowData:            Array<Array<Snowpoint>>;\n  public settings:              object            = {};\n  private _initialized:         boolean;          // can only draw after initialization\n\n  private _screenMode:          string;\n  private _trailLength:         number;\n\n  // SVG MAP\n  private _lineCanvas;                            // line (trail/snow) canvas\n  private _markerSvgCanvas;                       // poi (locations/user/trees) canvas\n  private _svgWidth:            number;\n  private _svgHeight:           number;\n\n  // USER\n  private _userMarker;\n\n\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _trailGenerator: TrailGeneratorService,\n    private _snowGenerator: SnowGeneratorService,\n    private _changeDetectorRef: ChangeDetectorRef,\n    private _markerFactory: MarkerService,\n    private _noteService: NoteService\n  ) {\n    super();\n  }\n\n\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n\n    const _self = this;\n    this._majorPoiTypes = getMajorPoiTypes();\n\n    this._screenMode = this._localStorage.retrieve('screenMode');\n    this._trailLength = this._trailGenerator.getTrailData().miles.length;\n\n    // dynamic subscriptions based on PoiTypes that are set as being major (important)\n    this._majorPoiTypes.forEach(function(type: string) {\n        _self._getSettingFromStorage(type);\n        _self._addSubscription(type);\n    });\n\n    // add snowPack subscription\n    _self._getSettingFromStorage('snow');\n    this._hasInvisiblePoi();\n    _self._addSubscription('snow');\n  }\n\n  ngAfterViewInit(): void {\n\n    // @ViewChild not always available, so get whichever is largest\n    this._svgWidth = Math.floor(Math.max(document.documentElement.clientWidth, window.innerWidth) / 4.5);\n    this._svgHeight = Math.floor(Math.max(document.documentElement.clientHeight, window.innerHeight) * 0.6);\n\n    this._lineCanvas = SVG('map_' + this.data.id)\n      .size(this._svgWidth, this._svgHeight)\n      .viewbox(0, 0, this._svgWidth, this._svgHeight)\n      .attr({focusable: false});\n\n    this._markerSvgCanvas = SVG('markers_' + this.data.id)\n      .size(this._svgWidth, this._svgHeight)\n      .viewbox(0, 0, this._svgWidth, this._svgHeight)\n      .attr({focusable: false})\n      .style('overflow', 'visible');\n\n    this._initialized = true;\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    // since this component requires the dom for drawing svg, it'll have to wait until initialization finishes\n    if (!this._initialized) {\n      return;\n    }\n\n    if (changes.data || changes.visibleOHLC) {\n\n      if (!this.visibleOHLC) {\n        return;\n      }\n\n      this._snowData = this._snowGenerator.getSnowForMile(this.data.id);\n      this._hasInvisiblePoi();\n      this._drawMap();\n    }\n\n    if (changes.update) {\n\n      console.log('changes, set screenmode, redraw');\n      this._screenMode = this._localStorage.retrieve('screenMode');\n      this._drawMap();\n    }\n\n    if (changes.resize) {\n\n      this._svgWidth = Math.floor(Math.max(document.documentElement.clientWidth, window.innerWidth) / 4.5);\n      this._svgHeight = Math.floor(Math.max(document.documentElement.clientHeight, window.innerHeight) * 0.6);\n\n      // update svg size\n      if (this._lineCanvas) {\n        const svg = window.document.getElementById(this._lineCanvas.node.id);\n        if (svg) {\n          svg.setAttribute('viewBox', '0 0 ' + this._svgWidth + ' ' + this._svgHeight + '');\n          svg.setAttribute('width', this._svgWidth + '');\n          svg.setAttribute('height', this._svgHeight + '');\n        }\n      }\n    }\n\n    if (changes.triggerUserUpdate || changes.user || changes.userStatus) {\n\n      if (this.userStatus !== 'tracking') {\n        this._clearUserMarker();\n      }\n\n      this._updateUserLocation();\n    }\n  }\n\n  // add a poi type subscription to the subscriptionsObject\n  private _addSubscription(name: string): void {\n\n    const _camelName =  this.createCamelCaseName(name, 'show');\n\n    this.addSubscription(_camelName, this._localStorage.observe(_camelName).subscribe(result => {\n      this.settings[_camelName] = result;\n      if (this._majorPoiTypes.indexOf(name) !== -1) {\n        this._hasInvisiblePoi();\n      }\n      this._drawMap();\n    }));\n  }\n\n  // get initial poi type saved values, as subscriptions only listen to updates\n  private _getSettingFromStorage(name: string): void {\n\n    const _camelName =  this.createCamelCaseName(name, 'show');\n    this.settings[_camelName] = this._localStorage.retrieve(_camelName);\n  }\n\n  // used to indicate that this mile has more pois than are being shown in elevation profile\n  private _hasInvisiblePoi(): void {\n\n    let _newValue: boolean;\n\n    const _self = this;\n\n    if (this.data.hasMinorPoi) {\n      _newValue = true;\n    } else if (this.data.hasMajorPoi) {\n      const _length = this._majorPoiTypes.length;\n      for (let i = 0; i < _length; i++) {\n        const _type = this._majorPoiTypes[i];\n        if (_self.data.poiTypes[_type] !== undefined && !_self.settings[_self.createCamelCaseName(_type, 'show')]) {\n          _newValue = true;\n          break;\n        }\n      }\n    } else {\n      _newValue = false;\n    }\n\n    this._hasNotes();\n\n    // only redraw if needed\n    if (this.hasInvisiblePoi !== _newValue) {\n      this.hasInvisiblePoi = _newValue;\n      this._changeDetectorRef.markForCheck();\n    }\n  }\n\n  private _hasNotes(): void {\n\n    const _mileNotes = this._noteService.getNotes('mile', this.data.id);\n    let _newValue: boolean;\n\n    if (_mileNotes) {\n      _newValue = true;\n    }\n\n    // only redraw if needed\n    if (this.hasNotes !== _newValue) {\n      this.hasNotes = _newValue;\n      this._changeDetectorRef.markForCheck();\n    }\n  }\n\n  private _drawMap(): void {\n\n    this._clearCanvas(true, true);\n\n    // line\n    this._drawLine();\n\n    if (this.settings['showSnow']) {\n      this._drawSnow();\n    }\n\n    // pois\n    this._drawTrees();\n    this._drawPois();\n\n    if (this.user) {\n      this._updateUserLocation();\n    }\n  }\n\n\n\n\n// DRAW ELEMENTS\n\n  private _clearCanvas(polyline: boolean = true, markers: boolean = false): void {\n\n    // polyline canvas\n    if (this._lineCanvas && polyline) {\n      this._lineCanvas.clear();\n    } else {\n      console.log('no line canvas');\n    }\n\n    // marker canvas\n    if (this._markerSvgCanvas && markers) {\n\n      if (this._userMarker) {\n        this._clearUserMarker();\n      }\n\n      this._markerSvgCanvas.clear();\n\n    } else {\n      console.log('no marker canvas');\n    }\n\n    this._lineCanvas.size(this._svgWidth, this._svgHeight);\n    this._lineCanvas.viewbox(0, 0, this._svgWidth, this._svgHeight);\n  }\n\n  private _drawLine(): void {\n\n    // console.log('draw line for mile', this.data.id);\n\n    const min: number = this.visibleOHLC.low;   // high point\n    const max: number = this.visibleOHLC.high;  // low point\n    const range = (max - min);\n\n    const drawPoints: Array<any> = [];\n\n    const _waypointsArr = this.data.waypoints;\n\n    let _waypointDistPerc: number;\n\n    const _totalWaypoints: number = _waypointsArr.length;\n    for (let i = 0; i < _totalWaypoints; i++) {\n\n      const _waypoint: Waypoint = _waypointsArr[i];\n\n      // calculate distance, starting at 2nd point\n      _waypointDistPerc = _waypoint.distance / environment.MILE;\n\n      const _elevation: number = normalizeElevation(this._svgHeight, _waypoint.elevation, min, range, environment.LINEHEIGHT);\n\n      // set startpoints\n      if (i === 0) {\n        drawPoints.push([-environment.LINEHEIGHT, this._svgHeight]);\n        drawPoints.push([-environment.LINEHEIGHT, _elevation]);\n      }\n\n      // add point\n      drawPoints.push([Math.round(this._svgWidth * _waypointDistPerc), _elevation]);\n\n      // set endpoints\n      if (i === _waypointsArr.length - 1) {\n        drawPoints.push([this._svgWidth + environment.LINEHEIGHT, _elevation]);\n        drawPoints.push([this._svgWidth + environment.LINEHEIGHT, this._svgHeight]);\n      }\n    }\n\n    if (this.data.id === this._trailLength) {\n\n      const _waypoint: Waypoint = _waypointsArr[_waypointsArr.length - 1];\n      const _lastWaypointDistPerc = _waypoint.distance / environment.MILE;\n\n      this._lineCanvas.size(this._svgWidth * _lastWaypointDistPerc, this._svgHeight);\n      this._lineCanvas.viewbox(0, 0, this._svgWidth * _lastWaypointDistPerc, this._svgHeight)\n    }\n\n    // draw line\n\n    let _fill: string = 'rgba(233,225,210, 0.5)';\n\n    if (this._screenMode == 'highContrast') {\n      _fill = 'rgba(255,255,255, 0.65)';\n    } else if (this._screenMode === 'nightHike') {\n      _fill = 'rgba(89,89,89, 0.65)';\n    }\n\n    const _polyline = this._lineCanvas.path(svgPath(drawPoints)).fill(_fill)\n      .stroke({ color: 'red', width: environment.LINEHEIGHT});\n  }\n\n  private _drawSnow(): void {\n\n    if (!this._snowData || !this._snowData[0] || this._snowData[0].length < 0) {\n      return;\n    }\n\n    const _snowArray: any = this._snowData[0];\n    const _waypointsArr = this.data.waypoints;\n\n    // if there is snow\n    if (_snowArray) {\n\n      const min: number = this.visibleOHLC.low;   // high point\n      const max: number = this.visibleOHLC.high;  // low point\n      const range = (max - min);\n\n      let drawPoints: Array<any> = [];\n\n      const _stroke: string = (this._screenMode === 'highContrast') ? '#97ffff' : 'rgba(255,255,255,0.9)';\n\n      const _totalWaypoints: number = _waypointsArr.length;\n      for (let i = 0; i < _totalWaypoints; i++) {\n\n        const _waypoint: Waypoint = _waypointsArr[i];\n\n        let _elevation = 0;\n\n        const elevationRange = function(): number {\n          // waypoint distance (%) on snowarray elevation range\n          return _snowArray[0].elevation + ((_waypoint.distance / environment.MILE) * ((_snowArray[1].elevation - _snowArray[0].elevation)));\n        };\n\n        // if waypoint is above snowline\n        if (_waypoint.elevation >= elevationRange()) {\n\n          // add point\n          _elevation = normalizeElevation(this._svgHeight, _waypoint.elevation, min, range, environment.LINEHEIGHT);\n          drawPoints.push([Math.round(this._svgWidth * (_waypoint.distance / environment.MILE)), _elevation]);\n\n        } else if (_waypoint.elevation < elevationRange()) {\n\n          // if trail drops below snowline\n\n          const snowLine = this._lineCanvas.path(svgPath(drawPoints)).fill('rgba(255,255,255,0)')\n            .stroke({ color: _stroke, width: environment.LINEHEIGHT * 2, linecap: 'round'});\n\n          drawPoints = [];\n        }\n      }\n\n      // if there is still snow to be drawn at the end of loop\n      if (drawPoints.length >= 1) {\n\n        const snowLine = this._lineCanvas.path(svgPath(drawPoints)).fill('rgba(255,255,255,0)')\n          .stroke({ color: _stroke, width: environment.LINEHEIGHT * 2, linecap: 'round'});\n      }\n    }\n  }\n\n  private _drawPois(): void {\n\n    const min: number = this.visibleOHLC.low;   // high point\n    const max: number = this.visibleOHLC.high;  // low point\n    const range = (max - min);\n\n    const _poisArray = this.data.pois;\n\n    // draw markers\n    if (_poisArray) {\n\n      const _self = this;\n      const _maxPoiDistance = this._localStorage.retrieve('poiMaxDistance');\n\n      const _totalPois: number = _poisArray.length;\n      for (let i = 0; i < _totalPois; i++) {\n\n        const _poi: Poi = this._trailGenerator.getPoiById(_poisArray[i]);\n\n        // filter out of range pois\n        if (_poi.waypoint.distance >= _maxPoiDistance) {\n          return;\n        }\n\n        if (!_poi) {\n          console.log('bug at poi with id: ' + _poi.id);\n        }\n\n        const _poiTypes = _poi['type'].split(', ');\n\n        // if poi is of visible type\n        const _visibleTypes: Array<string> = [];\n\n        const _poiTypesLength = _poiTypes.length;\n        for (let p = 0; p < _poiTypesLength; p++) {\n\n          const _type: string = _poiTypes[p];\n\n          // check if poi type is of visible type based on user settings (only camp/water/highway/end\n          const _setting: boolean = _self.settings[_self.createCamelCaseName(_type, 'show')];\n\n          if (_setting === true) {\n            _visibleTypes.push(_type);\n          }\n        }\n\n        if (_visibleTypes.length > 0) {\n\n          const _markerElevation: number = normalizeElevation(this._svgHeight, _poi.waypoint.elevation, min, range, environment.LINEHEIGHT / 2);\n\n          const _marker = this._markerFactory.setupMarker(this._markerSvgCanvas, _poi, _visibleTypes);\n\n          _marker.click(this._onMarkerClick.bind({data: _poi, self:this}));\n          _marker.move(this._svgWidth * (_poi.anchorPoint.distance / environment.MILE), _markerElevation);\n        }\n\n      }\n    }\n  }\n\n  // draw \"random\" trees below line\n  private _drawTrees(): void {\n\n    const min: number = this.visibleOHLC.low;   // high point\n    const max: number = this.visibleOHLC.high;  // low point\n    const range = (max - min);\n\n    // only way to execute seedrandom without compile errors\n    Math['seedrandom']('' + this.data.id);           // reseed\n\n    const _trees = this._markerSvgCanvas.group().addClass('tree-marker');\n\n    if (isPrime(this.data.id) || Math.random() * 100 < 25) {\n\n      const _count = Math.round(Math.random() * 4);\n\n      for (let i = 0; i < _count; i ++) {\n\n        const primeMarker = this._markerFactory.createSvgFaElement(this._markerSvgCanvas, 'tree', 0.5 + Math.random() * 0.75);\n        let treeline = normalizeElevation(this._svgHeight, this.data.elevationRange.low, min, range, 0);\n        treeline = treeline + (Math.random() * (treeline * 2));\n\n        primeMarker.move(Math.random() * this._svgWidth, treeline);\n        _trees.add(primeMarker);\n      }\n    }\n  }\n\n  private _drawUserMarker(): void {\n\n    if (!this.user) {\n      return;\n    }\n\n    const _onTrail: boolean = (this.user.distance <= this._localStorage.retrieve('userDistanceOffTrail'));\n\n    // if user matches in both type & status, move (animate) the current user to it's new position\n    // else redraw\n\n    if (this._userMarker) {\n\n      this._userMarker.node.id = this.userStatus;\n\n      const _attr = this._userMarker.node.attributes;\n\n      if (Boolean(_attr.onTrail.value) === _onTrail && _attr.type.value === 'pin' ||\n        Boolean(_attr.onTrail.value) === _onTrail && _attr.type.value === 'circle') {\n        return; // marker is already what it should be, no need to redraw\n      } else {\n\n        this._clearUserMarker();\n      }\n    }\n\n    // create user maker\n    if (_onTrail) {\n\n      this._userMarker = this._markerFactory.createSvgPinMarker(this._markerSvgCanvas, '#7f7f7f', 1);\n      this._userMarker.use(this._markerFactory.sampleFaIcon('user')).width(16).height(16).move(-8, -39);\n\n    } else {\n\n      this._userMarker = this._markerFactory.createSvgCircleMarker(this._markerSvgCanvas, '#7f7f7f', 1);\n      this._userMarker.use(this._markerFactory.sampleFaIcon('user')).width(16).height(16).move(-8, -8);\n    }\n\n    this._userMarker.node.id = this.userStatus;\n    this._userMarker.attr('onTrail', _onTrail);\n\n    this._userMarker.click(this._onUserClick.bind(this));\n\n  }\n\n  private _clearUserMarker(): void {\n    if (this._userMarker) {\n      this._userMarker.remove();\n      this._userMarker = null;\n    }\n  }\n\n\n// EVENT HANDLERS\n\n  // TODO: add tooltip/overlay, same as leaflet map\n  private _onUserClick(event: MouseEvent): void {\n\n    console.log('clicked on user');\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n  }\n\n  // linked directly to svg marker\n  private _onMarkerClick(event: MouseEvent): void {\n    event.stopPropagation();\n    event.stopImmediatePropagation();\n\n    const _event: CustomEvent = new CustomEvent(\n      'markerClick',\n      {\n        bubbles: true,\n        cancelable: true,\n        detail: this.data\n      });\n\n    // changed scope\n    this['self'].map.nativeElement.dispatchEvent(_event);\n  }\n\n  private _updateUserLocation(): void {\n\n    const min: number = this.visibleOHLC.low;   // high point\n    const max: number = this.visibleOHLC.high;  // low point\n    const range = (max - min);\n\n    this._drawUserMarker();\n\n    if (this.user && this._userMarker) {\n\n      const _withinVertBounds: boolean = (this.user.waypoint.elevation > this.visibleOHLC.low && this.user.waypoint.elevation < this.visibleOHLC.high);\n\n      let _userElevation = 0;\n\n      if (_withinVertBounds) {\n        _userElevation = normalizeElevation(this._svgHeight, this.user.waypoint.elevation, min, range, environment.LINEHEIGHT / 2);\n      } else {\n        if (this.user.waypoint.elevation < this.visibleOHLC.low) {\n          _userElevation = normalizeElevation(this._svgHeight, this.visibleOHLC.low, min, range, environment.LINEHEIGHT / 2);\n        } else {\n          _userElevation = normalizeElevation(this._svgHeight, this.visibleOHLC.high, min, range, environment.LINEHEIGHT / 2);\n        }\n      }\n\n      // set the user marker position\n      if (!this._userMarker.attr('x')) {\n        this._userMarker.move(this._svgWidth * (this.user.anchorPoint.distance / environment.MILE), _userElevation);\n      } else {\n\n        const _distance = this._trailGenerator.calcDistanceFlat(\n          {latitude:  this._userMarker.attr('x'), longitude: this._userMarker.attr('y')},\n          {latitude: this._svgWidth * (this.user.anchorPoint.distance / environment.MILE), longitude: _userElevation});\n\n        if (_distance > 1000000) {\n          this._userMarker.move(this._svgWidth * (this.user.anchorPoint.distance / environment.MILE), _userElevation);\n        } else {\n          this._userMarker.animate({duration: 300,  ease: ''}).move(this._svgWidth * (this.user.anchorPoint.distance / environment.MILE), _userElevation);\n        }\n      }\n\n      this._userMarker.attr('x', this._svgWidth * (this.user.anchorPoint.distance / environment.MILE));\n      this._userMarker.attr('y', _userElevation);\n    }\n  }\n\n  public createCamelCaseName(name: string, prepend?: string, append?: string): string {\n\n    prepend = (prepend) ? prepend : '';\n    append = (append) ? prepend : '';\n\n    return prepend + name.charAt(0).toUpperCase() + name.slice(1) + append;\n  };\n}\n","module.exports = \"\\n<div class=\\\"background-wrap\\\">\\n  <div class=\\\"background-layer\\\" #background></div>\\n</div>\\n\\n<div id=\\\"wrap\\\">\\n\\n  <cdk-virtual-scroll-viewport\\n    #scrollViewport\\n\\n    *ngIf=\\\"trailData\\\"\\n\\n    itemSize=\\\"{{itemWidth}}\\\"\\n    orientation=\\\"horizontal\\\"\\n    class=\\\"virtual-list\\\"\\n\\n    (window:resize)=\\\"onResize($event)\\\"\\n    (scrolledIndexChange)=\\\"onScroll(scrollViewport, $event)\\\">\\n\\n    <display-list-item\\n      class=\\\"list-item\\\"\\n\\n      *cdkVirtualFor=\\\"let li of trailData.miles; let last = last; templateCacheSize: cacheSize; trackBy: trackElementBy\\\"\\n      [resize]=\\\"resize\\\"\\n      [data]=\\\"li\\\"\\n      [isLast]=\\\"last\\\"\\n\\n      [user]=\\\"(user && li.id === user.nearestMileId) ? user : null\\\"\\n      [triggerUserUpdate]=\\\"(update && user && status === 'tracking' && li.id === user.nearestMileId) ? update : null\\\"\\n      [userStatus] = \\\"(user && li.id === user.nearestMileId) ? status : null\\\"\\n\\n      [visibleOHLC]=\\\"visibleOHLC\\\"\\n      [guides]=\\\"guides\\\"\\n      [update]=\\\"update\\\"\\n\\n      (click)=\\\"onClick(li)\\\">\\n      matRipple\\n    </display-list-item>\\n\\n    <!-- runs under marker layer (in list item) -->\\n    <guides id=\\\"guides\\\" [visibleOHLC]=\\\"visibleOHLC\\\" [guides]=\\\"guides\\\"></guides>\\n\\n  </cdk-virtual-scroll-viewport>\\n\\n</div>\\n\\n<!-- runs above marker layer (in list item) -->\\n<labels id=\\\"axis\\\" [visibleOHLC]=\\\"visibleOHLC\\\" [guides]=\\\"guides\\\"></labels>\\n\"","module.exports = \":host .background-wrap {\\n  position: absolute;\\n  width: 100vw;\\n  height: 100vh;\\n  overflow: hidden; }\\n  :host .background-wrap .background-layer {\\n    width: 200vw;\\n    height: 90vh;\\n    background: url('overlay.png') repeat-x;\\n    background-size: auto 100%;\\n    position: absolute;\\n    left: 0;\\n    right: 100vw;\\n    top: 0;\\n    -webkit-animation-timing-function: linear; }\\n  :host .virtual-list {\\n  position: unset !important;\\n  display: block;\\n  width: 100vw;\\n  height: 90vh;\\n  overflow-y: hidden;\\n  white-space: nowrap; }\\n  :host /deep/ .cdk-virtual-scroll-orientation-horizontal::-webkit-scrollbar-thumb {\\n  background-color: transparent; }\\n  :host /deep/ .cdk-virtual-scroll-orientation-horizontal::-webkit-scrollbar-track {\\n  background-color: transparent; }\\n  :host /deep/ .cdk-virtual-scroll-orientation-horizontal::-webkit-scrollbar {\\n  background-color: transparent; }\\n  :host /deep/ .cdk-virtual-scroll-orientation-horizontal::-webkit-scrollbar-thumb {\\n  background-color: transparent; }\\n  :host /deep/ #idle .circle, :host /deep/ #undefined .circle, :host /deep/ #idle .pin, :host /deep/ #undefined .pin {\\n  fill: #7f7f7f;\\n  stroke: #6c6c6c; }\\n  :host /deep/ #fetching .circle, :host /deep/ #fetching .pin {\\n  fill: #feff00;\\n  stroke: #d7d800; }\\n  :host /deep/ #tracking .circle, :host /deep/ #tracking .pin {\\n  fill: #00ff00;\\n  stroke: #00d800; }\\n  :host /deep/ #error .circle, :host /deep/ #error .pin {\\n  fill: #ff0100;\\n  stroke: #d80100; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9lbGV2YXRpb24tcHJvZmlsZS92aXJ0dWFsLWxpc3QvdmlydHVhbC1saXN0LmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFDO0VBSUcsa0JBQWtCO0VBQ2xCLFlBQVk7RUFDWixhQUFhO0VBQ2IsZ0JBQWdCLEVBQUE7RUFQbkI7SUFVSyxZQUFZO0lBQ1osWUFBWTtJQUNaLHVDQUFpRTtJQUNqRSwwQkFBMEI7SUFDMUIsa0JBQWtCO0lBQ2xCLE9BQU87SUFDUCxZQUFZO0lBQ1osTUFBTTtJQUNOLHlDQUF5QyxFQUFBO0VBbEI5QztFQXFCRywwQkFBMEI7RUFDMUIsY0FBYztFQUNkLFlBQVk7RUFDWixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLG1CQUFtQixFQUFBO0VBRXRCO0VBR0csNkJBQTZCLEVBQUE7RUFIaEM7RUFNRyw2QkFBNkIsRUFBQTtFQU5oQztFQVNHLDZCQUE2QixFQUFBO0VBVGhDO0VBWUcsNkJBQTZCLEVBQUE7RUFaaEM7RUFlRyxhQUFhO0VBQ2IsZUFBZSxFQUFBO0VBaEJsQjtFQW1CRyxhQUFhO0VBQ2IsZUFBZSxFQUFBO0VBcEJsQjtFQXVCRyxhQUFhO0VBQ2IsZUFBZSxFQUFBO0VBeEJsQjtFQTJCRyxhQUFhO0VBQ2IsZUFBZSxFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2VsZXZhdGlvbi1wcm9maWxlL3ZpcnR1YWwtbGlzdC92aXJ0dWFsLWxpc3QuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuXG4gIC8vIGFuZHJvaWQgZG9lc24ndCByZXNwZWN0IG92ZXJmbG93IGhpZGRlbiwgc28gaXQgbmVlZHMgYW4gYWJzb2x1dGUgd3JhcFxuICAuYmFja2dyb3VuZC13cmFwIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgd2lkdGg6IDEwMHZ3O1xuICAgIGhlaWdodDogMTAwdmg7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAgIC5iYWNrZ3JvdW5kLWxheWVyIHtcbiAgICAgIHdpZHRoOiAyMDB2dztcbiAgICAgIGhlaWdodDogOTB2aDtcbiAgICAgIGJhY2tncm91bmQ6IHVybCgnLi4vLi4vLi4vLi4vYXNzZXRzL2ltYWdlcy9vdmVybGF5LnBuZycpIHJlcGVhdC14O1xuICAgICAgYmFja2dyb3VuZC1zaXplOiBhdXRvIDEwMCU7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBsZWZ0OiAwO1xuICAgICAgcmlnaHQ6IDEwMHZ3O1xuICAgICAgdG9wOiAwO1xuICAgICAgLXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOiBsaW5lYXI7IH0gfVxuXG4gIC52aXJ0dWFsLWxpc3Qge1xuICAgIHBvc2l0aW9uOiB1bnNldCAhaW1wb3J0YW50O1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIHdpZHRoOiAxMDB2dztcbiAgICBoZWlnaHQ6IDkwdmg7XG4gICAgb3ZlcmZsb3cteTogaGlkZGVuO1xuICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7IH0gfVxuXG4gOmhvc3QgL2RlZXAvIHtcblxuICAuY2RrLXZpcnR1YWwtc2Nyb2xsLW9yaWVudGF0aW9uLWhvcml6b250YWw6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgfVxuXG4gIC5jZGstdmlydHVhbC1zY3JvbGwtb3JpZW50YXRpb24taG9yaXpvbnRhbDo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sge1xuICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyB9XG5cbiAgLmNkay12aXJ0dWFsLXNjcm9sbC1vcmllbnRhdGlvbi1ob3Jpem9udGFsOjotd2Via2l0LXNjcm9sbGJhciB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7IH1cblxuICAuY2RrLXZpcnR1YWwtc2Nyb2xsLW9yaWVudGF0aW9uLWhvcml6b250YWw6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgfVxuXG4gICNpZGxlIC5jaXJjbGUsICN1bmRlZmluZWQgLmNpcmNsZSwgI2lkbGUgLnBpbiwgI3VuZGVmaW5lZCAucGluIHtcbiAgICBmaWxsOiAjN2Y3ZjdmO1xuICAgIHN0cm9rZTogIzZjNmM2YzsgfVxuXG4gICNmZXRjaGluZyAuY2lyY2xlLCAjZmV0Y2hpbmcgLnBpbiB7XG4gICAgZmlsbDogI2ZlZmYwMDtcbiAgICBzdHJva2U6ICNkN2Q4MDA7IH1cblxuICAjdHJhY2tpbmcgLmNpcmNsZSwgI3RyYWNraW5nIC5waW4ge1xuICAgIGZpbGw6ICMwMGZmMDA7XG4gICAgc3Ryb2tlOiAjMDBkODAwOyB9XG5cbiAgI2Vycm9yIC5jaXJjbGUsICNlcnJvciAucGluIHtcbiAgICBmaWxsOiAjZmYwMTAwO1xuICAgIHN0cm9rZTogI2Q4MDEwMDsgfSB9XG4iXX0= */\"","import { Component, OnInit, AfterViewInit, OnChanges, Input, ViewChild,\n  SimpleChanges, EventEmitter, Output, ElementRef, ChangeDetectionStrategy, ChangeDetectorRef} from '@angular/core';\n\nimport {CdkVirtualScrollViewport} from '@angular/cdk/scrolling';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {LocationBasedComponent} from '../../../base/location-based/location-based.component';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {ScreenModeService} from '../../../service/screen-mode.service';\n\n// type classes\nimport {OHLC} from '../../../type/ohlc';\nimport {Mile} from '../../../type/mile';\nimport {User} from '../../../type/user';\nimport {Trail} from '../../../type/trail';\n\n@Component({\n  selector: 'virtual-list-component',\n  templateUrl: './virtual-list.component.html',\n  styleUrls: ['./virtual-list.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\nexport class VirtualListComponent extends LocationBasedComponent implements OnInit, AfterViewInit, OnChanges {\n\n  @ViewChild('background') background: ElementRef;\n  @ViewChild('backgroundFlat') backgroundFlat: ElementRef;\n  @ViewChild('scrollViewport') scrollViewport: CdkVirtualScrollViewport;\n\n  @Input() trailData: Trail;\n  @Input() scrollTo: number;\n\n  @Output() scrollEvent: EventEmitter<object> = new EventEmitter<object>();\n  @Output() resizeEvent: EventEmitter<object> = new EventEmitter<object>();\n\n  // public\n  public visibleOHLC:   OHLC;\n  public resize:        number;\n  public itemWidth:     number;\n\n  public guides:        Array<object>     = [];\n  public cacheSize:     number;\n  public update:        number;\n\n  // private\n  private _visibleRange:      object;\n  private _resizeTimer:       any;\n\n  private _currentIndex       = 0;\n  private _initialIndex       = 0;\n  private _isCentered:        boolean;\n  private _status             = 'idle';\n  private _parallaxEnabled: boolean;\n\n  constructor(\n    private _router:                    Router,\n    private _route:                     ActivatedRoute,\n    private _localStorageService:       LocalStorageService,\n    private _screenMode:                ScreenModeService,\n    private _changeDetector:            ChangeDetectorRef\n  ) {\n\n    super();\n    this.itemWidth = Math.floor(Math.max(document.documentElement.clientWidth, window.innerWidth || 0) / 4.5);\n  }\n\n\n\n\n// LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n\n    super.ngOnInit();\n\n    this._initialIndex = (this._route.snapshot) ? Number(this._route.snapshot.queryParams['id']) : 0;\n\n    const _notes = this._localStorageService.retrieve(this.trailData.abbr + '_notes');\n\n    this.cacheSize = Math.floor(this.trailData.miles.length / 10);\n\n    this._setupSubscriptions();\n  }\n\n  ngAfterViewInit() {\n\n    const _self = this;\n\n    window.requestAnimationFrame(function() {\n      if(_self._initialIndex) {\n        _self.scrollViewport.scrollToIndex(_self._initialIndex, 'auto');\n      }\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (changes.scrollTo) {\n      if (changes.scrollTo.currentValue) {\n        if (this.scrollViewport) {\n          this._currentIndex = Math.floor(this.scrollViewport.getDataLength() * changes.scrollTo.currentValue);\n          this.scrollViewport.scrollToIndex(this._currentIndex, 'auto');\n        }\n      }\n    }\n  }\n\n\n// OVERRIDES\n\n  public onStatusChange(status: string): void {\n    super.onStatusChange(status);\n    if (status !== 'tracking') {\n      this._status = status;\n    }\n    this.onUserLocationChange(this.user);\n  }\n\n  public onUserLocationChange(user: User): void {\n\n    // if we're switching to tracking\n    if (user && this.status === 'tracking' && this.scrollViewport && user.nearestMileId) {\n      if (!this._isCentered || this._status !== 'tracking' ) {\n        this.centerOnUser();\n        this._isCentered = true;\n      }\n    }\n\n    this._status = this.status;\n    this._changeDetector.markForCheck();\n  }\n\n  public centerOnUser(): void {\n    super.centerOnUser();\n    this._scrollToMile(this.user.nearestMileId);\n  }\n\n  private _scrollToMile(mileId: number) {\n    if (this.user && this.scrollViewport) {\n      const _index = (this.user.nearestMileId - 2 < 0) ? 0 : this.user.nearestMileId - 2;\n      this.scrollViewport.scrollToIndex(_index, 'auto');\n    }\n  }\n\n\n// EVENTS & HANDLERS\n\n  private _setupSubscriptions(): void {\n\n    const _self = this;\n\n    this.toggleParallax(this._localStorageService.retrieve('parallaxEnabled'));\n    this.addSubscription('parallax', this._localStorageService.observe('parallaxEnabled').subscribe(function(result) {\n      _self.toggleParallax(result);\n    }));\n\n    this.addSubscription('screenMode', this._screenMode.screenModeChangeObserver.subscribe(function(result) {\n      if (_self.scrollViewport) {\n        _self.update = new Date().getTime();\n        _self._changeDetector.markForCheck();\n      }\n    }));\n  }\n\n  // parralax effect seems to slow down iOS a lot, optional,\n  private _onScrollEvent(event: Event): void {\n\n      const _self = this;\n\n      if (event.target === _self.scrollViewport.elementRef.nativeElement) {\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        _self.scrollViewport.checkViewportSize();  // magically fixes everything! somehow...\n\n        const _scrollOffset: number = - (_self.scrollViewport.measureScrollOffset() * 0.015);\n        const _width: number = _self.scrollViewport.elementRef.nativeElement.clientWidth;\n        const _repeated: number = Math.ceil(_scrollOffset / _width);\n        const _finalOffset: number = _scrollOffset - (_repeated * _width);\n        _self.background.nativeElement.style.transform = 'translateX(' + _finalOffset + 'px)';\n      }\n  }\n\n  public onClick(listItem: Mile): void {\n    this._router['scrollToPosition'] = listItem.id - 1;\n    this._router.navigate(['detail/', this._router['scrollToPosition']]);\n  }\n\n  // only executed once every 250ms as it's a redraw of all list items\n  public onResize(event): void {\n\n    const self = this;\n\n    clearTimeout(this._resizeTimer);\n\n    this._resizeTimer = setTimeout(function() {\n      self.itemWidth = Math.floor(Math.max(document.documentElement.clientWidth, window.innerWidth || 0) / 4.5);\n      self.resize = new Date().getTime();\n      self.resizeEvent.emit({resize: new Date().getTime()});\n      self._redraw();\n    }, 250);\n  }\n\n  public onScroll(viewport: CdkVirtualScrollViewport, index: number): void {\n      this._currentIndex = index;\n      this._redraw();\n  }\n\n\n\n\n// OTHER\n\n  // calculate the open high low close (for high/low range) for the currently visible elements\n  // used to vertically scale svg content and calculate guides etc.\n  private _calculateVisOHLC(visibleRange: object): OHLC {\n\n    const _visibleItems = this.trailData.miles.slice(visibleRange['start'], visibleRange['end']);\n\n    let _highest:  number;\n    let _lowest:   number;\n\n    for (const vi of _visibleItems) {\n\n      const castOhlc = vi['elevationRange'] as OHLC;\n\n      if (!_highest || castOhlc.high > _highest) {\n        _highest = castOhlc.high;\n      }\n\n      if (!_lowest || castOhlc.low < _lowest) {\n        _lowest = castOhlc.low;\n      }\n    }\n\n    return {open: _visibleItems[0]['open'], high: _highest, low: _lowest, close: _visibleItems[_visibleItems.length - 1]['close']};\n  }\n\n  // calculate the number of guides and their values (used for labels and guides)\n  private _calculateGuides(): void {\n\n    this.guides = [];\n\n    const _range = this.visibleOHLC.high - this.visibleOHLC.low;\n\n    const _stepSize = (_range > 1000 ) ? _range / 5 : 200;\n\n    const _startSize = Math.ceil(this.visibleOHLC.low / _stepSize) * _stepSize;\n    const _maxSize = Math.ceil(this.visibleOHLC.high / _stepSize) * _stepSize;\n\n    for (let i = _startSize ; i < _maxSize; i += _stepSize) {\n      this.guides.push({elevation: i, label: Math.round(i)});\n    }\n\n    // max visible elevation\n    if (this.guides[this.guides.length - 1]['elevation'] >= this.visibleOHLC.high - (_stepSize / 4)) {\n      this.guides.pop();\n    }\n    this.guides.push({elevation: this.visibleOHLC.high, label: Math.round(this.visibleOHLC.high), range: 'max'});\n\n    // min visible elevation\n    if (this.guides[0]['elevation'] <= this.visibleOHLC.low + (_stepSize / 4)) {\n      this.guides.shift();\n    }\n    this.guides.unshift({elevation: this.visibleOHLC.low, label: Math.round(this.visibleOHLC.low), range: 'min'});\n  }\n\n  // redraw guides and trigger a scroll event (that redraws the list)\n  private _redraw(): void {\n\n    const _oldRange = this._visibleRange;\n    this._visibleRange = this.scrollViewport.getRenderedRange();\n\n    // only if really needed!\n    if (_oldRange !==  this._visibleRange) {\n      this.scrollEvent.emit({visibleRange: this._visibleRange, scrollX: this.scrollViewport.getOffsetToRenderedContentStart()});\n\n      // prevent redraw if not needed\n      const _newOHLC = this._calculateVisOHLC(this._visibleRange);\n      if (!this.visibleOHLC || _newOHLC.high !== this.visibleOHLC.high || _newOHLC.low !== this.visibleOHLC.low) {\n        this.visibleOHLC = _newOHLC;\n        this._calculateGuides();\n      }\n    }\n  }\n\n  // toggle parallax based on settings\n  private toggleParallax(enable:boolean): void {\n\n    // Listen for scroll events (angular \"events\" will not do!), needs to run on window for ios\n    if (this._parallaxEnabled && !enable) {\n      this.removeEventListener(window, 'scroll');\n    } else if (!this._parallaxEnabled && enable) {\n      this.addEventListener(window, 'scroll', this._onScrollEvent.bind(this), true);\n    }\n\n    this._parallaxEnabled = enable;\n  }\n\n\n\n\n// OPTIMISING\n\n  // define ID for better li recycling (according to the CDK virtual scroll docs)\n  public trackElementBy(index: number, element: any): number {\n    return element.id;\n  }\n}\n","module.exports = \"<fa-icon [icon]=\\\"[data.iconType, data.icon]\\\" class=\\\"fa-sample-icon\\\" [id]=\\\"'wrapper-' + data.type\\\"></fa-icon>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9mYS1zYW1wbGVyL2ZhLWljb24vZmEtaWNvbi5jb21wb25lbnQuc2FzcyJ9 */\"","import {AfterViewInit, Component, Input, OnInit} from '@angular/core';\nimport {PoiType} from '../../../type/poi';\n\n@Component({\n  selector: 'fa-icon-wrapper',\n  templateUrl: './fa-icon.component.html',\n  styleUrls: ['./fa-icon.component.sass']\n})\nexport class FaIconComponent implements OnInit, AfterViewInit {\n\n  @Input() data: PoiType;\n\n  constructor() { }\n\n  ngOnInit(): void {}\n\n  ngAfterViewInit(): void {\n\n    // fix svg icons, the SVGs need the ID of its container\n    const _faWrapper = document.getElementById('wrapper-' + this.data.type);\n    _faWrapper.childNodes[0]['id'] = 'sample-' + this.data.type;\n  }\n}\n","module.exports = \"<!-- sample svg data to clone, static data created from: <fa-icon [icon]=\\\"['fas', 'campground']\\\"></fa-icon>-->\\n<fa-icon-wrapper *ngFor=\\\"let poi of data\\\" [data]=\\\"poi\\\" class=\\\"hidden\\\"></fa-icon-wrapper>\\n<svg id=\\\"sample-tree\\\" aria-hidden=\\\"true\\\" data-prefix=\\\"fas\\\" data-icon=\\\"tree\\\" class=\\\"svg-inline--fa fa-tree fa-w-12 hidden\\\" role=\\\"img\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 384 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M378.31 378.49L298.42 288h30.63c9.01 0 16.98-5 20.78-13.06 3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61 3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26 3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25 3.8-8.17 2.44-17.47-3.56-24.26z\\\"></path></svg>\\n\"","module.exports = \".hidden {\\n  position: fixed;\\n  top: -100px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9mYS1zYW1wbGVyL2ZhLXNhbXBsZXIuY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxlQUFlO0VBQ2YsV0FBVyxFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2ZhLXNhbXBsZXIvZmEtc2FtcGxlci5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIi5oaWRkZW4geyAgICAgICAvLyB1c2VkIGZvciBmb250LWF3ZXNvbWUgc3ZncyBhdCB0b3Agb2YgdGVtcGxhdGVcbiAgcG9zaXRpb246IGZpeGVkO1xuICB0b3A6IC0xMDBweDsgfVxuIl19 */\"","import { Component, OnInit } from '@angular/core';\nimport { Settings } from '../../settings';\n\n@Component({\n  selector: 'fa-sampler',\n  templateUrl: './fa-sampler.component.html',\n  styleUrls: ['./fa-sampler.component.sass']\n})\n\n// create a Font awesome icon for each poi type (and hide it), as rendering font awesome as graphic within an SVG gets messy\n// give the svg element the correct id so it can be sampled/cloned by svgjs (through _utils/marker.ts)\nexport class FaSamplerComponent implements OnInit {\n\n  public data: object = Settings.POITYPES;\n\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","import * as L from 'leaflet';\nimport {NgElement, WithProperties} from '@angular/elements';\nimport {PopupComponent} from './popup/popup.component';\nimport {clearTimeOut, setTimeOut, TimerObj} from '../../../_util/timer';\n\nexport class DynamicComponentManager {\n\n  private _map: L.map;\n  private _popupTimer: TimerObj;\n  private _tooltipTimer: TimerObj;\n\n  constructor(map: L.map) {\n    this._map = map;\n  }\n\n  // load an angular component into a leaflet component map, _popupTimer\n  public createPopupComponent(location: L.LatLng, properties?: object, onTimeOut?: Function): TimerObj {\n\n    const _self = this;\n    const _popupContent = this._createDynamicComponent('popup', properties);\n\n    const _popup = L.popup({closeButton: false, autoClose: true, closeOnClick: true})\n      .setLatLng(location)\n      .setContent(_popupContent)\n      .addTo(this._map);\n\n    clearTimeOut(this._popupTimer);\n    this._popupTimer = setTimeOut(4000, function() {\n      _self._map.closePopup(_popup);\n      onTimeOut();\n    });\n\n    _popupContent.timer = this._popupTimer;\n\n    return this._popupTimer;\n  }\n\n  // load an angular component into a leaflet component\n  public createTooltipComponent(location: L.LatLng, properties?: object, onTimeOut?: Function): TimerObj {\n\n    const _self = this;\n    const _tooltipContent = this._createDynamicComponent('tooltip', properties);\n\n    const _tooltip = L.tooltip({autoClose: true, closeOnClick: true})\n      .setLatLng(location)\n      .setContent(_tooltipContent)\n      .addTo(this._map);\n\n    // provide the content component with the correct alignment value\n    if (_tooltip.getElement().classList.contains('leaflet-tooltip-left')) {\n      _tooltipContent.direction = 'left';\n    } else {\n      _tooltipContent.direction = 'right';\n    }\n\n    // disable hide on click\n    const _tElement = _tooltip.getElement();\n    _tElement.addEventListener('click', function(event: Event) {\n      event.stopPropagation();\n    });\n\n    clearTimeOut(this._tooltipTimer);\n    this._tooltipTimer = setTimeOut(2000, function() {\n      _self._map.closeTooltip(_tooltip);\n      onTimeOut();\n    });\n\n    _tooltipContent.timer = this._tooltipTimer;\n\n    return this._tooltipTimer;\n  }\n\n  private _createDynamicComponent(type: string, properties?: object): any {\n\n    let _component;\n    if (type === 'popup' || type === 'tooltip') {\n      const _popup: NgElement & WithProperties<PopupComponent> = document.createElement('leaflet-element-popup') as any;\n      _component = _popup;\n    }\n\n    _component.addEventListener('closed', () => document.body.removeChild(_component));\n\n    // set properties\n    if (properties) {\n      for (const key in properties) {\n        _component[key] = properties[key];\n      }\n    }\n\n    // add to dom, so I can reference it later\n    document.body.appendChild(_component);\n    return _component;\n  }\n}\n","module.exports = \"<div class=\\\"wrapper {{position}}\\\">\\n  <div class=\\\"container {{direction}}\\\">\\n    <span class=\\\"icon-wrap\\\" (click)=\\\"tag()\\\">\\n      <fa-icon class=\\\"menu\\\" [icon]=\\\"['fas', 'pen-alt']\\\"></fa-icon>\\n    </span>\\n    <div class=\\\"content\\\">\\n      <h3>{{label}}</h3>\\n      <p>{{description}}</p>\\n      <a *ngIf=\\\"showCoords\\\" [href]=\\\"createMapsLatLngLink()\\\" target=\\\"_blank\\\">Coordinates</a>\\n    </div>\\n  </div>\\n</div>\\n\"","module.exports = \":host {\\n  color: #5f5349 !important; }\\n  :host .wrapper .container {\\n    padding-top: 16.5px; }\\n  :host .wrapper .container .icon-wrap {\\n      position: absolute;\\n      top: -16.5px;\\n      left: 0;\\n      width: 100%; }\\n  :host .wrapper .container .icon-wrap fa-icon {\\n        display: inline-block;\\n        padding: 5px 0;\\n        width: 31px;\\n        text-align: center;\\n        border: 2px solid #b4a392;\\n        background-color: rgba(232, 214, 189, 0.85) !important;\\n        border-radius: 50%;\\n        font-size: 15px;\\n        color: rgba(95, 83, 73, 0.85); }\\n  :host .wrapper .container .content h3, :host .wrapper .container .content p {\\n      margin: 0 3px; }\\n  :host .wrapper .container .content h3 {\\n      font-weight: 600 !important; }\\n  :host .inline > div {\\n    padding-top: 0 !important; }\\n  :host .inline > div .icon-wrap {\\n      width: 36px !important; }\\n  :host .inline > div .icon-wrap fa-icon {\\n        width: 24px !important;\\n        font-size: 10px !important; }\\n  :host .inline > div h3 {\\n      padding-top: 3px; }\\n  :host .left .icon-wrap {\\n    top: -2px !important;\\n    left: -36px !important; }\\n  :host .right .icon-wrap {\\n    top: -2px !important;\\n    left: 100% !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9sZWFmbGV0LW1hcC9lbGVtZW50cy9wb3B1cC9wb3B1cC5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUVDLHlCQUFpQyxFQUFBO0VBRmxDO0lBT0ssbUJBQW1CLEVBQUE7RUFQeEI7TUFVTyxrQkFBa0I7TUFDbEIsWUFBWTtNQUNaLE9BQU87TUFDUCxXQUFXLEVBQUE7RUFibEI7UUFnQlMscUJBQXFCO1FBQ3JCLGNBQWM7UUFDZCxXQUFXO1FBQ1gsa0JBQWtCO1FBQ2xCLHlCQUFvQztRQUNwQyxzREFBc0Q7UUFDdEQsa0JBQWtCO1FBQ2xCLGVBQWU7UUFDZiw2QkFBNkIsRUFBQTtFQXhCdEM7TUE0QlMsYUFBYSxFQUFBO0VBNUJ0QjtNQStCUywyQkFBMkIsRUFBQTtFQS9CcEM7SUFrQ0cseUJBQXlCLEVBQUE7RUFsQzVCO01BdUNLLHNCQUFzQixFQUFBO0VBdkMzQjtRQTRDTyxzQkFBc0I7UUFDdEIsMEJBQTBCLEVBQUE7RUE3Q2pDO01BK0NLLGdCQUFnQixFQUFBO0VBL0NyQjtJQW9ESyxvQkFBb0I7SUFDcEIsc0JBQXNCLEVBQUE7RUFyRDNCO0lBMERLLG9CQUFvQjtJQUNwQixxQkFBcUIsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9sZWFmbGV0LW1hcC9lbGVtZW50cy9wb3B1cC9wb3B1cC5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG5cbiAgY29sb3I6IHJnYig5NSwgODMsIDczKSAhaW1wb3J0YW50O1xuXG4gIC53cmFwcGVyIHtcblxuICAgIC5jb250YWluZXIge1xuICAgICAgcGFkZGluZy10b3A6IDE2LjVweDtcblxuICAgICAgLmljb24td3JhcCB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgdG9wOiAtMTYuNXB4O1xuICAgICAgICBsZWZ0OiAwO1xuICAgICAgICB3aWR0aDogMTAwJTtcblxuICAgICAgICBmYS1pY29uIHtcbiAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgcGFkZGluZzogNXB4IDA7XG4gICAgICAgICAgd2lkdGg6IDMxcHg7XG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkIHJnYigxODAsIDE2MywgMTQ2KTtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIzMiwgMjE0LCAxODksIDAuODUpICFpbXBvcnRhbnQ7XG4gICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTVweDtcbiAgICAgICAgICBjb2xvcjogcmdiYSg5NSwgODMsIDczLCAwLjg1KTsgfSB9XG5cbiAgICAgIC5jb250ZW50IHtcbiAgICAgICAgaDMsIHAge1xuICAgICAgICAgIG1hcmdpbjogMCAzcHg7IH1cblxuICAgICAgICBoMyB7XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMCAhaW1wb3J0YW50OyB9IH0gfSB9XG5cbiAgLmlubGluZSA+IGRpdiB7XG4gICAgcGFkZGluZy10b3A6IDAgIWltcG9ydGFudDtcblxuICAgIC5pY29uLXdyYXAge1xuICAgICAgLy9wb3NpdGlvbjogcmVsYXRpdmUgIWltcG9ydGFudFxuICAgICAgLy93aWR0aDogdW5zZXQgIWltcG9ydGFudFxuICAgICAgd2lkdGg6IDM2cHggIWltcG9ydGFudDtcbiAgICAgIC8vdG9wOiB1bnNldCAhaW1wb3J0YW50XG4gICAgICAvL2xlZnQ6IHVuc2V0ICFpbXBvcnRhbnRcblxuICAgICAgZmEtaWNvbiB7XG4gICAgICAgIHdpZHRoOiAyNHB4ICFpbXBvcnRhbnQ7XG4gICAgICAgIGZvbnQtc2l6ZTogMTBweCAhaW1wb3J0YW50OyB9IH1cbiAgICBoMyB7XG4gICAgICBwYWRkaW5nLXRvcDogM3B4OyB9IH1cblxuICAubGVmdCB7XG5cbiAgICAuaWNvbi13cmFwIHtcbiAgICAgIHRvcDogLTJweCAhaW1wb3J0YW50O1xuICAgICAgbGVmdDogLTM2cHggIWltcG9ydGFudDsgfSB9XG5cbiAgLnJpZ2h0IHtcblxuICAgIC5pY29uLXdyYXAge1xuICAgICAgdG9wOiAtMnB4ICFpbXBvcnRhbnQ7XG4gICAgICBsZWZ0OiAxMDAlICFpbXBvcnRhbnQ7IH0gfSB9XG5cbi8vXG4vLyAgI21lbnVcbi8vICAgIHBvc2l0aW9uOiBhYnNvbHV0ZVxuLy8gICAgdG9wOiAtMzNweFxuLy8gICAgbGVmdDogMFxuLy8gICAgd2lkdGg6IDEwMCVcbi8vXG4vLyAgICBidXR0b25cbi8vICAgICAgaGVpZ2h0OiAzM3B4ICFpbXBvcnRhbnRcbi8vICAgICAgd2lkdGg6IDMzcHggIWltcG9ydGFudFxuLy9cbi8vICBoMywgcFxuLy8gICAgbWFyZ2luOiAwIDNweFxuLy8gICAgY29sb3I6IHJnYig5NSwgODMsIDczKSAhaW1wb3J0YW50XG4vL1xuLy8gIGgzXG4vLyAgICBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnRcbi8vXG4vLy5pbmxpbmVcbi8vXG4vLyAgLnJpZ2h0XG4vLyAgICBmbG9hdDogcmlnaHRcbi8vXG4vLyAgICBoM1xuLy8gICAgICBmbG9hdDogcmlnaHRcbi8vXG4vLyAgI21lbnVcbi8vICAgIHBvc2l0aW9uOiByZWxhdGl2ZSAhaW1wb3J0YW50XG4vLyAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2sgIWltcG9ydGFudFxuLy8gICAgd2lkdGg6IHVuc2V0ICFpbXBvcnRhbnRcbi8vICAgIHRvcDogdW5zZXQgIWltcG9ydGFudFxuLy8gICAgbGVmdDogdW5zZXQgIWltcG9ydGFudFxuLy9cbi8vICBoM1xuLy8gICAgZGlzcGxheTogaW5saW5lLWJsb2NrICFpbXBvcnRhbnRcbiJdfQ== */\"","import {Component, Input, OnInit} from '@angular/core';\nimport * as L from 'leaflet';\nimport {DialogService} from '../../../../factory/dialog.service';\nimport {latLngToWaypoint} from '../../../../_util/leaflet/converter';\nimport {clearTimeOut, pauseTimeOut, resumeTimeOut, TimerObj} from '../../../../_util/timer';\nimport {NoteProperties} from '../../../dialog/note-dialog/note-dialog.component';\nimport {environment} from '../../../../../environments/environment.prod';\n\n@Component({\n  selector: 'leaflet-element-popup',\n  templateUrl: './popup.component.html',\n  styleUrls: ['./popup.component.sass']\n})\nexport class PopupComponent implements OnInit {\n\n  @Input() waypoint?:       L.latlng;\n  @Input() anchorPoint?:    L.latlng;\n  @Input() distance:        number;      // the distance off-trail\n  @Input() distanceTotal:   number;      // the total trail distance\n\n  @Input() label:           string;\n  @Input() description:     string;\n\n  @Input() belongsTo:       number;     // always belong to a mile.\n\n  @Input() showCoords:      boolean;\n  @Input() timer:           TimerObj;   // popups have a timer that hides/destroys them\n  @Input() direction?:      string = '';\n\n  public position: string = '';\n\n  constructor(private _dialogFactory: DialogService) {}\n\n  ngOnInit(): void {\n    // show button inline if it's a single line popup (meaning a tooltip)\n    if (!this.description) {\n      this.position = 'inline';\n    }\n  }\n\n  public tag(): void {\n\n    if (!this.waypoint && !this.anchorPoint) {\n      console.warn('error: popup must have a waypoint or anchorPoint');\n      return;\n    }\n\n    const _self = this;\n\n    // pause the timer (so the location will still be shown if the user hits cancel)\n    pauseTimeOut(this.timer);\n\n    const _callback = function(result): void {\n      if (result === 'success') {\n        clearTimeOut(_self.timer);\n      } else {\n        resumeTimeOut(_self.timer);\n      }\n    }\n\n    // convert & populate waypoint/anchor\n    const _waypoint = (this.waypoint) ? latLngToWaypoint(this.waypoint) : undefined;\n    if (_waypoint) {\n      _waypoint.distance = this.distance || 0;\n      _waypoint.distanceTotal = this.distanceTotal || 0;\n    }\n\n    const _anchorPoint = (this.anchorPoint) ? latLngToWaypoint(this.anchorPoint) : undefined;\n    if (_anchorPoint) {\n      _anchorPoint.distance = this.distanceTotal - (environment.MILE * Math.floor(this.distanceTotal / environment.MILE)) || 0;\n      _anchorPoint.distanceTotal = this.distanceTotal || 0;\n    }\n\n    const _dialogProperties: NoteProperties = {\n      type:             'note',\n      label:            this.label,\n      waypoint:         _waypoint,\n      anchorPoint:      _anchorPoint,\n      belongsTo:        this.belongsTo,\n      belongsToType:    'mile'\n    };\n\n    this._dialogFactory.openDialog('note', _dialogProperties, _callback);\n  }\n\n  public createMapsLatLngLink() : string {\n    if (navigator.userAgent.match(/(iPhone|iPod|iPad)/)) {\n      return 'http://maps.apple.com/?ll=' + this.waypoint.lat + ',' + this.waypoint.lng;\n    } else {\n      return 'https://www.google.com/maps/search/?api=1&query=' + this.waypoint.lat + ',' + this.waypoint.lng;\n    }\n  }\n}\n","module.exports = \"<div id=\\\"leaflet_{{this.name}}\\\" #leaflet></div>\\n\"","module.exports = \":host {\\n  display: block;\\n  width: 100%;\\n  height: 100%; }\\n  :host .leaflet-container {\\n    height: 100% !important;\\n    background-color: rgba(0, 0, 0, 0); }\\n  :host .leaflet-pane {\\n    width: 100% !important;\\n    height: 100% !important; }\\n  :host .leaflet-pane .icon-white {\\n      color: white; }\\n  :host /deep/ #idle .circle, :host /deep/ #undefined .circle, :host /deep/ #idle .pin, :host /deep/ #undefined .pin {\\n  fill: #7f7f7f;\\n  stroke: #6c6c6c; }\\n  :host /deep/ #fetching .circle, :host /deep/ #fetching .pin {\\n  fill: #feff00;\\n  stroke: #d7d800; }\\n  :host /deep/ #tracking .circle, :host /deep/ #tracking .pin {\\n  fill: #00ff00;\\n  stroke: #00d800; }\\n  :host /deep/ #error .circle, :host /deep/ #error .pin {\\n  fill: #ff0100;\\n  stroke: #d80100; }\\n  :host /deep/ .user {\\n  color: white;\\n  width: 0 !important;\\n  height: 0 !important;\\n  margin: 0 !important;\\n  transition: -webkit-transform .3s ease-out;\\n  transition: transform .3s ease-out;\\n  transition: transform .3s ease-out, -webkit-transform .3s ease-out;\\n  text-rendering: optimizeLegibility; }\\n  :host /deep/ #tracking .pulse {\\n  position: absolute;\\n  top: -13px;\\n  left: -13px;\\n  width: 26px;\\n  height: 26px;\\n  border-radius: 50%;\\n  background-color: #4eba00;\\n  -webkit-animation: pulse 3s ease-out;\\n          animation: pulse 3s ease-out;\\n  -webkit-animation-iteration-count: infinite;\\n          animation-iteration-count: infinite;\\n  z-index: -1; }\\n  :host /deep/ .user-marker svg {\\n  position: absolute;\\n  top: 2px;\\n  shape-rendering: optimizeSpeed;\\n  text-rendering: optimizeLegibility; }\\n  :host /deep/ .marker svg {\\n  position: absolute;\\n  top: 6px;\\n  left: 6px;\\n  shape-rendering: optimizeSpeed;\\n  text-rendering: optimizeLegibility; }\\n  :host /deep/ .mile-marker .label {\\n  background-color: rgba(237, 237, 237, 0.75);\\n  display: block;\\n  position: absolute;\\n  box-sizing: border-box;\\n  padding: 0 3px;\\n  width: auto;\\n  min-width: 20px;\\n  bottom: 0;\\n  right: -50%;\\n  border: 1px solid #888;\\n  border-radius: 3px;\\n  font-size: 12px;\\n  text-align: center;\\n  -webkit-backdrop-filter: blur(3px);\\n          backdrop-filter: blur(3px); }\\n  :host /deep/ .leaflet-control-scale {\\n  padding: 0 0 10px 10px !important;\\n  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left) !important; }\\n  :host /deep/ .pin-marker {\\n  margin: 0 !important;\\n  color: white; }\\n  :host /deep/ .leaflet-popup-content-wrapper, :host /deep/ .leaflet-tooltip {\\n  border-radius: 6px;\\n  border: 2px solid #b4a392; }\\n  :host /deep/ .leaflet-popup {\\n  margin-bottom: 13px !important; }\\n  :host /deep/ .leaflet-popup-content-wrapper, :host /deep/ .leaflet-tooltip, :host /deep/ .leaflet-popup-tip {\\n  box-shadow: 0px -3px 20px -5px rgba(56, 50, 47, 0.25) !important;\\n  text-align: center !important;\\n  background-color: rgba(232, 214, 189, 0.85) !important;\\n  -webkit-backdrop-filter: blur(3px);\\n          backdrop-filter: blur(3px); }\\n  :host /deep/ .leaflet-tooltip {\\n  border-radius: 5px;\\n  padding: 0 2px !important;\\n  color: #5f5349;\\n  background-color: #e8d6bd !important;\\n  pointer-events: unset !important;\\n  cursor: default !important; }\\n  :host /deep/ .leaflet-popup-tip {\\n  width: 6px;\\n  height: 6px;\\n  margin-top: -4px;\\n  background-color: #5f5349 !important; }\\n  :host /deep/ .leaflet-popup-tip-container {\\n  height: 7px;\\n  bottom: -7px; }\\n  :host /deep/ .leaflet-popup-content {\\n  margin: 0;\\n  padding: 0; }\\n  :host /deep/ .leaflet-popup-content .btn-pill {\\n    background-color: #b4a392;\\n    border-radius: 26px;\\n    padding: 4px 8px;\\n    border: none;\\n    color: white !important; }\\n  :host /deep/ .leaflet-tooltip-left:before {\\n  border-left-color: #5f5349 !important; }\\n  :host /deep/ .leaflet-tooltip-right:before {\\n  border-right-color: #5f5349 !important; }\\n  @-webkit-keyframes pulse {\\n  0% {\\n    -webkit-transform: scale(0);\\n            transform: scale(0);\\n    opacity: 0.0; }\\n  75% {\\n    -webkit-transform: scale(1);\\n            transform: scale(1);\\n    opacity: 0.6; }\\n  100% {\\n    -webkit-transform: scale(1.65);\\n            transform: scale(1.65);\\n    opacity: 0.0; } }\\n  @keyframes pulse {\\n  0% {\\n    -webkit-transform: scale(0);\\n            transform: scale(0);\\n    opacity: 0.0; }\\n  75% {\\n    -webkit-transform: scale(1);\\n            transform: scale(1);\\n    opacity: 0.6; }\\n  100% {\\n    -webkit-transform: scale(1.65);\\n            transform: scale(1.65);\\n    opacity: 0.0; } }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9sZWFmbGV0LW1hcC9sZWFmbGV0LW1hcC5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUNDLGNBQWM7RUFDZCxXQUFXO0VBQ1gsWUFBWSxFQUFBO0VBSGI7SUFNRyx1QkFBdUI7SUFDdkIsa0NBQW9DLEVBQUE7RUFQdkM7SUFVRyxzQkFBc0I7SUFDdEIsdUJBQXVCLEVBQUE7RUFYMUI7TUFjSyxZQUFZLEVBQUE7RUFFakI7RUFHRyxhQUFhO0VBQ2IsZUFBZSxFQUFBO0VBSmxCO0VBT0csYUFBYTtFQUNiLGVBQWUsRUFBQTtFQVJsQjtFQVdHLGFBQWE7RUFDYixlQUFlLEVBQUE7RUFabEI7RUFlRyxhQUFhO0VBQ2IsZUFBZSxFQUFBO0VBaEJsQjtFQW1CRyxZQUFZO0VBQ1osbUJBQW1CO0VBQ25CLG9CQUFvQjtFQUNwQixvQkFBb0I7RUFDcEIsMENBQWtDO0VBQWxDLGtDQUFrQztFQUFsQyxrRUFBa0M7RUFDbEMsa0NBQWtDLEVBQUE7RUF4QnJDO0VBMkJLLGtCQUFrQjtFQUNsQixVQUFVO0VBQ1YsV0FBVztFQUNYLFdBQVc7RUFDWCxZQUFZO0VBR1osa0JBQWtCO0VBQ2xCLHlCQUF5QjtFQUN6QixvQ0FBNEI7VUFBNUIsNEJBQTRCO0VBQzVCLDJDQUFtQztVQUFuQyxtQ0FBbUM7RUFDbkMsV0FBVyxFQUFBO0VBdENoQjtFQXlDRyxrQkFBa0I7RUFDbEIsUUFBUTtFQUNSLDhCQUE4QjtFQUM5QixrQ0FBa0MsRUFBQTtFQTVDckM7RUFnREcsa0JBQWtCO0VBQ2xCLFFBQVE7RUFDUixTQUFTO0VBQ1QsOEJBQThCO0VBQzlCLGtDQUFrQyxFQUFBO0VBcERyQztFQTBESywyQ0FBMkM7RUFFM0MsY0FBYztFQUNkLGtCQUFrQjtFQUNsQixzQkFBc0I7RUFFdEIsY0FBYztFQUVkLFdBQVc7RUFDWCxlQUFlO0VBRWYsU0FBUztFQUNULFdBQVc7RUFFWCxzQkFBc0I7RUFDdEIsa0JBQWtCO0VBRWxCLGVBQWU7RUFDZixrQkFBa0I7RUFFbEIsa0NBQTBCO1VBQTFCLDBCQUEwQixFQUFBO0VBOUUvQjtFQWtGRyxpQ0FBaUM7RUFDakMsNkhBQTZILEVBQUE7RUFuRmhJO0VBc0ZHLG9CQUFvQjtFQUNwQixZQUFZLEVBQUE7RUF2RmY7RUEwRkcsa0JBQWtCO0VBQ2xCLHlCQUFvQyxFQUFBO0VBM0Z2QztFQThGRyw4QkFBOEIsRUFBQTtFQTlGakM7RUFvR0csZ0VBQTZEO0VBRTdELDZCQUE2QjtFQUM3QixzREFBc0Q7RUFDdEQsa0NBQTBCO1VBQTFCLDBCQUEwQixFQUFBO0VBeEc3QjtFQTJHRyxrQkFBa0I7RUFDbEIseUJBQXlCO0VBQ3pCLGNBQXNCO0VBQ3RCLG9DQUFtRDtFQUNuRCxnQ0FBZ0M7RUFDaEMsMEJBQTBCLEVBQUE7RUFoSDdCO0VBbUhHLFVBQVU7RUFDVixXQUFXO0VBQ1gsZ0JBQWdCO0VBQ2hCLG9DQUE0QyxFQUFBO0VBdEgvQztFQXlIRyxXQUFXO0VBQ1gsWUFBWSxFQUFBO0VBMUhmO0VBNkhHLFNBQVM7RUFDVCxVQUFVLEVBQUE7RUE5SGI7SUFpSUsseUJBQW9DO0lBQ3BDLG1CQUFtQjtJQUNuQixnQkFBZ0I7SUFDaEIsWUFBWTtJQUNaLHVCQUF1QixFQUFBO0VBckk1QjtFQXdJRyxxQ0FBNkMsRUFBQTtFQXhJaEQ7RUEwSUcsc0NBQThDLEVBQUE7RUFHbEQ7RUFDRTtJQUNFLDJCQUFtQjtZQUFuQixtQkFBbUI7SUFDbkIsWUFBWSxFQUFBO0VBQ2Q7SUFDRSwyQkFBbUI7WUFBbkIsbUJBQW1CO0lBQ25CLFlBQVksRUFBQTtFQUNkO0lBQ0UsOEJBQXNCO1lBQXRCLHNCQUFzQjtJQUN0QixZQUFZLEVBQUEsRUFBQTtFQVRoQjtFQUNFO0lBQ0UsMkJBQW1CO1lBQW5CLG1CQUFtQjtJQUNuQixZQUFZLEVBQUE7RUFDZDtJQUNFLDJCQUFtQjtZQUFuQixtQkFBbUI7SUFDbkIsWUFBWSxFQUFBO0VBQ2Q7SUFDRSw4QkFBc0I7WUFBdEIsc0JBQXNCO0lBQ3RCLFlBQVksRUFBQSxFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L2xlYWZsZXQtbWFwL2xlYWZsZXQtbWFwLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG5cbiAgLmxlYWZsZXQtY29udGFpbmVyIHtcbiAgICBoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMCk7IH1cblxuICAubGVhZmxldC1wYW5lIHtcbiAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50O1xuICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50O1xuXG4gICAgLmljb24td2hpdGUge1xuICAgICAgY29sb3I6IHdoaXRlOyB9IH0gfVxuXG4gOmhvc3QgL2RlZXAvIHtcblxuICAjaWRsZSAuY2lyY2xlLCAjdW5kZWZpbmVkIC5jaXJjbGUsICNpZGxlIC5waW4sICN1bmRlZmluZWQgLnBpbiB7XG4gICAgZmlsbDogIzdmN2Y3ZjtcbiAgICBzdHJva2U6ICM2YzZjNmM7IH1cblxuICAjZmV0Y2hpbmcgLmNpcmNsZSwgI2ZldGNoaW5nIC5waW4ge1xuICAgIGZpbGw6ICNmZWZmMDA7XG4gICAgc3Ryb2tlOiAjZDdkODAwOyB9XG5cbiAgI3RyYWNraW5nIC5jaXJjbGUsICN0cmFja2luZyAucGluIHtcbiAgICBmaWxsOiAjMDBmZjAwO1xuICAgIHN0cm9rZTogIzAwZDgwMDsgfVxuXG4gICNlcnJvciAuY2lyY2xlLCAjZXJyb3IgLnBpbiB7XG4gICAgZmlsbDogI2ZmMDEwMDtcbiAgICBzdHJva2U6ICNkODAxMDA7IH1cblxuICAudXNlciB7XG4gICAgY29sb3I6IHdoaXRlO1xuICAgIHdpZHRoOiAwICFpbXBvcnRhbnQ7XG4gICAgaGVpZ2h0OiAwICFpbXBvcnRhbnQ7XG4gICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7XG4gICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIC4zcyBlYXNlLW91dDtcbiAgICB0ZXh0LXJlbmRlcmluZzogb3B0aW1pemVMZWdpYmlsaXR5OyB9XG5cbiAgI3RyYWNraW5nIC5wdWxzZSB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICB0b3A6IC0xM3B4O1xuICAgICAgbGVmdDogLTEzcHg7XG4gICAgICB3aWR0aDogMjZweDtcbiAgICAgIGhlaWdodDogMjZweDtcbiAgICAgIC13ZWJraXQtYm9yZGVyLXJhZGl1czogNTAlO1xuICAgICAgLW1vei1ib3JkZXItcmFkaXVzOiA1MCU7XG4gICAgICBib3JkZXItcmFkaXVzOiA1MCU7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNGViYTAwO1xuICAgICAgYW5pbWF0aW9uOiBwdWxzZSAzcyBlYXNlLW91dDtcbiAgICAgIGFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQ6IGluZmluaXRlO1xuICAgICAgei1pbmRleDogLTE7IH1cblxuICAudXNlci1tYXJrZXIgc3ZnIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiAycHg7XG4gICAgc2hhcGUtcmVuZGVyaW5nOiBvcHRpbWl6ZVNwZWVkO1xuICAgIHRleHQtcmVuZGVyaW5nOiBvcHRpbWl6ZUxlZ2liaWxpdHk7IH1cblxuXG4gIC5tYXJrZXIgc3ZnIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiA2cHg7XG4gICAgbGVmdDogNnB4O1xuICAgIHNoYXBlLXJlbmRlcmluZzogb3B0aW1pemVTcGVlZDtcbiAgICB0ZXh0LXJlbmRlcmluZzogb3B0aW1pemVMZWdpYmlsaXR5OyB9XG5cbiAgLm1pbGUtbWFya2VyIHtcblxuICAgIC5sYWJlbCB7XG5cbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjM3LCAyMzcsIDIzNywgMC43NSk7XG5cbiAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcblxuICAgICAgcGFkZGluZzogMCAzcHg7XG5cbiAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgbWluLXdpZHRoOiAyMHB4O1xuXG4gICAgICBib3R0b206IDA7XG4gICAgICByaWdodDogLTUwJTtcblxuICAgICAgYm9yZGVyOiAxcHggc29saWQgIzg4ODtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDNweDtcblxuICAgICAgZm9udC1zaXplOiAxMnB4O1xuICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuXG4gICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoM3B4KTsgfSB9ICAgIC8vIHNhZmFyaS9pT1Mgb25seSwgY2F1c2VzIGdsaXRjaGluZy4uLlxuXG4gIC8vIGZpeCBmb3IgaU9TIG5vdGNoXG4gIC5sZWFmbGV0LWNvbnRyb2wtc2NhbGUge1xuICAgIHBhZGRpbmc6IDAgMCAxMHB4IDEwcHggIWltcG9ydGFudDtcbiAgICBwYWRkaW5nOiBlbnYoc2FmZS1hcmVhLWluc2V0LXRvcCkgZW52KHNhZmUtYXJlYS1pbnNldC1yaWdodCkgZW52KHNhZmUtYXJlYS1pbnNldC1ib3R0b20pIGVudihzYWZlLWFyZWEtaW5zZXQtbGVmdCkgIWltcG9ydGFudDsgfVxuXG4gIC5waW4tbWFya2VyIHtcbiAgICBtYXJnaW46IDAgIWltcG9ydGFudDtcbiAgICBjb2xvcjogd2hpdGU7IH1cblxuICAubGVhZmxldC1wb3B1cC1jb250ZW50LXdyYXBwZXIsIC5sZWFmbGV0LXRvb2x0aXAge1xuICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICBib3JkZXI6IDJweCBzb2xpZCByZ2IoMTgwLCAxNjMsIDE0Nik7IH1cblxuICAubGVhZmxldC1wb3B1cCB7XG4gICAgbWFyZ2luLWJvdHRvbTogMTNweCAhaW1wb3J0YW50OyB9XG5cbiAgLmxlYWZsZXQtcG9wdXAtY29udGVudC13cmFwcGVyLCAubGVhZmxldC10b29sdGlwLCAubGVhZmxldC1wb3B1cC10aXAge1xuXG4gICAgLXdlYmtpdC1ib3gtc2hhZG93OiAwcHggLTNweCAyMHB4IC01cHggcmdiYSg1Niw1MCw0NywwLjI1KSAhaW1wb3J0YW50O1xuICAgIC1tb3otYm94LXNoYWRvdzogMHB4IC0zcHggMjBweCAtNXB4IHJnYmEoNTYsNTAsNDcsMC4yNSkgIWltcG9ydGFudDtcbiAgICBib3gtc2hhZG93OiAwcHggLTNweCAyMHB4IC01cHggcmdiYSg1Niw1MCw0NywwLjI1KSAhaW1wb3J0YW50O1xuXG4gICAgdGV4dC1hbGlnbjogY2VudGVyICFpbXBvcnRhbnQ7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzIsIDIxNCwgMTg5LCAwLjg1KSAhaW1wb3J0YW50O1xuICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigzcHgpOyB9ICAgIC8vIHNhZmFyaS9pT1Mgb25seSwgY2F1c2VzIGdsaXRjaGluZy4uLlxuXG4gIC5sZWFmbGV0LXRvb2x0aXAge1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwYWRkaW5nOiAwIDJweCAhaW1wb3J0YW50O1xuICAgIGNvbG9yOiByZ2IoOTUsIDgzLCA3Myk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzIsIDIxNCwgMTg5LCAxKSAhaW1wb3J0YW50O1xuICAgIHBvaW50ZXItZXZlbnRzOiB1bnNldCAhaW1wb3J0YW50O1xuICAgIGN1cnNvcjogZGVmYXVsdCAhaW1wb3J0YW50OyB9XG5cbiAgLmxlYWZsZXQtcG9wdXAtdGlwIHtcbiAgICB3aWR0aDogNnB4O1xuICAgIGhlaWdodDogNnB4O1xuICAgIG1hcmdpbi10b3A6IC00cHg7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDk1LCA4MywgNzMpICFpbXBvcnRhbnQ7IH1cblxuICAubGVhZmxldC1wb3B1cC10aXAtY29udGFpbmVyIHtcbiAgICBoZWlnaHQ6IDdweDtcbiAgICBib3R0b206IC03cHg7IH1cblxuICAubGVhZmxldC1wb3B1cC1jb250ZW50IHtcbiAgICBtYXJnaW46IDA7XG4gICAgcGFkZGluZzogMDtcblxuICAgIC5idG4tcGlsbCB7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMTgwLCAxNjMsIDE0Nik7XG4gICAgICBib3JkZXItcmFkaXVzOiAyNnB4O1xuICAgICAgcGFkZGluZzogNHB4IDhweDtcbiAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50OyB9IH1cblxuICAubGVhZmxldC10b29sdGlwLWxlZnQ6YmVmb3JlIHtcbiAgICBib3JkZXItbGVmdC1jb2xvcjogcmdiKDk1LCA4MywgNzMpICFpbXBvcnRhbnQ7IH1cbiAgLmxlYWZsZXQtdG9vbHRpcC1yaWdodDpiZWZvcmUge1xuICAgIGJvcmRlci1yaWdodC1jb2xvcjogcmdiKDk1LCA4MywgNzMpICFpbXBvcnRhbnQ7IH0gfVxuXG5cbkBrZXlmcmFtZXMgcHVsc2Uge1xuICAwJSB7XG4gICAgdHJhbnNmb3JtOiBzY2FsZSgwKTtcbiAgICBvcGFjaXR5OiAwLjA7IH1cbiAgNzUlIHtcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDEpO1xuICAgIG9wYWNpdHk6IDAuNjsgfVxuICAxMDAlIHtcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuNjUpO1xuICAgIG9wYWNpdHk6IDAuMDsgfSB9XG4iXX0= */\"","import * as L from 'leaflet';\nimport 'leaflet-polylinedecorator/dist/leaflet.polylineDecorator';\nimport 'node_modules/leaflet-geometryutil/src/leaflet.geometryutil.js';\nimport 'node_modules/leaflet.Geodesic/Leaflet.Geodesic.js';\nimport '../../_util/leaflet/plugins/grid.js';\nimport '../../_util/leaflet/marker.js';\nimport {\n  Component,\n  OnInit,\n  AfterViewInit,\n  OnChanges,\n  Input,\n  SimpleChanges,\n  ElementRef,\n  ViewChild,\n  OnDestroy,\n  ChangeDetectionStrategy\n} from '@angular/core';\nimport {Mile} from '../../type/mile';\nimport {ActivatedRoute} from '@angular/router';\nimport {Poi} from '../../type/poi';\nimport {LocationBasedComponent} from '../../base/location-based/location-based.component';\nimport {User} from '../../type/user';\nimport {Waypoint} from '../../type/waypoint';\nimport {environment} from '../../../environments/environment.prod';\nimport {SnowGeneratorService} from '../../service/snow-generator.service';\nimport {TrailGeneratorService} from '../../service/trail-generator.service';\nimport {OrientationService} from '../../service/orientation.service';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {ScreenModeService} from '../../service/screen-mode.service';\nimport {MarkerService} from '../../factory/marker.service';\nimport {htmlIcon} from '../../_util/leaflet/icon';\nimport {calculateTrailAnchorPoint} from '../../_util/leaflet/calculate';\nimport {latLngToWaypoint, waypointToLatLng} from '../../_util/leaflet/converter';\nimport {distanceInMilesFeet} from '../../_util/math';\nimport {NoteService} from '../../service/note.service';\nimport {createGridLayer, createMapTileLayer} from '../../_util/leaflet/layer';\nimport {clearTimeOut, TimerObj} from '../../_util/timer';\nimport {Distance} from '../../_util/geolib/distance';\nimport {DynamicComponentManager} from './elements/dynamic-component-manager';\nimport {Town} from '../../type/town';\nimport * as geolib from \"geolib\";\n\ndeclare const SVG: any;    // fixes SVGjs bug\n\n@Component({\n  selector: 'leaflet-map',\n  templateUrl: './leaflet-map.component.html',\n  styleUrls: ['./leaflet-map.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\n// uses basic for loops for performance\n/* TODO: split up this monster into some smaller files */\n/* TODO: needs guidelines for towns */\nexport class LeafletMapComponent extends LocationBasedComponent implements OnInit, AfterViewInit, OnChanges, OnDestroy {\n\n  @ViewChild('leaflet') leaflet: ElementRef;\n\n  // data\n  @Input() name: String;\n  @Input() activeMileId: number;      // id of the currently active mile (selected mile in the overview or the mile nearest to the user location)\n  @Input() userCentered?: boolean;\n  @Input() centerPoint?: Waypoint;\n  @Input() range: object;             // the range of miles to show\n\n  @Input() poiRange?: any;            // the visible poi (in poi list) that should be bounded on map\n  @Input() mileRange?: any;           //  the visible miles (in poi list) that should be bounded on map\n\n  // map tiles\n  @Input() showMapTiles: boolean;\n\n  // map controls\n  @Input() allowPanning: boolean;\n  @Input() allowZooming: boolean;\n\n  // elements\n  @Input() showPois: boolean;\n\n  private _dynamicComponentManager: DynamicComponentManager;\n\n  private _map: any;\n  private _initialized = false;\n  private _showMileGrid: boolean;\n  private _animateMap: boolean;\n  private _trailLength: number;\n\n  private _centerpoint: object;\n  private _userMarker;\n  private _visibleMiles: Array<number> = [];\n\n  private _renderedData: Array<any> = [];\n  private _renderedCenterMileId: number;\n  private _popupBelongsTo = -1;       // uses mile index, not mile.id\n\n  private _tileLayers: Array<any> = [];\n  private _trailLayers: any = L.layerGroup();\n\n  private _popupTimer: TimerObj;\n  private _tooltipTimer: TimerObj;\n\n  private _overlayElements: Array<any>;\n\n  constructor(\n    private _route:                 ActivatedRoute,\n    private _snowGenerator:         SnowGeneratorService,\n    private _trailGenerator:        TrailGeneratorService,\n    private _orientationService:    OrientationService,\n    private _localStorageService:   LocalStorageService,\n    private _screenModeService:     ScreenModeService,\n    private _markerFactory:         MarkerService,\n    private _noteService:           NoteService\n  ) {\n    super();\n  }\n\n\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n    super.ngOnInit();\n\n    const _self = this;\n\n    this._showMileGrid = this._localStorageService.retrieve('showMileGrid');\n    this._animateMap = this._localStorageService.retrieve('animateMap');\n    this._trailLength = this._trailGenerator.getTrailData().miles.length;\n\n    this.addSubscription('notes', this._noteService.noteUpdateObserver.subscribe(function(update) {\n\n      if (update === 'added') {\n\n        const _lastAddedNote: Poi = _self._noteService.getLastNote();\n\n        // extra check, should\n        if (_self._visibleMiles.includes(_lastAddedNote.belongsTo - 1)) {\n          clearTimeOut(_self._popupTimer);\n          clearTimeOut(_self._tooltipTimer);\n          _self._addNote(_lastAddedNote);\n        }\n      } else if (update === 'removed') {\n        const _deletedNote: Poi = _self._noteService.getLastNote();\n        _self._removeMarkerByPoiId(_deletedNote.id);\n      }\n    }));\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (this._initialized) {\n\n      if (changes.activeMileId) {\n        this._dataManager();\n        this.onUserLocationChange(this.user);\n      }\n    }\n  }\n\n  ngAfterViewInit(): void {\n\n    this._setupMap();\n    this._dataManager();\n    this.onUserLocationChange(this.user);\n\n    this._initialized = true;\n    if (!this.userCentered) {\n      this._centerOnPoint(this.centerPoint);\n    }\n  }\n\n  ngOnDestroy() {\n\n    super.ngOnDestroy();\n\n    this._removeMiles(this._visibleMiles);\n\n    if (this._map){\n      this._map.eachLayer(function(layer){\n        layer.remove();\n      });\n      this._map.remove();\n      this._map = null;\n    }\n  }\n\n\n\n\n  // SETUP\n\n  private _setupMap(): void {\n\n    const _self = this;\n\n    // no data, no map\n    if (!this.trailGenerator.getTrailData()) {\n      console.log('no map data');\n      return;\n    }\n\n    // create the tile layer (deals with online / offline / missing tiles)\n    if (this.showMapTiles) {\n      const _url = this._generateTileUrl();\n      this._tileLayers.push(createMapTileLayer(_url, this._localStorageService.retrieve('detectRetina')));\n    }\n\n    // grid layer is only shown on the full map, not the mini map)\n    if (this.allowZooming && this._showMileGrid) {\n      const _gridLayerArray = createGridLayer(this._trailGenerator.getTrailData().abbr);\n      this._tileLayers = this._tileLayers.concat(_gridLayerArray);\n    }\n\n    this._map = new L.map('leaflet_' + this.name, {\n      minNativeZoom: 15,\n      maxNativeZoom: 15,\n      minZoom: 13.75,\n      maxZoom: 16,\n      zoomControl: false, attributionControl: false,\n      layers: this._tileLayers,\n      zoomSnap: 0,\n      preferCanvas: true,\n      closePopupOnClick: false,     // manual toggle\n      maxBoundsViscosity: 0.95      // near solid\n    });\n\n    this._setupMapListeners();\n    this._dynamicComponentManager = new DynamicComponentManager(this._map);\n    this._setMapInteractionProperties();\n\n    // set an initial location\n    this._map.setView([0, 0], 15);\n\n    // TODO: this needs to be moved, as towns need to be linked to miles (like pois)\n    if (this._trailGenerator.getTrailData().towns) {\n      this._trailGenerator.getTrailData().towns.forEach(function (town: Town) {\n        _self._drawTown(town);\n      });\n    }\n  }\n\n\n\n\n\n  // draw pois\n  private _drawTown(town: Town): void {\n\n    const _towns: Array<any> = [];\n\n    _towns.push(this._assembleTownMarker(town));\n\n    const _markerGroup = L.featureGroup(_towns);\n    _markerGroup.addTo(this._map);\n\n    // draw line from anchor point in direction of town\n    if (town.anchorPoint) {\n\n\n      let _distance: number = geolib.getDistance(waypointToLatLng(town.centerPoint), waypointToLatLng(town.anchorPoint))\n\n      // only draw guide if trail is over a mile away\n      // max guide length is 0.2mi\n      if (_distance < environment.MILE) {\n        return;\n      } else {\n        _distance = ((_distance / 8) > environment.MILE) ? environment.MILE : _distance / 8;\n      }\n\n      const _heading = Math.atan2(town.centerPoint.longitude - town.anchorPoint.longitude, town.centerPoint.latitude - town.anchorPoint.latitude) * 180 / Math.PI;\n\n      const _point: Waypoint = this._createPoint(town.anchorPoint, _heading, _distance);\n\n      console.log(_point, town.anchorPoint);\n\n      const _guide = this._createGuide(waypointToLatLng(town.anchorPoint), waypointToLatLng(_point), false, true, 'rgb(0, 255, 0)');\n      _guide[0].addTo(this._map);\n      _guide[1].addTo(this._map);\n    }\n  }\n\n  private _assembleTownMarker(town: Town): void {\n\n    const _element = document.createElement('div');\n    const _svg = SVG(_element).size(36, 54).style('overflow', 'visible');\n    this._markerFactory.createSvgCircleMarker(_svg, '#FF0000', 0.787878);\n    _svg.use(this._markerFactory.sampleFaIcon('town')).width(24).height(24).move(-12, -12);\n\n    const _icon = htmlIcon({className: 'marker town', html: _element});\n    const _options = {icon: _icon , town: town};\n    const _poiMarker = L.marker(waypointToLatLng(town.centerPoint), _options);\n    return _poiMarker;\n  }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  private _setMapInteractionProperties(): void {\n\n    // panning\n    if (!this.allowPanning) {\n      this._map.dragging.disable();\n    }\n\n    // zooming\n    if (!this.allowZooming) {\n      this._map['scrollWheelZoom'].disable();\n      this._map.touchZoom.disable();\n      this._map.doubleClickZoom.disable();\n    } else {\n\n      // if zoom is enabled, add scale indicator\n      L.control.scale().addTo(this._map);\n    }\n  }\n\n  /* setup routines for popup/ indicator showing the poition and trail mileage\n  * manually closes popup (disabled feature on map */\n  private _setupMapListeners(): void {\n\n    const _self = this;\n\n    // show popup or inditor (and guides)\n    this._map.on('click', function(e: any) {\n\n      // if there's still an overlay, or overlay data, get rid of it.\n      if (_self._overlayElements) {\n\n        clearTimeOut(_self._popupTimer);\n        clearTimeOut(_self._tooltipTimer);\n\n        return;\n      }\n\n      _self._createPopupTooltip(e);\n\n    });\n  }\n\n\n  // clear all the extra elements that belong to the overlays (popups/tooltips)\n  private _clearOverlayElements(): void {\n\n    const _self = this;\n\n    if (this._overlayElements && this._overlayElements.length > 0) {\n      this._overlayElements.forEach(function(element) {\n        if (_self._map && element) {\n          _self._map.removeLayer(element); // remove\n        }\n      });\n    }\n\n    this._popupBelongsTo = -1;\n    this._overlayElements = null;\n  }\n\n  // generate a tile url, if online tiles are available (downloaded) use those, else use an online source\n  private _generateTileUrl(): string {\n\n    const _version = this._localStorageService.retrieve(this.trailGenerator.getTrailData().abbr + '_tilesVersion');\n\n    if (_version) {\n      // appends the ionic webview compatible root directory URL\n      return this.fileSystem.rootPath + this.trailGenerator.getTrailData().abbr + '/' + _version + '/tiles/{x}/{y}.png';\n    } else {\n      return environment.onlineTileUrl;\n    }\n  }\n\n  // display Tooltip (on trail) or Popup (off trail), both use dynamic components as content\n  private _createPopupTooltip(e: any): void {\n\n    const _self = this;\n    const _eLatLngAsWaypoint = latLngToWaypoint(e.latlng)\n    let _anchor: Waypoint;\n    let _nearestPoints: Array<Distance>;\n\n    // use a plugin to get the nearest point in the nearest (rendered) trail segment.\n    // TODO: eliminate the plugin dependency, since I'm only using a single function\n    const _closestLayer = L.GeometryUtil.closestLayer(this._map, this._trailLayers.getLayers(), e.latlng);\n\n    if (!_closestLayer) {\n      return;     // no trail\n    } else {\n      const _mile: Mile = this._trailGenerator.getTrailData().miles[Number(_closestLayer.layer.mileId) - 1];\n      _nearestPoints = this._trailGenerator.findNearestWaypointInMile(_eLatLngAsWaypoint, _mile);\n      _anchor = calculateTrailAnchorPoint(_mile, _nearestPoints);\n    }\n\n    const _anchorAsLatLng: L.latlng = waypointToLatLng(_anchor);    // convert for leaflet\n\n    // if the distance is substantial, show a guideline/popup, else show a tooltip\n    const _offTrail = (_nearestPoints[0].distance > this.localStorage.retrieve('poiDistanceOffTrail'));\n\n    if (_offTrail) {\n\n      this._popupBelongsTo = Number(_closestLayer.layer.mileId);\n      this._activatePopup(e.latlng, _anchorAsLatLng, _nearestPoints[0].distance, _anchor.distanceTotal);\n\n      // render guides\n      this._overlayElements.forEach(function(element) {\n        element.addTo(_self._map);\n      });\n\n    } else {\n\n      this._popupBelongsTo = Number(_closestLayer.layer.mileId);\n      this._activateTooltip(_anchorAsLatLng, _anchor.distanceTotal);\n\n      // create empty array for 'click' cycle\n      this._overlayElements = [];\n    }\n  }\n\n  // activate a popup (component)\n  private _activatePopup(waypoint: L.latLng, anchor: L.latLng, offTrailDistance: number, nearestMileage: number): void {\n\n    const _offTrailDistanceConverted: any = distanceInMilesFeet(offTrailDistance);\n    const _nearestMileageConverted: any = distanceInMilesFeet(nearestMileage);\n\n    const _label: string =  + _offTrailDistanceConverted.distance + ' ' + _offTrailDistanceConverted.unit + ' off trail';\n    const _description: string = 'Nearest: ' + _nearestMileageConverted.unit + ' ' + _nearestMileageConverted.distance;\n    this._popupTimer = this._dynamicComponentManager.createPopupComponent(waypoint,\n      {\n        label: _label,\n        description: _description,\n        waypoint: waypoint,\n        anchorPoint: anchor,\n        distance: offTrailDistance,\n        distanceTotal: nearestMileage,\n        belongsTo: this._popupBelongsTo\n      }, this._clearOverlayElements.bind(this));\n\n    this._overlayElements = this._createGuide(anchor, waypoint, false, false, 'rgba(255, 0, 0, 0.75)', 3);\n  }\n\n  // activate a tooltip (component)\n  private _activateTooltip(waypoint: L.latLng, nearestMileage: number): void {\n\n    const _nearestMileageConverted: any = distanceInMilesFeet(nearestMileage);\n\n    _nearestMileageConverted.unit = String(_nearestMileageConverted.unit).charAt(0).toUpperCase() + String(_nearestMileageConverted.unit).slice(1);\n\n    this._dynamicComponentManager.createTooltipComponent(waypoint, {\n      waypoint: waypoint,\n      anchorPoint: waypoint,\n      label: _nearestMileageConverted.unit + ' ' + _nearestMileageConverted.distance,\n      distance: 0,\n      distanceTotal: nearestMileage,\n      belongsTo: this._popupBelongsTo\n    },this._clearOverlayElements.bind(this));\n  }\n\n\n  // ELEMENT CREATION\n\n  // manages the visible data (mile segments, markers, guides and snow)\n  // the map only renders what should be visible based on the range provided)\n  private _dataManager(): void {\n\n    if (!this.range) {\n      return;\n    }\n\n    // get visible miles\n    const _relativeRange = {start: this.activeMileId - this.range['behind'], end: this.activeMileId + this.range['ahead']};\n    const _oldmMilesToDelete: Array<number> = [];\n    const _newVisibleMiles: Array<number> = [];\n\n    if (_relativeRange.start < _relativeRange.end - 9) {\n      this._renderedCenterMileId = _relativeRange.start + Math.floor((_relativeRange.end - _relativeRange.start) / 2);\n    } else {\n      this._renderedCenterMileId = -1;\n    }\n\n    // create range array (check for trail ends)\n    for (let i = _relativeRange.start; i <= _relativeRange.end; i++) {\n      if (i >= 0 && i < this._trailGenerator.getTrailData().miles.length) {\n        _newVisibleMiles.push(i);\n      }\n    }\n\n    // compare drawn miles array to new visibleMiles\n    const _visibleMilesLength = this._visibleMiles.length;\n    for (let i = 0; i < _visibleMilesLength; i++) {\n\n      const _mileId = this._visibleMiles[i]\n\n      if (_newVisibleMiles.indexOf(_mileId) < 0) {\n        _oldmMilesToDelete.push(_mileId);\n      } else {\n        _newVisibleMiles.splice(_newVisibleMiles.indexOf(_mileId), 1);\n      }\n    }\n\n    this._drawMiles(_newVisibleMiles);\n    this._setBounds();\n    this._removeMiles(_oldmMilesToDelete);\n\n    this._visibleMiles = this._visibleMiles.concat(_newVisibleMiles);\n  }\n\n  // draw all mile data\n  private _drawMiles(mileIds: Array<number>): void {\n\n    const _self = this;\n\n    if (mileIds.length === 0) {\n      return;\n    }\n\n    const _mileIdsLength = mileIds.length;\n\n    for (let i = 0; i < _mileIdsLength; i++) {\n\n      const _mileId = mileIds[i];\n\n      if (_self._visibleMiles.indexOf(_mileId) !== -1) {\n        return;\n      }\n\n      const _mile = _self._trailGenerator.getTrailData().miles[_mileId];\n\n      if (!_mile) {\n        return;\n      }\n\n      if (_mile.id === _self.activeMileId) {\n        _self._centerpoint = _mile.centerpoint;\n      }\n\n      _self._renderedData[_mileId] = {};\n\n      _self._drawTrail(_mile, _mileId);\n      _self._drawSnow(_mile, _mileId);\n      _self._drawPois(_mile, _mileId);\n      _self._drawNotes(_mile, _mileId);\n    }\n  }\n\n  // removes miles (trail/snow/pois/labels/lines that are no longer visible\n  private _removeMiles(mileIds: Array<number>): void {\n\n    const _self = this;\n\n    if (mileIds.length === 0) {\n      return;\n    }\n\n    const _mileIdsLength = mileIds.length;\n    for (let i = 0; i < _mileIdsLength; i++) {\n\n      const _mileId = mileIds[i];\n\n      if (_self._popupBelongsTo === _mileId + 1) {\n        clearTimeOut(this._popupTimer);\n        clearTimeOut(this._tooltipTimer);\n      }\n\n      try {\n\n        if (_self._renderedData[_mileId] && _self._map) {\n\n          // remove miles/markers/snow data/notes\n          for (const key in _self._renderedData[_mileId]) {\n\n            // clear from trailLayers\n            if (key === 'trail') {\n              _self._trailLayers.removeLayer(_self._renderedData[_mileId].trail);\n            }\n\n            _self._map.removeLayer(_self._renderedData[_mileId][key]);\n\n            if (key === 'markers' || key === 'notes') {\n              _self._renderedData[_mileId][key].clearLayers();\n            }\n\n            _self._renderedData[_mileId][key] = null;\n            delete _self._renderedData[_mileId][key];\n          }\n\n          // clear container\n          _self._renderedData[_mileId] = null;\n          delete _self._renderedData[_mileId];\n          _self._visibleMiles.splice(_self._visibleMiles.indexOf(_mileId), 1);\n\n          // this leaves the array structure in place (it'll be the length of the trail, as we're using the index for reference)\n        }\n      } catch (e) {\n        console.log(e);\n      }\n\n    }\n  }\n\n  // TODO: there is overlap between this and how the elevation profile deals with the same data, could/should be optimised\n\n  // draw trail line segment\n  private _drawTrail(mile: Mile, index: number): void {\n\n    const _waypoints: Array<any> = [];\n\n    const _waypointsLength = mile.waypoints.length;\n\n    for (let i = 0; i < _waypointsLength; i++) {\n\n      const _wp: L.latLng = new L.latLng(mile.waypoints[i].latitude, mile.waypoints[i].longitude, mile.waypoints[i].elevation);\n\n      _waypoints.push(_wp);\n    }\n\n    // draw waypoints\n    const _trailLine = new L.Polyline(_waypoints, {\n      color: 'red', weight: 4, opacity: 1, smoothFactor: 0\n    });\n\n    _trailLine['mileId'] = mile.id;       // set the mileId for referencing\n\n    this._renderedData[index].trail = _trailLine;\n\n    this._trailLayers.addLayer(_trailLine);\n    _trailLine.addTo(this._map);\n  }\n\n  private _drawSnow(mile: Mile, index: number): void {\n\n    const _snowData = this._snowGenerator.getSnowForMile(index);\n\n    const snowMile = (_snowData) ? _snowData[0] : undefined;\n\n    let _snowPoints: Array<any> = [];\n\n    if (snowMile) {\n\n      mile.waypoints.forEach((waypoint) => {\n\n        function elevationRange(): number {\n\n          // waypoint distance (%) on snowarray elevation range\n          return snowMile[0].elevation + ((waypoint.distance / environment.MILE) * ((snowMile[1].elevation - snowMile[0].elevation)));\n        }\n\n        // if waypoint is above showline\n        if (waypoint.elevation >= elevationRange()) {\n\n          // add point\n          const _wp: L.latLng = new L.latLng(waypoint.latitude, waypoint.longitude, waypoint.elevation);\n          _snowPoints.push(_wp);\n\n        } else if (waypoint.elevation < elevationRange() && _snowPoints.length > 0) {\n\n          this._drawSnowLine(_snowPoints, index);\n\n          _snowPoints = [];\n        }\n\n      });\n\n      // if there is still snow to be drawn at the end of loop\n      if (_snowPoints.length > 0) {\n\n        this._drawSnowLine(_snowPoints, index);\n      }\n    }\n  }\n\n  // draw snow line segment\n  private _drawSnowLine(waypoints: Array<any>, index: number): void {\n\n    const _stroke: string = (this._screenModeService.screenModeSubject.getValue() === 'highContrast') ? '#97ffff' : 'rgba(255,255,255,0.9)';\n\n    // draw waypoints\n    const _snowLine = new L.Polyline(waypoints, {\n      color: _stroke, weight: 8, smoothFactor: 0\n    });\n\n    this._renderedData[index].snow = _snowLine;\n\n    _snowLine.addTo(this._map);\n  }\n\n  private _assemblePoiMarker (poi: Poi, optionalMarkerParams?: object): any {\n\n    const _element = document.createElement('div');\n    const _svg = SVG(_element).size(36, 54).style('overflow', 'visible');\n\n    this._markerFactory.setupMarker(_svg, poi, null);\n\n    const _poiTypeClasses  = poi.type.split(',').join('');\n\n    const _icon = htmlIcon({className: 'marker ' + _poiTypeClasses, html: _element});\n    let _options = {icon: _icon , poi: poi};\n\n    // add additional params to marker\n    if (optionalMarkerParams) {\n      _options = {..._options, ...optionalMarkerParams};\n    }\n\n    const _poiMarker = L.marker(waypointToLatLng(poi.waypoint), _options);\n    _poiMarker.on('click', this._onMarkerClick.bind({data: poi, self: this}));\n\n    return _poiMarker;\n  };\n\n  // draw pois\n  private _drawPois(mile: Mile, index: number): void {\n\n    let _mileMarkers: Array<any> = [];\n\n    if (mile.id !== 1) {\n      // startMile marker\n      _mileMarkers = _mileMarkers.concat(this._createLabelMarker(index, mile));\n    }\n\n    // pois sit on top of label markers\n    if (this.showPois) {\n\n      const _maxPoiDistance = this.localStorage.retrieve('poiMaxDistance');\n\n      if (mile.pois) {\n\n        const _poiLength = mile.pois.length;\n        for (let i = 0; i < _poiLength; i++) {\n\n          const _poi: Poi = this._trailGenerator.getPoiById(mile.pois[i]);\n\n          // filter out of range pois (TODO: side trails)\n          if (_poi.waypoint.distance >= _maxPoiDistance) {\n            return;\n          }\n\n          _mileMarkers.push(this._assemblePoiMarker(_poi));\n        }\n      }\n    }\n\n    const _markerGroup = L.featureGroup(_mileMarkers);\n    this._renderedData[index].markers = _markerGroup;\n    _markerGroup.addTo(this._map);\n  }\n\n\n  // notes are pois, but they're excluded from the marker feature group, meaning they'll be ignored for map bounds\n  private _drawNotes(mile: Mile, index: number): void {\n\n    const _noteMarkers: Array<any> = [];\n\n    const _mileNotes: Array<Poi> = this._noteService.getNotes('mile', mile.id - 1);\n\n    if (_mileNotes) {\n      const _length = _mileNotes.length;\n      for (let i = 0; i < _length; i++) {\n        const _note: Poi = _mileNotes[i];\n        _noteMarkers.push(this._assemblePoiMarker(_note));\n      }\n    }\n\n    const _notesGroup = L.featureGroup(_noteMarkers);\n    this._renderedData[index].notes = _notesGroup;\n    _notesGroup.addTo(this._map);\n  }\n\n  // add a single note, using the bounce animation\n  private _addNote(note: Poi): void {\n\n    const _bounce = {\n      bounceOnAdd: true,\n      bounceOnAddOptions: {duration: 600, height: 55},\n    };\n\n    const _noteMarker = this._assemblePoiMarker(note, _bounce);\n    this._renderedData[note.belongsTo].notes.addLayer(_noteMarker);\n  }\n\n  private _drawUser(): void {\n\n    const _self = this;\n\n    if (!this._userMarker) {\n      this._userMarker = this._createUserMarker(this.user);\n    }\n\n    if (this.user && this._map && this.user.waypoint) {\n\n      const _userLocation = new L.LatLng(this.user.waypoint.latitude, this.user.waypoint.longitude);\n\n      this._userMarker.setLatLng(_userLocation);\n\n      if (!this.userCentered) {\n        this._userMarker.on('click', function (e) {\n\n          const _closestLayer = L.GeometryUtil.closestLayer(_self._map,\n            _self._trailLayers.getLayers(), e.latlng);\n\n          if (_closestLayer) {\n\n            // get the nearest point(s) for mile (own data routine)\n            const _mile: Mile = _self._trailGenerator.getTrailData().miles[Number(_closestLayer.layer.mileId) - 1];\n            const _nearestPoints: Array<Distance> = _self._trailGenerator.findNearestWaypointInMile(_self.user.waypoint, _mile);\n\n            const _nearestMileage: string = (_self.user.anchorPoint.distanceTotal / environment.MILE).toFixed(2);\n\n            let _onOffTrailString;\n            let _2ndLine = '';\n\n            const _offTrail = (_nearestPoints[0].distance > _self.localStorage.retrieve('poiDistanceOffTrail'));\n            if (_offTrail) {\n              _onOffTrailString = (_nearestPoints[0].distance / environment.MILE).toFixed(2) + ' mi. off trail';\n              _2ndLine = 'Nearest: mi. ' + _nearestMileage;\n            } else {\n              _onOffTrailString = 'On trail';\n              _2ndLine = 'mi. ' + _nearestMileage;\n            }\n\n            _self._dynamicComponentManager.createPopupComponent(e.latlng,\n              {\n                waypoint: e.latlng,\n                label: _onOffTrailString,\n                description: _2ndLine,\n                distance: _nearestPoints[0].distance,\n                distanceTotal: _nearestMileage,\n                showCoords: true\n              }, _self._clearOverlayElements.bind(_self));\n          }\n        });\n      }\n\n      this._userMarker.addTo(this._map);\n    }\n  }\n\n  private _setBounds(): void {\n\n    if (!this.poiRange) {\n      return;\n    }\n\n    // get the poi map objects\n\n    const _bounds: Array<any> = [];\n\n    const _rLength = this._renderedData.length;\n    let _visibleMileCount = 0;\n\n    for (let i = 0; i < _rLength; i++) {\n\n      const _mileData = this._renderedData[i];\n\n      if (_mileData && _mileData.markers) {\n\n        for (const key in _mileData.markers._layers) {\n\n          const _marker = _mileData.markers._layers[key];\n\n          if (_marker.options.poi && this.poiRange.indexOf(_marker.options.poi.id) !== -1\n            || _marker.options.mileNumber && this.mileRange.indexOf(Number(_marker.options.mileNumber)) !== -1) {\n\n            if (_visibleMileCount < 5) {\n              _visibleMileCount++;\n              _bounds.push(_marker);\n            }\n          }\n        }\n      }\n    }\n\n    if (_bounds.length > 0) {\n\n      const _group = new L.featureGroup(_bounds, this.centerPoint);\n\n      this._map.stop();\n\n      // else center on the center mile of the rendered range.\n      if (this._renderedCenterMileId === -1) {\n        this._map.fitBounds(_group.getBounds(), {animate: this._animateMap, duration: 0.5, maxZoom: 16});\n      } else {\n        const _centerPoint = this._trailGenerator.getTrailData().miles[this._renderedCenterMileId].centerpoint;\n        this._map.setView([_centerPoint['latitude'], _centerPoint['longitude']], 13.75, {animate: this._animateMap, duration: 0.5, maxZoom: 16});\n      }\n    }\n  }\n\n  private _centerOnPoint(point: Waypoint, forceAnimate?: boolean): void {\n    if (this._map) {\n\n      let _animate = (this.userCentered || this._animateMap);\n\n      if (forceAnimate) {\n        _animate = forceAnimate;\n      }\n\n      this._map.panTo([point.latitude, point.longitude], {animate: _animate, duration: 0.5, maxZoom: 16});\n    }\n  }\n\n  public centerOnUser(): void {\n    if (this.user) {\n      this._centerOnPoint(this.user.waypoint);\n    }\n  }\n\n  // EVENT HANDLERS\n\n  // linked directly to svg marker (scope change)\n  private _onMarkerClick (event: MouseEvent) {\n\n    // clear all overlays\n    clearTimeOut(this['self']._popupTimer);\n    clearTimeOut(this['self']._tooltipTimer);\n\n    // center on the marker you just clicked\n    this['self']._centerOnPoint(this['data'].waypoint, true);\n\n    const _event: CustomEvent = new CustomEvent(\n      'markerClick',\n      {\n        bubbles: true,\n        cancelable: true,\n        detail: this['data']\n      });\n\n    // get DOM element on changed scope\n    this['self']._map._container.dispatchEvent(_event);\n  }\n\n\n  public onStatusChange(status: string): void {\n\n    this.status = status;\n    super.onStatusChange(status);\n    this.onUserLocationChange(this.user);\n  }\n\n  public onUserLocationChange(user: User): void {\n\n    super.onUserLocationChange(user);\n\n    if (this._map) {\n      this._drawUser();\n    }\n\n    // use the id for status\n    if (this._userMarker) {\n      this._userMarker._icon.id = this.status;\n    }\n\n    if (this.userCentered) {\n      this.centerOnUser();\n    }\n  }\n\n\n  // CREATE MAP ELEMENTS\n\n  // a label marker is drawn at the start of a mile\n  private _createLabelMarker(index: number, mile: Mile): Array<any> {\n\n    let _labelElements: Array<any> = [];\n\n    /* calculate the exact X (start) location for the mile,\n    miles overlap so it's somewhere between point 0 and 1\n    [0]=====[X]=====[1] */\n\n    // calculate percentage of X point in total covered distance by 2 points\n    const _xDistance = Math.abs(mile.waypoints[0].distance) + mile.waypoints[1].distance;\n    const _xPercentage = Math.abs(mile.waypoints[0].distance) / _xDistance;\n\n    // calculate lang/long/elevation based on percentage\n    const _xPoint: Waypoint = {\n      latitude: mile.waypoints[0].latitude + ((mile.waypoints[1].latitude - mile.waypoints[0].latitude) * _xPercentage),\n      longitude: mile.waypoints[0].longitude + ((mile.waypoints[1].longitude - mile.waypoints[0].longitude) * _xPercentage),\n      elevation: mile.waypoints[0].elevation + ((mile.waypoints[1].elevation - mile.waypoints[0].elevation) * _xPercentage),\n      distance: 0,    // unused\n      distanceTotal: (mile.id - 1) * environment.MILE\n    };\n\n    /* calculate the position of the mile marker based on the angle of the trail\n    * there are 2 measurements:\n    * - a long one (based on a quarter mile in either direction\n    * - a short one (based on 2 points ahead / 2 points behind\n    *\n    * depending on the angle and the direction a new point is generated\n    * depending on the sharpness of bend the marker distance is calucated*/\n\n    // TODO: optimise / cleanup, works fine, could/should be shorter/clearer\n\n    const _prevMile = this._trailGenerator.getTrailData().miles[index - 1];\n\n    const _nearPoint: Waypoint = mile.waypoints[2];\n    const _prevNearPoint: Waypoint = _prevMile.waypoints[_prevMile.waypoints.length - 3];\n    const _prevCenter: object = _prevMile.centerpoint;\n    const _mileCenter: object = mile.centerpoint;\n\n    const _quarterMilePoint: object = {\n      latitude: (_xPoint.latitude + Number(_mileCenter['latitude'])) / 2,\n      longitude: (_xPoint.longitude + Number(_mileCenter['longitude'])) / 2,\n    };\n\n    const _prevQuarterMilePoint: object = {\n      latitude: (_xPoint.latitude + Number(_prevCenter['latitude'])) / 2,\n      longitude: (_xPoint.longitude + Number(_prevCenter['longitude'])) / 2,\n    };\n\n    const _prevQPoint = new L.latLng(_prevQuarterMilePoint['latitude'], _prevQuarterMilePoint['longitude'], 0);\n    const _qPoint = new L.latLng(_quarterMilePoint['latitude'], _quarterMilePoint['longitude'], 0);\n    const _zPoint = new L.latLng(_xPoint.latitude, _xPoint.longitude, 0);\n    const _nPoint = new L.latLng(_nearPoint.latitude, _nearPoint.longitude, 0);\n    const _prevNPoint = new L.latLng(_prevNearPoint.latitude, _prevNearPoint.longitude, 0);\n\n    const calcHeading = function (waypoint1: any, waypoint2: any): number {\n      return Math.atan2(waypoint2.lng - waypoint1.lng, waypoint2.lat - waypoint1.lat) * 180 / Math.PI;\n    }\n\n    const _headingLong = calcHeading(_zPoint, _qPoint);\n    const _headingLongPrev = calcHeading(_prevQPoint, _zPoint);\n    const _headingShort = calcHeading(_zPoint, _nPoint);\n    const _headingShortPrev = calcHeading(_prevNPoint, _zPoint);\n\n    const _longBend = _headingLong - _headingLongPrev;\n    const _shortBend = _headingShort - _headingShortPrev;\n\n    const _shortPrevLongBend = _headingShort - _headingLongPrev;\n\n    let _useShort: boolean;\n    let _overHalf: boolean;\n\n    if (_longBend > 0) {\n      if (_shortPrevLongBend < _longBend) {\n        _useShort = true;\n      } else {\n        _overHalf = true;\n      }\n    } else {\n      if (_shortPrevLongBend > _longBend) {\n        _useShort = true;\n      } else {\n      }\n    }\n\n    if (_useShort) {\n      if (_shortBend > 0) {\n        _overHalf = true;\n      }\n    }\n\n    // the actual angle calculation\n    const _startAngle = (_useShort) ? _headingShortPrev : _headingLongPrev;\n    const _offsetAngle = (_useShort) ? _shortBend : _longBend;\n\n    // distance gets smaller the sharper the corner is...\n    const _distancePerc = 1 - Math.abs(_offsetAngle / 180);\n\n    let _angle: number = _startAngle + (_offsetAngle / 2);\n    _angle = (_overHalf) ? _angle - 90 : _angle + 90;\n\n    // from -180 to 180\n    if (_angle > 180) {\n      _angle = -180 - (_angle - 180);\n    } else if (_angle < -180) {\n      _angle = 180 - Math.abs(_angle - 180);\n    }\n\n    const _distance = (environment.MILE / 8) * _distancePerc;\n\n    const _point: Waypoint = this._createPoint(_xPoint, _angle, _distance);\n\n    const _labelIcon = L.divIcon({className: 'mile-marker', html: '<div class=\"label\">' + (mile.id - 1) + '</div>'});\n    _labelElements.push(L.marker([_point.latitude, _point.longitude], {icon: _labelIcon, mileNumber: mile.id - 1}));\n\n    const _newPoint = new L.latLng(_point.latitude, _point.longitude, 0);\n\n    if (_distance > 0) {\n      _labelElements = _labelElements.concat(this._createGuide(_zPoint, _newPoint));\n    }\n\n    return _labelElements;\n  }\n\n  // create a point based on distance/angle of another point\n  private _createPoint(point: Waypoint, angle: number, meters: number): Waypoint {\n\n    const toRad = function(deg: number) {\n      return deg * Math.PI / 180;\n    }\n\n    const toDeg = function(rad: number) {\n      return rad * 180 / Math.PI;\n    }\n\n    const dist = (meters / 1000) / 6371;\n    angle = toRad(angle);\n\n    const lat1 = toRad(point.latitude), lon1 = toRad(point.longitude);\n\n    const lat2 = Math.asin(Math.sin(lat1) * Math.cos(dist) +\n      Math.cos(lat1) * Math.sin(dist) * Math.cos(angle));\n\n    const lon2 = lon1 + Math.atan2(Math.sin(angle) * Math.sin(dist) *\n      Math.cos(lat1),\n      Math.cos(dist) - Math.sin(lat1) *\n      Math.sin(lat2));\n\n    if (isNaN(lat2) || isNaN(lon2)) { return; }\n\n    return {latitude: toDeg(lat2), longitude: toDeg(lon2), elevation: 0};\n  }\n\n  // create an svg user marker\n  private _createUserMarker(user: User): any {\n    if (!user) {\n      return;\n    }\n    return L.marker([user.waypoint.latitude, user.waypoint.longitude], {icon: this._markerFactory.createLeafletUserMarker(), user: user, forceZIndex: 1000});\n  }\n\n  // create a guide line, with optional arrowheads on either side.\n  private _createGuide(point1: any, point2: any, arrowHeadStart?: boolean, arrowHeadEnd?: boolean, color?: string, width?: number): Array<any> {\n\n    const _elements: Array<any> = [];\n\n    const _weight = width || 2;\n\n    const _guide = new L.geodesic([], {\n      color: color || 'rgb(119, 119, 119)',\n      dashArray: _weight * 2.5 + ' ' + _weight * 3.5,\n      weight: _weight,\n      opacity: 1,\n      smoothFactor: 3,\n      steps: 10\n    });\n\n    _guide.setLatLngs([[point1, point2]]);\n\n    _elements.push(_guide);\n\n    const _createArrowHead = function (guide: any, positionPerc: number): any {\n\n      const _angle = (positionPerc === 0 ) ? 270 : 90;\n\n      return L.polylineDecorator(guide, {\n        patterns: [{\n          offset: positionPerc + '%',\n          repeat: 0,\n          symbol: L.Symbol.arrowHead({\n            pixelSize: 5,\n            headAngle: _angle,\n            polygon: false,\n            pathOptions: {\n              color: color,\n              weight: 2}\n          })\n        }]\n      });\n    };\n\n    if (arrowHeadStart) {\n      _elements.push(_createArrowHead(_guide, 0));\n    }\n\n    if (arrowHeadEnd) {\n      _elements.push(_createArrowHead(_guide, 100));\n    }\n\n    return _elements;\n  }\n\n  private _removeMarkerByPoiId(poiId: number): void {\n\n    const _self = this;\n\n    if(this._map) {\n      this._map.eachLayer(function (layer) {\n        if (layer.options.poi && layer.options.poi.id === poiId) {\n          _self._map.removeLayer(layer);\n        }\n      });\n    }\n  }\n\n}\n","module.exports = \"<div class=\\\"{{this.state}}\\\" id=\\\"loader-wrap\\\">\\n  <div id=\\\"loader\\\">\\n    <div id=\\\"box\\\"></div>\\n    <div id=\\\"hill\\\"></div>\\n    <div id=\\\"meta\\\">\\n      <div id=\\\"spinner\\\" *ngIf=\\\"spinner\\\">spin</div>\\n      <p id=\\\"message\\\" *ngIf=\\\"message\\\">{{message}}</p>\\n      <button id=\\\"button\\\" *ngIf=\\\"button\\\">{{button.label}}</button>\\n    </div>\\n  </div>\\n</div>\\n\"","module.exports = \":host #loader-wrap {\\n  position: fixed;\\n  width: 100%;\\n  height: 100%;\\n  background-color: #EEE;\\n  z-index: 2000; }\\n\\n:host .show {\\n  visibility: visible;\\n  opacity: 1;\\n  transition: opacity 0.25s linear; }\\n\\n:host .hide {\\n  visibility: hidden;\\n  opacity: 0;\\n  transition: visibility 0s 0.15s, opacity 0.15s linear; }\\n\\n:host #loader {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  margin-top: -2.7em;\\n  margin-left: -2.7em;\\n  width: 5.4em;\\n  height: 5.4em;\\n  background-color: transparent; }\\n\\n:host #loader #meta {\\n    padding-top: 8em;\\n    width: 100vw;\\n    font-size: 12px; }\\n\\n:host #loader #meta #message {\\n      display: block;\\n      width: 100%; }\\n\\n:host #loader #hill {\\n    position: absolute;\\n    width: 7.1em;\\n    height: 7.1em;\\n    top: 1.7em;\\n    left: 1.7em;\\n    background-color: transparent;\\n    border-left: .25em solid #333;\\n    -webkit-transform: rotate(45deg);\\n            transform: rotate(45deg); }\\n\\n:host #loader #hill:after {\\n    content: '';\\n    position: absolute;\\n    width: 7.1em;\\n    height: 7.1em;\\n    left: 0;\\n    background-color: transparent; }\\n\\n:host #loader #box {\\n    position: absolute;\\n    left: 0;\\n    bottom: -.1em;\\n    width: 1em;\\n    height: 1em;\\n    background-color: transparent;\\n    border: .25em solid #333;\\n    border-radius: 15%;\\n    -webkit-transform: translate(0, -1em) rotate(-45deg);\\n            transform: translate(0, -1em) rotate(-45deg);\\n    -webkit-animation: push 2.5s cubic-bezier(0.79, 0, 0.47, 0.97) infinite;\\n            animation: push 2.5s cubic-bezier(0.79, 0, 0.47, 0.97) infinite; }\\n\\n@-webkit-keyframes push {\\n  0% {\\n    -webkit-transform: translate(0, -1em) rotate(-45deg);\\n            transform: translate(0, -1em) rotate(-45deg); }\\n  5% {\\n    -webkit-transform: translate(0, -1em) rotate(-50deg);\\n            transform: translate(0, -1em) rotate(-50deg); }\\n  20% {\\n    -webkit-transform: translate(1em, -2em) rotate(47deg);\\n            transform: translate(1em, -2em) rotate(47deg); }\\n  25% {\\n    -webkit-transform: translate(1em, -2em) rotate(45deg);\\n            transform: translate(1em, -2em) rotate(45deg); }\\n  30% {\\n    -webkit-transform: translate(1em, -2em) rotate(40deg);\\n            transform: translate(1em, -2em) rotate(40deg); }\\n  45% {\\n    -webkit-transform: translate(2em, -3em) rotate(137deg);\\n            transform: translate(2em, -3em) rotate(137deg); }\\n  50% {\\n    -webkit-transform: translate(2em, -3em) rotate(135deg);\\n            transform: translate(2em, -3em) rotate(135deg); }\\n  55% {\\n    -webkit-transform: translate(2em, -3em) rotate(130deg);\\n            transform: translate(2em, -3em) rotate(130deg); }\\n  70% {\\n    -webkit-transform: translate(3em, -4em) rotate(217deg);\\n            transform: translate(3em, -4em) rotate(217deg); }\\n  75% {\\n    -webkit-transform: translate(3em, -4em) rotate(220deg);\\n            transform: translate(3em, -4em) rotate(220deg); }\\n  100% {\\n    -webkit-transform: translate(0, -1em) rotate(-225deg);\\n            transform: translate(0, -1em) rotate(-225deg); } }\\n\\n@keyframes push {\\n  0% {\\n    -webkit-transform: translate(0, -1em) rotate(-45deg);\\n            transform: translate(0, -1em) rotate(-45deg); }\\n  5% {\\n    -webkit-transform: translate(0, -1em) rotate(-50deg);\\n            transform: translate(0, -1em) rotate(-50deg); }\\n  20% {\\n    -webkit-transform: translate(1em, -2em) rotate(47deg);\\n            transform: translate(1em, -2em) rotate(47deg); }\\n  25% {\\n    -webkit-transform: translate(1em, -2em) rotate(45deg);\\n            transform: translate(1em, -2em) rotate(45deg); }\\n  30% {\\n    -webkit-transform: translate(1em, -2em) rotate(40deg);\\n            transform: translate(1em, -2em) rotate(40deg); }\\n  45% {\\n    -webkit-transform: translate(2em, -3em) rotate(137deg);\\n            transform: translate(2em, -3em) rotate(137deg); }\\n  50% {\\n    -webkit-transform: translate(2em, -3em) rotate(135deg);\\n            transform: translate(2em, -3em) rotate(135deg); }\\n  55% {\\n    -webkit-transform: translate(2em, -3em) rotate(130deg);\\n            transform: translate(2em, -3em) rotate(130deg); }\\n  70% {\\n    -webkit-transform: translate(3em, -4em) rotate(217deg);\\n            transform: translate(3em, -4em) rotate(217deg); }\\n  75% {\\n    -webkit-transform: translate(3em, -4em) rotate(220deg);\\n            transform: translate(3em, -4em) rotate(220deg); }\\n  100% {\\n    -webkit-transform: translate(0, -1em) rotate(-225deg);\\n            transform: translate(0, -1em) rotate(-225deg); } }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9sb2FkZXItb3ZlcmxheS9sb2FkZXItb3ZlcmxheS5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLGVBQWU7RUFDZixXQUFXO0VBQ1gsWUFBWTtFQUNaLHNCQUFzQjtFQUN0QixhQUFhLEVBQUE7O0FBUGhCO0VBVUcsbUJBQW1CO0VBQ25CLFVBQVU7RUFDVixnQ0FBZ0MsRUFBQTs7QUFabkM7RUFlRyxrQkFBa0I7RUFDbEIsVUFBVTtFQUNWLHFEQUFxRCxFQUFBOztBQWpCeEQ7RUFvQkcsa0JBQWtCO0VBQ2xCLFFBQVE7RUFDUixTQUFTO0VBQ1Qsa0JBQWtCO0VBQ2xCLG1CQUFtQjtFQUNuQixZQUFZO0VBQ1osYUFBYTtFQUNiLDZCQUE2QixFQUFBOztBQTNCaEM7SUErQkssZ0JBQWdCO0lBQ2hCLFlBQVk7SUFDWixlQUFlLEVBQUE7O0FBakNwQjtNQW9DTyxjQUFjO01BQ2QsV0FBVyxFQUFBOztBQXJDbEI7SUF3Q0ssa0JBQWtCO0lBQ2xCLFlBQVk7SUFDWixhQUFhO0lBQ2IsVUFBVTtJQUNWLFdBQVc7SUFDWCw2QkFBNkI7SUFDN0IsNkJBQTZCO0lBQzdCLGdDQUF3QjtZQUF4Qix3QkFBd0IsRUFBQTs7QUEvQzdCO0lBa0RLLFdBQVc7SUFDWCxrQkFBa0I7SUFDbEIsWUFBWTtJQUNaLGFBQWE7SUFDYixPQUFPO0lBQ1AsNkJBQTZCLEVBQUE7O0FBdkRsQztJQTBESyxrQkFBa0I7SUFDbEIsT0FBTztJQUNQLGFBQWE7SUFDYixVQUFVO0lBQ1YsV0FBVztJQUNYLDZCQUE2QjtJQUM3Qix3QkFBd0I7SUFDeEIsa0JBQWtCO0lBQ2xCLG9EQUE0QztZQUE1Qyw0Q0FBNEM7SUFDNUMsdUVBQTREO1lBQTVELCtEQUE0RCxFQUFBOztBQUVoRTtFQUNFO0lBQ0Usb0RBQTRDO1lBQTVDLDRDQUE0QyxFQUFBO0VBQzlDO0lBQ0Usb0RBQTRDO1lBQTVDLDRDQUE0QyxFQUFBO0VBQzlDO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBO0VBQy9DO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBO0VBQy9DO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBO0VBQy9DO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBLEVBQUE7O0FBdEJqRDtFQUNFO0lBQ0Usb0RBQTRDO1lBQTVDLDRDQUE0QyxFQUFBO0VBQzlDO0lBQ0Usb0RBQTRDO1lBQTVDLDRDQUE0QyxFQUFBO0VBQzlDO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBO0VBQy9DO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBO0VBQy9DO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBO0VBQy9DO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0Usc0RBQThDO1lBQTlDLDhDQUE4QyxFQUFBO0VBQ2hEO0lBQ0UscURBQTZDO1lBQTdDLDZDQUE2QyxFQUFBLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvbG9hZGVyLW92ZXJsYXkvbG9hZGVyLW92ZXJsYXkuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuXG4gICNsb2FkZXItd3JhcCB7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRUVFO1xuICAgIHotaW5kZXg6IDIwMDA7IH1cblxuICAuc2hvdyB7XG4gICAgdmlzaWJpbGl0eTogdmlzaWJsZTtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4yNXMgbGluZWFyOyB9XG5cbiAgLmhpZGUge1xuICAgIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgICBvcGFjaXR5OiAwO1xuICAgIHRyYW5zaXRpb246IHZpc2liaWxpdHkgMHMgMC4xNXMsIG9wYWNpdHkgMC4xNXMgbGluZWFyOyB9XG5cbiAgI2xvYWRlciB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogNTAlO1xuICAgIGxlZnQ6IDUwJTtcbiAgICBtYXJnaW4tdG9wOiAtMi43ZW07XG4gICAgbWFyZ2luLWxlZnQ6IC0yLjdlbTtcbiAgICB3aWR0aDogNS40ZW07XG4gICAgaGVpZ2h0OiA1LjRlbTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcblxuICAgICNtZXRhIHtcblxuICAgICAgcGFkZGluZy10b3A6IDhlbTtcbiAgICAgIHdpZHRoOiAxMDB2dztcbiAgICAgIGZvbnQtc2l6ZTogMTJweDtcblxuICAgICAgI21lc3NhZ2Uge1xuICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgd2lkdGg6IDEwMCU7IH0gfVxuXG4gICAgI2hpbGwge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgd2lkdGg6IDcuMWVtO1xuICAgICAgaGVpZ2h0OiA3LjFlbTtcbiAgICAgIHRvcDogMS43ZW07XG4gICAgICBsZWZ0OiAxLjdlbTtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgICAgYm9yZGVyLWxlZnQ6IC4yNWVtIHNvbGlkICMzMzM7XG4gICAgICB0cmFuc2Zvcm06IHJvdGF0ZSg0NWRlZyk7IH1cblxuICAgICNoaWxsOmFmdGVyIHtcbiAgICAgIGNvbnRlbnQ6ICcnO1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgd2lkdGg6IDcuMWVtO1xuICAgICAgaGVpZ2h0OiA3LjFlbTtcbiAgICAgIGxlZnQ6IDA7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgfVxuXG4gICAgI2JveCB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBsZWZ0OiAwO1xuICAgICAgYm90dG9tOiAtLjFlbTtcbiAgICAgIHdpZHRoOiAxZW07XG4gICAgICBoZWlnaHQ6IDFlbTtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICAgICAgYm9yZGVyOiAuMjVlbSBzb2xpZCAjMzMzO1xuICAgICAgYm9yZGVyLXJhZGl1czogMTUlO1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMCwgLTFlbSkgcm90YXRlKC00NWRlZyk7XG4gICAgICBhbmltYXRpb246IHB1c2ggMi41cyBjdWJpYy1iZXppZXIoLjc5LCAwLCAuNDcsIC45NykgaW5maW5pdGU7IH0gfVxuXG4gIEBrZXlmcmFtZXMgcHVzaCB7XG4gICAgMCUge1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMCwgLTFlbSkgcm90YXRlKC00NWRlZyk7IH1cbiAgICA1JSB7XG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwLCAtMWVtKSByb3RhdGUoLTUwZGVnKTsgfVxuICAgIDIwJSB7XG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgxZW0sIC0yZW0pIHJvdGF0ZSg0N2RlZyk7IH1cbiAgICAyNSUge1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMWVtLCAtMmVtKSByb3RhdGUoNDVkZWcpOyB9XG4gICAgMzAlIHtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDFlbSwgLTJlbSkgcm90YXRlKDQwZGVnKTsgfVxuICAgIDQ1JSB7XG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgyZW0sIC0zZW0pIHJvdGF0ZSgxMzdkZWcpOyB9XG4gICAgNTAlIHtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDJlbSwgLTNlbSkgcm90YXRlKDEzNWRlZyk7IH1cbiAgICA1NSUge1xuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoMmVtLCAtM2VtKSByb3RhdGUoMTMwZGVnKTsgfVxuICAgIDcwJSB7XG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgzZW0sIC00ZW0pIHJvdGF0ZSgyMTdkZWcpOyB9XG4gICAgNzUlIHtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDNlbSwgLTRlbSkgcm90YXRlKDIyMGRlZyk7IH1cbiAgICAxMDAlIHtcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAsIC0xZW0pIHJvdGF0ZSgtMjI1ZGVnKTsgfSB9IH1cbiJdfQ== */\"","import {Component, Input, OnInit, OnChanges, SimpleChanges, isDevMode, ChangeDetectorRef} from '@angular/core';\nimport { LoaderService } from '../../service/loader.service';\n\n@Component({\n  selector: 'loader-overlay',\n  templateUrl: './loader-overlay.component.html',\n  styleUrls: ['./loader-overlay.component.sass']\n})\n\nexport class LoaderOverlayComponent implements OnInit, OnChanges {\n\n  @Input() showLoader: boolean;\n\n  public state = 'show';\n  public spinner: boolean;\n  public message: number;\n  public button: object;\n\n  public activeMetaObjects: Array<string> = [];\n\n  // simple loader animation component, uses the loader service\n  constructor(\n    private _changeDetector: ChangeDetectorRef,\n    private _loaderService: LoaderService\n  ) {}\n\n  ngOnInit(): void {\n\n    this._loaderService.observe.subscribe((obj: object) => {\n\n      if (isDevMode()) {\n        console.log(obj['action'], obj['type'], obj['data']);\n      }\n\n      if (obj['action'] === 'show' && obj['type'] !== 'self') {\n\n        if (obj['type'] === 'spinner') {\n          this.spinner = true;\n        } else {\n          this[obj['type']] = obj['data'] as String;\n        }\n\n      } else if (obj['action'] === 'hide' && obj['type'] !== 'self') {\n\n         if (obj['type'] === 'spinner') {\n            this.spinner = false;\n         } else {\n           this[obj['type']] = null;\n         }\n      }\n\n      this._changeDetector.detectChanges();\n\n    });\n  }\n\n  // only gets triggered through @Input showLoader\n  ngOnChanges(changes: SimpleChanges): void {\n    this.state = (this.showLoader) ? 'show' : 'hide';\n  }\n}\n","module.exports = \"<div id=\\\"layout\\\">\\n  <div id=\\\"main\\\">\\n    <leaflet-map\\n      name=\\\"detail-map\\\"\\n      [allowPanning]=true\\n      [allowZooming]=true\\n      [showPois]=true\\n      [showMapTiles]=true\\n      [activeMileId]=\\\"routedMile\\\"\\n      [centerPoint]=\\\"centerPoint\\\"\\n      [poiRange]=\\\"visiblePoiRange\\\"\\n      [mileRange]=\\\"visibleMileRange\\\"\\n      [range]=\\\"drawRange\\\">\\n    </leaflet-map>\\n    <div id=\\\"overlay\\\"></div>    <!-- inner shadow -->\\n  </div>\\n  <div id=\\\"list\\\">\\n    <poi-list\\n      [directionReversal]=\\\"isNobo\\\"\\n      [milesData]=\\\"trailData.miles\\\"\\n      [showUser]=\\\"true\\\"\\n      [activeMileId]=\\\"routedMile\\\"\\n      (scrollToEvent)=\\\"onScrollTo($event)\\\">\\n    </poi-list>\\n  </div>\\n</div>\\n\"","module.exports = \":host #layout {\\n  display: grid;\\n  grid-template-columns: 61.8vw auto;\\n  grid-template-areas: 'main list';\\n  height: 100vh; }\\n  :host #layout #main {\\n    height: 100%;\\n    grid-area: main; }\\n  :host #layout #main #overlay {\\n      position: absolute;\\n      top: 0;\\n      width: 61.8vw;\\n      height: 100vh;\\n      pointer-events: none;\\n      box-shadow: inset -15px 0px 20px -20px rgba(0, 0, 0, 0.5);\\n      z-index: 1000; }\\n  :host #layout #list {\\n    grid-area: list;\\n    min-width: 150px;\\n    overflow-y: scroll;\\n    border-left: 1px solid #CCC;\\n    /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#f7f7f7+0,f9f9f9+7 */\\n    background: #f7f7f7;\\n    background: linear-gradient(to right, #f7f7f7 0%, #f9f9f9 7%);\\n    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f7f7f7', endColorstr='#f9f9f9',GradientType=1 ); }\\n  :host #center-user-btn {\\n  position: absolute;\\n  bottom: 0;\\n  left: 0;\\n  z-index: 1000; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9taWxlLWRldGFpbC9taWxlLWRldGFpbC5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLGFBQWE7RUFDYixrQ0FBa0M7RUFDbEMsZ0NBQWdDO0VBQ2hDLGFBQWEsRUFBQTtFQU5oQjtJQVNLLFlBQVk7SUFDWixlQUFlLEVBQUE7RUFWcEI7TUFhTyxrQkFBa0I7TUFDbEIsTUFBTTtNQUNOLGFBQWE7TUFDYixhQUFhO01BQ2Isb0JBQW9CO01BR3BCLHlEQUFzRDtNQUN0RCxhQUFhLEVBQUE7RUFyQnBCO0lBd0JLLGVBQWU7SUFDZixnQkFBZ0I7SUFDaEIsa0JBQWtCO0lBRWxCLDJCQUEyQjtJQUUzQiw4R0FBQTtJQUNBLG1CQUE0QjtJQUc1Qiw2REFBb0Y7SUFDcEYsbUhBQW1ILEVBQUE7RUFuQ3hIO0VBdUNHLGtCQUFrQjtFQUNsQixTQUFTO0VBQ1QsT0FBTztFQUNQLGFBQWEsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9taWxlLWRldGFpbC9taWxlLWRldGFpbC5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG5cbiAgI2xheW91dCB7XG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDYxLjh2dyBhdXRvO1xuICAgIGdyaWQtdGVtcGxhdGUtYXJlYXM6ICdtYWluIGxpc3QnO1xuICAgIGhlaWdodDogMTAwdmg7XG5cbiAgICAjbWFpbiB7XG4gICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICBncmlkLWFyZWE6IG1haW47XG5cbiAgICAgICNvdmVybGF5IHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICB0b3A6IDA7XG4gICAgICAgIHdpZHRoOiA2MS44dnc7XG4gICAgICAgIGhlaWdodDogMTAwdmg7XG4gICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICAgICAgICAtd2Via2l0LWJveC1zaGFkb3c6IGluc2V0IC0xNXB4IDBweCAyMHB4IC0yMHB4IHJnYmEoMCwwLDAsMC41KTtcbiAgICAgICAgLW1vei1ib3gtc2hhZG93OiBpbnNldCAtMTVweCAwcHggMjBweCAtMjBweCByZ2JhKDAsMCwwLDAuNSk7XG4gICAgICAgIGJveC1zaGFkb3c6IGluc2V0IC0xNXB4IDBweCAyMHB4IC0yMHB4IHJnYmEoMCwwLDAsMC41KTtcbiAgICAgICAgei1pbmRleDogMTAwMDsgfSB9XG5cbiAgICAjbGlzdCB7XG4gICAgICBncmlkLWFyZWE6IGxpc3Q7XG4gICAgICBtaW4td2lkdGg6IDE1MHB4O1xuICAgICAgb3ZlcmZsb3cteTogc2Nyb2xsO1xuXG4gICAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNDQ0M7XG5cbiAgICAgIC8qIFBlcm1hbGluayAtIHVzZSB0byBlZGl0IGFuZCBzaGFyZSB0aGlzIGdyYWRpZW50OiBodHRwOi8vY29sb3J6aWxsYS5jb20vZ3JhZGllbnQtZWRpdG9yLyNmN2Y3ZjcrMCxmOWY5ZjkrNyAqL1xuICAgICAgYmFja2dyb3VuZDogcmdiKDI0NywyNDcsMjQ3KSAvKiBPbGQgYnJvd3NlcnMgKi87XG4gICAgICBiYWNrZ3JvdW5kOiAtbW96LWxpbmVhci1ncmFkaWVudChsZWZ0LCByZ2JhKDI0NywyNDcsMjQ3LDEpIDAlLCByZ2JhKDI0OSwyNDksMjQ5LDEpIDclKSAvKiBGRjMuNi0xNSAqLztcbiAgICAgIGJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KGxlZnQsIHJnYmEoMjQ3LDI0NywyNDcsMSkgMCUscmdiYSgyNDksMjQ5LDI0OSwxKSA3JSkgLyogQ2hyb21lMTAtMjUsU2FmYXJpNS4xLTYgKi87XG4gICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsIHJnYmEoMjQ3LDI0NywyNDcsMSkgMCUscmdiYSgyNDksMjQ5LDI0OSwxKSA3JSkgLyogVzNDLCBJRTEwKywgRkYxNissIENocm9tZTI2KywgT3BlcmExMissIFNhZmFyaTcrICovO1xuICAgICAgZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoIHN0YXJ0Q29sb3JzdHI9JyNmN2Y3ZjcnLCBlbmRDb2xvcnN0cj0nI2Y5ZjlmOScsR3JhZGllbnRUeXBlPTEgKSAvKiBJRTYtOSAqLzsgfSB9XG5cblxuICAjY2VudGVyLXVzZXItYnRuIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgYm90dG9tOiAwO1xuICAgIGxlZnQ6IDA7XG4gICAgei1pbmRleDogMTAwMDsgfSB9XG4iXX0= */\"","import {Component, OnDestroy, OnInit} from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {Trail} from '../../type/trail';\nimport {Waypoint} from '../../type/waypoint';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {LocationService} from '../../service/location.service';\nimport {BaseComponent} from '../../base/base/base.component';\nimport {ConnectionService} from '../../service/connection.service';\nimport {RateService} from '../../service/rate.service';\n\n@Component({\n  selector: 'app-mile-detail',\n  templateUrl: './mile-detail.component.html',\n  styleUrls: ['./mile-detail.component.sass']\n})\n\nexport class MileDetailComponent extends BaseComponent implements OnInit {\n\n  public routedMile:              number;\n  public trailData:               Trail;\n  public centerPoint:             Waypoint;\n  public isNobo:                  boolean;\n  public isTracking:              boolean;\n\n  public visiblePoiRange:         any;          // the visible poi range (in the poi list)\n  public visibleMileRange:        any;          // the visible mile range (in the poi list)\n  public drawRange:               any;          // the range thats actually rendered\n\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _locationService: LocationService,\n    private _route: ActivatedRoute,\n    private _router: Router\n  ) {\n    super();\n  }\n\n\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n    this.isNobo = (this._localStorage.retrieve('direction') === 0);\n    this._addSubscriptions();\n  }\n\n\n\n  // SUBSCRIPTIONS\n\n  private _addSubscriptions(): void {\n\n    const _self = this;\n\n    // get miles data based on route id\n    this.routedMile = (this._route.snapshot) ? Number(this._route.snapshot.paramMap.get('id')) : 0;\n\n    this.addSubscription('routeData', this._route.data.subscribe(result => {\n        this.trailData = result.data['trail'];\n        this._setMapData(this.routedMile);\n      }\n    ));\n\n    this.addSubscription('location', this._locationService.locationStatus.subscribe(function(result) {\n      _self.isTracking = (result === 'tracking');\n    }));\n  }\n\n\n\n  // EVENTS\n\n  public onScrollTo(data: any): void {\n\n    console.log('on scroll to', data.mileId);\n    this._setMapData(data.mileId, data.renderedPoiRange, data.renderedMileRange);\n    this.routedMile = data.mileId;\n\n    /* updating queryParamams (this._router.navigate) seems to cause bugs over time on iOS,\n    so i'm setting a property that will be used for the back button navigate call */\n    this._router['scrollToPosition'] = this.routedMile;\n    //this._router.navigate(['.'], {relativeTo: this._route, queryParams: {back: this.routedMile}});\n  }\n\n  private _setMapData(mileId: number, poiRange?: any, mileRange?: any): void {\n\n    if (mileRange && mileRange.length > 0) {\n\n      mileRange.sort((a, b) => a - b);\n\n      this.drawRange = {\n        behind: Math.abs(mileId - mileRange[0]) + 3,\n        ahead: Math.abs(  mileRange[mileRange.length - 1] - mileId)\n      };\n\n      this.visibleMileRange = mileRange;\n    }\n\n    if (poiRange && poiRange.length > 0) {\n      this.visiblePoiRange = poiRange;\n    }\n\n    mileId = (mileId === 0) ? 0 : mileId - 1;\n\n    this.centerPoint = this.trailData.miles[mileId].centerpoint as Waypoint;\n  }\n}\n","module.exports = \"<button id=\\\"locator\\\" (click)=\\\"onClick()\\\" [className]=\\\"(status === 'tracking' && showMiniMap) ? 'active' : 'inactive'\\\" #container>\\n  <span *ngIf=\\\"user && showMiniMap\\\">\\n    <leaflet-map\\n\\n      id=\\\"mini-map\\\"\\n\\n      [className]=\\\"status === 'tracking' ? 'visible' : 'invisible'\\\"\\n\\n      name=\\\"mini-map\\\"\\n\\n      [allowPanning]=false\\n      [allowZooming]=false\\n      [showPois]=false\\n      [showMapTiles]=true\\n      [activeMileId]=\\\"nearestMileId\\\"\\n      [userCentered]=true\\n      [range]=\\\"{behind: 2, ahead: 2}\\\"\\n    >\\n    </leaflet-map>\\n  </span>\\n  <fa-layers [fixedWidth]=\\\"true\\\">\\n    <fa-icon icon=\\\"location-arrow\\\" size=\\\"2x\\\" [className]=\\\"status === 'idle' ? 'visible' : 'invisible'\\\"></fa-icon>\\n    <fa-icon [icon]=\\\"['far', 'compass']\\\" [spin]=\\\"true\\\" size=\\\"2x\\\" [className]=\\\"status === 'fetching' ? 'visible' : 'invisible'\\\"></fa-icon>\\n    <fa-icon icon=\\\"hiking\\\" size=\\\"2x\\\" [className]=\\\"status === 'tracking' && !showMiniMap ? 'visible' : 'invisible'\\\"></fa-icon>\\n    <fa-icon id=\\\"error\\\" icon=\\\"exclamation-triangle\\\" size=\\\"2x\\\" [className]=\\\"status === 'error' ? 'visible' : 'invisible'\\\"></fa-icon>\\n  </fa-layers>\\n</button>\\n\"","module.exports = \":host button:focus {\\n  outline: 0; }\\n\\n:host button {\\n  position: relative;\\n  background-image: unset;\\n  /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#ffffff+0,ffffff+100&0.78+0,0.55+100 */\\n  background: linear-gradient(135deg, rgba(255, 255, 255, 0.78) 0%, rgba(255, 255, 255, 0.55) 100%);\\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c7ffffff', endColorstr='#8cffffff',GradientType=1 );\\n  border-radius: 50%;\\n  font-size: 1.5vw;\\n  width: 7vw;\\n  height: 7vw;\\n  margin: 10px 10px 0 0;\\n  padding: 0;\\n  outline: none;\\n  border: 2px solid white;\\n  overflow: hidden;\\n  box-shadow: 0px 5px 10px -5px rgba(0, 0, 0, 0.35);\\n  -webkit-backdrop-filter: blur(6px);\\n          backdrop-filter: blur(6px);\\n  color: #555;\\n  transition: all 200ms ease;\\n  transition-property: width, height, border-radius, padding; }\\n\\n:host button fa-icon {\\n    -webkit-filter: drop-shadow(-1px -2px 1px rgba(0, 0, 0, 0.1)) drop-shadow(2px 3px 2px white);\\n            filter: drop-shadow(-1px -2px 1px rgba(0, 0, 0, 0.1)) drop-shadow(2px 3px 2px white); }\\n\\n:host button #mini-map {\\n    position: absolute;\\n    top: 0;\\n    left: 0;\\n    width: 15vw;\\n    height: 15vw;\\n    transition-property: opacity;\\n    opacity: 0;\\n    visibility: hidden;\\n    transition: all 200ms ease; }\\n\\n:host button fa-icon {\\n    position: absolute;\\n    top: 50%;\\n    left: -35%; }\\n\\n:host button #error {\\n    color: red; }\\n\\n:host .active {\\n  padding: env(safe-area-inset-right);\\n  width: 15vw;\\n  height: 15vw;\\n  border-radius: 5%; }\\n\\n:host .active #mini-map {\\n    opacity: 1;\\n    visibility: visible; }\\n\\n:host .visible {\\n  opacity: 1;\\n  visibility: visible; }\\n\\n:host .invisible {\\n  opacity: 0;\\n  visibility: hidden; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9uYXZpZ2F0aW9uL2xvY2F0b3IvbG9jYXRvci5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLFVBQVUsRUFBQTs7QUFIYjtFQU1HLGtCQUFrQjtFQUNsQix1QkFBdUI7RUFFdkIsZ0lBQUE7RUFHQSxpR0FBMEY7RUFDMUYsdUhBQXVIO0VBRXZILGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsVUFBVTtFQUNWLFdBQVc7RUFDWCxxQkFBcUI7RUFDckIsVUFBVTtFQUNWLGFBQWE7RUFDYix1QkFBdUI7RUFDdkIsZ0JBQWdCO0VBR2hCLGlEQUE4QztFQUM5QyxrQ0FBMEI7VUFBMUIsMEJBQTBCO0VBQzFCLFdBQVc7RUFFWCwwQkFBMEI7RUFDMUIsMERBQTBELEVBQUE7O0FBL0I3RDtJQWtDSyw0RkFBaUY7WUFBakYsb0ZBQWlGLEVBQUE7O0FBbEN0RjtJQXFDSyxrQkFBa0I7SUFDbEIsTUFBTTtJQUNOLE9BQU87SUFDUCxXQUFXO0lBQ1gsWUFBWTtJQUNaLDRCQUE0QjtJQUM1QixVQUFVO0lBQ1Ysa0JBQWtCO0lBQ2xCLDBCQUEwQixFQUFBOztBQTdDL0I7SUFnREssa0JBQWtCO0lBQ2xCLFFBQVE7SUFDUixVQUFVLEVBQUE7O0FBbERmO0lBcURLLFVBQVUsRUFBQTs7QUFyRGY7RUF3REcsbUNBQW1DO0VBQ25DLFdBQVc7RUFDWCxZQUFZO0VBQ1osaUJBQWlCLEVBQUE7O0FBM0RwQjtJQThESyxVQUFVO0lBQ1YsbUJBQW1CLEVBQUE7O0FBL0R4QjtFQWtFRyxVQUFVO0VBQ1YsbUJBQW1CLEVBQUE7O0FBbkV0QjtFQXFFRyxVQUFVO0VBQ1Ysa0JBQWtCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvbmF2aWdhdGlvbi9sb2NhdG9yL2xvY2F0b3IuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuXG4gIGJ1dHRvbjpmb2N1cyB7XG4gICAgb3V0bGluZTogMDsgfVxuXG4gIGJ1dHRvbiB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIGJhY2tncm91bmQtaW1hZ2U6IHVuc2V0O1xuXG4gICAgLyogUGVybWFsaW5rIC0gdXNlIHRvIGVkaXQgYW5kIHNoYXJlIHRoaXMgZ3JhZGllbnQ6IGh0dHA6Ly9jb2xvcnppbGxhLmNvbS9ncmFkaWVudC1lZGl0b3IvI2ZmZmZmZiswLGZmZmZmZisxMDAmMC43OCswLDAuNTUrMTAwICovXG4gICAgYmFja2dyb3VuZDogLW1vei1saW5lYXItZ3JhZGllbnQoLTQ1ZGVnLCByZ2JhKDI1NSwyNTUsMjU1LDAuNzgpIDAlLCByZ2JhKDI1NSwyNTUsMjU1LDAuNTUpIDEwMCUpIC8qIEZGMy42LTE1ICovO1xuICAgIGJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KC00NWRlZywgcmdiYSgyNTUsMjU1LDI1NSwwLjc4KSAwJSxyZ2JhKDI1NSwyNTUsMjU1LDAuNTUpIDEwMCUpIC8qIENocm9tZTEwLTI1LFNhZmFyaTUuMS02ICovO1xuICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsIHJnYmEoMjU1LDI1NSwyNTUsMC43OCkgMCUscmdiYSgyNTUsMjU1LDI1NSwwLjU1KSAxMDAlKSAvKiBXM0MsIElFMTArLCBGRjE2KywgQ2hyb21lMjYrLCBPcGVyYTEyKywgU2FmYXJpNysgKi87XG4gICAgZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoIHN0YXJ0Q29sb3JzdHI9JyNjN2ZmZmZmZicsIGVuZENvbG9yc3RyPScjOGNmZmZmZmYnLEdyYWRpZW50VHlwZT0xICkgLyogSUU2LTkgZmFsbGJhY2sgb24gaG9yaXpvbnRhbCBncmFkaWVudCAqLztcblxuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICBmb250LXNpemU6IDEuNXZ3O1xuICAgIHdpZHRoOiA3dnc7XG4gICAgaGVpZ2h0OiA3dnc7XG4gICAgbWFyZ2luOiAxMHB4IDEwcHggMCAwO1xuICAgIHBhZGRpbmc6IDA7XG4gICAgb3V0bGluZTogbm9uZTtcbiAgICBib3JkZXI6IDJweCBzb2xpZCB3aGl0ZTtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIC13ZWJraXQtYm94LXNoYWRvdzogMHB4IDVweCAxMHB4IC01cHggcmdiYSgwLDAsMCwwLjM1KTtcbiAgICAtbW96LWJveC1zaGFkb3c6IDBweCA1cHggMTBweCAtNXB4IHJnYmEoMCwwLDAsMC4zNSk7XG4gICAgYm94LXNoYWRvdzogMHB4IDVweCAxMHB4IC01cHggcmdiYSgwLDAsMCwwLjM1KTtcbiAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNnB4KTtcbiAgICBjb2xvcjogIzU1NTtcblxuICAgIHRyYW5zaXRpb246IGFsbCAyMDBtcyBlYXNlO1xuICAgIHRyYW5zaXRpb24tcHJvcGVydHk6IHdpZHRoLCBoZWlnaHQsIGJvcmRlci1yYWRpdXMsIHBhZGRpbmc7XG5cbiAgICBmYS1pY29uIHtcbiAgICAgIGZpbHRlcjogZHJvcC1zaGFkb3coLTFweCAtMnB4IDFweCByZ2JhKDAsMCwwLDAuMSkpIGRyb3Atc2hhZG93KDJweCAzcHggMnB4IHdoaXRlKTsgfVxuXG4gICAgI21pbmktbWFwIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIHRvcDogMDtcbiAgICAgIGxlZnQ6IDA7XG4gICAgICB3aWR0aDogMTV2dztcbiAgICAgIGhlaWdodDogMTV2dztcbiAgICAgIHRyYW5zaXRpb24tcHJvcGVydHk6IG9wYWNpdHk7XG4gICAgICBvcGFjaXR5OiAwO1xuICAgICAgdmlzaWJpbGl0eTogaGlkZGVuO1xuICAgICAgdHJhbnNpdGlvbjogYWxsIDIwMG1zIGVhc2U7IH1cblxuICAgIGZhLWljb24ge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgdG9wOiA1MCU7XG4gICAgICBsZWZ0OiAtMzUlOyB9XG5cbiAgICAjZXJyb3Ige1xuICAgICAgY29sb3I6IHJlZDsgfSB9XG5cbiAgLmFjdGl2ZSB7XG4gICAgcGFkZGluZzogZW52KHNhZmUtYXJlYS1pbnNldC1yaWdodCk7XG4gICAgd2lkdGg6IDE1dnc7XG4gICAgaGVpZ2h0OiAxNXZ3O1xuICAgIGJvcmRlci1yYWRpdXM6IDUlO1xuXG4gICAgI21pbmktbWFwIHtcbiAgICAgIG9wYWNpdHk6IDE7XG4gICAgICB2aXNpYmlsaXR5OiB2aXNpYmxlOyB9IH1cblxuICAudmlzaWJsZSB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB2aXNpYmlsaXR5OiB2aXNpYmxlOyB9XG4gIC5pbnZpc2libGUge1xuICAgIG9wYWNpdHk6IDA7XG4gICAgdmlzaWJpbGl0eTogaGlkZGVuOyB9IH1cbiJdfQ== */\"","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { User } from '../../../type/user';\nimport { Subscription } from 'rxjs';\nimport { LocationBasedComponent } from '../../../base/location-based/location-based.component';\n\n@Component({\n  selector: 'locator-button',\n  templateUrl: './locator.component.html',\n  styleUrls: ['./locator.component.sass']\n})\nexport class LocatorComponent extends LocationBasedComponent implements OnInit, OnDestroy {\n\n  public nearestMileId:           number;\n  public showMiniMap:             boolean;\n\n  private _mapObserver:           Subscription;\n\n  constructor() {\n    super();\n  }\n\n\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n    super.ngOnInit();\n\n    this.showMiniMap = this.localStorage.retrieve('showMiniMap');\n    this._mapObserver = this.localStorage.observe('showMiniMap').subscribe(result => {\n      this.showMiniMap = result;\n    });\n  }\n\n  ngOnDestroy():void {\n\n    this._mapObserver.unsubscribe();\n\n    super.ngOnDestroy();\n  }\n\n\n\n  // EVENT HANDLERS\n\n  public onClick(): void {\n    this.locationService.toggleTracking();\n  }\n\n\n\n\n  // OTHER\n\n  public onStatusChange(status: string): void {\n    this.onUserLocationChange(this.user);\n  }\n\n  public onUserLocationChange(user: User): void {\n\n    if (this.user && this.status === 'tracking') {\n      this.nearestMileId = user.nearestMileId;\n    }\n  }\n}\n","module.exports = \"<div id=\\\"container\\\">\\n\\n\\n  <div class=\\\"right {{this.oppositeClass}}\\\">\\n    <locator-button></locator-button>\\n  </div>\\n\\n  <div class=\\\"right {{this.oppositeClass}}\\\">\\n    <settings-button (click)=\\\"onSettingsClick()\\\" [updateAvailable]=\\\"updateAvailable\\\" [isDownloading]=\\\"isDownloading\\\"></settings-button>\\n  </div>\\n\\n  <div class=\\\"right {{this.oppositeClass}}\\\" *ngIf=\\\"isAdmin\\\">\\n    <display-button class=\\\"button\\\" label=\\\"\\\" icon=\\\"skull\\\" (click)=\\\"onAdminClick()\\\"></display-button>\\n  </div>\\n\\n  <div class=\\\"left {{this.visibleClass}}\\\">\\n    <display-button class=\\\"button back\\\" label=\\\"\\\" icon=\\\"arrow-left\\\" (click)=\\\"onBackClick()\\\"></display-button>\\n  </div>\\n\\n  <div id=\\\"center-user-btn\\\" [class]=\\\"dynamicSide\\\" *ngIf=\\\"locationStatus === 'tracking'\\\">\\n    <display-button class=\\\"button\\\" label=\\\"\\\" icon=\\\"street-view\\\" (click)=\\\"onCenterUserClick()\\\"></display-button>\\n  </div>\\n\\n</div>\\n\"","module.exports = \":host {\\n  width: 100%;\\n  float: left;\\n  top: 0;\\n  position: absolute;\\n  z-index: 1000;\\n  pointer-events: none;\\n  padding-bottom: 10px; }\\n  :host #container {\\n    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left); }\\n  :host #container .button, :host #container .right, :host #container .left {\\n      pointer-events: all;\\n      color: #555; }\\n  :host #container .left {\\n      float: left; }\\n  :host #container .right {\\n      float: right; }\\n  :host #container .show {\\n      visibility: visible;\\n      opacity: 1;\\n      transition: opacity 0.15s linear;\\n      pointer-events: all; }\\n  :host #container .hide {\\n      visibility: hidden;\\n      opacity: 0;\\n      transition: visibility 0.15s linear, opacity 0.15s linear;\\n      pointer-events: none; }\\n  :host #container .back {\\n      padding-left: 10px; }\\n  :host #container #center-user-btn {\\n      transition: all 300ms ease; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9uYXZpZ2F0aW9uL25hdmlnYXRpb24uY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUM7RUFDQyxXQUFXO0VBQ1gsV0FBVztFQUNYLE1BQU07RUFDTixrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLG9CQUFvQjtFQUNwQixvQkFBb0IsRUFBQTtFQVByQjtJQVVHLGtIQUFrSCxFQUFBO0VBVnJIO01BYUssbUJBQW1CO01BQ25CLFdBQVcsRUFBQTtFQWRoQjtNQWlCSyxXQUFXLEVBQUE7RUFqQmhCO01Bb0JLLFlBQVksRUFBQTtFQXBCakI7TUF1QkssbUJBQW1CO01BQ25CLFVBQVU7TUFDVixnQ0FBZ0M7TUFDaEMsbUJBQW1CLEVBQUE7RUExQnhCO01BNkJLLGtCQUFrQjtNQUNsQixVQUFVO01BQ1YseURBQXlEO01BQ3pELG9CQUFvQixFQUFBO0VBaEN6QjtNQW1DSyxrQkFBa0IsRUFBQTtFQW5DdkI7TUFzQ0ssMEJBQTBCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvbmF2aWdhdGlvbi9uYXZpZ2F0aW9uLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IHtcbiAgd2lkdGg6IDEwMCU7XG4gIGZsb2F0OiBsZWZ0O1xuICB0b3A6IDA7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgei1pbmRleDogMTAwMDtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHBhZGRpbmctYm90dG9tOiAxMHB4OyAgLy8gZml4ZXMgZHJvcCBzaGFkb3cgY2xpcHBpbmdcblxuICAjY29udGFpbmVyIHtcbiAgICBwYWRkaW5nOiBlbnYoc2FmZS1hcmVhLWluc2V0LXRvcCkgZW52KHNhZmUtYXJlYS1pbnNldC1yaWdodCkgZW52KHNhZmUtYXJlYS1pbnNldC1ib3R0b20pIGVudihzYWZlLWFyZWEtaW5zZXQtbGVmdCk7XG5cbiAgICAuYnV0dG9uLCAucmlnaHQsIC5sZWZ0IHtcbiAgICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gICAgICBjb2xvcjogIzU1NTsgfVxuXG4gICAgLmxlZnQge1xuICAgICAgZmxvYXQ6IGxlZnQ7IH1cblxuICAgIC5yaWdodCB7XG4gICAgICBmbG9hdDogcmlnaHQ7IH1cblxuICAgIC5zaG93IHtcbiAgICAgIHZpc2liaWxpdHk6IHZpc2libGU7XG4gICAgICBvcGFjaXR5OiAxO1xuICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjE1cyBsaW5lYXI7XG4gICAgICBwb2ludGVyLWV2ZW50czogYWxsOyB9XG5cbiAgICAuaGlkZSB7XG4gICAgICB2aXNpYmlsaXR5OiBoaWRkZW47XG4gICAgICBvcGFjaXR5OiAwO1xuICAgICAgdHJhbnNpdGlvbjogdmlzaWJpbGl0eSAwLjE1cyBsaW5lYXIsIG9wYWNpdHkgMC4xNXMgbGluZWFyO1xuICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7IH1cblxuICAgIC5iYWNrIHtcbiAgICAgIHBhZGRpbmctbGVmdDogMTBweDsgfVxuXG4gICAgI2NlbnRlci11c2VyLWJ0biB7XG4gICAgICB0cmFuc2l0aW9uOiBhbGwgMzAwbXMgZWFzZTsgfSB9IH1cbiJdfQ== */\"","import {Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges} from '@angular/core';\nimport {ActivatedRoute, NavigationEnd, Router} from '@angular/router';\nimport {DownloadService} from '../../service/download.service';\nimport {Subscription} from 'rxjs';\nimport {VersionResolverService} from '../../service/version-resolver.service';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {LocationService} from '../../service/location.service';\nimport {LoaderService} from '../../service/loader.service';\n\n@Component({\n  selector: 'navigation-component',\n  templateUrl: './navigation.component.html',\n  styleUrls: ['./navigation.component.sass']\n})\nexport class NavigationComponent implements OnInit, OnChanges {\n\n  @Input() appInitialized: boolean;\n  @Output() navEvent: EventEmitter<string> = new EventEmitter<string>();\n\n  public visibleClass:                string = 'hide';\n  public oppositeClass:               string = 'show';\n  public isDownloading:               boolean = false;\n  public updateAvailable:             boolean = false;\n  public isAdmin:                     boolean;\n  public dynamicSide:                 string;\n  public locationStatus:             string;\n\n  private _backIndex:                 object;\n\n  private _downloadSubScription:      Subscription;\n  private _updateSubscription:        Subscription;\n\n  constructor(\n    private _versionResolverService:  VersionResolverService,\n    private _locationService:         LocationService,\n    private _localStorage:            LocalStorageService,\n    private _route:                   ActivatedRoute,\n    private _router:                  Router,\n    private _downloadService:         DownloadService,\n    private _loaderOverlay:           LoaderService\n  ) {\n\n    _router.events.forEach((event) => {\n\n      if (event instanceof NavigationEnd && event['url']) {\n\n        this._backIndex = this._route.snapshot.queryParams['back'];\n\n        if (event['url'].includes('detail')) {\n          this.visibleClass = 'show';\n          this.oppositeClass = 'hide';\n          this.dynamicSide = 'left';\n        } else if (event['url'].includes('admin')) {\n          this.visibleClass = this.oppositeClass = 'show';\n        } else {\n          this.visibleClass = 'hide';\n          this.oppositeClass = 'show';\n          this.dynamicSide = 'right';\n        }\n      }\n    });\n  }\n\n\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n\n    const _self = this;\n\n    this._downloadSubScription = this._downloadService.isDownloadingObservable.subscribe(isDownloading => {\n       this.isDownloading = isDownloading;\n    });\n\n    this._updateSubscription = this._versionResolverService.observables['updateAvailable'].subscribe( updateAvailable => {\n      this.updateAvailable = updateAvailable;\n    });\n\n    this.isAdmin = this._localStorage.retrieve('isAdmin');\n    this._localStorage.observe('isAdmin').subscribe( value => {\n      this.isAdmin = value;\n    });\n\n    this._locationService.locationStatus.subscribe(status => {\n      this.locationStatus = status;\n    })\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    // wait for loader to be ready, as the app requires trail/snow version data to run the version check\n    // since navigator isn't part of the router, we're waiting for the loader to finish (which triggers initialized on the app component)\n    if (changes.appInitialized.firstChange === false && this.appInitialized === true) {\n      this._versionResolverService.versionCheck();\n    }\n  }\n\n\n\n  // EVENT HANDLERS\n\n  public onSettingsClick(): void {\n    this.navEvent.emit('settings');\n  }\n\n  public onBackClick(): void {\n    this.visibleClass = 'hide';\n    this.oppositeClass = 'show';\n    this._loaderOverlay.showOverlay();\n    this._router.navigate(['elevation-profile/'], {queryParams: {id: this._router['scrollToPosition']}});\n    this.navEvent.emit('elevation-profile');\n  }\n\n  public onAdminClick(): void {\n    this._router.navigate(['admin']);\n    this.navEvent.emit('admin');\n  }\n\n  public onCenterUserClick(): void {\n    this._locationService.onCenterUser();\n  }\n}\n","module.exports = \"<display-button\\n  class=\\\"button settings\\\"\\n  icon=\\\"cog\\\"\\n  [badge]=\\\"(updateAvailable) ? (isDownloading) ? 'spinner' : ['far', 'arrow-alt-circle-down'] : null\\\"\\n  >\\n</display-button>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9uYXZpZ2F0aW9uL3NldHRpbmdzL3NldHRpbmdzLmNvbXBvbmVudC5zY3NzIn0= */\"","import {Component, Input, OnInit} from '@angular/core';\n\n@Component({\n  selector: 'settings-button',\n  templateUrl: './settings.component.html',\n  styleUrls: ['./settings.component.scss']\n})\nexport class SettingsComponent implements OnInit {\n\n  @Input() isDownloading: boolean;\n  @Input() updateAvailable: boolean;\n\n  constructor() {}\n\n  ngOnInit() {}\n}\n","module.exports = \"<div #container></div>\\n\"","module.exports = \":host {\\n  background-color: #EEE;\\n  width: 100%;\\n  border-bottom: 1px solid #E6E6E6;\\n  height: calc(100vh / 7) !important; }\\n\\n:host /deep/ .note {\\n  background-color: #fbf8f4 !important; }\\n\\n:host /deep/ fa-icon {\\n  font-size: 3vw;\\n  color: #444; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9wb2ktbGlzdC9keW5hbWljLWl0ZW0vZHluYW1pYy1pdGVtLmNvbXBvbmVudC5zYXNzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFDO0VBQ0Msc0JBQXNCO0VBQ3RCLFdBQVc7RUFDWCxnQ0FBZ0M7RUFDaEMsa0NBQWtDLEVBQUE7O0FBRW5DO0VBR0csb0NBQStDLEVBQUE7O0FBSGxEO0VBTUcsY0FBYztFQUNkLFdBQVcsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudC9wb2ktbGlzdC9keW5hbWljLWl0ZW0vZHluYW1pYy1pdGVtLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0IHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI0VFRTtcbiAgd2lkdGg6IDEwMCU7XG4gIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjRTZFNkU2O1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLyA3KSAhaW1wb3J0YW50OyB9XG5cbiA6aG9zdCAvZGVlcC8ge1xuXG4gIC5ub3RlIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjUxLCAyNDgsIDI0NCkgIWltcG9ydGFudDsgfVxuXG4gIGZhLWljb24ge1xuICAgIGZvbnQtc2l6ZTogM3Z3O1xuICAgIGNvbG9yOiAjNDQ0OyB9IH1cbiJdfQ== */\"","import {\n  Component,\n  OnInit,\n  OnDestroy,\n  ViewChild,\n  ViewContainerRef,\n  Input,\n  ComponentRef,\n  ComponentFactoryResolver,\n  OnChanges,\n  SimpleChanges,\n  HostBinding, ChangeDetectorRef\n} from '@angular/core';\nimport { PoiListItemComponent } from '../poi-list-item/poi-list-item.component';\nimport { PoiUserItemComponent } from '../poi-user-item/poi-user-item.component';\n\n@Component({\n  selector: 'poi-dynamic-item',\n  templateUrl: './dynamic-item.component.html',\n  styleUrls: ['./dynamic-item.component.sass']\n})\n\n/* renders dynamic list item types based on type\nuse multiple components as list items in a CDK virtual scroll\nif type === user, use user-item, else use poi-item */\nexport class DynamicItemComponent implements OnInit, OnDestroy, OnChanges {\n\n  @HostBinding('class.offtrail') isHidden = false;\n  @ViewChild('container', { read: ViewContainerRef }) container: ViewContainerRef;\n\n  @Input() data: object;\n  @Input() status: string = 'idle';\n  @Input() timestamp: number;\n\n  private _componentRef: ComponentRef<{}>;\n  private _instance: any;             // the dynamic list item instance (user or poi)\n\n  constructor(\n    private _changeDetector: ChangeDetectorRef,\n    private _componentFactoryResolver: ComponentFactoryResolver) {\n  }\n\n  ngOnInit(): void {\n    this._setup();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n\n    if (!this._instance) {\n      return;\n    }\n\n    if (changes.data) {\n\n      if (changes.data.currentValue.type !== this._instance.data.type) {\n\n        this.isHidden = (this.data['type'].includes('offtrail'));\n        this._changeDetector.markForCheck();\n\n        // item type mismatch, render new instance of correct item\n        if (this._instance instanceof PoiListItemComponent && this.data['type'] === 'user'\n          || this._instance instanceof PoiUserItemComponent && this.data['type'] !== 'user') {\n          this.ngOnDestroy();\n          this._setup();\n          return;\n        }\n      }\n    }\n\n    if (changes.status) {\n      this._instance.status = changes.status.currentValue;\n    }\n\n    if (changes.data) {\n      this._instance.data = changes.data.currentValue;\n      if (this._instance.setupIcons) {\n        this._instance.setupIcons();\n      }\n    }\n\n    this._instance.timeStamp = new Date().getTime();\n  }\n\n  ngOnDestroy(): void {\n    if (this._componentRef) {\n      this._componentRef.destroy();\n      this._componentRef = null;\n    }\n  }\n\n  private _setup(): void {\n\n    const componentType: any = (this.data['type'] === 'user') ? PoiUserItemComponent : PoiListItemComponent;\n\n    this.isHidden = (this.data['type'] === 'offtrail');\n\n    const factory = this._componentFactoryResolver.resolveComponentFactory(componentType);\n\n    this._componentRef = this.container.createComponent(factory);\n\n    // set dynamic component data\n    this._instance = <any> this._componentRef.instance;\n\n    // inject data\n    this._instance.data = this.data;\n    this._instance.status = this.status;\n    this._instance.timeStamp = new Date().getTime();\n    this._changeDetector.markForCheck();\n  }\n\n}\n","module.exports = \"<div class=\\\"icon-container\\\">\\n  <display-icon [data]=\\\"this.poiTypes\\\" [name]=\\\"timeStamp\\\"></display-icon>\\n</div>\\n<div class=\\\"mat-list-text\\\">\\n  <h2 matLine [innerHTML]=\\\"data.label\\\"></h2>\\n  <p matLine *ngIf=\\\"data.anchorPoint\\\">\\n    <span *ngIf=\\\"status !== 'tracking'\\\"> {{data.anchorPoint.distanceTotal | distance:'meters':'miles':false:2:true}} </span>\\n    <span *ngIf=\\\"status === 'tracking' && data.distanceFromUser\\\"> {{data.distanceFromUser | distance:'meters':'miles':false:2:true:true}} </span>\\n    <span *ngIf=\\\"data.distanceFromPoi\\\"> {{data.distanceFromPoi | distance:'meters':'miles':false:2:true:true}} </span>\\n    <span> ({{data.waypoint.distance | distance:'meters':'miles':true}}) </span>\\n  </p>\\n</div>\\n\"","module.exports = \":host {\\n  background-color: white;\\n  height: calc(100vh / 7) !important; }\\n  :host h2 {\\n    font-size: 3.4vh !important;\\n    font-weight: 300 !important;\\n    margin-bottom: 0.2em !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9wb2ktbGlzdC9wb2ktbGlzdC1pdGVtL3BvaS1saXN0LWl0ZW0uY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUM7RUFDQyx1QkFBdUI7RUFDdkIsa0NBQWtDLEVBQUE7RUFGbkM7SUFLRywyQkFBMkI7SUFDM0IsMkJBQTJCO0lBQzNCLCtCQUErQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvY29tcG9uZW50L3BvaS1saXN0L3BvaS1saXN0LWl0ZW0vcG9pLWxpc3QtaXRlbS5jb21wb25lbnQuc2FzcyIsInNvdXJjZXNDb250ZW50IjpbIiA6aG9zdCB7XG4gIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLyA3KSAhaW1wb3J0YW50O1xuXG4gIGgyIHtcbiAgICBmb250LXNpemU6IDMuNHZoICFpbXBvcnRhbnQ7XG4gICAgZm9udC13ZWlnaHQ6IDMwMCAhaW1wb3J0YW50O1xuICAgIG1hcmdpbi1ib3R0b206IDAuMmVtICFpbXBvcnRhbnQ7IH0gfVxuIl19 */\"","import {Component, HostBinding, Input, OnChanges, OnInit, SimpleChanges} from '@angular/core';\nimport { Poi, PoiType } from '../../../type/poi';\nimport { getPoiTypeByType } from '../../../_util/poi';\n\n@Component({\n  selector: 'poi-list-item',\n  templateUrl: './poi-list-item.component.html',\n  styleUrls: ['./poi-list-item.component.sass']\n})\nexport class PoiListItemComponent implements OnInit, OnChanges {\n\n  @HostBinding('class')\n  get typeClass(){\n    return 'mat-list-item-content ' + this.data['type'].split(',').join('');\n  };\n\n  @Input() data: Poi;\n  @Input('status') status: string = 'idle';\n  @Input() timeStamp: number;\n\n  public poiTypes: Array<PoiType> = [];\n\n  constructor() {}\n\n  ngOnInit(): void {\n    this.setupIcons();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    console.log(changes);\n  }\n\n  public setupIcons(): void {\n\n    const _self = this;\n    this.poiTypes = [];\n\n    if (this.data) {\n\n      // generate poiTypes (icons)\n      const _poiStrArr: Array<string> = this.data['type'].split(', ');\n\n      _poiStrArr.forEach(function(poi, index) {\n\n        if (poi === 'offtrail') {\n          return;\n        }\n\n        const _poiData = getPoiTypeByType(poi);\n\n        if (_poiData !== undefined) {\n\n          if (_poiStrArr.length > 2 && index === 1) {\n            _self.poiTypes.push(getPoiTypeByType('unknown'));\n          }\n          _self.poiTypes.push(_poiData);\n        } else {\n          _self.poiTypes.push(getPoiTypeByType('unknown'));\n        }\n      });\n\n      // if no types\n      if (this.poiTypes.length === 0) {\n        this.poiTypes.push(getPoiTypeByType('unknown'));\n      }\n    }\n  }\n}\n","module.exports = \"<!-- just to use its classes -->\\n<mat-action-list class=\\\"hidden\\\"></mat-action-list>\\n\\n<cdk-virtual-scroll-viewport\\n  class=\\\"mat-list mat-list-base\\\"\\n  id=\\\"poi-list\\\"\\n  orientation=\\\"vertical\\\"\\n  [itemSize]=\\\"itemSize\\\"\\n\\n  (scrolledIndexChange)=\\\"onScroll($event)\\\"\\n\\n  autosize\\n  #poiList>\\n\\n\\n  <poi-dynamic-item *cdkVirtualFor=\\\"let poi of this.combinedData; templateCacheSize: cacheSize; trackBy: trackElementBy\\\"\\n\\n                    class = \\\"mat-list-item mat-2-line mat-list-item-avatar mat-list-item-with-avatar\\\"\\n\\n                    [data] = \\\"poi\\\"\\n                    [status] = \\\"status\\\"\\n                    [timestamp] = \\\"timestamp\\\"\\n                    (click) = \\\"onListItemClick(poi, $event)\\\"\\n\\n                    matRipple>\\n  </poi-dynamic-item>\\n\\n</cdk-virtual-scroll-viewport>\\n\\n<user-indicator *ngIf=\\\"showUser\\\" [userPosition]=\\\"userPosition\\\" [status]=\\\"status\\\" (click)=\\\"centerOnUser()\\\"></user-indicator>\\n\"","module.exports = \":host .offtrail {\\n  opacity: 0.5;\\n  background-color: grey;\\n  pointer-events: none; }\\n\\n:host .hidden {\\n  visibility: hidden;\\n  display: none; }\\n\\n:host #poi-list {\\n  padding-top: unset !important;\\n  display: block;\\n  height: 100%;\\n  max-height: 100%;\\n  width: 100%;\\n  overflow-x: hidden; }\\n\\n:host /deep/ poi-list-item, :host /deep/ poi-user-item {\\n  padding: 0 1vw !important;\\n  width: 38vw !important; }\\n\\n:host /deep/ poi-list-item .mat-list-text, :host /deep/ poi-user-item .mat-list-text {\\n    padding-left: 1vw !important;\\n    overflow-x: hidden; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9wb2ktbGlzdC9wb2ktbGlzdC5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUdHLFlBQVk7RUFDWixzQkFBc0I7RUFDdEIsb0JBQW9CLEVBQUE7O0FBTHZCO0VBUUcsa0JBQWtCO0VBQ2xCLGFBQWEsRUFBQTs7QUFUaEI7RUFZRyw2QkFBNkI7RUFDN0IsY0FBYztFQUNkLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsV0FBVztFQUNYLGtCQUFrQixFQUFBOztBQUVyQjtFQUdHLHlCQUF5QjtFQUN6QixzQkFBc0IsRUFBQTs7QUFKekI7SUFPSyw0QkFBNEI7SUFDNUIsa0JBQWtCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvcG9pLWxpc3QvcG9pLWxpc3QuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuXG4gIC5vZmZ0cmFpbCB7XG4gICAgb3BhY2l0eTogMC41O1xuICAgIGJhY2tncm91bmQtY29sb3I6IGdyZXk7XG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7IH1cblxuICAuaGlkZGVuIHtcbiAgICB2aXNpYmlsaXR5OiBoaWRkZW47XG4gICAgZGlzcGxheTogbm9uZTsgfVxuXG4gICNwb2ktbGlzdCB7XG4gICAgcGFkZGluZy10b3A6IHVuc2V0ICFpbXBvcnRhbnQ7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICAgIG1heC1oZWlnaHQ6IDEwMCU7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgb3ZlcmZsb3cteDogaGlkZGVuOyB9IH1cblxuIDpob3N0IC9kZWVwLyB7XG5cbiAgcG9pLWxpc3QtaXRlbSwgcG9pLXVzZXItaXRlbSB7XG4gICAgcGFkZGluZzogMCAxdncgIWltcG9ydGFudDtcbiAgICB3aWR0aDogMzh2dyAhaW1wb3J0YW50O1xuXG4gICAgLm1hdC1saXN0LXRleHQge1xuICAgICAgcGFkZGluZy1sZWZ0OiAxdncgIWltcG9ydGFudDtcbiAgICAgIG92ZXJmbG93LXg6IGhpZGRlbjsgfSB9IH1cbiJdfQ== */\"","import {Component, Input, OnInit, ViewChild, OnChanges, SimpleChanges, Output, EventEmitter,\n  ChangeDetectionStrategy, ChangeDetectorRef, OnDestroy\n} from '@angular/core';\nimport {LocationBasedComponent} from '../../base/location-based/location-based.component';\n\nimport {BehaviorSubject} from 'rxjs';\nimport {CdkVirtualScrollViewport} from '@angular/cdk/scrolling';\n\nimport {Mile} from '../../type/mile';\nimport {Poi} from '../../type/poi';\nimport {User} from '../../type/user';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {NoteService} from '../../service/note.service';\n\n@Component({\n  selector: 'poi-list',\n  templateUrl: './poi-list.component.html',\n  styleUrls: ['./poi-list.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\n\n// using basic for loops, nothing fancy for performance.\nexport class PoiListComponent extends LocationBasedComponent implements OnInit, OnChanges, OnDestroy {\n\n  @ViewChild('poiList') container: CdkVirtualScrollViewport;\n\n  @Output() scrollToEvent: EventEmitter<any> = new EventEmitter<any>();\n\n  @Input() milesData?: Array<Mile>;\n  @Input() poisData?: Array<Mile>;\n  @Input() masterPoi?: Poi;\n  @Input() showUser: boolean;\n  @Input() activeMileId: number;\n  @Input() directionReversal?: boolean;     // reverse list\n\n  public combinedData: BehaviorSubject<Array<any>> = new BehaviorSubject([]);         // user and pois combined in a single (sorted) array\n  private _dataLength: number;              // the length of the combined data (pois + user), speed optimisation\n  public timestamp: number;                 // used to trigger reload\n  public userPosition: string;\n  public itemSize: number;\n  public cacheSize = 10;\n  private _visibleItemCount = 7;\n  private _userStatus: string;\n\n  private _staticPoisArray:           Array<any>  = [];\n  private _userIndex:                 number;\n\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _noteService: NoteService,\n    private _changeDetector: ChangeDetectorRef) {\n\n    super();\n  }\n\n  // LIFECYCLE HOOKS\n\n  ngOnInit(): void {\n\n    const _self = this;\n    super.ngOnInit();\n\n    this.itemSize = Math.round(this.container.elementRef.nativeElement.clientHeight / this._visibleItemCount);\n\n    this.addSubscription('data', this.combinedData.subscribe(\n      data => {\n        this._dataLength = data.length;\n      }));\n\n    this.addSubscription('note', this._noteService.noteUpdateObserver.subscribe(function(update) {\n      if (update === 'added') {\n\n        const _lastAddedNote: Poi = _self._noteService.getLastNote();\n        const _newCombinedData: Array<any> = _self.combinedData.getValue();\n        _newCombinedData.push(_lastAddedNote);\n        _self._sortListData(_newCombinedData);\n\n      } else if (update === 'removed') {\n\n        const _deletedNote: Poi = _self._noteService.getLastNote();\n        const _data: Array<any> = _self.combinedData.getValue();\n\n        const _length = _data.length;\n        for(let i = 0; i < _length; i++) {\n          if (_data[i].id === _deletedNote.id) {\n            _data.splice(i, 1);\n            _self._sortListData(_data);\n            break;\n          }\n        }\n      }\n    }));\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n\n    if (changes.milesData || changes.poisData) {\n      this.setup();\n      this._scrollToCenterMile();\n    }\n\n    if (changes.trigger) {\n      this.centerOnUser();\n    }\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n  }\n\n  private setup(): void {\n\n    this._staticPoisArray = [];\n    let _poiIndexes = [];\n    const _maxPoiDistance = this._localStorage.retrieve('poiMaxDistance');\n\n    const _self = this;\n\n    // get all pois within miles\n    if (this.milesData) {\n\n      const _length = this.milesData.length;\n      for (let i = 0; i < _length; i++) {\n        const _mile: Mile = this.milesData[i];\n        if (_mile.pois && _mile.pois.length > 0) {\n          _poiIndexes = _poiIndexes.concat(_mile.pois);\n        }\n      }\n\n    } else if (this.poisData) {\n      _poiIndexes = this.poisData;\n    }\n\n    const _poiLength = _poiIndexes.length;\n    for (let p = 0; p < _poiLength; p++) {\n      const _poiId = _poiIndexes[p];\n\n      // filter out of range pois\n      const _poi = _self.trailGenerator.getPoiById(_poiId);\n\n      if (_poi.waypoint.distance > _maxPoiDistance) {\n        _poi.type += ', offtrail';\n      }\n      _self._staticPoisArray.push(_poi);\n    }\n\n    if (this.showUser) {\n      const _userRef: User = (this.user !== undefined) ? this.user : super.createBlankUser();\n\n      let _array = this._staticPoisArray.concat(_userRef);\n\n      const _notes = this._noteService.getFlatNotesArray();\n      if (_notes) {\n        _array = _array.concat(_notes);\n      }\n\n      this._sortListData(_array);\n      this.onUserLocationChange(_userRef);\n    } else {\n      this._sortListData(this._staticPoisArray);\n      if (this.masterPoi) {\n        this._calculateDistance(this.masterPoi);\n      }\n    }\n  }\n\n\n\n  // SUBSCRIPTION HANDLERS\n\n  public onStatusChange(status: string): void {\n\n    // if we're switching to tracking\n    if (this._userStatus && this._userStatus !== 'tracking' && status === 'tracking') {\n      this.centerOnUser();\n    }\n    this._userStatus = this.status;\n    this._changeDetector.markForCheck();      // needed to update user poi list item\n  }\n\n  public onUserLocationChange(user: User): void {\n\n    const _notes = this._noteService.getFlatNotesArray();\n    let _poisArray: Array<Poi>;\n\n    // // if tracking\n    if (location && this.status !== 'idle') {\n\n      if (this.showUser) {\n        _poisArray = this._staticPoisArray.concat(user);\n      }\n\n      if (this.milesData) {\n        this._calculateDistance(user);\n      }\n\n    } else if (this.showUser) {\n\n      user.waypoint = user.anchorPoint = undefined;\n\n      _poisArray = this._staticPoisArray.concat(user);\n    }\n\n    if (_notes) {\n      _poisArray = _poisArray.concat(_notes);\n    }\n\n    this._sortListData(_poisArray);\n  }\n\n  private _calculateDistance(master: Poi | User): void {\n\n    if (master) {\n      const staticPoisLength = this._staticPoisArray.length;\n\n      // figure out where pois are in relation to the master poi\n      for (let i = 0; i < staticPoisLength; i++) {\n        const _poi = this._staticPoisArray[i];\n\n        if (master.anchorPoint) {\n          if (!this.showUser) {\n            _poi.distanceFromPoi = _poi.anchorPoint.distanceTotal - master.anchorPoint.distanceTotal;\n          } else {\n            _poi.distanceFromUser = _poi.anchorPoint.distanceTotal - master.anchorPoint.distanceTotal;\n          }\n        }\n      }\n    }\n  }\n\n\n\n  // EVENT HANDLERS\n\n  public onListItemClick(poi: Poi, event: any): void {\n\n    let _event: CustomEvent;\n\n    if (poi.type === 'user') {\n\n      this.locationService.toggleTracking();\n      return;\n\n    } else {\n\n      _event = new CustomEvent(\n        'markerClick',\n        {\n          bubbles: true,\n          cancelable: true,\n          detail: poi\n        });\n    }\n\n    document.getElementsByTagName('app-root')[0].dispatchEvent(_event);\n  }\n\n  public centerOnUser(): void {\n\n    super.centerOnUser();\n\n    if (!this.showUser) {\n      return;\n    }\n\n    const _self = this;\n    if (this.container) {\n\n      requestAnimationFrame(function() {\n\n        const _padding = _self.itemSize * 2;    // this makes sure the user list item is fully on screen, therefor the poi/mile index is correct\n        let _verticalOffset = _padding;\n\n        if (_self.directionReversal) {\n          _verticalOffset = _self.container.elementRef.nativeElement.clientHeight - _self.itemSize - _padding;\n        }\n\n        _self.container.scrollToOffset((_self.itemSize * _self._userIndex) - _verticalOffset, 'auto');\n      });\n    }\n  }\n\n  private _scrollToCenterMile(): void {\n\n    const _self = this;\n\n    const trailLength: number = this.trailGenerator.getTrailData().miles.length;\n\n    let _activeMile: Mile;\n\n    // find the first mile containing a poi\n    for (let i = this.activeMileId - 1; i < trailLength; i++) {\n\n      if (i > -1) {\n\n        if (this.trailGenerator.getTrailData().miles[i].pois) {\n          _activeMile = this.trailGenerator.getTrailData().miles[i];\n          break;\n        }\n      }\n    }\n\n    if (!_activeMile) {\n      return;\n    }\n\n    let _middlePoi: number = _activeMile.pois[Math.floor(_activeMile.pois.length - 1)];\n\n    window.requestAnimationFrame(function () {\n\n      const _maxIndex = _self.combinedData.getValue().length;\n\n      if (_self.directionReversal) {\n        _middlePoi = _maxIndex - _middlePoi - _self._visibleItemCount;\n        if (_middlePoi < 0) {\n          _middlePoi = 0;\n        }else if ( _middlePoi > _maxIndex) {\n          _middlePoi = _maxIndex;\n        }\n      }\n\n      // scrolling to 0 somehow scrolls to the end of the list (cdk bug)\n      const _total = (_middlePoi === 0) ? 1 : _middlePoi * _self.itemSize;\n\n      _self.container.scrollToIndex(_middlePoi, 'auto');\n      _self.container.scrollToOffset(_total, 'auto');\n    });\n  }\n\n  public onScroll(event): void {\n\n    if (this.combinedData.getValue().length < 1) {\n      return; // no data\n    }\n\n    this._updateUserListIndicator();\n\n    const _renderedIndexes: Array<number> = [];\n    const _renderedPois: Array<number> = [];\n    const _renderedMiles: Array<number> = [];\n\n    // get the offset\n    const _renderedOffset = this.container.measureScrollOffset('top');\n\n    const _firstIndex = Math.floor(_renderedOffset / this.itemSize);\n\n    // using 8 instead of 7 to compensate for the possibility that there is a user visible in list data\n    for (let i = _firstIndex; i < _firstIndex + (this._visibleItemCount + 1); i++) {\n\n      const _poi: Poi | User = this.combinedData.getValue()[i];\n\n      // filter out the user\n      if (_poi && _poi.type !== 'user') {\n        _renderedIndexes.push(i);\n        _renderedPois.push(_poi.id);\n        _renderedMiles.push(_poi['belongsTo']);\n      }\n    }\n\n    // const _firstPoiId: number = (this.directionReversal) ? _renderedIndexes[_renderedIndexes.length - 1] : _renderedIndexes[0];\n    const _firstPoi = this.combinedData.getValue()[_renderedIndexes[0]];\n\n    if (!_firstPoi) {\n      return;\n    }\n\n    const _mile = this.trailGenerator.getTrailData().miles[_firstPoi['belongsTo'] - 1];\n    this.scrollToEvent.emit({mileId: _mile.id, renderedPoiRange: _renderedPois, renderedMileRange: _renderedMiles});\n  }\n\n\n\n  private _updateUserListIndicator(): void {\n    const _renderedRange = this.container.getRenderedRange();\n    if (this._userIndex < _renderedRange.start) {\n      this.userPosition = 'above';\n    } else if (this._userIndex > _renderedRange.end) {\n      this.userPosition = 'below';\n    } else if (this._userIndex >= _renderedRange.start && this._userIndex <= _renderedRange.end) {\n      this.userPosition = 'visible';\n    }\n  }\n\n\n  // OTHER\n\n  private _sortListData(data: Array<any>): void {\n\n    if (!data) {\n      return;\n    }\n\n    // sort array by the trail distance of the anchor point (the nearest on trail location)\n    data.sort(\n      function(a, b) {\n        const _aDist = (a.anchorPoint && a.anchorPoint.distanceTotal) ? a.anchorPoint.distanceTotal : 0;\n        const _bDist = (b.anchorPoint && b.anchorPoint.distanceTotal) ? b.anchorPoint.distanceTotal : 0;\n        return _aDist - _bDist;\n      });\n\n    if (this.directionReversal) {\n      data.reverse();\n    }\n\n    this.cacheSize = Math.floor(data.length / 10);\n    this.cacheSize = (this.cacheSize < this._visibleItemCount ) ? this._visibleItemCount : this.cacheSize;\n\n    this._userIndex = data.findIndex(poi => poi.type === 'user');\n    this.combinedData.next(data);\n    this.timestamp = new Date().getTime();\n    this.container.checkViewportSize();  // magically fixes everything! somehow...\n  }\n\n  // define ID for better li recycling (according to the CDK virtual scroll docs)\n  public trackElementBy(index: number, element: any): number {\n    return element.id;\n  }\n}\n","module.exports = \"<div class=\\\"icon noselect fa-2x\\\">\\n  <fa-layers id=\\\"icons\\\" [fixedWidth]=\\\"true\\\">\\n    {{userStatus}}\\n    <fa-icon icon=\\\"location-arrow\\\" [className]=\\\"!userStatus || userStatus === 'idle' ? 'visible' : 'invisible'\\\"></fa-icon>\\n    <fa-icon [icon]=\\\"['far', 'compass']\\\" [spin]=\\\"true\\\" [className]=\\\"userStatus === 'fetching' ? 'visible' : 'invisible'\\\"></fa-icon>\\n    <fa-icon [icon]=\\\"['fa', 'hiking']\\\" [className]=\\\"userStatus === 'tracking' ? 'visible' : 'invisible'\\\"></fa-icon>\\n    <fa-icon id=\\\"error\\\" icon=\\\"exclamation-triangle\\\" [className]=\\\"userStatus === 'error' ? 'visible' : 'invisible'\\\"></fa-icon>\\n  </fa-layers>\\n</div>\\n\\n<div class=\\\"mat-list-text\\\">\\n  <h2 matLine>You</h2>\\n  <p matLine>\\n    <span *ngIf=\\\"userStatus !== 'tracking'\\\">{{userStatus}}</span>\\n    <span *ngIf=\\\"userStatus === 'tracking' && data.anchorPoint && data.waypoint\\\">{{data.anchorPoint.distanceTotal | distance:'meters':'miles':false:2:true}} ({{data.waypoint.distance | distance:'meters':'miles':true}})</span>\\n  </p>\\n</div>\\n\"","module.exports = \":host.idle {\\n  background-color: #DDD; }\\n\\n:host.fetching {\\n  background-color: lightgoldenrodyellow; }\\n\\n:host.error {\\n  background-color: lightsalmon; }\\n\\n:host.tracking {\\n  background-color: lightgreen; }\\n\\n:host {\\n  height: calc(100vh / 7) !important; }\\n\\n:host h2 {\\n    font-size: 3.4vh !important;\\n    font-weight: 500 !important;\\n    margin-bottom: 0.2em !important; }\\n\\n:host .visible {\\n    opacity: 1;\\n    visibility: visible; }\\n\\n:host .invisible {\\n    opacity: 0;\\n    visibility: hidden; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9wb2ktbGlzdC9wb2ktdXNlci1pdGVtL3BvaS11c2VyLWl0ZW0uY29tcG9uZW50LnNhc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUM7RUFDQyxzQkFBc0IsRUFBQTs7QUFFdkI7RUFDQyxzQ0FBc0MsRUFBQTs7QUFFdkM7RUFDQyw2QkFBNkIsRUFBQTs7QUFFOUI7RUFDQyw0QkFBNEIsRUFBQTs7QUFFN0I7RUFFQyxrQ0FBa0MsRUFBQTs7QUFGbkM7SUFhRywyQkFBMkI7SUFDM0IsMkJBQTJCO0lBQzNCLCtCQUErQixFQUFBOztBQWZsQztJQWtCRyxVQUFVO0lBQ1YsbUJBQW1CLEVBQUE7O0FBbkJ0QjtJQXFCRyxVQUFVO0lBQ1Ysa0JBQWtCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvcG9pLWxpc3QvcG9pLXVzZXItaXRlbS9wb2ktdXNlci1pdGVtLmNvbXBvbmVudC5zYXNzIiwic291cmNlc0NvbnRlbnQiOlsiIDpob3N0LmlkbGUge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjREREOyB9XG5cbiA6aG9zdC5mZXRjaGluZyB7XG4gIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z29sZGVucm9keWVsbG93OyB9XG5cbiA6aG9zdC5lcnJvciB7XG4gIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0c2FsbW9uOyB9XG5cbiA6aG9zdC50cmFja2luZyB7XG4gIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JlZW47IH1cblxuIDpob3N0IHtcblxuICBoZWlnaHQ6IGNhbGMoMTAwdmggLyA3KSAhaW1wb3J0YW50O1xuXG4gIC8vZmEtbGF5ZXJzXG4gIC8vICBiYXNlOiBibG9ja1xuICAvLyAgY29sb3I6ICM1NTVcblxuICAvLy8vZmEtaWNvblxuICAvLy8vICBiYXNlOiBibG9ja1xuICAvLy8vICBwb3NpdGlvbjogYWJzb2x1dGVcbiAgLy8vLyAgdG9wOiA1MCVcbiAgaDIge1xuICAgIGZvbnQtc2l6ZTogMy40dmggIWltcG9ydGFudDtcbiAgICBmb250LXdlaWdodDogNTAwICFpbXBvcnRhbnQ7XG4gICAgbWFyZ2luLWJvdHRvbTogMC4yZW0gIWltcG9ydGFudDsgfVxuXG4gIC52aXNpYmxlIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHZpc2liaWxpdHk6IHZpc2libGU7IH1cbiAgLmludmlzaWJsZSB7XG4gICAgb3BhY2l0eTogMDtcbiAgICB2aXNpYmlsaXR5OiBoaWRkZW47IH0gfVxuIl19 */\"","import {Component, Input, OnInit, HostBinding, ChangeDetectorRef} from '@angular/core';\nimport { Poi } from '../../../type/poi';\n\n@Component({\n  selector: 'poi-user-item',\n  templateUrl: './poi-user-item.component.html',\n  styleUrls: ['./poi-user-item.component.sass']\n})\nexport class PoiUserItemComponent implements OnInit {\n\n  // TODO: there has to be a an easier way to add dynamic classes to the host...\n  @HostBinding('class.idle') isIdle = true;\n  @HostBinding('class.fetching') isFetching = false;\n  @HostBinding('class.tracking') isTracking = false;\n  @HostBinding('class.error') isError = false;\n  @HostBinding('class.mat-list-item-content') isActive = true;\n\n  public userStatus: string;\n\n  @Input() data: Poi;\n  @Input() timestamp: number;\n  @Input('status') set status(value: string) {\n\n    if (value) {\n      this.userStatus = value;\n    }\n\n\n    if (value === 'tracking') {\n      this.isTracking = true;\n      this.isIdle = this.isFetching = this.isError = false;\n    } else if (value === 'fetching') {\n      this.isFetching = true;\n      this.isIdle = this.isTracking = this.isError = false;\n    } else if (value === 'error') {\n      this.isError = true;\n      this.isIdle = this.isFetching = this.isTracking = false;\n    } else {\n      this.isIdle = true;\n      this.isFetching = this.isTracking = this.isError = false;\n    }\n  }\n\n  constructor(\n    private _changeDetector: ChangeDetectorRef\n  ) {}\n\n  ngOnInit(): void {}\n}\n","module.exports = \"<div id=\\\"indicator-bar\\\" *ngIf=\\\"userPosition !== 'visible'\\\" class=\\\"{{userPosition}} {{status}}\\\">\\n  <fa-icon *ngIf=\\\"userPosition === 'above'\\\" icon=\\\"chevron-up\\\"></fa-icon>\\n  <fa-icon *ngIf=\\\"userPosition === 'below'\\\" icon=\\\"chevron-down\\\"></fa-icon>\\n</div>\\n\"","module.exports = \":host {\\n  position: absolute;\\n  z-index: 1000;\\n  right: 0;\\n  width: 38.2vw;\\n  height: calc(100vh / 14) !important;\\n  text-align: center; }\\n  :host #indicator-bar {\\n    height: 100%;\\n    box-sizing: border-box;\\n    text-align: center;\\n    font-size: 3vh; }\\n  :host .idle {\\n    background-color: #DDD; }\\n  :host .fetching {\\n    background-color: lightgoldenrodyellow; }\\n  :host .error {\\n    background-color: lightsalmon; }\\n  :host .tracking {\\n    background-color: lightgreen; }\\n  :host.above {\\n  top: 0; }\\n  :host.above #indicator-bar {\\n    padding-top: 1.75vh; }\\n  :host.below {\\n  bottom: 0; }\\n  :host.below #indicator-bar {\\n    padding-top: 2vh; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2RvdXdlcy93b3JrL2p1c3QtaGlrZS9zcmMvYXBwL2NvbXBvbmVudC9wb2ktbGlzdC91c2VyLWluZGljYXRvci91c2VyLWluZGljYXRvci5jb21wb25lbnQuc2FzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQztFQUNDLGtCQUFrQjtFQUNsQixhQUFhO0VBQ2IsUUFBUTtFQUNSLGFBQWE7RUFDYixtQ0FBbUM7RUFDbkMsa0JBQWtCLEVBQUE7RUFObkI7SUFTRyxZQUFZO0lBQ1osc0JBQXNCO0lBQ3RCLGtCQUFrQjtJQUNsQixjQUFjLEVBQUE7RUFaakI7SUFlRyxzQkFBc0IsRUFBQTtFQWZ6QjtJQWtCRyxzQ0FBc0MsRUFBQTtFQWxCekM7SUFxQkcsNkJBQTZCLEVBQUE7RUFyQmhDO0lBd0JHLDRCQUE0QixFQUFBO0VBRS9CO0VBQ0MsTUFBTSxFQUFBO0VBRFA7SUFJRyxtQkFBbUIsRUFBQTtFQUV0QjtFQUNDLFNBQVMsRUFBQTtFQURWO0lBSUcsZ0JBQWdCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9jb21wb25lbnQvcG9pLWxpc3QvdXNlci1pbmRpY2F0b3IvdXNlci1pbmRpY2F0b3IuY29tcG9uZW50LnNhc3MiLCJzb3VyY2VzQ29udGVudCI6WyIgOmhvc3Qge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHotaW5kZXg6IDEwMDA7XG4gIHJpZ2h0OiAwO1xuICB3aWR0aDogMzguMnZ3O1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLyAxNCkgIWltcG9ydGFudDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuXG4gICNpbmRpY2F0b3ItYmFyIHtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgZm9udC1zaXplOiAzdmg7IH1cblxuICAuaWRsZSB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogI0RERDsgfVxuXG4gIC5mZXRjaGluZyB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogbGlnaHRnb2xkZW5yb2R5ZWxsb3c7IH1cblxuICAuZXJyb3Ige1xuICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0c2FsbW9uOyB9XG5cbiAgLnRyYWNraW5nIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyZWVuOyB9IH1cblxuIDpob3N0LmFib3ZlIHtcbiAgdG9wOiAwO1xuXG4gICNpbmRpY2F0b3ItYmFyIHtcbiAgICBwYWRkaW5nLXRvcDogMS43NXZoOyB9IH1cblxuIDpob3N0LmJlbG93IHtcbiAgYm90dG9tOiAwO1xuXG4gICNpbmRpY2F0b3ItYmFyIHtcbiAgICBwYWRkaW5nLXRvcDogMnZoOyB9IH1cblxuIl19 */\"","import {Component, HostBinding, Input, OnInit} from '@angular/core';\n\n@Component({\n  selector: 'user-indicator',\n  templateUrl: './user-indicator.component.html',\n  styleUrls: ['./user-indicator.component.sass']\n})\n\n// user indicator that shows if the user is north/south of currently rendered list items\nexport class UserIndicatorComponent implements OnInit {\n\n  @HostBinding('class') get classes(): string {return this.userPosition;};\n  @Input('userPosition') userPosition: string;\n  @Input('status') status: string;\n\n  constructor() { }\n\n  ngOnInit() {}\n\n}\n","import {Injectable} from '@angular/core';\nimport {MatDialog} from '@angular/material';\nimport {Subscription} from 'rxjs-observable';\n\n// supported dialogs\nimport {NoteDialogComponent} from '../component/dialog/note-dialog/note-dialog.component';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// TODO: generate the correct dialog, should house all dialogs (from app component)\nexport class DialogService {\n\n  constructor(private _dialog: MatDialog) {}\n\n  private _currentDialog: any;\n  private _currentCloseSubscription: Subscription;\n\n  // marker dialog\n  public openDialog(type: string, properties: object, callback?: Function): void {\n\n    this._toggleNavigationBar();\n\n    if (this._currentDialog) {\n      this._dialog.closeAll();\n    }\n\n    if (this._currentCloseSubscription) {\n      this._currentCloseSubscription.unsubscribe();\n      this._currentCloseSubscription = null;\n    }\n\n    this._currentDialog = this._createDialogByType(type, properties);\n\n    // set a self destroying close subscription\n    if (this._currentDialog) {\n      this._currentCloseSubscription = this._currentDialog.afterClosed().subscribe(result => {\n\n        // result should be success/failure or cancel\n\n        this._currentCloseSubscription.unsubscribe();\n        this._currentCloseSubscription = null;\n\n        if (callback) {\n          callback(result);\n        }\n\n        this._currentDialog = null;\n      });\n    }\n  }\n\n  private _createDialogByType(type: string, properties: object): any {\n\n    if (type === 'note') {\n      return this._dialog.open(NoteDialogComponent, {\n        autoFocus: false,\n        width: '60%',\n        height: '75%',\n        data: properties\n      });\n    } else {\n      console.warn('attempting to open an unknown dialog type');\n      return;\n    }\n  }\n\n  private _toggleNavigationBar(): void {\n    // // get marker poi data\n    // if (this.navIsVisible) {\n    //   this._toggleNavigationVisibility(false);\n    // }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {User} from '../type/user';\ndeclare const SVG: any;    // fixes SVGjs bug\nimport {Poi} from '../type/poi';\nimport {getPoiTypeByType} from '../_util/poi';\nimport {htmlIcon} from '../_util/leaflet/icon';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {shadeColor} from '../_util/color';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// factory for generating markers (leaflet & elevation profile markers)\nexport class MarkerService {\n\n  // svg pin icon\n  private _markerData: string = 'm16.75,0.75c-8.28366,0 -15,6.71484 -15,15c0,2.32031 0.52734,4.52053 ' +\n    '1.46925,6.48047c0.05269,0.11137 13.53075,26.51953 13.53075,26.51953l13.36819,-26.19141c1.04297,-2.04197 ' +\n    '1.63181,-4.35647 1.63181,-6.80859c0,-8.28516 -6.71484,-15 -15,-15z';\n\n  private maxPoiDistanceOffTrail: number;\n\n  constructor(private _localStorageService: LocalStorageService) {\n\n    this.maxPoiDistanceOffTrail = _localStorageService.retrieve('poiDistanceOffTrail');\n  }\n\n  /* deals with multiple poi icons per marker:\n  - if a poi has 1 type, base it\n  - if a poi has 2 types, base them\n  - if a poi has > 2 types, base 1+\n  if a poi contains water always show that icon first */\n  public setupMarker(containerElement: any, poi: Poi, poiTypes?: Array<string>): any {\n\n    // if there are no explicit poi types set, use all poi types\n    if (!poiTypes) {\n      poiTypes = poi.type.split(', ');\n    }\n\n    const _poiTypesLength = poiTypes.length;\n\n    let _marker;\n    let _markerColor: string;\n    let _extraOffset: number = 0;\n    let _iconSize: number = 16;\n\n    const poiMeta = getPoiTypeByType(poiTypes[0]);\n\n    if (!poiMeta || _poiTypesLength > 1) {\n      _markerColor = getPoiTypeByType('multiple').color;\n    } else {\n      _markerColor = poiMeta.color;\n    }\n\n    _marker = this._createMarkerType(poi, containerElement, _markerColor);\n\n    // set classes\n    const _length = (_poiTypesLength > 2) ? 2 : _poiTypesLength;\n    for (let i = 0; i < _length; i++) {\n      _marker.addClass(poiTypes[i]);\n    }\n\n    if ( _poiTypesLength > 1) {\n      _marker.addClass('multiple');\n      _iconSize = 14;\n      _extraOffset = (_iconSize / 2);\n    }\n\n    // if multipoi\n    if (poiTypes.length > 1) {\n\n      // check if there's water\n      const _waterIndex = poiTypes.indexOf('water');\n\n      // swap elements so water is first\n      if (_waterIndex > 0) {\n        poiTypes[0] = poiTypes.splice(_waterIndex, 1, poiTypes[0])[0];\n      }\n    }\n\n    for (let t = 0; t < 2; t++) {\n\n      let _type = poiTypes[t];\n\n      if (_type) {\n\n        // max of 2 icons in marker, if more types show plus symbol\n        if (t === 1 && poiTypes.length > 2) {\n          _type = 'multiple';\n        }\n\n        _marker.use(this.sampleFaIcon(_type)).width(_iconSize).height(_iconSize).move(\n          -(_iconSize / 2) + ((t * 1.5) * (_iconSize / 2)) - _extraOffset,\n          Number(_marker.node.attributes.vOffset.value) + (_iconSize / 2) + (t * _extraOffset));\n      }\n    }\n    return _marker;\n  }\n\n  private _createMarkerType(poi: Poi | User, containerElement: any, color: string): any {\n\n    let _marker;\n\n    if (poi.waypoint.distance <= this.maxPoiDistanceOffTrail || !this.maxPoiDistanceOffTrail) {\n      _marker = this.createSvgPinMarker(containerElement, color);\n    } else {\n      _marker = this.createSvgCircleMarker(containerElement, color);\n    }\n\n    return _marker;\n  }\n\n  public createSvgFaElement(canvas: any, id: string, scale: number = 1, offsetX: number = -16.5, offsetY: number = -48) {\n\n    let _element = canvas.group();\n    _element.use(this.sampleFaIcon(id)).width(33 * scale).height(50 * scale).move(offsetX, offsetY);\n\n    return _element;\n  }\n\n  // by default a point marker is 30 x 45px, and the border color is 10% darker than the fill color\n  public createSvgPinMarker (canvas: any, color: string, scale: number = 1, opacity: number = 0.85) {\n\n    const _marker = canvas.group();\n    _marker.attr('vOffset', -(50 * scale));\n    _marker.attr('fill-opacity', opacity);\n    _marker.addClass('fa-marker');\n    _marker.attr('type', 'pin');\n    _marker.path(this._markerData).fill(color).width(33 * scale).height(50 * scale).stroke({color: shadeColor(color, -15), width: 2 * scale}).move(-(16.5 * scale), -(50 * scale)).addClass('pin');\n\n    return _marker;\n  }\n\n  // by default a round marker is 30 x 30px, and the border color is 10% darker than the fill color\n  public createSvgCircleMarker (canvas: any, color: string, scale: number = 1, opacity: number = 0.85) {\n\n    const _marker = canvas.group();\n    _marker.attr('vOffset', -(16.5 * scale));\n    _marker.attr('fill-opacity', opacity);\n    _marker.addClass('fa-marker');\n    _marker.attr('type', 'pin');\n    _marker.attr('type', 'circle');\n    const _size = Math.round(33 * scale);\n    _marker.circle(_size, _size).fill(color).stroke({color: shadeColor(color, -15), width: 2 * scale}).move(-(16.5 * scale), -(16.5 * scale)).addClass('circle');\n\n    return _marker;\n  }\n\n  // font awesome webfont doesn't seem to render to svg elements\n  // to fix this we're cloning svg data from generated (hidden) elements at start-up, see fa-sampler (component)\n  // check if the svg data exists, and return the full id string to use\n  public sampleFaIcon(iconId:string) {\n\n    // test if Font Awesome SVG data exists\n    let svgIcon = document.getElementById('sample-' + iconId);\n\n    if (svgIcon === null) {\n      iconId = 'unknown';\n      console.log('attempting to use unknown Font Awesome icon', iconId);\n    }\n\n    return 'sample-' + iconId;\n  }\n\n  // leaflet only, creates a circular leaflet marker that pulses (tracking only, invisible when idle/fetching)\n  public createLeafletUserMarker(): any {\n\n    // create root + svg element\n    const _element = document.createElement('div');\n    _element.classList.add('user-marker');\n\n    // create circle + icon\n    const _draw = SVG(_element).size(26, 26).style('overflow', 'visible');\n    this.createSvgCircleMarker(_draw, '#7f7f7f', 0.787878);\n    _draw.use(this.sampleFaIcon('user-dot')).width(24).height(24).move(-12, -12);\n\n    // pulsing circle\n    const _pulse = document.createElement('div');\n    _pulse.classList.add('pulse');\n    _element.appendChild(_pulse);\n\n    return htmlIcon({className: 'user', html: _element});\n  }\n\n  // public createLeafletIndicatorMarker(): any {\n  //\n  //   // create root + svg element\n  //   const _element = document.createElement('div');\n  //   _element.classList.add('indicator-marker');\n  //\n  //   // create circle + icon\n  //   const _draw = SVG(_element).size(8, 8).style('overflow', 'visible');\n  //   this.createSvgCircleMarker(_draw, '#FF0000', 0.25);\n  //\n  //   return htmlIcon({className: 'indicator', html: _element});\n  // }\n}\n","import {Waypoint} from '../type/waypoint';\nimport {Poi} from '../type/poi';\nimport {TrailMeta} from '../type/trail';\nimport {environment} from '../../environments/environment.prod';\nimport {calculateSectionScale} from '../_util/geolib/distance';\nimport {pointArrayTypeConversion} from '../_util/leaflet/converter';\nimport {TrailParser} from '../base/trail-parser/trail-parser';\nimport {Town} from '../type/town';\n\n/* Pacific Crest Trail www.pcta.org */\nexport class PCTData extends TrailParser {\n\n  constructor() {\n    super();\n  }\n\n  // parses the entire PCT as well as the DEMO trail (the first section of the PCT)\n  parse(trail: TrailMeta, trailData: Array<string> | string, poiData: string, snow: object, towns: Array<Town>, direction: any): any {\n\n    super.parse(trail, trailData, poiData, snow, towns, direction);\n\n    // set waypoint string property conversion values\n    this.findReplaceArray = [\n      {find: 'ele', replace: 'elevation'},\n      {find: 'lat=', replace: 'latitude='},\n      {find: 'lon=', replace: 'longitude='},\n      {find: 'desc', replace: 'description'},\n      {find: 'cmt', replace: 'comment'},\n      {find: 'sym', replace: 'icon'}];\n\n\n\n    // WAYPOINTS\n\n    // convert the waypoints\n    let _trailData: Array<Waypoint>;\n    if (Array.isArray(this.trailData)) {\n      _trailData = this.parseTrail(this.trailData as Array<string>);\n    } else {\n      _trailData = this.parseTrail([this.trailData]);\n    }\n\n    trail.length = this.totalDistance / environment.MILE;\n\n\n\n    // POIS (=points of interest. water sources, campsites etc.)\n\n    poiData = this.convertToWaypointString(poiData);\n    const poiAsJson: JSON = this.x2js.xml2js(poiData);\n    const _pois: Array<Poi> = this.directionReverse(this.parsePois(poiAsJson['gpx']['wpt']));\n\n    return [trail, _trailData, _pois, snow['datasets'][0], towns];\n  }\n\n  parseTrail(trailData: Array<string>): Array<Waypoint> {\n\n    const _self = this;\n\n    // TRAIL\n    let _waypoints: Array<Waypoint> = [];\n\n    trailData.forEach(function(trailString: string, index: number) {\n\n      trailString = _self.convertToWaypointString(trailString);\n\n      console.log(trailString);\n\n      const trailAsJson: JSON = _self.x2js.xml2js(trailString);\n\n      console.log(trailAsJson);\n      // get just the main trail data, ignore side-trails (for now)\n      if (!Array.isArray(trailAsJson['gpx']['trk'])) {\n        // convert to array with 1 track\n        trailAsJson['gpx']['trk'] = [trailAsJson['gpx']['trk']];\n      }\n\n      trailAsJson['gpx']['trk'] = _self.directionReverse(trailAsJson['gpx']['trk']);\n\n      const _length = trailAsJson['gpx']['trk'].length;\n      for (let i = 0; i < _length; i ++) {\n\n        const _section = trailAsJson['gpx']['trk'][i];\n\n        // 'Red' identifies the main track\n        if (_section.extensions.TrackExtension.DisplayColor.__text.includes('Red')) {\n\n          _section.trkseg.trkpt = _self.directionReverse(_section.trkseg.trkpt);\n\n          let _sectionWaypoints: Array<Waypoint> = pointArrayTypeConversion(_section.trkseg.trkpt, 'waypoint', 'waypoint');\n\n          let _trailLength: number;\n\n          // DEMO data has a single number, PCT has an array (sections)\n          if (typeof _self.trail.length === 'number') {\n            _trailLength = _self.trail.length;\n          } else {\n            _trailLength = _self.trail.length[index];\n          }\n\n          const _scale: number = calculateSectionScale(_sectionWaypoints, _trailLength);\n\n          _sectionWaypoints = _self.addDistanceToWaypoints(_sectionWaypoints, _scale);\n          _waypoints = _waypoints.concat(_sectionWaypoints);\n        }\n      }\n    });\n\n    return _waypoints;\n  }\n\n  // TODO: cleanup (dealing with other peoples data files gets messy)\n  parsePois(pois: Array<object>): Array<Poi> {\n\n    const _poisLength: number = pois.length;     // faster\n    const _parsedPois: Array<Poi> = [];\n\n    // a static list of poi types based on the raw data identifiers, which are manually linked to poiTypes (or unknown)\n    const _identifierTypes: object =\n      {MexB: 'end', WR: 'water', RD: 'road', RDB: 'road', PO: 'postoffice', Trad: 'store, food', Hwy: 'highway', RR: 'railroad', CS: 'camp', GT: 'gate', GTB: 'gate', PL: 'powerline', PLB: 'powerline', WRCS: 'water, camp', WACS: 'water, camp', OakS: 'store, food', Kitc: 'water', TR: 'trail', RedT: 'information', RDb: 'road', Deck: 'view', TH: 'trailhead', WRA: 'water', WRB: 'water', WRC: 'water', BV: 'camp', BVB: 'camp', CSC: 'camp', CSB: 'camp', BGCa: 'sight', Ranc: 'view', GTC: 'gate', Eagl: 'sight', HwyB: 'highway', TRb: 'trail', WRb: 'water', Heme: 'store, food', Tqtz: 'water', Humb: 'trailhead', Sadd: 'trail', PSTr: 'trail', TrRo: 'trail', WA: 'water', MtSa: 'view', Roun: 'boundary', SJSh: 'shelter', TrWi: 'trail', Well: 'water', SJTr: 'trail', BY: 'boundary', Suic: 'peak', TrSu: 'trail', Stra: 'trailhead', Zigg: 'resort', RDC: 'road', CCra: 'sight', Fish: 'trail', Anim: 'sight', Spli: 'shelter', Brid: 'bridge', MFSp: 'unknown', Stat: 'boundary', Moja: 'powerline', Fore: 'boundary', McDo: 'food', RRB: 'railroad', RDD: 'road', Bald: 'trailhead', MtBa: 'peak', Memo: 'sight', Door: 'water', TRB: 'trail', TRC: 'trail', HwyC: 'highway', BigR: 'water', Burk: 'peak', Punc: 'water', HwyD: 'highway', HwyE: 'highway', Buck: 'road', HWYF: 'highway', HwyG: 'highway', HwyH: 'highway', HwyI: 'highway', Mess: 'camp', Acto: 'resort', Gold: 'sight', Agua: 'town', Sier: 'highway', Benc: 'sight', Casa: 'resort', Iber: 'postoffice, water', Wind: 'sight', Pass: 'peak', Gull: 'sight', KMSt: 'resort', WAB: 'water', Hors: 'camp', JMT: 'trail', BVI: 'camp', CSH: 'camp', CSL: 'camp', CSM: 'camp', MTWh: 'peak', Trai: 'peak', WAC: 'water', WAD: 'water', WAE: 'water', WAJ: 'water', WAN: 'water', WAO: 'water', WAQ: 'water', WAS: 'water', WAT: 'water', WAU: 'water', Onio: 'trailhead', RaeL: 'information', GTD: 'gate', McCl: 'information', HotS: 'sight', Muir: 'resort', CSD: 'camp', VVR: 'resort', Reds: 'resort', CSO: 'camp', WAF: 'water', WAK: 'water', WAV: 'water', MMSk: 'unknown', NoCa: 'warning', Tuol: 'postoffice, store, food', JMTC: 'camp', Happ: 'road', HWYB: 'highway', JMTW: 'water', Walk: 'trailhead', Cars: 'boundary', Meis: 'water', Echo: 'trailhead', Ski: 'sight', Weat: 'sight', Rest: 'sight', Pete: 'camp', Chur: 'sight', Road: 'road', Paul: 'water', EBra: 'water', WBra: 'water', RDN: 'road', Bear: 'water', Hask: 'store, resort', Lake: 'resort', Beld: 'resort', Will: 'water', Myrt: 'water', Cold: 'water', PCTM: 'sight', HWY: 'highway', Drak: 'resort', OldS: 'town', JJsC: 'food, store', Subw: 'water', HatC: 'view', Crys: 'water', Brit: 'water', Fitz: 'water', Fern: 'water', Dead: 'water', Litt: 'water', Wolf: 'water', Etna: 'road', Shel: 'water', Marb: 'water, camp', Seia: 'resort', Alex: 'water', Ward: 'road', Oreg: 'boundary', Rogu: 'boundary', Call: 'resort', OldH: 'highway', Camp: 'resort', Klum: 'camp, water', Howa: 'water, road', Brow: 'water, camp', RimD: 'highway', RimV: 'information', RimT: 'trailhead', Casc: 'water', Summ: 'trailhead', Maza: 'resort', ORWA: 'sign', CSDi: 'camp', SkiS: 'sight, camp', Isla: 'water', Koos: 'camp', Obsi: 'boundary, warning', Sant: 'trailhead', Jeff: 'boundary', SFor: 'water', Park: 'camp', Many: 'view', Olal: 'resort', Pinh: 'trailhead', OakG: 'water', Kohn: 'boundary', Timb: 'resort', Radi: 'sight', Ramo: 'water', Mudd: 'water, camp', Indi: 'water', Mile: 'sight', High: 'sight', Tunn: 'sight', SWMo: 'road', Tabl: 'information', Blue: 'water, camp', Yaka: 'warning', Krac: 'resort', TwoL: 'water', BigC: 'camp', Mart: 'camp', Uric: 'camp, water', Olla: 'sight', MFor: 'camp, water', Dutc: 'view', Lema: 'camp', Deep: 'water', Dece: 'water', HwyJ: 'highway', Rain: 'water', Monu: 'end', RESO: 'resort'};\n    let _count: number = 0;\n\n    for (let i = 0; i < _poisLength; i++) {\n\n      const _poi: object = pois[i];\n\n      // delete if poi is mile marker\n      if (_poi['icon'] === 'Triangle, Red') {\n        delete pois[i];\n      } else {\n\n        _poi['id'] = _count;\n        _count++;\n\n        // create waypoint\n        _poi['waypoint'] = {latitude: _poi['latitude'], longitude: _poi['longitude'], elevation: _poi['elevation']} as Waypoint;\n        delete _poi['latitude'];\n        delete _poi['longitude'];\n        delete _poi['elevation'];\n\n        // remove color from icon\n        delete _poi['icon'];\n\n        // set the type based on the remaining string\n        let _identifier = _poi['name'].replace(/\\d+/g, '');\n\n        // '-' means side trail, which we're ignoring for now.\n        if (!_poi['name'].includes('-')) {\n\n          const _last2Letters = _identifier.substr(_identifier.length - 2, _identifier.length - 1).toLowerCase();\n          const _last3Letters = _identifier.substr(_identifier.length - 3, _identifier.length - 1).toLowerCase();\n          const _last4Letters = _identifier.substr(_identifier.length - 4, _identifier.length - 1).toLowerCase();\n          if (_last2Letters === 'tr') {\n            _identifier = 'TR';\n          } else if (_last2Letters === 'th') {\n            _identifier = 'TH';\n          } else if (_last2Letters === 'cg' || _last3Letters === 'cmp') {\n            _identifier = 'WRCS';\n          } else if (_last2Letters === 'np' || _last2Letters === 'nf' || _last2Letters === 'sp' || _last4Letters === 'wild') {\n            _identifier = 'BY';\n          } else if (_last2Letters === 'rd' || _last4Letters === 'road') {\n            _identifier = 'RD';\n          } else if (_last4Letters === 'inn' || _last4Letters === 'odge' || _last4Letters === 'sort') {\n            _identifier = 'RESO';\n          } else if (_last4Letters === 'pass') {\n            _identifier = 'Pass';\n          } else if (_last4Letters === 'ring' || _last4Letters === 'reek' || _last4Letters === 'iver'\n            || _last4Letters === 'trib' || _last4Letters === 'lake' || _last4Letters === 'pond' || _last4Letters === 'seep'\n            || _last3Letters === 'crk' || _last3Letters === 'spg' || _last4Letters === 'fork') {\n            _identifier = 'WA';\n          } else if (_last4Letters === 'camp') {\n            _identifier = 'CS';\n          } else {\n            _identifier = _poi['name'].replace(/\\d+/g, '').substr(0, 4);\n          }\n          // generateIdentifierList(_identifier);\n        }\n\n        _poi['type'] = _identifierTypes[_identifier];\n        if (!_poi['type']) {\n          _poi['type'] = 'unknown';\n        }\n\n        // title & description\n\n        console.log(JSON.stringify(_poi['description']));\n\n        const _textArray = this._splitCleanStrings(_poi['description'], [', ', '---', '<br/>']);\n        const _labelArray = _textArray.shift().split('. ');\n\n        _poi['label'] = _labelArray.shift();\n\n        _textArray.unshift(_labelArray.join('. '));\n\n        // filter out blank elements\n        const _descriptionArray = _textArray.filter(function (element: string) {\n          return element !== '';\n        });\n\n        const _description: string = _descriptionArray.join(' ').split('. ').join('<br/><br/>');\n\n        _poi['description'] = this._convertDescription(_description);\n        _poi['identifier'] = 'HM: ' + _poi['name'];\n\n        delete _poi['name'];\n\n        _parsedPois.push(_poi as Poi);\n      }\n    }\n\n    // 4. adjust individual pois\n\n    // Highway elevation seems to be in feet, while rest of the waypoints is in meters\n    const _highwayExceptions = ['Highway 78', 'Highway 74', 'Highway 178', 'Highway 108', 'Highway 50', 'Highway 49', 'Highway 36'\n      , 'Highway 299', 'Highway 5', 'Highway 99', 'Highway 140', 'Hwy 242', 'under Highway 84', 'Stevens Pass', 'Highway 20']\n\n    const _pLength = _parsedPois.length;\n    const _eLength = _highwayExceptions.length;\n\n    for (let p = 0; p < _pLength; p++) {\n\n      let _exception = -1;\n      for (let e = 0; e < _eLength; e++) {\n\n        if (_parsedPois[p].label.includes(_highwayExceptions[e])) {\n          _parsedPois[p].waypoint.elevation = _parsedPois[p].waypoint.elevation * environment.FOOT;\n          _exception = e;\n          break;\n        }\n      }\n\n      if (_exception !== -1) {\n        _highwayExceptions.splice( _exception,1);\n      }\n\n      if (_highwayExceptions.length === 0) {\n        break;\n      }\n    }\n\n    return _parsedPois;\n  }\n\n  private _convertDescription(input: string): string {\n\n    let _description = this.convertStringUrls(input);     // a href tag\n    _description = this.convertStringTel(_description);   // a tel tag\n    _description = this._capFirstLetter(_description);    // capitalize\n\n    return _description;\n  }\n\n  // does not support ~ (tilde), this is slow...\n  private _splitCleanStrings(input: string, remove: Array<string>): Array<string> {\n\n    remove.push('~');\n    let _input: any = input;\n\n    const _length = remove.length;\n    for (let i = 0; i < _length; i++) {\n\n      _input = _input.split(remove[i]);\n\n      if (i !== _length - 1) {\n        _input = _input.join('~');\n      }\n    }\n\n    return _input;\n  }\n\n  private _capFirstLetter(input: string): string {\n    return input.charAt(0).toUpperCase() + input.slice(1);\n  }\n}\n","import {Waypoint} from '../type/waypoint';\nimport {Poi} from '../type/poi';\nimport {TrailMeta} from '../type/trail';\nimport {environment} from '../../environments/environment.prod';\nimport {calculateSectionScale} from '../_util/geolib/distance';\nimport {pointArrayTypeConversion} from '../_util/leaflet/converter';\nimport {TrailParser} from '../base/trail-parser/trail-parser';\nimport {Town} from '../type/town';\n\n/* Sierra High Route, only app that supports it! */\nexport class SHRData extends TrailParser {\n\n  constructor() {\n    super();\n  }\n\n  // parses the entire PCT as well as the DEMO trail (the first section of the PCT)\n  parse(trail: TrailMeta, trailData: string, poiData: string, snow: object, towns: Array<Town>, direction: any): any {\n\n    super.parse(trail, trailData, poiData, snow, towns, direction);\n\n    // set waypoint string property conversion values\n    this.findReplaceArray = [\n      {find: 'ele', replace: 'elevation'},\n      {find: 'lat=', replace: 'latitude='},\n      {find: 'lon=', replace: 'longitude='},\n      {find: 'desc', replace: 'description'}]\n\n\n    // WAYPOINTS\n\n    // convert the waypoints\n    const _trailData: Array<Waypoint> = this.parseTrail(this.trailData as string);\n\n    trail.length = this.totalDistance / environment.MILE;\n\n    // POIS (=points of interest. water sources, campsites etc.)\n\n    poiData = this.convertToWaypointString(poiData);\n    const poiAsJson: JSON = this.x2js.xml2js(poiData);\n    const _pois: Array<Poi> = this.directionReverse(this.parsePois(poiAsJson['gpx']['wpt']));\n\n    return [trail, _trailData, _pois, snow, towns];\n  }\n\n  parseTrail(trailData: string): Array<Waypoint> {\n\n    const _self = this;\n\n    // TRAIL\n    let _waypoints: Array<Waypoint> = [];\n\n    trailData = _self.convertToWaypointString(trailData);\n    const trailAsJson: JSON  = _self.x2js.xml2js(trailData);\n\n    const _tracks: Array<any> = _self.directionReverse(trailAsJson['gpx']['trk'][1]['trkseg']);\n\n      // combine all track segments in a single array\n    _tracks.forEach(function(track) {\n\n      const _sectionWaypoints: Array<Waypoint> = _self.directionReverse(pointArrayTypeConversion(track['trkpt'], 'waypoint', 'waypoint'));\n      _waypoints = _waypoints.concat(_sectionWaypoints);\n    });\n\n    const _trailLength: number = _self.trail.length as number;\n    const _scale: number = calculateSectionScale(_waypoints, _trailLength);\n\n    _waypoints = _self.smoothFlatPoints(_waypoints);\n\n    _waypoints = _self.addDistanceToWaypoints(_waypoints, _scale);\n\n    return _waypoints;\n  }\n\n  // remove waypoints that don't have elevation\n  smoothFlatPoints(waypoints: Array<Waypoint>): Array<Waypoint> {\n\n    const _length = waypoints.length;\n    for (let i = 0; i < _length; i++) {\n      const _waypoint = waypoints[i];\n\n      if (!_waypoint.elevation) {\n        _waypoint.elevation = (waypoints[i - 1].elevation + waypoints[i + 1].elevation) / 2;\n      }\n    }\n\n    return waypoints;\n  }\n\n  parsePois(pois: Array<object>): Array<Poi> {\n\n    pois.forEach(function(poi, index) {\n\n      poi['id'] = index;\n\n      // create waypoint\n      poi['waypoint'] = {latitude: poi['latitude'], longitude: poi['longitude'], elevation: poi['elevation']} as Waypoint;\n      delete poi['latitude'];\n      delete poi['longitude'];\n      delete poi['elevation'];\n\n      // fix name\n      if (poi['name'].match(/^\\d/)) {\n        // string starts with a number\n        const _parts = poi['name'].split(' - ');\n        poi['name'] = _parts[0];\n        poi['label'] = _parts[1] || 'unknown';\n      } else {\n        poi['name'] = poi['label'] = poi['name'].split(' - ')[0];\n      }\n\n      // if no name, use a part of the description\n      if (!poi['name']) {\n        if (String(poi['description']).includes(' - ')) {\n          poi['name'] = poi['label'] = poi['description'].split(' - ')[0] || 'unknown';\n        } else {\n          poi['name'] = poi['label'] = 'alternate';\n        }\n      }\n\n      // TODO: parse poi types\n\n      // set the type based on the remaining string\n      const _identifier = poi['name'] + poi['label'];\n\n      poi['type'] = 'unknown';\n\n      if (_identifier.includes('Begin') || _identifier.includes('Mono Village')) {\n        poi['type'] = 'end';\n      } else if (_identifier.includes('Peak') || _identifier.includes('Mount') || _identifier.includes('Col')) {\n        poi['type'] = 'peak';\n      } else if (_identifier.includes('Lake') || _identifier.includes('Outlet') || _identifier.includes('WA')\n        || _identifier.includes('Stream') || _identifier.includes('Tarn') || _identifier.includes('Creek')) {\n        poi['type'] = 'water';\n      } else if (_identifier.includes('WACS')) {\n        poi['type'] = 'water, camp';\n      } else if (_identifier.includes('Pass') || _identifier.includes('Saddle')) {\n        poi['type'] = 'view';\n      } else if (_identifier.includes('Memorial')) {\n        poi['type'] = 'sight';\n      } else if (_identifier.includes('OnionValley')) {\n        poi['type'] = 'trailhead';\n      } else if (_identifier.includes('CS') || _identifier.includes('Campsite')) {\n        poi['type'] = 'camp';\n      } else if (_identifier.includes('Point')) {\n        poi['type'] = 'view';\n      }\n\n      // TODO: cleanup unused properties\n      delete poi['sym'];\n      delete poi['name'];\n    });\n\n    return pois as Array<Poi>;\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport {environment} from '../../environments/environment.prod';\n\n@Pipe({ name: 'distance' })\n\nexport class DistancePipe implements PipeTransform {\n\n  // converts a number in a string indicating distance\n  // optional: distance from trail\n\n  transform(\n\n    value:                  number,\n    currentUnit:            string,\n    desiredUnit:            string,\n\n    fromTrailIndicator:     boolean       = false,\n    round:                  number        = 2,\n    force:                  boolean       = false,\n    relative:               boolean       = false\n\n  ): string {\n\n    let _currentUnit: string = (currentUnit) ? currentUnit : 'meters';\n    let _convertedValue: number;\n    let _format: string = 'm';\n\n    // convert to meters\n    if (_currentUnit !== 'meters') {\n      if (_currentUnit === 'miles' || _currentUnit === 'mile') {\n        value = value * environment.MILE;\n      }\n      if (_currentUnit === 'feet' || _currentUnit === 'foot') {\n        value = value * environment.FOOT;\n      }\n      _currentUnit = 'meters';\n    }\n\n    // convert value from meters to desiredUnit (if needed)\n    if (desiredUnit === 'miles' || desiredUnit === 'mile') {\n\n      if (value / environment.MILE >= 0.1 || force === true) {\n\n        _convertedValue = Number((value / environment.MILE).toFixed(round));\n        _format = 'mi.';\n\n      } else {\n\n        _convertedValue = Number((value / environment.FOOT).toFixed(0));\n        _format = (_convertedValue > 1) ? 'feet' : 'foot';\n        _format = (!fromTrailIndicator) ? _format : 'ft.';\n\n      }\n\n    } else if (desiredUnit === 'feet' || desiredUnit === 'foot') {\n\n      _convertedValue = Number((value / environment.FOOT).toFixed(0));\n      _format = (_convertedValue > 1) ? 'feet' : 'foot';\n      _format = (!fromTrailIndicator) ? _format : 'ft.';\n\n    } else {\n\n      _convertedValue = Number(value.toFixed(round));\n    }\n\n    // on/off trail\n    if (fromTrailIndicator) {\n\n      if (value > 10) {\n        return '~' + _convertedValue + ' ' + _format + ' off trail';\n      } else {\n        return 'on trail';\n      }\n    } else if (relative) {\n\n      const _relativeString = (value > 0) ? ' ahead' : ' back';\n\n      return Math.abs(_convertedValue) + ' ' + _format + ' ' + _relativeString;\n\n    } else {\n      // return distance\n      return _format + ' ' + _convertedValue;\n    }\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'filesize'\n})\nexport class FilesizePipe implements PipeTransform {\n\n  transform(bytes: number, decimalPoint?: number): string {\n\n    if (bytes === 0) {\n      return '0 Bytes';\n    }\n\n    const _k = 1000;\n    const _dm = decimalPoint || 2;\n    const _sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    const _i = Math.floor(Math.log(bytes) / Math.log(_k));\n\n    return parseFloat((bytes / Math.pow(_k, _i)).toFixed(_dm)) + ' ' + _sizes[_i];\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport {Poi} from '../type/poi';\nimport {BehaviorSubject} from 'rxjs';\n\n@Pipe({ name: 'poisorting' })\n\nexport class PoiSortingPipe implements PipeTransform {\n\n  transform(subject: BehaviorSubject<Array<Poi>>) {\n\n    if (!subject) {\n      return;\n    }\n\n    const poiArray: Array<Poi> = subject.getValue();\n\n    // sort array by the trail distance of the anchor point (the nearest on trail location)\n    poiArray.sort(\n      function(a, b) {\n\n        const _aDist = (a.anchorPoint && a.anchorPoint.distanceTotal) ? a.anchorPoint.distanceTotal : 0;\n        const _bDist = (b.anchorPoint && b.anchorPoint.distanceTotal) ? b.anchorPoint.distanceTotal : 0;\n\n        return _aDist - _bDist;\n      });\n\n    return poiArray;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {BehaviorSubject, Observable} from 'rxjs';\nimport {getConnection, hasConnection} from '../_util/cordova';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// TODO: online / offline doesn't seem to work reliably (and is slow), consider using another method/package\nexport class ConnectionService {\n\n  private _connection: BehaviorSubject<boolean> = new BehaviorSubject(false);\n\n  public connectionObserver: Observable<boolean>;\n  public state = 'unknown';\n\n  constructor() {\n    this.connectionObserver = this._connection.asObservable();\n  }\n\n  public startTracking(): void {\n    window.addEventListener('online', this._toggleConnection.bind(this), true);\n    window.addEventListener('offline', this._toggleConnection.bind(this), true);\n    this._toggleConnection();\n  }\n\n  public stopTracking(): void {\n    window.removeEventListener('online', this._toggleConnection.bind(this), true);\n    window.removeEventListener('offline', this._toggleConnection.bind(this), true);\n    this._connection.next(null);\n  }\n\n  public getConnectionInfo(): object {\n\n    if (!hasConnection()) {\n      return {state: 0, message: 'Unknown connection'};\n    }\n\n    const _connection = getConnection();\n    const _navigator: any = navigator;\n    const _networkState = _navigator.connection.type;\n\n    const _states = {};\n    _states[_connection.UNKNOWN]  = 'Unknown connection';\n    _states[_connection.ETHERNET] = 'Ethernet connection';\n    _states[_connection.WIFI]     = 'WiFi connection';\n    _states[_connection.CELL_2G]  = 'Cell 2G connection';\n    _states[_connection.CELL_3G]  = 'Cell 3G connection';\n    _states[_connection.CELL_4G]  = 'Cell 4G connection';\n    _states[_connection.CELL]     = 'Cell generic connection';\n    _states[_connection.NONE]     = 'No network connection';\n\n    // alert('Connection type: ' + _states[_networkState]);\n\n    return {state: _networkState, message: _states[_networkState]};\n  }\n\n  public getStatus(): string {\n\n    if (!hasConnection()) {\n      return 'unknown';\n    }\n\n    // cordova navigator\n    const _connection = getConnection();\n    const _navigator: any = navigator;\n    const _networkState = _navigator.connection.type;\n\n    return (_networkState === _connection.NONE || _networkState === _connection.UNKNOWN)? 'offline' : 'online';\n  }\n\n  private _toggleConnection(event?: Event): void {\n\n    const _isOnline: boolean = navigator.onLine;\n\n    if (this._connection.getValue() !== _isOnline) {\n      this.state = (_isOnline) ? 'online' : 'offline';\n      this._connection.next(_isOnline);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Downloader } from '../_util/downloader/downloader';\nimport { BehaviorSubject, Observable, Subscription } from 'rxjs';\nimport { share } from 'rxjs/operators';\nimport { FilesystemService } from './filesystem.service';\nimport {LocalStorageService} from 'ngx-webstorage';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// Downloader manager\n// creates separate downloaders for files that continue when components are removed\n// has a global state (isDownloading), to see if there are still active processes\nexport class DownloadService {\n\n  public isDownloadingObservable: Observable<boolean>;\n\n  private _downloaders = {};\n  private _observers = {};\n  private _states = {};\n  private _isDownloading: BehaviorSubject<boolean> = new BehaviorSubject(false);\n\n  constructor(\n    private _fileSystemService: FilesystemService,\n    private _httpClient: HttpClient,\n    private _localStorageService: LocalStorageService\n  ) {\n\n    this.isDownloadingObservable  = this._isDownloading.asObservable().pipe(share());\n  }\n\n  // create a new downloader or return existing based on name\n  public createDownloader(name: string): Downloader {\n\n    let _dl: Downloader = this._downloaders[name];\n\n    if (!_dl) {\n      _dl = new Downloader(name, this._fileSystemService, this._httpClient, this._localStorageService);\n      this._downloaders[name] = _dl;\n      this._addStatusObserver(name, _dl);\n    }\n\n    return _dl;\n  }\n\n  public clearDownloaders(trailAbbr?: string, force: boolean = false): void {\n\n    this._updateGlobalStatus();\n\n    if (this._isDownloading.getValue() && !force) {\n\n      alert('Trying to cancel actively running downloads, use force!');\n      return;\n\n    } else {\n\n      let _downloadersToClear = {};\n\n      if (trailAbbr) {\n\n        // only cancel/clear downloaders for trail\n        for (const key in this._downloaders) {\n\n          if (key.includes(trailAbbr)) {\n            _downloadersToClear[key] = this._downloaders[key];\n          }\n        }\n\n      } else {\n        // clear all\n        _downloadersToClear = this._downloaders;\n      }\n\n      for (const key in _downloadersToClear) {\n\n        let _dl: Downloader = this._downloaders[key];\n        _dl.cancelDownload();\n        _dl = null;\n\n        let _ob: Subscription = this._observers[key];\n        _ob.unsubscribe();\n        _ob = null;\n      }\n\n      if (!trailAbbr) {\n        this._downloaders = {};\n        this._observers = {};\n        this._states = {};\n      }\n    }\n  }\n\n  private _addStatusObserver(name: string, downloader: Downloader): void {\n\n    // observe status\n    const _downloadState: Subscription = downloader.meta.subscribe(\n      status => {\n          this._updateGlobalStatus();\n      });\n\n    this._states[name] = downloader.status.isActiveSubject;\n    this._observers[name] = _downloadState;\n  }\n\n  private _updateGlobalStatus(): void {\n\n    let _newState = false;\n\n    for (const key in this._states) {\n\n      const _statusSubject: BehaviorSubject<boolean> = this._states[key];\n\n      if (_statusSubject.getValue() === true) {\n        _newState = true;\n      }\n    }\n\n    if (this._isDownloading.getValue() !== _newState) {\n      this._isDownloading.next(_newState);\n    }\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {convertToIonicUrl} from '../_util/file';\nimport {cordovaEnabled, getCordova, getZip, hasZip} from '../_util/cordova';\nimport {BehaviorSubject, Observable} from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// TODO: needs better error handling? a retry dialog/function?\n// TODO: unzipping for chrome (desktop), just nice to have...\nexport class FilesystemService  {\n\n  public rootPath: string;\n  public root;\n  public rootDir;\n  public isStorageAvailable: boolean;\n\n  constructor() {}\n\n\n  // set root\n  public async initializeStorage() {\n\n    return await this._setupStorage();\n  }\n\n\n  private _setupStorage() {\n\n    const _self = this;\n    const _window: any = window;\n\n    return new Promise(function (resolve, reject) {\n\n      if (_self.root) {\n        resolve(true);\n        return;\n      }\n\n      if (cordovaEnabled()) {\n\n        // cordova file plugin storage\n\n        _window.resolveLocalFileSystemURL(getCordova().file.dataDirectory, function (filesystem) {\n\n          _self.root = filesystem;\n          _self.rootDir = filesystem;   // no root!\n          _self.rootPath = convertToIonicUrl(filesystem.toURL());\n          resolve(_self.isStorageAvailable = true);\n\n        }, function (error) {\n          reject(false);\n          alert('Filesystem error: ' + error);\n        });\n\n      } else {\n\n        // chrome (browser storage)\n        const _requestFileSystem = window['requestFileSystem'] || window['webkitRequestFileSystem'];\n\n        if (_requestFileSystem) {\n\n          // first prop: 0 = temp, 1 = persistent (errors)\n          _requestFileSystem(0, 0, function (fileSystem) {\n\n            console.log('filesystem set', fileSystem);\n\n            _self.root = fileSystem;\n            _self.rootDir = fileSystem.root;\n            _self.rootPath = fileSystem.root.toURL();\n\n            resolve(_self.isStorageAvailable = true);\n\n          }, function (error) {\n            resolve(false);\n            alert('Filesystem error: ' + error);\n          });\n        } else {\n          resolve(false);\n          alert('No filesystem available, use chrome or do a cordova build (iOS/Android)');\n        }\n      }\n    });\n  }\n\n\n\n  // DIRECTORY\n\n  // loops through directories within pathName and creates missing directories, callback gets DirectoryEntry of final subDir\n  public setupDirectory(pathName: string, within, callback: Function, createMissing:boolean = true): void {\n\n    const _self = this;\n    const _urlSegments: Array<string> = pathName.split('/');\n\n    const _loop = function (directorySegments: Array<string>, wi, cb: Function) {\n\n      _self._getDirectory(directorySegments[0], wi, createMissing, function(directory) {\n\n        directorySegments.shift();\n\n        if (directorySegments.length > 0) {\n          _loop(directorySegments, directory, cb);\n        } else {\n          cb(directory);\n        }\n      });\n    };\n\n    _loop(_urlSegments, within, callback);\n  }\n\n  // get an exisiting directory within another directory (or root), optional to create the dir if it doesn't exist\n  public _getDirectory(dirName: string, within, createMissing: boolean, callback: Function): void {\n\n    const _self = this;\n    within = (!within) ? this.rootDir : within;\n\n    if (within === 'error' || !within) {\n      callback(within);\n      return;\n    }\n\n    within.getDirectory(dirName, {create: false, exclusive: true}, function(directory) {\n\n      callback(directory);\n\n    }, function(error) {\n\n      if (error && createMissing) {\n        _self._createDirectory(dirName, within, callback);\n      } else {\n\n        console.log('directory ' + dirName + ' does not exist.');\n        callback('error');\n      }\n\n    });\n  }\n\n  // create a directory in a directory, if it already exists, it returns the existing directory\n  private _createDirectory(dirName: string, within, callback: Function): void {\n\n    const _self = this;\n    within = (!within) ? this.rootDir : within;\n\n    within.getDirectory(dirName, {create: true, exclusive: true}, function(directory) {\n\n      callback(directory);\n\n    }, function(error) {\n      if (error.code === 12) {\n        _self._getDirectory(dirName, within, false, callback);\n      }\n    });\n  }\n\n  // save a file to file system, parse directories\n  public saveFile(data: any, within: any, pathName: string, callback: Function): void {\n\n    const _self = this;\n    const pathSegments = pathName.split('/');\n    const filename = pathSegments[pathSegments.length - 1];\n    pathSegments.splice(-1, 1);\n    const _directories = pathSegments.join('/');\n\n    this.setupDirectory(_directories, within, function(directory) {\n      _self._createFile(directory, filename, function(fileEntry) {\n        _self._writeFile(fileEntry, data, callback);\n      });\n    });\n  }\n\n  // create an empty fileEntry\n  private _createFile(dirEntry, fileName: string, callback: Function, override: boolean = true) {\n\n    const _self = this;\n    dirEntry = (!dirEntry) ? this.rootDir : dirEntry;\n\n    if (dirEntry === 'error' || !dirEntry) {\n      callback(dirEntry);\n      return;\n    }\n\n    // Creates a new file or returns the file if it already exists.\n    dirEntry.getFile(fileName, {create: true, exclusive: !override}, function(fileEntry) {\n\n      callback(fileEntry);\n\n    }, function(error) {\n\n      console.log('error creating file ' + error);\n\n      _self.readFile(dirEntry, fileName, callback);\n\n    });\n  }\n\n  // // write to a fileEntry\n  private _writeFile(file, data: any, callback: Function) {\n\n    if (data instanceof Blob === false) {\n      if (typeof data !== 'string') {\n        data = JSON.stringify(data);\n      }\n      data = new Blob([data], {type : 'application/json'});\n    }\n\n    file.createWriter(function (fileWriter) {\n\n      fileWriter.onwriteend = function () {\n        callback('success');\n      };\n\n      fileWriter.onprogress = function (p) {\n        console.log('progress', p.toString());\n      };\n\n      fileWriter.onerror = function (e) {\n        callback('error');\n        console.log('Failed file write: ' + e);\n      };\n\n      fileWriter.write(data);\n    });\n  }\n\n  // TODO: abort write\n  public abort(): void {\n\n    console.warn('abort function (filesystem) is blank');\n    // writer.abort();\n  }\n\n  // returns the file entry (directry can be string or dirEntry object)\n  public readFile(directory, fileName: string, callback: Function): any {\n\n    const _self = this;\n\n    if (typeof directory === 'string') {\n      this.setupDirectory(directory, null, function (result) {\n\n        if (result !== 'error') {\n          _self._getFile(result, fileName, callback);\n        } else {\n          callback(result);\n        }\n      }, false);\n    }\n  }\n\n  // will return null if file cant be found\n  private _getFile(dirEntry, fileName: string, callback: Function): void {\n\n    const _self = this;\n\n    dirEntry = (!dirEntry) ? this.rootDir : dirEntry;\n\n    if (dirEntry === 'error' || !dirEntry) {\n      callback(dirEntry);\n      return;\n    }\n\n    // Creates a new file or returns the file if it already exists.\n    dirEntry.getFile(fileName, {create: false}, function(fileEntry) {\n\n      _self._readFileData(fileEntry, callback);\n\n    }, function(error) {\n\n      console.log('file ' + fileName + ' does not exist.');\n      callback('error');\n    });\n  }\n\n  // read the data from a fileEntry\n  private _readFileData(fileEntry, callback: Function): void {\n\n    fileEntry.file(function (file) {\n\n      var reader = new FileReader();\n\n      reader.onloadend = function() {\n        console.log(\"Successful file read\", fileEntry);\n\n        let _res = this.result;\n\n        if (typeof _res === 'string') {\n          _res = JSON.parse(_res);\n        }\n\n        callback(_res);\n      };\n\n      reader.readAsText(file);\n\n    }, function(error) {\n      callback('error');\n      alert('error reading file' + error);\n    });\n  }\n\n  public unzip(filePath: string, parts: boolean = false): Observable<object> {\n\n    const _self = this;\n\n    const _unzipState: BehaviorSubject<object> = new BehaviorSubject<object>({state:'initialize'});\n\n    if (hasZip()) {\n\n      let _seperator = (parts) ? '_' : '.';     // multipart files are _0, _1, _2, else just remove the extension\n\n      const _directoryArr: Array<string> = filePath.split(_seperator);\n      _directoryArr.pop();\n      const _directoryStr = _directoryArr.join(_seperator) + '/';\n\n      const url = this._joinPaths([getCordova().file.dataDirectory, filePath]);\n      const destination = this._joinPaths([getCordova().file.dataDirectory, _directoryStr]);\n\n      console.log(url, destination);\n\n      getZip().unzip(url, destination, function(x) {\n        _unzipState.next({state: 'progress', percentage: 100});\n\n        _self.deleteFile(filePath);\n\n        _unzipState.next({state: 'complete'});\n      }, function(progressEvent) {\n        _unzipState.next({state: 'progress', percentage: (progressEvent.loaded / progressEvent.total) * 100});\n      });\n    } else {\n\n      alert('Chrome unzipping currently not implemented.')\n\n      _unzipState.next({state: 'error'});\n    }\n\n    return _unzipState;\n  }\n\n  private _joinPaths(pathList: Array<string>) {\n    let path = '';\n    if (pathList.length > 0) {\n      path += pathList[0].replace(/\\/+$/, '') + '/';\n      for (let i = 1; i < pathList.length; i++) {\n        path += pathList[i].replace(/^\\/+/, '').replace(/\\/+$/, '') + '/';\n      }\n      path = path.slice(0, -1);\n    }\n    return path;\n  }\n\n  // // returns the data from file entry (used for stored json)\n  // public readFileData(): any {\n  //\n  // }\n\n  // delete a file or directory, accepts path\n  public deleteFile(filePath: string): void {\n\n    const _pathSegments = filePath.split('/');\n    const _filename: string = _pathSegments.pop();\n    const _directory = _pathSegments.join('/') + '/';\n\n    this.setupDirectory(_directory, null, function(dirEntry) {\n      dirEntry.getFile(_filename, {create: false}, function(fileEntry) {\n        fileEntry.remove(function (file) {\n          // File deleted successfully\n          console.log('file deleted');\n        }, function (err) {\n          console.log(err); // Error while removing File\n        });\n      });\n    }, false);\n  }\n\n  // delete directory and everything in it\n  public deleteDirectory(directoryPath: string, callback: Function): void {\n\n    this.setupDirectory(directoryPath, null, function(dirEntry) {\n      if (dirEntry !== 'error') {\n\n        /* poorly described cordova only? function, it's not clear if chrome still has this\n        as the status of the filesysem of chrome is unclear. */\n        dirEntry.removeRecursively(function (directory) {\n\n          callback(directory);\n        }, function (error) {\n          // TODO: needs an error check, not sure what I'm getting here\n          alert('error deleting directory' + error);\n          callback(error);\n        });\n\n      } else {\n\n        callback(dirEntry);\n      }\n    }, false);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// to communicate with the overlay loader component, which lives outside of the router\nexport class LoaderService {\n\n  constructor() {}\n\n  private _overlaySubject:  BehaviorSubject<object>     = new BehaviorSubject<object>({});\n  public observe:    Observable<object>  = this._overlaySubject.asObservable();\n\n  public showOverlay(): void {\n\n    this._overlaySubject.next({action: 'show', type: 'self'});\n  }\n\n  public hideOverlay(): void {\n\n    this._overlaySubject.next({action: 'hide', type: 'self'});\n  }\n\n  public showSpinner(): void {\n\n    this._overlaySubject.next({action: 'show', type: 'spinner'});\n  }\n\n  public showMessage(message: string): void {\n\n    this._overlaySubject.next({action: 'show', type: 'message', data: message});\n  }\n\n  public showButton(label: string, action: Function): void {\n\n    this._overlaySubject.next({action: 'show', type: 'button', data:{label: label, action: action}});\n  }\n\n  // spinner, button, message\n  public hideContent(type?: string): void {\n\n    if (!type) {\n      this.hideOverlay();\n    } else {\n      this._overlaySubject.next({action: 'hide', type: type});\n    }\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { LocalStorageService } from 'ngx-webstorage';\nimport { TrailGeneratorService } from './trail-generator.service';\nimport { Waypoint } from '../type/waypoint';\nimport { environment } from '../../environments/environment.prod';\nimport { cordovaEnabled } from '../_util/cordova';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n/* tracks user location, has a simulated mile (location) option\nalso pauses/resumes based on app state (pause/resume) to preserve battery */\nexport class LocationService {\n\n  static injector: Injector;\n\n  // behaviour subjects\n  private _locationStatus:  BehaviorSubject<string>     = new BehaviorSubject<string>('idle');\n  private _location:        BehaviorSubject<object>     = new BehaviorSubject<object>(undefined);\n  private _centerUser:      BehaviorSubject<number>     = new BehaviorSubject<number>(0);\n\n  // Observable streams\n  public locationStatus:    Observable<string>  = this._locationStatus.asObservable();\n  public location:          Observable<object>  = this._location.asObservable();\n  public centerUser:        Observable<number>  = this._centerUser.asObservable();\n\n  // watcher\n  private _locationWatcher:         any;        // web uses number?\n  private _previousLocation:        object;\n  private _paused:                  boolean;\n\n  private _toggleStatus             = false;\n  private _locationStatusLocal      = '';\n\n  /* track user location and status:\n      location = gps data > converted to Poi\n      holds a mile tree (centerpoints per mile, for nearest trail location)\n      status = idle/fetching/tracking/stopping */\n\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _trailGenerator: TrailGeneratorService\n  ) {\n    this._updateStatusLabel('idle');\n\n    if (cordovaEnabled()) {\n      document.addEventListener(\"pause\", this._onPause, false);\n      document.addEventListener(\"resume\", this._onResume, false);\n    }\n  }\n\n  // enable / disable location tracking\n  public toggleTracking(force: boolean = false): void {\n\n    const _simulate: boolean = (this._localStorage.retrieve('simulatedMile') !== -1);\n\n    this._toggleStatus = (!force) ? !this._toggleStatus : force;\n\n    if (this._toggleStatus) {\n\n      this._updateStatusLabel('fetching');\n\n      if (_simulate) {\n        this._stopTracking(true);\n        this._simulateLocation();\n      } else {\n        this._trackLocation();\n      }\n\n    } else {\n      this._updateStatusLabel('stopping');\n      this._stopTracking();\n    }\n  }\n\n  // simulate location\n  private _simulateLocation(): void {\n    this._parseLocation(this._localStorage.retrieve('simulatedMile'));\n  }\n\n  private _trackLocation(): void {\n\n    const _watchOptions = {\n      enableHighAccuracy: true,\n      maximumAge: 3000,\n      requireAltitude: true\n    };\n\n    if (navigator.geolocation) {\n\n      this._locationWatcher  = navigator.geolocation.watchPosition(\n        this._parseLocation.bind(this),\n        this._showTrackingErrors.bind(this),\n        _watchOptions);\n    } else {\n      this._showTrackingErrors(null);\n    }\n  }\n\n  private _stopTracking(simulate: boolean = false): void {\n\n    if (navigator.geolocation) {\n      navigator.geolocation.clearWatch(this._locationWatcher)\n\n      this._centerUser.next(0);\n\n      if (!simulate) {\n        this._location.next(undefined);\n        this._localStorage.store('simulatedMile', -1);\n        this._previousLocation = null;\n        this._updateStatusLabel('idle');\n      }\n    }\n  }\n\n  private _parseLocation(location: any): void {\n\n    if (typeof location === 'number') {\n\n      const _waypoints: Array<Waypoint> = this._trailGenerator.getTrailData().miles[Math.floor(location)].waypoints;\n\n      let _nearestPoint: Waypoint = _waypoints[1];\n\n      const _mileInMeters: number = location * environment.MILE;\n\n      if (_mileInMeters >= _waypoints[_waypoints.length - 1].distanceTotal) {\n        // this only applies to the last (incomplete) mile, if your total simulated distance is greater than the trail length, use last waypoint\n        _nearestPoint = _waypoints[_waypoints.length - 1];\n      } else {\n        // find nearest 2 waypoints, find out which is closest\n        for (var i = 0; i < _waypoints.length - 1; i++) {\n          if (_waypoints[i].distanceTotal <= _mileInMeters && _waypoints[i + 1].distanceTotal >= _mileInMeters) {\n            _nearestPoint = (Math.abs(_waypoints[i].distanceTotal - _mileInMeters) < Math.abs(_waypoints[i + 1].distanceTotal - _mileInMeters)) ? _waypoints[i] : _waypoints[i + 1];\n            break;\n          }\n        }\n      }\n\n      location = {\n        coords: {\n          latitude: _nearestPoint.latitude,\n          longitude: _nearestPoint.longitude,\n          altitude: _nearestPoint.elevation,\n        },\n        timestamp: new Date().getTime()\n      };\n\n      this._updateLocation(location, true);\n\n    } else if (location){\n\n      // only execute if location changed (optimisation)\n      if (!this._previousLocation ||\n        this._previousLocation['coords']['latitude'] !== location['coords']['latitude'] &&\n        this._previousLocation['coords']['longitude'] !== location['coords']['longitude'] &&\n        this._previousLocation['coords']['altitude'] !== location['coords']['altitude']) {\n\n        this._updateLocation(location);\n      }\n\n      this._previousLocation = location;\n    }\n  }\n\n  private _updateLocation(location: object, simulate: boolean = false): void {\n    this._location.next(location);\n    this._updateStatusLabel('tracking');\n  }\n\n  private _showTrackingErrors(error): void {\n\n    let _errorMessage;\n\n    switch (error.code) {\n      case error.PERMISSION_DENIED:\n        _errorMessage = 'User denied request.';\n        break;\n      case error.POSITION_UNAVAILABLE:\n        _errorMessage = 'Location unavailable.';\n        break;\n      case error.TIMEOUT:\n        _errorMessage = 'Location timeout.';\n        break;\n      case error.UNKNOWN_ERROR:\n        _errorMessage = 'Unknown error.';\n        break;\n    }\n\n    this._updateStatusLabel('error');\n  }\n\n  private _updateStatusLabel(label: string): void {\n    // prevent duplicates\n    if (label !== this._locationStatusLocal) {\n      this._locationStatusLocal = label;\n      this._locationStatus.next(this._locationStatusLocal);\n    }\n  }\n\n  public onCenterUser(): void {\n    if (this._locationStatus.value === 'tracking') {\n      this._centerUser.next(new Date().getTime());\n    }\n  }\n\n\n  // APPLICATION STATE (BACKGROUND/FOREGROUND)\n\n  private _onPause(event): void {\n    if (this._toggleStatus === true && !this._paused) {\n      this._stopTracking();\n      this._paused = true;\n    }\n  }\n\n  private _onResume(event): void {\n    if (this._toggleStatus === false && this._paused) {\n      this.toggleTracking(true);\n      this._paused = false;\n    }\n  }\n}\n","import {Injectable, OnDestroy} from '@angular/core';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {TrailGeneratorService} from './trail-generator.service';\nimport {BehaviorSubject, Observable, Subscription} from 'rxjs';\nimport {share} from 'rxjs/operators';\nimport {Trail} from '../type/trail';\nimport {cloneData} from '../_util/generic';\nimport {HttpClient} from '@angular/common/http';\nimport {ConnectionService} from './connection.service';\nimport {environment} from '../../environments/environment.prod';\nimport {Note} from '../type/note';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n/* there are 2 types of notes:\n- notes that belong to a mile (TODO: not implemented yet)\n- notes that belong to a poi\n\nstructure of notes library object:\n\nnotes.mile\n            1: [Poi, Poi]\n            13: [Poi, Poi, Poi]\n            87: [Poi]\n\nnotes.poi\n            5: [Poi, Poi]\n            68: [Poi, Poi, Poi]\n            123: [Poi]\n*/\n\n// keeps track of new notes that should be uploaded (shared with developer)\nexport class NoteService implements OnDestroy {\n\n  public noteUpdateObserver: Observable<string>;\n  public noteSubject: BehaviorSubject<string>;\n\n  private _notesSubscription: Subscription;\n  private _connectionSubscription: Subscription;\n\n  private _notesLibrary: object;\n  private _notes: Array<Note>;\n  private _lastNote: Note;         // this is the last note an operation was performed on (will also hold the last deleted note)\n  private _uploadObserver: Observable<string>;\n  private _uploadSubscription: Subscription;\n  private _previouslyOffline = false;\n\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _trailGenerator: TrailGeneratorService,\n    private _http: HttpClient,\n    private _connectionService: ConnectionService)\n  {\n    this.noteSubject = new BehaviorSubject('initialize');\n    this.noteUpdateObserver = this.noteSubject.asObservable().pipe(share());\n\n    this._setupSubscriptions();\n    this._loadFromStorage();\n  }\n\n  ngOnDestroy(): void {\n\n    if (this._notesSubscription) {\n      this._notesSubscription.unsubscribe();\n      this._notesSubscription = null;\n    }\n\n    if (this._connectionSubscription) {\n      this._connectionSubscription.unsubscribe();\n      this._connectionSubscription = null;\n    }\n\n    // just to be safe\n    this.noteSubject = null;\n    this.noteUpdateObserver = null;\n  }\n\n  private _setupSubscriptions(): void {\n\n    const _self = this;\n\n    const _trail: Trail = this._trailGenerator.getTrailData();\n    const _directionString: string = (_trail.direction === 1) ? 'sobo' : 'nobo';\n\n    this._notesSubscription = this._localStorage.observe( _trail.abbr + '-' + _directionString + '_notes').subscribe(function(result) {\n      _self.noteSubject.next('storage changed');\n      _self._shareNotes();\n    });\n\n    this._connectionSubscription = this._connectionService.connectionObserver.subscribe(function(result: boolean) {\n      if (result === true) {\n        _self._shareNotes();\n      }\n    });\n  }\n\n  // notes are added 1 at a time, unless there are no notes (initial run)\n  private _parseNotes(notes: Array<Note>): void {\n\n    if (!notes || notes.length < 1) {\n      return;\n    }\n\n    const _lastAddedNote = notes[notes.length - 1];\n\n    if (!this._notesLibrary) {\n\n      this._notesLibrary = {};\n\n      // sort all notes by belongsTo (mile)\n      this._addNotesToLib(notes);\n\n    } else {\n\n      // only the last added\n      this._addNotesToLib([_lastAddedNote]);\n    }\n  }\n\n  private _addNotesToLib(notes: Array<Note>): void {\n\n    const _length = notes.length;\n    for (let i = 0; i < _length; i++) {\n\n      const _note: Note = notes[i];\n      const _typeLib: object = this._notesLibrary[_note.belongsToType];\n\n      if (_typeLib) {\n        if (_typeLib[_note.belongsTo]) {\n          this._notesLibrary[_note.belongsToType][_note.belongsTo].push(_note);\n        } else {\n          this._notesLibrary[_note.belongsToType][_note.belongsTo] = [_note];\n        }\n      } else {\n        this._notesLibrary[_note.belongsToType] = {};\n        this._notesLibrary[_note.belongsToType][_note.belongsTo] = [_note];\n      }\n\n      // set the last added note\n      if (i === _length - 1) {\n        this._lastNote = _note;\n        this.noteSubject.next('added');\n      }\n    }\n  }\n\n  // get notes based on a given type and id (of that type)\n  public getNotes(type: string, id: number): Array<Note> {\n\n    if (!this._notesLibrary) {\n      return;\n    }\n\n    return this._notesLibrary[type][id];\n  }\n\n  // get the Poi that was last added to the library\n  public getLastNote(): Note {\n    return this._lastNote;\n  }\n\n  // TODO: double loop, a fetch of new data might be faster with lots of notes?\n  public deleteNote(noteId: number, type: string, id: number): void {\n\n    const _group: Array<Note> = this._notesLibrary[type][id];\n    let _length = _group.length;\n    for (let i = 0; i < _length; i++) {\n\n      const _note: Note = _group[i];\n\n      if (_note.id === noteId) {\n\n        this._lastNote = cloneData(_note) as Note;\n\n        this._notesLibrary[type][id].splice(i, 1);\n        break;\n      }\n    }\n\n    _length = this._notes.length;\n    for (let j = 0; j < _length; j++) {\n\n      const _note: Note = this._notes[j];\n\n      if (_note.id === noteId) {\n        this._notes.splice(j, 1);\n        break;\n      }\n    }\n\n    this._updateStorage();\n    this.noteSubject.next('removed');\n  }\n\n  private _updateStorage(): void {\n    const _trail: Trail = this._trailGenerator.getTrailData();\n    const _directionString: string = (_trail.direction === 1) ? 'sobo' : 'nobo';\n    this._localStorage.store( _trail.abbr + '-' + _directionString + '_notes', JSON.stringify(this._notes));\n  }\n\n  private _loadFromStorage(): void {\n\n    const _trail: Trail = this._trailGenerator.getTrailData();\n    const _directionString: string = (_trail.direction === 1) ? 'sobo' : 'nobo';\n    const _notesString = this._localStorage.retrieve( _trail.abbr + '-' + _directionString + '_notes');\n\n    if (_notesString === null || _notesString === undefined || _notesString === '') {\n      return;\n    }\n\n    this._notes = JSON.parse(_notesString);\n\n    this._parseNotes(this._notes);\n  }\n\n  public saveNote(note: Note): void {\n\n    if (!this._notes) {\n      this._notes = [];\n    }\n\n    this._notes.push(note);\n\n    this._parseNotes([note]);\n\n    if (note.share) {\n      this._localStorage.store('shareNotes', true);\n    }\n\n    this._updateStorage();\n  }\n\n  // easier to sort by distance (poi list)\n  public getFlatNotesArray(): Array<Note> {\n    return this._notes;\n  }\n\n  /* share notes (upload notes to server), runs when internet becomes available\n  - TODO: currently used to share notes with developer, will eventually be shared to a personal online map */\n  private _shareNotes(): void {\n\n    const _self = this;\n\n    // check connection\n    if (this._connectionService.state !== 'online') {\n      this._previouslyOffline = true;\n      return;\n    }\n\n    if (this._localStorage.retrieve('shareNotes') && this._notes) {\n\n      const _shareableNotes: Array<Note> = this._gatherShareableNotes();\n\n      // upload\n      if (_shareableNotes.length > 0) {\n\n        const _trail: Trail = _self._trailGenerator.getTrailData();\n        const _directionString: string = (_trail.direction === 1) ? 'sobo' : 'nobo';\n\n        // params to send in post object\n        const _params = new FormData();\n        _params.append('trail', _trail.abbr);\n        _params.append('direction', _directionString);\n        _params.append('user', _self._localStorage.retrieve('userName'));\n        _params.append('data', JSON.stringify(_shareableNotes));\n\n        this._uploadObserver = this._http.post(environment.mailto, _params, {responseType: 'text'});\n        this._uploadSubscription = this._uploadObserver.subscribe(function(result: string) {\n\n          if (result === 'success') {\n\n            // only show an alert if data didn't send before because user was online\n            if (_self._previouslyOffline) {\n              _self._previouslyOffline = false;\n              alert('Successfully shared backed-up note(s) with developer, thanks!');\n            }\n\n            _self._clearShareableNotes();\n          } else {\n            alert('Error while sending note(s) to developer!');\n          }\n\n          _self._uploadSubscription.unsubscribe();\n          _self._uploadSubscription = null;\n        }, function(error) {\n\n          // error handling\n          alert('Error while sending note(s) to developer!');\n        });\n      }\n    }\n  }\n\n  private _clearShareableNotes(): void {\n\n    this._notes.forEach(function(note: Note) {\n      if (note.share) {\n        note.share = false;\n      }\n    });\n\n    // write to storage\n    this._updateStorage();\n\n    this._localStorage.clear('shareNotes');\n  }\n\n  private _gatherShareableNotes(): Array<Note> {\n\n    const _shareableNotes: Array<Note> = [];\n\n    // run through all data and collect notes that need sharing (duplicates)\n    this._notes.forEach(function(note: Note) {\n\n      if (note.share) {\n\n        const _clone: Note = cloneData(note) as Note;\n        _shareableNotes.push(_clone);\n      }\n    });\n\n    return _shareableNotes as Array<Note>;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport {BehaviorSubject, Observable} from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n/* Orientation being compass orientation, not device, web standard doesn't work on android, cordova plugin does */\n// TODO: research a better compass direction solution, as none seem to be compatible with the various devices (mainly android issues)\nexport class OrientationService {\n\n  public orientationObserver: Observable<number>;\n\n  private _orientation: BehaviorSubject<number> = new BehaviorSubject(null);\n  private _orientationListener;\n\n  constructor() {\n    this.orientationObserver = this._orientation.asObservable();\n  }\n\n  public startTracking(): void {\n    // if (navigator['compass']) {\n    //   this._orientationListener = navigator['compass'].watchHeading(this._handleOrientation.bind(this), function (e) {\n    //     console.log('ERROR', e);\n    //   });\n    // }\n  }\n\n  public stopTracking(): void {\n    // if (navigator['compass']) {\n    //   navigator['compass'].clearWatch(this._orientationListener);\n    //   this._orientation.next(null);\n    // }\n  }\n\n  private _handleOrientation(event): void {\n    this._orientation.next(event.trueHeading);\n  }\n\n}\n","import {Injectable, OnDestroy} from '@angular/core';\nimport {Waypoint} from '../type/waypoint';\nimport {Rating, Score} from '../type/rating';\nimport {concat, Observable, of, Subscription} from 'rxjs';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {TrailGeneratorService} from './trail-generator.service';\nimport {HttpClient} from '@angular/common/http';\nimport {getUUID} from '../_util/cordova';\nimport {cloneData, isObjectEmpty} from '../_util/generic';\nimport {ConnectionService} from './connection.service';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n\n// Ratings are combined Scores, a water-source (rateable) can be rated on multiple aspects (providing Scores)\nexport class RateService implements OnDestroy {\n\n  private _lastUpdated = 0;\n  private _hasInternet = false;\n\n  private _localScores: Array<Score>;         // all scores (aspects of rating)\n  private _localRatings: Array<Rating> = [];  // all ratings for the current trail\n\n  private _activeTrailAbbr: string;\n\n  private _connectionSubscription: Subscription;\n\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _trailGenerator: TrailGeneratorService,\n    private _connectionService: ConnectionService,\n    private _http: HttpClient) {\n  }\n\n  // LIFECYCLE\n\n  ngOnDestroy(): void {\n    this._connectionSubscription.unsubscribe();\n    this._connectionSubscription = null;\n  }\n\n  // requires active trail meta data (runs after loading/parsing trail\n  // - 1. upload all data that needs uploading (offline mode etc.)\n  // - 2. download all new data since last update\n  // (TODO: this needs to be limited to the last 10 scores per belongsTo, firebase cloud functions...)\n  public setup(): void {\n\n    const _self = this;\n\n    this._activeTrailAbbr = this._trailGenerator.getTrailData().abbr;\n    this._lastUpdated = this._localStorage.retrieve(this._activeTrailAbbr + '_scores-lastUpdated') || 0;\n\n    this._connectionSubscription = this._connectionService.connectionObserver.subscribe(function(result) {\n\n      // internet just became available\n      if (result !== _self._hasInternet && result === true) {\n        _self._hasInternet = result;\n        _self._syncData();\n      } else {\n        _self._hasInternet = result;\n      }\n\n    });\n  }\n\n  private _syncData(): void {\n\n    const _self = this;\n    let runCount = 0;\n\n    const _scoreUpdateObservables = this.sendAllScores();\n    let _scoreUpdateLength = 1;\n    if (Array.isArray(_scoreUpdateObservables)) {\n      _scoreUpdateLength = _scoreUpdateObservables['length'];\n    }\n\n    // run in sequence\n    let _updateSubscription = concat(\n      _scoreUpdateObservables,\n      this._getRatingsOnline()\n    ).subscribe(function(result) {\n\n      if (runCount === _scoreUpdateLength) {\n\n        // if new scores have been downloaded, parse them\n        if (result && !isObjectEmpty(result)) {\n\n          const resultArray: Array<Score> = Object.keys(result).map(function(key) {\n\n            if (!result[key].dbId && result[key].userId) {\n              result[key].dbId = key;     // set the firebase id so we can PUT instead of POST to update a users comment\n            }\n\n            return result[key];\n          });\n\n          _self._localScores = _self._localScores.concat(resultArray);\n          _self._writeToLocalStorage();\n        }\n\n        // done getting updates / save timestamp & self destruct\n        _self._lastUpdated = new Date().getTime();\n        _self._localStorage.store(_self._activeTrailAbbr + '_scores-lastUpdated', _self._lastUpdated);\n        _updateSubscription.unsubscribe();\n        _updateSubscription = null;\n      } else {\n        runCount ++;\n      }\n    });\n  }\n\n\n  // gets/sets all ratings, since it's a (mostly) offline app, deals with both online/offline files and syncs everything\n  public sendAllScores(): Array<Observable<Object>> | Observable<Object> {\n\n    // get locally stored data\n    this._localScores = this._localStorage.retrieve(this._activeTrailAbbr + '_scores') || [];\n\n    if (this._hasInternet && this._localScores.length !== -1) {\n\n      const _localUpdates = this._checkForUnsynced();\n\n      if (_localUpdates) {\n\n        const _postArray: Array<Observable<Object>> = [];\n\n        const _url: string = 'https://just-hike.firebaseio.com/' + this._activeTrailAbbr + '/score.json';\n        const _length = _localUpdates.length;\n\n        for (let i = 0; i < _length; i++) {\n          const _updateObservable: Observable<object> = this._http.post(_url, _localUpdates[i]);\n          _updateObservable.subscribe(function(result) {\n            _localUpdates[i].unsynced = null;\n          });\n\n          _postArray.push(_updateObservable);\n        }\n\n        return _postArray;\n\n      } else {\n\n        return of(null);\n      }\n\n    } else {\n\n      return of(null);\n    }\n  }\n\n  // whenever a user rates something\n  public saveRatings(scores: Score | Array<Score>): void {\n\n    if (this._hasInternet) {\n      const _scoreObservers: Array<Observable<object>> = [];\n\n      if (!Array.isArray(scores)) {\n        scores = [scores];\n      }\n\n      const _length = scores.length;\n\n      for (let i = 0; i < _length; i++) {\n        _scoreObservers.push(this._saveScoreOnline(scores[i]));\n      }\n\n      let count = 0;\n      concat(_scoreObservers).subscribe((result) => {\n\n        count++;\n        if (count === _scoreObservers.length) {\n          this._writeToLocalStorage();\n        }\n      })\n    } else {\n      this._writeToLocalStorage();\n    }\n  }\n\n\n  // creates a Rating object, which houses aspects (Scores) that are locally/externally saved.\n  // there's no need to make a separate online call here\n  // as the app mostly runs in offline mode and syncRatingsForTrail() is called once the app goes online\n  // this way the ratings stay reasonably up to date.\n  public getRatingById(type: string, location: Waypoint, create: boolean = true): Rating {\n\n    const _id = type + '_' + Number(location.latitude).toFixed(4) + '_' + Number(location.longitude).toFixed(4);\n\n    let _rating: Rating;\n\n    const _length = this._localRatings.length;\n    for (let i = 0; i < _length; i++) {\n      if (this._localRatings[i].id === _id) {\n        _rating = this._localRatings[i];\n        _rating.setupObserver();    // important as they're being destroyed\n        break;\n      }\n    }\n\n    if (!_rating && create) {\n      this._getScoresForRating(type, location);\n      _rating = new Rating(type, location, this._getScoresForRating(type, location));\n      this._localRatings.push(_rating);\n    }\n\n    return _rating;\n  }\n\n  private _getScoresForRating(type: string, location: Waypoint): Array<Score> {\n\n    const id = type + '_' + Number(location.latitude).toFixed(4) + '_' + Number(location.longitude).toFixed(4);\n\n    let _ratingScoresArray: Array<Score>;\n\n    const _length = this._localScores.length;\n    for (let i = 0; i < _length; i++) {\n\n      const _score: Score = this._localScores[i];\n      if (_score.belongsTo === id) {\n\n        if (!_ratingScoresArray) {\n          _ratingScoresArray = [];\n        }\n        _ratingScoresArray.push(_score);\n      }\n    }\n\n    return _ratingScoresArray;\n  }\n\n  // get all updated/new ratings online for trail\n  // this will fetch 'Score' objects that have a 'belongTo' field with a waypointId\n  private _getRatingsOnline(): Observable<Object> {\n\n    let _since = this._lastUpdated || 0;\n    const _trailAbbr = this._activeTrailAbbr;\n\n    const _url: string = 'https://just-hike.firebaseio.com/' + _trailAbbr + '/score.json' +\n      '?orderBy=\"timestamp\"' +\n      '&startAt=' + _since + '';\n\n    return this._http.get(_url);\n  }\n\n  /* cleans up scores:\n  - filter out duplicates based on timestamp/id\n  - maximum of 10 scores per Rating */\n  private _scoresAsRating(): void {\n\n    const _filteredScores: Array<Score> = [];\n\n    const _length = this._localScores.length;\n    for (let i = 0; i < _length; i++) {\n\n    }\n  }\n\n  // check if there are local Scores that need to be synced online (marked unsynced)\n  private _checkForUnsynced(): Array<Score> {\n\n    if (!this._localScores || this._localScores.length === -1) {\n      return;\n    }\n\n    const _scores = [];\n    const _length = this._localScores.length;\n    for (let i = 0; i < _length; i++) {\n      if (this._localScores[i].unsynced) {\n        _scores.push(this._localScores[i]);\n      }\n    }\n\n    return (_scores.length > 0) ? _scores : undefined;\n  }\n\n\n  private _saveScoreOnline(score: Score): Observable<object> {\n\n    const _self = this;\n    let _duplicate: Score = cloneData(score) as Score;\n    _duplicate.unsynced = null;\n\n    const _trailAbbr: string = this._trailGenerator.getTrailData().abbr;\n    const _url: string = 'https://just-hike.firebaseio.com/' + _trailAbbr + '/score';\n    const _urlEnd: string = '.json';\n\n    let _scoreQuery: Observable<object>;\n\n    if (_duplicate.dbId && _duplicate.score > 0) {\n\n      // we're updating\n      _scoreQuery = this._http.put(_url + '/' + _duplicate.dbId + _urlEnd, _duplicate);\n    } else if (_duplicate.dbId) {\n\n      // deleting 0 score\n      _scoreQuery = this._http.delete(_url + '/' + _duplicate.dbId + _urlEnd);\n    } else {\n\n      // posting new\n      _scoreQuery = this._http.post(_url + _urlEnd, _duplicate);\n    }\n\n    let _sub = _scoreQuery.subscribe(\n      function(result) {\n\n        score.unsynced = false;\n\n        if (!score.dbId) {\n          score.dbId = result['name'];\n        }\n\n        if (result === null) {\n          _self._localScores.splice(_self._localScores.indexOf(score), 1);\n          score = null;\n        }\n\n        _sub.unsubscribe();\n        _sub = null;\n      }\n    );\n\n    _duplicate = null;\n    return _scoreQuery;\n  }\n\n  private _writeToLocalStorage(): void {\n    this._localStorage.store(this._activeTrailAbbr + '_scores', this._localScores);\n  }\n}\n","import {Injectable, OnDestroy} from '@angular/core';\nimport {BehaviorSubject, Observable, Subscription} from 'rxjs';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {share} from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// class that injects stylesheets based on (user) screen settings\nexport class ScreenModeService implements OnDestroy {\n\n  private _screenModeSubscription: Subscription;\n\n  private _currentScreenMode: Array<string>;\n  public screenModeChangeObserver: Observable<any>;     // when screen mode changes\n  public screenModeSubject: BehaviorSubject<string>;\n\n  constructor(private _localStorage: LocalStorageService) {\n\n    const _self = this;\n\n    // listen for greyscale mode\n    _self._screenModeSubscription = _self._localStorage.observe('screenMode').subscribe(function(result) {\n\n      _self.screenModeSubject.next(result);\n\n      _self._toggleStyleSheet(result);\n\n    });\n\n    const _initial = this._localStorage.retrieve('screenMode');\n\n    _self.screenModeSubject = new BehaviorSubject(_initial);\n    _self._toggleStyleSheet(_initial);\n    this.screenModeChangeObserver = this.screenModeSubject.asObservable().pipe(share());\n  }\n\n  private _toggleStyleSheet(name: string): void {\n\n    const _self = this;\n\n    const _names: Array<string> =  (name !== 'nightHike') ? [name] : ['highContrast', name];\n\n    _names.forEach(function(n) {\n      _self._injectStylesheet(n);\n    });\n\n    if (this._currentScreenMode) {\n      this._currentScreenMode.forEach(function (n) {\n        _self._removeInjectedStylesheet(n);\n      });\n    }\n\n    this._currentScreenMode = _names;\n  }\n\n  // inject a stylesheet into the head of the\n  private _injectStylesheet(name: string): void {\n\n    if (name === 'default' || !name) {\n      return;\n    }\n\n    const _head = document.head;\n    const _link = document.createElement('link');\n\n    _link.type = 'text/css';\n    _link.rel = 'stylesheet';\n    _link.href = 'assets/css/' + name + '.css';\n    _link.setAttribute('data-name', name);\n\n    _head.appendChild(_link);\n  }\n\n  private _removeInjectedStylesheet(name: string): void {\n\n    if (name === 'default') {\n      return;\n    }\n\n    const _link = document.querySelectorAll('[data-name=\"' + name + '\"]')[0];\n    if (_link) {\n      _link.parentNode.removeChild(_link);\n    }\n  }\n\n  ngOnDestroy(): void {\n\n    this._screenModeSubscription.unsubscribe();\n    this._screenModeSubscription = null;\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {VersionResolverService} from './version-resolver.service';\nimport {TrailResolverService} from './trail-resolver.service';\nimport {ActivatedRouteSnapshot, Resolve, RouterStateSnapshot} from '@angular/router';\nimport {FilesystemService} from './filesystem.service';\nimport {environment} from '../../environments/environment.prod';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {getMajorPoiTypes} from '../_util/poi';\nimport {getCordova, setConnection, setCordova, setDevice, setDialogs, setScreen, setZip} from '../_util/cordova';\n\n// cordova plugins\ndeclare let cordova: any;\ndeclare let screen: any;\ndeclare let zip: any;\ndeclare let Connection: any;\ndeclare let device: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SequentialResolverService implements Resolve<any> {\n\n  private _route: ActivatedRouteSnapshot;\n  private _state: RouterStateSnapshot;\n\n  constructor(\n    private _versionResolver: VersionResolverService,\n    private _trailResolver: TrailResolverService,\n    private _fileSystemService: FilesystemService,\n    private _localStorage: LocalStorageService,\n  ) {}\n\n  // first setup the filesystem\n  async resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Promise<object> {\n\n    const _self = this;\n    this._route = route;\n    this._state = state;\n\n    this.firstRun();\n\n    // cordova enabled or not\n    if (navigator.userAgent.match(/(iPhone|iPod|iPad|Android)/)) {\n\n      return new Promise(function(resolve, reject) {\n        document.addEventListener('deviceready', function(event) {\n          resolve(_self._sequencer(event));\n        });\n      });\n\n    } else {\n\n      return this._sequencer();\n    }\n  }\n\n\n  // set default user settings (unless they already exist)\n  // good place to force user settings during development/debugging\n  public firstRun() {\n\n    const _self = this;\n\n    // always clear simulatedMile\n    this._localStorage.store('simulatedMile', -1);\n\n    const _firstRun = this._localStorage.retrieve('firstRun');\n\n    if (_firstRun !== false) {\n\n      this._localStorage.store('firstRun', true);\n\n      // by default show all major pois\n      const _majorPoiTypes: Array<string> = getMajorPoiTypes();\n\n      // dynamic subscriptions based on PoiTypes that are set as being major (important)\n      _majorPoiTypes.forEach(function(type: string) {\n        const _camelName =  'show' +  type.charAt(0).toUpperCase() + type.slice(1);\n        _self._localStorage.store(_camelName, true);\n      });\n\n      // set default user settings\n      for (const key in environment.DEFAULT_USER_SETTINGS) {\n\n        const _value = environment.DEFAULT_USER_SETTINGS[key];\n\n        if (this._localStorage.retrieve(key) === null) {\n          this._localStorage.store(key, _value);\n        }\n      }\n    }\n  }\n\n  // app needs version data before it can start resolving trail data, so we await, before returning a promise to the router\n  // sets cordova helper functions\n  private _sequencer(event?: Event): Promise<any> {\n\n    if (event) {\n      // console.log('device');\n\n      // setup cordova helpers\n      if (cordova && !getCordova()) {\n        setCordova(cordova);\n        setDevice(device);\n        setScreen(screen);\n        setConnection(Connection);\n        setZip(zip);\n        setDialogs(navigator['notification']);\n      }\n    } else {\n      // console.log('browser');\n    }\n\n    const _self = this;\n\n    return this._fileSystemService.initializeStorage().then(async function(result) {\n      await _self._versionResolver.resolve().toPromise();\n      return _self._trailResolver.resolve(_self._route, _self._state).toPromise();\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Snow, Snowpoint } from '../type/snow';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class SnowGeneratorService {\n\n  private _snowData: Snow;\n\n  constructor() { }\n\n  public setSnowData(data: Snow): void {\n    this._snowData = data;\n  }\n\n  public getSnowForMile(mileId: number | Array<number>): Array<Array<Snowpoint>> {\n\n    if (! this._snowData) {\n      return;\n    }\n\n    if (typeof mileId === 'number') {\n      mileId = [mileId];\n    }\n\n    const _partialData: Array<Array<Snowpoint>> = [];\n\n    const _self = this;\n\n    mileId.forEach(function(id) {\n      _partialData.push(_self._snowData.snowMiles[id]);\n    });\n\n    return (_partialData.length > 0) ? _partialData : undefined;\n  }\n\n  // get the snow data version for the current trail\n  public getSnowVersion(): string {\n    return this._snowData.version;\n  }\n}\n","import {Injectable} from '@angular/core';\nimport * as geolib from 'geolib';\nimport {OHLC} from '../type/ohlc';\nimport {Waypoint} from '../type/waypoint';\nimport {Mile} from '../type/mile';\nimport {Poi} from '../type/poi';\nimport {Trail, TrailMeta} from '../type/trail';\nimport {environment} from '../../environments/environment.prod';\nimport {LoaderService} from './loader.service';\nimport {getPoiTypeByType} from '../_util/poi';\nimport {cloneData, sortByKey} from '../_util/generic';\nimport {calculateDistance, Distance} from '../_util/geolib/distance';\nimport {pointArrayTypeConversion, waypointToWaypoint} from '../_util/leaflet/converter';\nimport {getClosestPointOnLine} from '../_util/math';\nimport PositionAsDecimal = geolib.PositionAsDecimal;\nimport {Town} from '../type/town';\nimport {calculateOHLC} from '../_util/trail';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n// TODO: generating multiple trails causes enourmous slowdown in poiToMiles, I'm assuming I'm not clearing something...\nexport class TrailGeneratorService {\n\n  public flatTrailData: Array<Waypoint>;              // the loaded raw waypoints\n  private _trailData: Trail;\n\n  private _mileCenterpointTree: Array<Array<Waypoint>>;\n\n  constructor(\n    private _loaderService: LoaderService,\n  ) {}\n\n\n  public setTrailData(data: Trail) {\n    this._trailData = data;\n  }\n\n  public getTrailData(): Trail {\n    return this._trailData;\n  }\n\n  public getTrailVersion(): string {\n    return this._trailData.version;\n  }\n\n  public getPoiById(id: number): Poi {\n    return this._trailData.pois[id];\n  }\n\n  public calcDistanceFlat(p1: any, p2: any): number {\n    return geolib.getDistance(\n      {latitude: p1.latitude, longitude: p1.longitude} as geolib.PositionAsDecimal,\n      {latitude: p2.latitude, longitude: p2.longitude} as geolib.PositionAsDecimal\n      , 0, 4);\n  }\n\n  public getPoisByIds(ids: Array<number>): Array<Poi> {\n\n    const _self = this;\n    const _result: Array<Poi> = [];\n\n    ids.forEach(function(id) {\n      _result.push(_self.getPoiById(id));\n    });\n\n    return _result;\n  }\n\n  // called to generate new trail data files (json), only used by admin, not for users)\n  // TODO: move this to a webworker, not a priority as it's rarely used (trail data won't update often)\n  public generateMiles(trail: TrailMeta, waypoints: Array<Waypoint>, pois: Array<Poi>, direction: number, towns?: Array<Town>): Trail {\n\n    this._trailData = cloneData(trail) as Trail;\n    this._trailData.version = trail.trailVersion;\n\n    // remove unneeded trail meta\n    delete this._trailData['trailVersion'];\n    delete this._trailData['tilesVersion'];\n    delete this._trailData['snowVersion'];\n    delete this._trailData['dataPath'];\n    delete this._trailData['dataPath'];\n    delete this._trailData['waypointsPerMile'];\n\n    this._trailData.direction = direction;\n\n    // // sobo reversal\n    // if (direction === 1) {\n    //   waypoints.reverse();\n    //   pois.reverse();\n    // }\n\n    this._trailData.pois = pois;\n\n    // 1. optimise waypoints\n    // const _optimisedWaypoints: Array<Waypoint> = this.simplify(waypoints, this._tolerance);\n    this.flatTrailData = pointArrayTypeConversion(waypoints, 'waypoint', 'waypoint');\n\n    this._loaderService.showMessage('optimised waypoints');\n\n    // 2. calculate trail properties\n    const flatPoints: Array<object> = [];\n\n    // remove elevation, causes errors\n    for (let i = 0; i < this.flatTrailData.length; i++) {\n      flatPoints.push({latitude: this.flatTrailData[i].latitude, longitude: this.flatTrailData[i].longitude});\n    }\n\n    this._trailData.calcLength = geolib.getPathLength(flatPoints as Array<PositionAsDecimal>) / environment.MILE;\n    this._trailData.scale = (this._trailData.length / this._trailData.calcLength);\n    this._trailData.elevationRange = calculateOHLC(this.flatTrailData, {start: 0, end: waypoints.length - 1});\n\n    this._loaderService.showMessage('calculated trail properties');\n\n    // 3. split waypoints into miles\n    this._trailData.miles = this._createMiles(this.flatTrailData);\n\n    this._loaderService.showMessage('created miles');\n\n    // 4a. generate waypoint tree for easy lookups\n    const flatMileCoordinates: Array<Waypoint> = this._trailData.miles.map(function(elem) {\n        return elem.centerpoint as Waypoint;\n      }\n    );\n\n    // create a tree structure to quickly find nearest mile (for Geolocating)\n    this.createMileTree(flatMileCoordinates);\n\n    this._loaderService.showMessage('created mile tree');\n\n    // 4b. link pois to trail waypoints\n    this._trailData.sortedPoiIds = {};\n\n    if (pois) {\n      this._linkPoisToMiles(pois, this._trailData.miles);\n      this._loaderService.showMessage('linked pois to miles');\n    } else {\n      this._loaderService.showMessage('no pois');\n    }\n\n    // 5. Towns\n    this._trailData.towns = this._calculateTownsAnchorPoints(towns);\n\n    return this._trailData;\n  }\n\n  // create overlapping miles (first/last waypoint overlap, insert 2 new points at 0 & 100%\n  // input:     x *--------------------------------------* x             (flat array with lon/lat/elevation points\n  // output:    x                                                        (arr)\n  //              */------/*                                                  (mile)\n  //                    */------/*                                            (mile)\n  //                          */------/*                                      (mile)\n  //                                */------/*                                (mile)\n  //                                      */------/*                          (mile)\n  //                                            */------/*                    (mile)\n  //                                                       x             (/arr)\n  private _createMiles(waypoints: Array<Waypoint>): Array<Mile> {\n\n    this._loaderService.showMessage('create miles');\n\n    const _miles:           Array<Mile>     = [];\n\n    let _prevPoint:         Waypoint;\n    let _prevOffset         = 0;\n\n    // distances\n    let _distance           = 0;\n    let _bridgedDistance    = 0;\n    let _totalDistance      = 0;\n\n    // elevation gain\n    let _totalGain          = 0;\n    let _totalLoss          = 0;\n\n    // mile waypoints\n    const _mileWaypoints:   Array<Waypoint> = [];\n    let _poisWaypoints:   Array<Waypoint> = []; // for ohlc\n\n    const _wayPointsLength: number          = waypoints.length;      // faster.\n\n    for (let i = 0; i < _wayPointsLength; i++) {\n\n      const _waypoint: Waypoint = waypoints[i] as Waypoint;\n\n\n      // elevation\n      if (!_waypoint.elevation) {\n        _waypoint.elevation = 0;\n      }\n\n      _waypoint.elevation = _waypoint.elevation / environment.FOOT;\n\n      let _elevationChange = 0;\n\n      // calucalte distance between points\n      if (_prevPoint) {\n\n        _distance = _waypoint.distanceTotal - _prevPoint.distanceTotal;\n\n        _totalDistance += _distance;\n        _bridgedDistance += _distance;\n\n        // calculate elevation gain/loss\n        _elevationChange = _waypoint.elevation - _prevPoint.elevation;\n        if (_elevationChange > 0) {\n          _totalGain += _elevationChange;\n        } else {\n          _totalLoss += Math.abs(_elevationChange);\n        }\n      }\n\n      _waypoint.distance = _totalDistance - (_miles.length * environment.MILE);     // the mile distance\n\n      _mileWaypoints.push(_waypoint);\n\n      // if a distance of 1 mile+ has been bridged, or end of waypoints reached\n      if (_bridgedDistance > environment.MILE || waypoints.length - 1 === i) {\n\n        const _combinedWaypoints: Array<Waypoint> = (_poisWaypoints.length > 0) ? _mileWaypoints.concat(_poisWaypoints) : _mileWaypoints;\n\n        const _combinedOhlc: OHLC = calculateOHLC(_combinedWaypoints, {start: 0, end: _combinedWaypoints.length});\n\n        // set data\n        _miles.push({\n          id:               _miles.length + 1,\n          elevationRange:   _combinedOhlc,\n          waypoints:        cloneData(_mileWaypoints) as Array<Waypoint>,\n          elevationGain:    Math.round(_totalGain),\n          elevationLoss:    Math.round(_totalLoss),\n          centerpoint:      waypointToWaypoint(geolib.getCenter(_mileWaypoints)),\n          isCurrent:        false,\n          hasMajorPoi:      false,\n          hasMinorPoi:      false,\n          poiTypes:         {}\n        });\n\n        // clear data\n        _bridgedDistance -= environment.MILE;\n        _totalGain = _totalLoss = 0;\n        _mileWaypoints.splice(0, _mileWaypoints.length - 2);    // keep last 2\n        _poisWaypoints = [];\n        // _hasEscape = _hasCamp = _hasOther = false;\n\n        // adjust offset for the last 2 (which are now the first 2)\n        for (const wp of _mileWaypoints) {\n          wp.distance -= environment.MILE;\n        }\n      }\n\n      // set the previous point for next distance calc.\n      _prevPoint = _waypoint;\n      _prevOffset = _distance;\n\n    }\n\n    return _miles;\n  }\n\n  /* create data tree, a sorting mechanism to quickly figure out where the user is in relation to the trail,\n  and what the closest waypoint it. TODO: research optimal algo, someone smart probably made something for this. */\n  public createMileTree(waypoints: Array<Waypoint>): void {\n    this._mileCenterpointTree = this._createWaypointTree(waypoints);\n  }\n\n  /* create data tree, a sorting mechanism to quickly figure out where a waypoint is in relationship to a tree of waypoints.\n  TODO: research optimal algo, someone smart probably made something for this. */\n  private _createWaypointTree(startData: Array<Waypoint>, returnArray?: Array<any>): any {\n\n    const resultArray: Array<Waypoint> = [];\n    const _length = startData.length;\n\n    for (let i = 0; i < _length; i += 2) {\n\n      let _data: Waypoint;\n\n      if (!startData[i + 1]) {\n        _data = startData[i];\n      } else {\n        _data = geolib.getCenter([startData[i], startData[i + 1]]);\n      }\n\n      resultArray.push(_data);\n    }\n\n    if (returnArray) {\n      returnArray.unshift(resultArray);\n    } else {\n      returnArray = [resultArray, startData];\n    }\n\n    if (resultArray.length > 2) {\n      return this._createWaypointTree(resultArray, returnArray);\n    } else {\n      return returnArray;\n    }\n  }\n\n  // this should loop\n  // TODO: extend geolib.orderByDistance() to include a range within an array, that way I wont have to lookup indexOf(). optimisation!\n  private _findNearestWaypointInTree(location: Waypoint, waypointTree: Array<Array<Waypoint>>, branch?: number, index?: number): Array<Distance> {\n\n    branch = (branch) ? branch : 0;\n    index = (index) ? index : 0;\n\n    const _multiplier = branch;\n\n    const _waypointBranch: Array<Waypoint> = waypointTree[branch];\n\n    const _startIndex = ((index * 2) - _multiplier > 0) ? (index * 2) - _multiplier : 0;\n    const _endIndex = ((index * 2) + _multiplier < waypointTree[branch].length - 1 && (index * 2) + _multiplier > 1) ? (index * 2) + _multiplier : waypointTree[branch].length - 1;\n\n    const _waypointSelection: Array<Waypoint> = _waypointBranch.slice(_startIndex, _endIndex + 1);\n\n    let _orderedWaypoints: Array<Distance> = geolib.orderByDistance(location, _waypointSelection) as Array<Distance>;\n\n    if (branch !== waypointTree.length - 1 && _orderedWaypoints.length > 1) {\n\n      // loop\n      branch ++;\n      return this._findNearestWaypointInTree(location, waypointTree, branch, _startIndex + _waypointSelection.indexOf(_waypointSelection[_orderedWaypoints[0].key]));\n\n    } else {\n\n      // get the 3 nearest\n      _orderedWaypoints = _orderedWaypoints.slice(0,3);\n\n      // fix indexes\n      _orderedWaypoints.forEach(function(d: Distance) {\n        d.key = _startIndex + _waypointSelection.indexOf(_waypointSelection[d.key]);\n      });\n\n      return _orderedWaypoints;\n    }\n  }\n\n  /* parses nearest 3 miles, sorts the reulting top 2 waypoints for each mile by distance\n  returns 1 of 2 nearest points (in nearest mile) */\n  public findNearestPointInMileTree(location: Waypoint, count: number = 1): Array<any> {\n\n    const _nearestMiles: Array<any> = this._findNearestWaypointInTree(location, this._mileCenterpointTree);\n    let _nearestPoints: Array<any> = [];\n    const _nearestMileNearestPoints: Array<any> = [];\n\n    const _mLength = _nearestMiles.length;\n    for (let i = 0; i < _mLength; i++) {\n\n      const _mile = this._trailData.miles[_nearestMiles[i].key];\n      const _nearestWaypoints: Array<Distance> = this.findNearestWaypointInMile(location, _mile);\n\n      // limit to 2 for faster sorting (as we only really need 2\n      const _selection: Array<Distance> = _nearestWaypoints.slice(0, 2);\n      for (let j = 0 ; j < _selection.length; j++) {\n        _selection[j].belongsTo = _nearestMiles[i].key;\n      }\n\n      _nearestPoints = _nearestPoints.concat(_selection);\n    }\n\n    _nearestPoints = sortByKey(_nearestPoints, 'distance');\n\n    _nearestPoints.filter(function(point) {\n      return point.belongsTo === _nearestPoints[0].belongsTo;\n    }).map(function(point) {\n      _nearestMileNearestPoints.push(point);\n    });\n\n    return _nearestMileNearestPoints.slice(0, count + 1);\n  }\n\n  // Get the nearest point (this simply sorts a miles waypoints on distance and returns an array.\n  // Not very efficient for larger data sets.\n  public findNearestWaypointInMile(waypoint: Waypoint, nearestMile: Mile): Array<Distance> {\n    return geolib.orderByDistance({latitude: waypoint.latitude, longitude: waypoint.longitude} as geolib.PositionAsDecimal,\n      nearestMile.waypoints);\n  }\n\n\n  // links points of interest to miles, this is a slow loop\n  private _linkPoisToMiles(pois: Array<Poi>, miles: Array<Mile>): void {\n\n    const _self = this;\n\n    this._loaderService.showMessage('linking pois to miles');\n\n    const _poisLength = pois.length;\n    for (let p = 0; p < _poisLength; p++) {\n\n      const _poi = pois[p];\n\n      // fix string points\n      _poi.waypoint = waypointToWaypoint(_poi.waypoint);\n\n      _poi.id = p; // to prevent mismatching ids in raw data\n\n      _self._loaderService.showMessage('linking pois to miles:' + _poi.id);\n      console.log('linking pois to miles:' + _poi.id + ' of ' + (_poisLength - 1));\n\n      _poi.waypoint.elevation = _poi.waypoint.elevation / environment.FOOT;\n\n      // get nearest point from 3 miles to fix potentially odd trail shape (loops and traverses)\n      const _nearestMileWaypoints: any = _self.findNearestPointInMileTree({latitude: _poi.waypoint.latitude, longitude: _poi.waypoint.longitude} as Waypoint, 2);\n      const _nearestMile = this._trailData.miles[_nearestMileWaypoints[0].belongsTo];\n\n      const _anchorData = _self._anchorDistanceCalculation(_poi.waypoint, _nearestMile, _nearestMileWaypoints);\n\n      _poi.anchorPoint = _anchorData.anchorPoint;\n      _poi.belongsTo = _nearestMile.id;\n\n      // setup poi reference in waypoint\n      if (!_anchorData.nearestWaypoint.nearestToPois) {\n        _anchorData.nearestWaypoint.nearestToPois = [];\n      }\n      _anchorData.nearestWaypoint.nearestToPois.push(_poi.id);\n\n      // the distance of poi from trail\n      _poi.waypoint.distance = _nearestMileWaypoints[0].distance;\n\n      // add poi to mile\n      if (!_nearestMile.pois) {\n        _nearestMile.pois = [];\n      }\n\n      _nearestMile.pois.push(_poi.id);\n\n\n      // set poi types for current mile, so it's clear what kind of poi a mile has in it\n      // differentiates between major and minor poi (major are the ones possibly shown on elevation profile\n      // sets a flag for each poi type in 'poiTypes' property\n      const _curPoiTypes: Array<string> = String(_poi.type).split(', ');\n\n      const _poiTypesLength = _curPoiTypes.length;\n      for (let t = 0; t < _poiTypesLength; t++) {\n\n        const _type = _curPoiTypes[t];\n\n        // create arrays for each type\n        if (!_self._trailData.sortedPoiIds.hasOwnProperty(_type)) {\n          _self._trailData.sortedPoiIds[_type] = [];\n        }\n        _self._trailData.sortedPoiIds[_type].push(_poi.id);\n\n        _nearestMile.poiTypes[_type + ''] = true;\n\n        // identify major/minor poi per mile\n        if (getPoiTypeByType(_type) && getPoiTypeByType(_type).isMajor) {\n          _nearestMile.hasMajorPoi = true;\n        } else {\n          _nearestMile.hasMinorPoi = true;\n        }\n      }\n\n      if (_nearestMile.hasMajorPoi) {\n        // refactor ohlc if needed\n        if (_nearestMile.elevationRange.high < _poi.waypoint.elevation) {\n          _nearestMile.elevationRange.high = _poi.waypoint.elevation;\n        } else if (_nearestMile.elevationRange.low > _poi.waypoint.elevation) {\n          _nearestMile.elevationRange.low = _poi.waypoint.elevation;\n        }\n      }\n    }\n  }\n\n  private _calculateTownsAnchorPoints(towns: Array<Town>): Array<Town> {\n\n    if (!towns) {\n      return;\n    }\n\n    const _length = towns.length;\n    for (var t = 0; t < _length; t++) {\n      const _town: Town = towns[t];\n\n      // only calculate the towns anchorpoint if it doesn't have any\n      if (!_town.anchorPoint) {\n        const _nearestMileWaypoints = this.findNearestPointInMileTree(_town.centerPoint, 2);\n        const _nearestMile = this._trailData.miles[_nearestMileWaypoints[0].belongsTo];\n        const _anchorData = this._anchorDistanceCalculation(_town.centerPoint, _nearestMile, _nearestMileWaypoints);\n        _town.anchorPoint = _anchorData.anchorPoint;\n      }\n    }\n\n\n    return towns;\n  }\n\n  // distance calculation\n  private _anchorDistanceCalculation(location: Waypoint, nearestMile: Mile, nearestWaypoints: object) {\n\n    // console.log(location, nearestMile, nearestWaypoints);\n\n    const _nearestWaypoint = nearestMile.waypoints[nearestWaypoints[0].key];\n    const _2ndNearestWaypoint = nearestMile.waypoints[nearestWaypoints[1].key];\n\n    // create an anchor waypoint (an on trail point nearest to the poi (simple triangulation)\n    const _diffDistPercentage = (nearestWaypoints[0].distance / nearestWaypoints[1].distance);\n    const _lat = _nearestWaypoint.latitude + (((_2ndNearestWaypoint.latitude - _nearestWaypoint.latitude) * _diffDistPercentage) || 0);\n    const _lon = _nearestWaypoint.longitude + (((_2ndNearestWaypoint.longitude - _nearestWaypoint.longitude) * _diffDistPercentage) || 0);\n    const _ele = _nearestWaypoint.elevation + (((_2ndNearestWaypoint.elevation - _nearestWaypoint.elevation) * _diffDistPercentage) || 0);\n    const _dist = _nearestWaypoint.distance + (((_2ndNearestWaypoint.distance - _nearestWaypoint.distance) * _diffDistPercentage) || 0);\n    const _distT = _nearestWaypoint.distanceTotal + (((_2ndNearestWaypoint.distanceTotal - _nearestWaypoint.distanceTotal) * _diffDistPercentage) || 0);\n\n    // console.log({latitude: _lat, longitude: _lon}, {latitude: location.latitude, longitude: location.longitude});\n\n    // return data\n    return {\n      anchorPoint: {latitude: _lat, longitude: _lon, elevation: _ele, distance: _dist, distanceTotal: _distT},\n      nearestWaypoint: _nearestWaypoint,\n      distance: calculateDistance({latitude: _lat, longitude: _lon}, {latitude: location.latitude, longitude: location.longitude})\n    };\n  }\n\n  // simplify an array of data points using 2 methods (radial distance and the douglas peucker alg.)\n  public simplify(points: Array<Waypoint>, tolerance: number, highestQuality: boolean = true): Array<any> {\n\n    const sqTolerance: number = tolerance !== undefined ? tolerance * tolerance : 1;\n\n    points = highestQuality ? this._simplifyRadialDistance(points, sqTolerance) : points;\n    points = this._simplifyDouglasPeucker(points, sqTolerance);\n\n    return points;\n  }\n\n  // basic distance-based simplification\n  private _simplifyRadialDistance(points, sqTolerance): Array<Waypoint> {\n\n    let prevPoint: Waypoint = this._castAsNumbers(points[0]);\n    const newPoints: Array<Waypoint> = [prevPoint];\n    let point: Waypoint;\n\n    for (let i = 1, len = points.length; i < len; i++) {\n\n      // cast as number\n      point = this._castAsNumbers(points[i]);\n      if (this._getSquareDistance(point, prevPoint) > sqTolerance) {\n        newPoints.push(point);\n        prevPoint = point;\n      }\n    }\n\n    if (prevPoint !== point) {\n      newPoints.push(point);\n    }\n\n    return newPoints;\n  }\n\n  private _castAsNumbers(point: object): Waypoint {\n    return {longitude: Number(point['longitude']), latitude: Number(point['latitude']), elevation: Number(point['elevation'])};\n  }\n\n  // simplification using optimized Douglas-Peucker algorithm with recursion elimination\n  private _simplifyDouglasPeucker(points, sqTolerance) {\n\n    let len = points.length,\n      MarkerArray = typeof Uint8Array !== 'undefined' ? Uint8Array : Array,\n      markers = new MarkerArray(len),\n\n      first = 0,\n      last = len - 1,\n\n      stack = [],\n      newPoints = [],\n\n      i, maxSqDist, sqDist, index;\n\n    markers[first] = markers[last] = 1;\n\n    while (last) {\n\n      maxSqDist = 0;\n\n      for (i = first + 1; i < last; i++) {\n\n        sqDist = this._getSquareSegmentDistance(points[i], points[first], points[last]);\n\n        if (sqDist > maxSqDist) {\n          index = i;\n          maxSqDist = sqDist;\n        }\n      }\n\n      if (maxSqDist > sqTolerance) {\n        markers[index] = 1;\n        stack.push(first, index, index, last);\n      }\n\n      last = stack.pop();\n      first = stack.pop();\n    }\n\n    for (i = 0; i < len; i++) {\n      if (markers[i]) {\n        newPoints.push(points[i]);\n      }\n    }\n\n    return newPoints;\n  }\n\n\n\n  /*\n   (c) 2013, Vladimir Agafonkin\n   Simplify.js, a high-performance JS polyline simplification library\n   mourner.github.io/simplify-js\n  */\n\n  // square distance between 2 points\n  private _getSquareDistance(p1, p2) {\n\n    const dx: number = p1.latitude - p2.latitude,\n      dy: number = p1.longitude - p2.longitude,\n      dz: number = (p1.elevation - p2.elevation) || 0;\n\n    return dx * dx + dy * dy + dz * dz;\n  }\n\n  // square distance from a point to a segment\n  private _getSquareSegmentDistance(p, p1, p2) {\n\n    let x: number = p1.latitude,\n      y: number = p1.longitude,\n      z: number = p1.elevation,\n\n      dx: number = p2.latitude - x,\n      dy: number = p2.longitude - y,\n      dz: number = p2.elevation - z;\n\n    if (dx !== 0 || dy !== 0 || dz !== 0) {\n\n      const t = ((p.latitude - x) * dx + (p.longitude - y) * dy + (p.elevation - z) * dz) /\n        (dx * dx + dy * dy + dz * dz);\n\n      if (t > 1) {\n        x = p2.latitude;\n        y = p2.longitude;\n        z = p2.elevation;\n\n      } else if (t > 0) {\n        x += dx * t;\n        y += dy * t;\n      }\n    }\n\n    dx = p.latitude - x;\n    dy = p.longitude - y;\n    dz = p.elevation - z;\n\n    return dx * dx + dy * dy + dz * dz;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Router, Resolve, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { switchMap, take } from 'rxjs/operators';\nimport { TrailService }  from './trail.service';\nimport { LoaderService } from './loader.service';\nimport { LocalStorageService } from 'ngx-webstorage';\nimport { Trail } from '../type/trail';\nimport { Waypoint } from '../type/waypoint';\nimport { TrailGeneratorService } from './trail-generator.service';\nimport { SnowGeneratorService } from './snow-generator.service';\nimport { Snow } from '../type/snow';\nimport { reverseSnow } from '../_util/snow';\nimport { DownloadService } from './download.service';\nimport {RateService} from './rate.service';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class TrailResolverService implements Resolve<any> {\n\n  private _cachedTrail: Trail;\n  private _cachedSnow: Snow;\n  private _activeTrailId: number;\n\n  // makes sure trail data is available before navigating anywhere\n  constructor(\n    private _localStorage: LocalStorageService,\n    private _trailService: TrailService,\n    private _router: Router,\n    private _loaderService: LoaderService,\n    private _downloadService: DownloadService,\n    private _trailGenerator: TrailGeneratorService,\n    private _snowGenerator: SnowGeneratorService,\n    private _rateService: RateService\n  ) {}\n\n\n  /* there are 3 locations for trail data\n   * - assets: contains default trail data that shipped with the app\n   * - filesystem: contains downloaded versions of the trail data\n   * - online data */\n  resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<object> | Observable<never> {\n\n    this._activeTrailId = this._localStorage.retrieve('activeTrailId') || 0;\n    const _direction: number = this._localStorage.retrieve('direction') || 0;\n\n      if (this._cachedTrail && this._cachedTrail.id === this._activeTrailId && this._cachedTrail.direction === _direction) {\n\n        return of({trail: this._cachedTrail, snow: this._cachedSnow});\n\n      } else {\n\n        return this._trailService.getPreParsedTrailData(this._activeTrailId, _direction).pipe(\n\n          take(1),                // closes subscription\n          switchMap(data => {\n\n            if (data) {\n\n              // cache trail\n              this._cachedTrail = data[0] as Trail;\n              this._trailGenerator.setTrailData(this._cachedTrail);\n\n              // if there's snow data, there might not be\n              if (data[1]) {\n\n                // parse snow data individually (as it's a separate update/download)\n                this._cachedSnow = data[1] as Snow;\n                this._snowGenerator.setSnowData(this._cachedSnow);\n\n\n                // reverse if needed\n                if (_direction === 1) {\n                  this._cachedSnow = reverseSnow(this._cachedSnow, this._cachedTrail.miles.length);\n                }\n              }\n\n              // generate a mileTree (for GPS location)\n              const flatMileCoordinates: Array<Waypoint> = data[0].miles.map(function (elem) {\n                  return elem.centerpoint as Waypoint;\n                }\n              );\n\n              this._trailGenerator.createMileTree(flatMileCoordinates);\n              this._loaderService.showMessage('created mile tree');\n\n              // set up the rating system (requires active trail data)\n              this._rateService.setup();\n              this._loaderService.showMessage('initialized rating system');\n\n              this._loaderService.hideOverlay();\n\n              return of({trail: this._cachedTrail, snow: this._cachedSnow});\n\n            } else {\n\n              this._loaderService.hideOverlay();\n              this._router.navigate(['/error']);\n              return;\n            }\n          })\n        );\n      }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { forkJoin, Observable } from 'rxjs';\nimport { of } from 'rxjs';\nimport { TrailMeta } from '../type/trail';\nimport { LocalStorageService } from 'ngx-webstorage';\nimport { LoaderService } from './loader.service';\nimport { TrailGeneratorService } from './trail-generator.service';\nimport { Waypoint } from '../type/waypoint';\nimport { Poi } from '../type/poi';\nimport { SnowGeneratorService } from './snow-generator.service';\nimport { parseSnow, reverseSnow } from '../_util/snow';\nimport { environment } from '../../environments/environment.prod';\nimport { getTrailMetaDataById } from '../_util/trail-meta';\nimport { FilesystemService } from './filesystem.service';\n\n// dynamically called\n// import { parseCDTData } from '../parser/cdt-data';\n// import { parseATData } from '../parser/at-data';\nimport {PCTData} from '../parser/pct-data';\nimport {SHRData} from '../parser/shr-data';\nimport {Town} from '../type/town';\n\n@Injectable({\n  providedIn: 'root'\n})\n\n/* trail generating, trail parsing, trail loading:\ntrail:\n- consists of trail waypoints (can be multiple files)\n- contists poi data (points of interest), can be multiple files (TODO: multi poi files, when needed)\n- consists of snow data (single file)\n */\nexport class TrailService {\n\n  // prevent removal of dynamically used imports (tree shaking), see: https://github.com/Microsoft/TypeScript/issues/9191\n  // since each dataset has a different source, they all have their own parsing routine, before step 2 (generateMiles() / parseSnow())\n  private _DEMOParser: PCTData = new PCTData();   // demo is the first section of the PCT\n  private _PCTParser: PCTData = new PCTData();\n  private _SHRParser: SHRData = new SHRData();\n  // private _parseCDTData:    Function = parseCDTData;\n  // private _parseATData:     Function = parseATData;\n\n  constructor(\n    private _http: HttpClient,\n    private _localStorage: LocalStorageService,\n    private _loaderService: LoaderService,\n    private _trailGenerator: TrailGeneratorService,\n    private _snowGenerator: SnowGeneratorService,\n    private _fileSystemService: FilesystemService\n  ) {}\n\n  // Get raw trail data, for parsing (dev mode)\n  // this generates the preparsed data files to be used by regular users (stored online for download + default version in assets)\n  // supports trails that consist of multiple files (sections)\n  public getRawTrailData(trailId: number): Observable<object> {\n\n    let _trailMeta: TrailMeta;\n    const _observables = [];\n\n    for (const key in environment.TRAILS_GENERATION) {\n      if (environment.TRAILS_GENERATION[key].id === trailId) {\n        _trailMeta = environment.TRAILS_GENERATION[key] as TrailMeta;\n      }\n    }\n\n    const _metaAsObservable = of(_trailMeta);     // so it can be passed into the forkjoin\n\n    _observables.push(_metaAsObservable);\n\n    // AT data from the ATC\n    // PCT data from halfmile\n    // CDT data from CDTC (might be able to get better dataset)\n    // SHR http://onthetrail.org/trekking/shr/ (unofficial)\n    // TODO: snow data ripped from postholer (not very nice, I know)\n\n    // .dat is an xml structured file (so a .gpx or .kml)\n\n    const _assetsDir: string = 'assets/data/';\n\n    if (_trailMeta.multipart) {\n\n      for(let i = 0; i < _trailMeta.parts; i++) {\n        const _trailDownloader = this._http.get(_assetsDir + _trailMeta.dataPath + 'trail_' + i + '.dat', {responseType: 'text'});\n        _observables.push(_trailDownloader);\n      }\n    } else {\n      const _trail = this._http.get(_assetsDir + _trailMeta.dataPath + 'trail.dat', {responseType: 'text'});\n      _observables.push(_trail);\n    }\n\n    const _poi = this._http.get(_assetsDir + _trailMeta.dataPath + 'poi.dat', {responseType: 'text'});\n    _observables.push(_poi);\n\n    // snow is an optional data file\n    let _snow: Observable<Object>;\n    if (_trailMeta.snowVersion) {\n      _snow = this._http.get(_assetsDir + _trailMeta.dataPath + 'snow.json', {responseType: 'json'});\n      _observables.push(_snow);\n    }\n\n    // towns is an optional data file\n    let _towns: Observable<Object>;\n    if (_trailMeta.hasTowns) {\n      _towns = this._http.get(_assetsDir + _trailMeta.dataPath + 'towns.json', {responseType: 'json'});\n      _observables.push(_towns);\n    }\n\n    return forkJoin(_observables);\n  }\n\n  /* Get the pre parsed trail data (regular user), returns a promise\n  2 options\n  - get the locally stored (user downloaded) combined trail file (that includes trail & poi), 2 separate JSONs, trail has nobo/sobo versions\n  - get the default combined file (from assets, baked into the app), 2 separate JSONs, trail has nobo/sobo versions */\n  public getPreParsedTrailData(trailId: number, direction: number): Observable<object> {\n\n    const _self = this;\n    const _trailMeta = getTrailMetaDataById(trailId);\n    const _directionString: string = (direction === 0) ? 'nobo' : 'sobo';\n\n    this._loaderService.showMessage('fetching trail data');\n\n      const _getData = async function(name: string, hasDirection: boolean) {\n\n        return new Promise(function(resolve, reject) {\n\n          const _fileName = (hasDirection) ? name + '-' + _directionString + '.json' : name + '.json';\n\n          _self._fileSystemService.readFile(_trailMeta.abbr, _fileName, async function(result) {\n\n            if (result && result !== 'error') {\n\n              resolve(result);\n\n            } else {\n\n              // if there isn't a trail, get it from assets\n              _self._http.get('assets/files/' + _trailMeta.abbr + '/' + _fileName, {responseType: 'json'}).subscribe(function (file) {\n                resolve(file);\n              });\n            }\n          });\n      });\n    };\n\n\n    // attempt to get data from filesystem, if that fails, get it from assets\n    const _observables = [];\n\n    const _trailData = _getData('trail', true);\n    _observables.push(_trailData);\n\n    if (_trailMeta.snowVersion) {\n      const _snowData = _getData('snow', false);\n      _observables.push(_snowData);\n    }\n\n    return forkJoin(_observables);\n  }\n\n  // Parse the raw data (routines for each trail), returns a promise\n  public parseTrailData(trail: TrailMeta, waypoints: Array<string> | string, pois: string, snow: object, towns: object, direction: number): object {\n\n    this._loaderService.showMessage('parsing trail data');\n\n    // dynamic function call\n    const _parsed = this['_' + trail.abbr + 'Parser'].parse(trail, waypoints, pois, snow, towns, direction);\n\n    const _trail = this._trailGenerator.generateMiles(\n      _parsed[0] as TrailMeta,\n      _parsed[1] as  Array<Waypoint>,\n      _parsed[2] as Array<Poi>,\n      direction,\n      _parsed[4] as Array<Town>\n    );\n\n    let _snow;\n    if (_parsed[3]) {\n      _snow = parseSnow(_parsed[3], _trail.id, _trail.abbr, trail.snowVersion);\n\n      if (direction === 1) {\n        _snow = reverseSnow(_snow, _trail.miles.length);\n      }\n\n      this._snowGenerator.setSnowData(_snow);\n    }\n\n\n    return {trail: _trail, snow: _snow};\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {Resolve, Router} from '@angular/router';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {environment} from '../../environments/environment.prod';\nimport {getTrailMetaDataById, setTrailMetaData} from '../_util/trail-meta';\nimport {BehaviorSubject, forkJoin, Observable, of} from 'rxjs';\nimport {share, switchMap, take} from 'rxjs/operators';\nimport {TrailGeneratorService} from './trail-generator.service';\nimport {SnowGeneratorService} from './snow-generator.service';\nimport {ConnectionService} from './connection.service';\nimport {hasConnection} from '../_util/cordova';\nimport {DownloadService} from './download.service';\nimport {Downloader} from '../_util/downloader/downloader';\nimport {HttpResponse} from '@angular/common/http';\nimport {TrailMeta} from '../type/trail';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class VersionResolverService implements Resolve<any> {\n\n  private _internalDownloader: Downloader;     // downloads file from assets\n  private _externalDownloader: Downloader;     // downloads online file\n\n  public observables: any = {};       // object containing all observables\n  private _subjects: any = {};        // object containing all behaviorSubjects\n\n  // TODO: incorporate town list (will be a seperate file)\n  private _dataTypes: Array<string> = ['trail', 'snow', 'tiles'];\n\n  constructor(\n    private _router:                  Router,\n    private _localStorage:            LocalStorageService,\n    private _snowGeneratorService:    SnowGeneratorService,\n    private _trailGeneratorService:   TrailGeneratorService,\n    private _connectionService:       ConnectionService,\n    private _downloadService:         DownloadService\n  ) {\n\n    // create the update available observer\n    const _sub = this._subjects['updateAvailable'] = new BehaviorSubject(false);\n    this.observables['updateAvailable'] = _sub.asObservable().pipe(share());\n\n    this._internalDownloader = this._downloadService.createDownloader('DATA_version_internal');\n    this._externalDownloader = this._downloadService.createDownloader('DATA_version_external');\n  }\n\n  resolve(): Observable<string> | Observable<never> {\n\n    return this.collectVersionData().pipe(\n\n      take(1),\n      switchMap(data => {\n\n          if (data) {\n\n            const _parseHttpResponce = function(input): any {\n              if (input && input instanceof HttpResponse) {\n                if (input.status === 200) {\n                  return input.body;      // return just the data\n                } else {\n                  return null;            // failed http request\n                }\n              } else {\n                return input;             // not an http response\n              }\n            };\n\n            const _self = this;\n            const _internal = _parseHttpResponce(data[0]);\n            const _external = _parseHttpResponce(data[1]);\n\n            /* check if this is the first run\n            if so, write all the internal version to local storage, so we can later check against those versions) */\n            for (const key in _internal) {\n\n              const _trail: TrailMeta = _internal[key];\n\n              this._dataTypes.forEach(function(type) {\n\n                const _storedKeyName: string = _trail.abbr + '_' + type + 'Version';\n\n                if (type !== 'tiles' && !_self._localStorage.retrieve(_storedKeyName)) {\n\n                  // if the trail has data of type (not all trails have snow data)\n                  if (_trail[type + 'Version']) {\n                    _self._localStorage.store(_storedKeyName, _trail[type + 'Version']);\n                  }\n                }\n              });\n            }\n\n            // if we have newly downloaded data\n            if (_external) {\n\n              this._localStorage.store('lastVersionCheck', new Date().getTime());\n              this._localStorage.store('availableUpdates', _external);\n              setTrailMetaData(_external);\n\n            } else {\n\n              /* we're using internal data, so the last version data is what we saved to local storage\n              the last time internet was available, if nothing was ever downloaded use internal data */\n              const _updateData: any = this._localStorage.retrieve('availableUpdates');\n              if (_updateData) {\n                setTrailMetaData(_updateData);\n              } else {\n                setTrailMetaData(_internal);\n              }\n            }\n            return of('success');\n          } else {\n            this._router.navigate(['/error']);\n            return of('error');\n          }\n        }\n      )\n    );\n  }\n\n  /* collect version data, from assets/local storage and external,\n  this function is also executed from app.component */\n  public collectVersionData(): Observable<object> {\n\n    let _hasInternetConnection = true;\n\n    if (hasConnection()) {\n      _hasInternetConnection = (this._connectionService.getStatus() === 'online');\n    }\n\n    // INTERNAL\n    // if there is no stored data available (first run) get data from assets\n    const _storageVersion = this._localStorage.retrieve('availableUpdates');\n    let _internal: Observable<any>;\n\n    if (_storageVersion) {\n      _internal = of(_storageVersion);\n    } else {\n      _internal = this._internalDownloader.downloadFile('assets/files/version.json', false);\n    }\n\n\n    // EXTERNAL\n    // only update once every 24 hours to save bandwidth\n    let _lastChecked = this._localStorage.retrieve('lastVersionCheck');\n\n    let _external: Observable<any>;\n\n    if (!_lastChecked) {\n      _lastChecked = 0;\n    }\n\n    if (_lastChecked + environment.updateCheckInterval < new Date().getTime() && _hasInternetConnection) {\n      _external = this._externalDownloader.downloadFile(      environment.appDomain + environment.fileBaseUrl + 'version.json'\n        , false);\n    } else {\n      _external = of(null);\n    }\n\n    return forkJoin([_internal, _external]);\n  }\n\n\n\n\n  /* separately called: if internet were to become available and the app hasn't checked for updates in 24 hours, check.\n   * check if the version of currently loaded trail data === the latest available trail data\n   * show version mismatch (download available indicator)\n   * TODO: trigger auto snow data download if user setting is enabled. */\n  public versionCheck(currentTrailOnly: boolean = false): void {\n\n    const _self = this;\n\n    this.resolve().subscribe(function (result) {\n\n      _self._subjects['updateAvailable'].next(false);\n\n      const _activeTrailId = _self._localStorage.retrieve('activeTrailId') | 0;\n\n      let _trails = _self._localStorage.retrieve('availableUpdates');\n\n      if (currentTrailOnly) {\n        _trails = { activeTrail: getTrailMetaDataById(_activeTrailId) };\n      }\n\n      // for each trail\n      for (const key in _trails) {\n\n        const _trailMeta: TrailMeta = _trails[key];\n\n        // compare versions for each data type\n        _self._dataTypes.forEach(function(type: string) {\n\n          if (!_self.observables[_trailMeta.abbr + '_' + type + 'Available']) {\n\n            // dynamically create behavior subjects / observables for each type\n            const _sub = _self._subjects[_trailMeta.abbr + '_' + type] = new BehaviorSubject(false);\n            _self.observables[_trailMeta.abbr + '_' + type + 'Available'] = _sub.asObservable().pipe(share());\n\n            // subscribe to localstorage\n            _self._localStorage.observe(_trailMeta.abbr + '_' + type + 'Version').subscribe(function () {\n              _self.versionCheck(true);  // as soon as the local storage version changes we re-resolve\n            });\n          }\n\n          // the actual comparison\n          const _storedVersion = _self._localStorage.retrieve(_trailMeta.abbr + '_' + type + 'Version');\n\n          if (_storedVersion !== _trailMeta[type + 'Version']) {\n\n            _self._subjects[_trailMeta.abbr + '_' + type].next(true);\n\n            if (_activeTrailId === _trailMeta.id) {\n              // set the general update available flag\n              _self._subjects['updateAvailable'].next(true);\n            }\n          } else {\n            _self._subjects[_trailMeta.abbr + '_' + type].next(false);\n          }\n        });\n      }\n    });\n  }\n}\n","import { Trail } from './type/trail';\nimport {PoiType} from './type/poi';\n\nexport class Settings {\n\n  // TODO: this should be moved somewhere else\n  public static POITYPES: Array<PoiType> = [\n    {\n      type: 'user',\n      label: 'user',\n      iconType: 'fa',\n      icon: 'hiking'\n    }, {\n      type: 'user-dot',\n      label: '',\n      iconType: 'far',\n      icon: 'dot-circle'\n    }, {\n      type: 'water',\n      label: 'water source',\n      isMajor: true,\n      color: '#58aed9',\n      iconType: 'fa',\n      icon: 'tint',\n      rateable: true,\n      rateBy: ['quality', 'flow', 'accessibility'],\n      userEnabled: true\n    }, {\n      type: 'camp',\n      label: 'campsite',\n      isMajor: true,\n      color: '#d9a758',\n      iconType: 'fa',\n      icon: 'campground',\n      userEnabled: true\n    }, {\n      type: 'shelter',\n      label: 'shelter',\n      isMajor: false,\n      color: '#d9a758',\n      iconType: 'fa',\n      icon: 'house-damage',\n      rateBy: ['pests', 'amenities'],\n      userEnabled: true\n    },{\n      type: 'road',\n      label: 'road',\n      color: '#878787',\n      iconType: 'fa',\n      icon: 'road',\n      userEnabled: true\n    }, {\n      type: 'highway',\n      label: 'highway',\n      isMajor: true,\n      color: '#9b9b9b',\n      iconType: 'fa',\n      icon: 'car',\n      userEnabled: true\n    }, {\n      type: 'railroad',\n      label: 'railroad',\n      color: '#afafaf',\n      iconType: 'fa',\n      icon: 'train',\n      userEnabled: true\n    }, {\n      type: 'gate',\n      label: 'gate',\n      color: '#58d9aa',\n      iconType: 'fa',\n      icon: 'door-open',\n      userEnabled: true\n    }, {\n      type: 'powerline',\n      label: 'powerline',\n      color: '#8b6765',\n      iconType: 'fa',\n      icon: 'bolt',\n      userEnabled: true\n    }, {\n      type: 'store',\n      label: 'store',\n      color: '#9e58d9',\n      iconType: 'fa',\n      icon: 'store',\n      rateable: true,\n      rateBy: ['assortment', 'price'],\n      userEnabled: true\n    }, {\n      type: 'postoffice',\n      label: 'post office',\n      color: '#d958aa',\n      iconType: 'fa',\n      icon: 'box-open',\n      userEnabled: true\n    }, {\n      type: 'food',\n      label: 'food',\n      color: '#805bd9',\n      iconType: 'fa',\n      icon: 'utensils',\n      rateable: true,\n      rateBy: ['quantity', 'quality', 'price'],\n      userEnabled: true\n    }, {\n      type: 'information',\n      label: 'information',\n      color: '#4498d9',\n      iconType: 'fa',\n      icon: 'info',\n      userEnabled: true\n    }, {\n      type: 'trailhead',\n      label: 'trail head',\n      color: '#8d5e35',\n      iconType: 'fa',\n      icon: 'parking',\n      userEnabled: true\n    }, {\n      type: 'sign',\n      label: 'sign',\n      color: '#d08d4b',\n      iconType: 'fa',\n      icon: 'map-signs',\n      userEnabled: true\n    }, {\n      type: 'bridge',\n      label: 'bridge',\n      color: '#d95da5',\n      iconType: 'fa',\n      icon: 'shoe-prints',\n      userEnabled: true\n    }, {\n      type: 'trail',\n      label: 'trail',\n      color: '#a5d958',\n      iconType: 'fa',\n      icon: 'map-signs',\n      userEnabled: true\n    }, {\n      type: 'view',\n      label: 'view',\n      color: '#d97948',\n      iconType: 'fa',\n      icon: 'mountain',\n      userEnabled: true\n    }, {\n      type: 'peak',\n      label: 'summit',\n      color: '#d97948',\n      iconType: 'fa',\n      icon: 'mountain',\n      userEnabled: true\n    }, {\n      type: 'boundary',\n      label: 'boundary',\n      color: '#d9c558',\n      iconType: 'fa',\n      icon: 'map-pin',\n      userEnabled: true\n    }, {\n      type: 'end',\n      label: 'sign',\n      isMajor: true,\n      color: '#d9c558',\n      iconType: 'fa',\n      icon: 'flag'\n    }, {\n      type: 'sight',\n      label: 'sight',\n      color: '#56ccd9',\n      iconType: 'fa',\n      icon: 'gem'\n    }, {\n      type: 'resort',\n      label: 'resort / inn / lodge / angel',\n      isMajor: true,\n      color: '#48d965',\n      iconType: 'fa',\n      icon: 'hotel',\n      rateable: true,\n      rateBy: ['amenities', 'price'],\n      userEnabled: true\n    }, {\n      type: 'town',\n      label: 'town / city',\n      isMajor: true,\n      color: '#ff0000',\n      iconType: 'fa',\n      icon: 'city'\n    },\n\n    // warning\n    {\n      type: 'note',       // add\n      label: 'note',\n      color: '#E8D6BD',\n      iconType: 'fas',\n      icon: 'pen-alt',\n      userEnabled: true\n    },\n\n    // warning\n    {\n      type: 'warning',       // add\n      label: 'warning',\n      color: '#d75b4e',\n      iconType: 'fa',\n      icon: 'exclamation-triangle'\n    },\n\n    // multiple type\n    {\n      type: 'multiple',\n      label: 'plus',\n      color: '#4b4b4b',\n      iconType: 'fa',\n      icon: 'plus'\n    },\n\n    // if all else fails\n    {\n      type: 'unknown',\n      label: '',\n      color: '#808080',\n      iconType: 'fa',\n      icon: 'question-circle'\n    }\n\n  ];\n\n  public trailData: Trail;\n}\n","import {Waypoint} from './waypoint';\nimport {PoiType} from './poi';\nimport {getPoiTypeByType} from '../_util/poi';\nimport {BehaviorSubject, Observable} from 'rxjs';\nimport {share} from 'rxjs/operators';\nimport {getUUID} from '../_util/cordova';\n\n// score\nexport interface Score {\n\n  // need to be public for database POST\n  timestamp: number;               // if date is set, user has added a score\n  score: number;                   // max. the last 10 ratings\n  aspect: string;                  // the 'aspect' (scoreable property within rating. 'flow', 'quality' etc.)\n  belongsTo: string;               // the ID (waypoint) of a rating this score belongs to\n  userId?: string;                 // UUID (TODO: v2, accounts)\n  unsynced?: boolean;              // (optional) locally stored but still has to be pushed online\n  dbId?: string;                   // firebase database id\n}\n\n// maintains a total score based on the last 10 inputs\nexport class TotalScore {\n\n  public userScore: Score;                  // if set, the user has rated;\n\n  private _scores: Array<number> = [];      // max. the last 10 ratings\n  private _count = 0;                       // max. 10\n  private _aspect: string;                  // the 'aspect' (scoreable property within rating. 'flow', 'quality' etc.)\n  private _belongsTo: string;               // the ID (waypoint) of a rating this score belongs to\n\n  constructor(belongsTo: string, aspect: string, scores?: Array<Score>) {\n\n    this._belongsTo = belongsTo;\n    this._aspect = aspect;\n\n    this._setScore(scores);\n\n    console.log(this);\n  }\n\n  private _setScore(scores: Array<Score>) {\n\n    if (scores) {\n\n      const _length = scores.length;\n      const _UUID = getUUID();\n\n      for (let i = 0; i < _length; i++) {\n\n        const _score: Score = scores[i];\n        this._scores.push(_score.score);\n\n        // set user score ref\n        if (_score.userId === _UUID) {\n          this.userScore = _score;\n        }\n\n        this._count ++;\n      }\n    }\n  }\n\n  public addToScore(score: number, force: boolean = false) {\n\n    // without forcing a user can only have a single score\n    if (this.userScore && !force) {\n\n      this.userScore.score = score;\n      this.userScore.unsynced = true;\n      this.userScore.timestamp = new Date().getTime();\n      this.removeUserScore(false);\n\n    } else {\n      this.userScore = {\n        aspect: this._aspect,\n        belongsTo: this._belongsTo,\n        score: score,\n        timestamp: new Date().getTime(),\n        unsynced: true,\n        userId: getUUID()\n      }\n\n      if (this._count < 10) {\n        this._count++;\n      }\n\n    }\n\n    this._scores.push(this.userScore.score);\n\n    if (this._scores.length > 10) {\n      this._scores.shift();\n    }\n  }\n\n  public getScore(): number {\n\n    let _total = 0;\n    let _count = 0;\n\n    for (let i = 0; i < this._scores.length; i++) {\n\n      const _multiplier = (1 + (i * 0.5));    // make more recent scores count more\n\n      _total += (this._scores[i] * _multiplier);\n      _count += _multiplier;\n    }\n\n    return Number((_total / _count).toFixed(2));\n  }\n\n  public getUserScore(): number {\n\n    if (this.userScore) {\n      return this.userScore.score;\n    } else {\n      return 0;\n    }\n  }\n\n  public removeUserScore(clearUserScoreObj: boolean = true): void {\n    if (this.userScore) {\n\n      const _userScroreIndex = this._scores.indexOf(this.userScore.score);\n      this._scores.splice(_userScroreIndex, 1);\n\n      if (clearUserScoreObj) {\n        this.userScore = null;\n      }\n      this._count--;\n    }\n  }\n}\n\nexport class Rating {\n\n  public id?:               string;             // id = type_lat_lng\n  public date:              number;             // last rating\n\n  public ratingChangedObserver: Observable<number>;\n\n  private _aspects:         Object = {};        // you can rate different aspects (water: flow / quality / ease of use)\n  private _rating:          number;\n  private _ratingChangedSubject: BehaviorSubject<number>;\n  private _type:            string;\n\n  constructor(type: string, location: Waypoint, scores?: Array<Score>) {\n\n    const _self = this;\n\n    this._type = type;\n    this.id = type + '_' + Number(location.latitude).toFixed(4) + '_' + Number(location.longitude).toFixed(4);\n\n    const _poiType: PoiType = getPoiTypeByType(this._type);\n\n    if (!_poiType.rateable) {\n      console.warn('trying to create a rating object for an unrateable type: ' + this._type);\n      return;\n    }\n\n    _self._setTotalScores(scores, _poiType.rateBy);\n\n    this.setupObserver();\n\n    this.calculateRating();\n  }\n\n  public destroy(): void {\n    if (this.ratingChangedObserver) {\n      this.ratingChangedObserver = null;\n      this._ratingChangedSubject = null;\n    }\n  }\n\n  public setupObserver(): void {\n\n    if (!this.ratingChangedObserver) {\n      this._ratingChangedSubject = new BehaviorSubject(-1);\n      this.ratingChangedObserver = this._ratingChangedSubject.asObservable().pipe(share());\n    }\n  }\n\n  // sort scores by aspect\n  private _setTotalScores(scores: Array<Score>, aspects: Array<string>): void {\n\n    let aspectCount = 0;\n\n    if (scores) {\n\n      const _aspectsTypeCollection: Object = {};\n      const _length = scores.length;\n      for (let i = 0; i < _length; i++) {\n\n        const _score: Score = scores[i];\n\n        if (!_aspectsTypeCollection[_score.aspect]) {\n          _aspectsTypeCollection[_score.aspect] = [];\n        }\n\n        _aspectsTypeCollection[_score.aspect].push(_score);\n      }\n\n      // create total scores based on the aspects provided by scores\n      for (const key in _aspectsTypeCollection) {\n        this._aspects[key] = new TotalScore(this.id, key, _aspectsTypeCollection[key]);\n        aspectCount ++;\n      }\n    }\n\n    // create blank total scores\n    if (aspects.length !== aspectCount) {\n\n      aspects.forEach((aspect: string) => {\n        if (!this._aspects.hasOwnProperty(aspect)) {\n          this._aspects[aspect] = new TotalScore(this.id, aspect);\n        }\n      })\n    }\n  }\n\n  // updates the user rating within the total score object\n  // sets the new total value\n  public setAspectRating(aspect: string, rating: number, force: boolean = false): void {\n\n    const _curAspect: TotalScore = this._aspects[aspect];\n    _curAspect.addToScore(rating, force);\n\n    this.calculateRating();\n  }\n\n  public calculateRating(): void {\n\n    let _aspectCount = 0;\n    let _cummulativeScore = 0;\n\n    for (const key in this._aspects) {\n\n      const _rating: TotalScore = this._aspects[key];\n      const _aspectScore = _rating.getScore() || 0;\n\n      if (_aspectScore) {\n        _aspectCount ++;\n        _cummulativeScore += _aspectScore;\n      }\n    }\n\n    this._rating = Number((_cummulativeScore / _aspectCount).toFixed(2)) || 0;\n\n    // trigger\n    this._ratingChangedSubject.next(new Date().getTime());\n  }\n\n  public getRating(): number {\n    return this._rating;\n  }\n\n  public getAspect(name: string): TotalScore {\n    return this._aspects[name];\n  }\n\n  public getAspects(): Array<TotalScore> {\n\n    const _returnArray: Array<TotalScore> = [];\n\n    for (const key in this._aspects) {\n      _returnArray.push(this._aspects[key]);\n    }\n\n    return _returnArray;\n  }\n}\n","export class Snow {\n  trailId:        number;\n  version:        string;\n  abbr:           string;\n  direction:      number;\n  snowMiles:      Array<Array<Snowpoint>>;\n}\n\nexport class Snowpoint {\n\n  public elevation?:       number;           // optional elevation\n  public distance?:        number;           // percentage within mile (so it won't have to be recalculated)\n\n  constructor(elevation: number, distance: number) {\n    this.elevation = elevation;\n    this.distance = distance;\n  }\n}\n","export const environment = {\n\n  production: true,\n  simulateTouch: false,           //  simulate touch with hammerjs, production must be set to false\n\n  version: '1.0',     // current application version that settings belong to (in case of update to settings structure)\n\n  // FILES\n  // PRODUCTION SERVER:\n  // appDomain: 'https://storage.googleapis.com/',\n  // fileBaseUrl: 'just-hike/',\n\n  // TEST SERVER:\n  appDomain: 'https://hike.frankdouwes.com/',\n  fileBaseUrl: 'files/',\n\n  mailto: 'https://hike.frankdouwes.com/scripts/mailto.php',       // TODO: BETA only\n\n\n  updateCheckInterval: 86400000,      // the time between (online) data update checks\n  onlineTileUrl: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\n\n  MILE: 1609.344,    // mile in meters\n  FOOT: 0.3048,      // foot in meters\n  LINEHEIGHT: 4,     // main line thickness\n\n  // user preferences\n  DEFAULT_USER_SETTINGS: {\n\n    activeTrailId: 0,               // the ID of the current trail\n    purchasedTrails: [],            // IDs of purchased trails\n    direction: 0,                   // northbound (0) or southbound (1)\n    showSnow: true,                 // draw the snowpack\n    showMiniMap: true,              // show mini map in elevation profile\n    showMileGrid: false,            // show square mile grid\n    animateMap: false,              // animate the map transitions (panning)\n\n    poiDistanceOffTrail: 250,       // distance (in feet?) that a water source has to be off trail to be rendered as such\n    poiMaxDistance: 1000,           // the maximum distance before a poi is ignored (and not rendered), eliminates side trail poi\n    userDistanceOffTrail: 10,       // the distance (in feet?) that a user has to be off trail for marker to change\n    autoUpdate: true,               // auto download updates (only used for snow data) (TODO UNUSED v1)\n\n    // major markers visibility (elevation profile)\n    showWater: true,\n    showCamp: true,\n    showHighway: false,                // not showing roads by default\n    showEnd: true,\n\n    // internal\n    maxPoiDistance: 1,              // maximum poi distance from trail (in mi) to be included in the app\n    scrollbarSegmentSize: 26,       // scrollbar (elevation profile) renders 1 point for every X points)\n    simulatedMile: -1,              // the simulated mile number\n    userName: 'Hiker',              // default username\n\n    // elevationProfile\n    parallaxEnabled: false,         // parallax effect in elevation profile\n    screenMode: 'default',          // 'default', 'highContrast' or 'nighHike'\n    detectRetina: false             // disable retina by default (battery saving)\n  },\n\n\n  // Data set by DEVs before generating new trail data.\n  TRAILS_GENERATION: [\n    {\n      abbr: 'DEMO',\n      id: 0,\n      trailVersion: '1.1',\n      tilesVersion: '1.0',\n      snowVersion: '1.0',\n      hasTowns: true,                   // has a seperate file for towns\n      length: 109.5,                    // estimated length (first section is 109.5)\n      dataPath: 'DEMO/',\n      scrollbarSegmentSize: 100,        // one scrollbar segment for every X miles\n      multipart: false\n    }, {\n      abbr: 'PCT',\n      id: 1,\n      trailVersion: '1.1',\n      tilesVersion: '1.0',\n      snowVersion: '1.0',\n      hasTowns: true,                   // has a seperate file for towns\n      length: [109.5, 100, 132.5, 112.5, 111.9, 85.6, 115, 175.5, 74.4, 75.4,\n        64.8, 38.3, 91.4, 132.2, 82.2, 98.5, 56.2, 63, 54.5, 74.4, 60.1, 75.9,\n        107.9, 55, 148.2, 98.3, 70.9, 127, 70.3],     // estimated length (including 8mi into Canada) according to halfmile pct data\n      dataPath: 'PCT/',\n      scrollbarSegmentSize: 200,       // one scrollbar segment for every X miles\n      multipart: true,\n      parts: 29\n    }, {\n      abbr: 'CDT',\n      id: 2,\n      trailVersion: '1.0',\n      tilesVersion: '1.0',\n      snowVersion: '1.0',\n      length: 3011,                    // estimated length\n      dataPath: 'CDT/',\n      scrollbarSegmentSize: 200,       // one scrollbar segment for every X miles\n      multipart: false,\n\n    }, {\n      abbr: 'AT',\n      id: 3,\n      trailVersion: '1.0',\n      tilesVersion: '1.0',\n      snowVersion: '1.0',\n      length: 2199,                    // estimated length\n      dataPath: 'AT/',\n      scrollbarSegmentSize: 200,       // one scrollbar segment for every X miles\n      multipart: false,\n    }, {\n      abbr: 'SHR',\n      id: 4,\n      trailVersion: '1.0',\n      tilesVersion: '1.0',\n      length: 215,                      // estimated length\n      dataPath: 'SHR/',\n      scrollbarSegmentSize: 100,        // one scrollbar segment for every X miles\n      multipart: false,\n    }\n  ]\n};\n","import 'hammerjs';\n\nimport { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment.prod';\nimport * as TouchEmulator from 'hammer-touchemulator/touch-emulator';\n\nif (environment.simulateTouch) {\n  TouchEmulator();\n}\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","/* (ignored) */"],"sourceRoot":""}