<div id="wrap">

  <cdk-virtual-scroll-viewport
    *ngIf="trailData"

    #scrollViewport

    itemSize="{{itemWidth}}"
    orientation="horizontal"
    class="virtual-list"
    templateCacheSize="14"

    (window:resize)="onResize($event)"
    (scrolledIndexChange)="onScroll(scrollViewport, $event)">

    <!-- the virtual list item trackBy: trackElementBy -->
    <display-list-item
      class="list-item"

      *cdkVirtualFor="let li of trailData.miles; let last = last; templateCacheSize: trailData.miles.length / 10; trackBy: trackElementBy"
      [resize]="resize"
      [data]="li"
      [isLast]="last"

      [user]="(user && li.id === user.nearestMileId) ? user : null"
      [triggerUserUpdate]="(user && status === 'tracking' && li.id === user.nearestMileId) ? timestamp : null"
      [userStatus] = "(user && li.id === user.nearestMileId) ? status : null"

      [visibleOHLC]="visibleOHLC"
      [guides]="guides"

      (click)="onClick(li)">
      matRipple
    </display-list-item>

    <!-- runs under marker layer (in list item) -->
    <guides id="guides" [visibleOHLC]="visibleOHLC" [guides]="guides"></guides>

  </cdk-virtual-scroll-viewport>

</div>

<!-- runs above marker layer (in list item) -->
<axis id="axis" [visibleOHLC]="visibleOHLC" [guides]="guides"></axis>
